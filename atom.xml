<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>LeBronChao&#39;s Blog</title>
  
  
  <link href="https://lebronchao.com/atom.xml" rel="self"/>
  
  <link href="https://lebronchao.com/"/>
  <updated>2022-10-12T15:59:18.000Z</updated>
  <id>https://lebronchao.com/</id>
  
  <author>
    <name>LeBronChao-</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>JavaScriptè®¾è®¡æ¨¡å¼-å‘å¸ƒè®¢é˜…æ¨¡å¼</title>
    <link href="https://lebronchao.com/2022/10/12/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F/"/>
    <id>https://lebronchao.com/2022/10/12/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F/</id>
    <published>2022-10-12T15:59:18.000Z</published>
    <updated>2022-10-12T15:59:18.000Z</updated>
    
    <content type="html"><![CDATA[<h1>ä»€ä¹ˆæ˜¯å‘å¸ƒ â€” è®¢é˜…æ¨¡å¼</h1><p>å‘å¸ƒ â€” è®¢é˜…æ¨¡å¼ï¼Œå®ƒå®šä¹‰ç¨‹åºå¯¹è±¡ä¹‹é—´ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–å®ƒçš„å¯¹è±¡éƒ½å°†å¾—åˆ°é€šçŸ¥å¹¶æ‰§è¡Œç›¸åº”æ“ä½œã€‚åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œå¸¸è§çš„å‘å¸ƒè®¢é˜…æ¨¡å¼æœ‰ï¼šè®¢é˜…å·ï¼Œç”¨æˆ·å…³æ³¨è®¢é˜…å·ï¼Œå†…å®¹åˆ›ä½œè€…åœ¨å¹³å°å‘å¸ƒå†…å®¹åï¼Œå¹³å°éå†ç²‰ä¸åˆ—è¡¨è¿›è¡Œå†…å®¹æ¨é€ï¼›é”€å”®ä¸­ä»‹ï¼Œå®¢æˆ·ç»™é”€å”®äººå‘˜ç•™ä¸‹äº†å®¢æˆ·ä¿¡æ¯åŠè”ç³»æ–¹å¼ï¼Œåœ¨æ–°äº§å“æ¨å‡ºæ—¶ï¼ŒæŒ¨ä¸ªç»™å®¢æˆ·æ‰“ç”µè¯è¿›è¡Œæ¨é”€ï¼Œç­‰ç­‰â€¦ è€Œå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œä¸€èˆ¬ç”±ä¸‰ç±»å¯¹è±¡ç»„æˆï¼š</p><ul><li>å‘å¸ƒè€… Publisher<ul><li>äº‹ä»¶å‘å¸ƒè€…ï¼Œå°†éœ€è¦å‘å¸ƒçš„äº‹ä»¶ä¼ é€’ç»™ä¿¡é“ä¸­ä»‹</li></ul></li><li>ä¿¡é“ä¸­ä»‹ Event Channel<ul><li>ä½œä¸ºå‘å¸ƒè®¢é˜…çš„ä¸­ä»‹ï¼Œéœ€è¦ç¼“å­˜ç›¸åº”äº‹ä»¶çš„è®¢é˜…è€…åˆ—è¡¨ï¼Œåœ¨å‘å¸ƒè€…å‘å¸ƒæ—¶éå†è®¢é˜…è€…åˆ—è¡¨å¹¶é€šçŸ¥å®ƒä»¬</li></ul></li><li>è®¢é˜…è€… Subscriber<ul><li>è®¢é˜…äº‹ä»¶ï¼Œå¹¶å®šä¹‰äº‹ä»¶å‘å¸ƒåçš„æ“ä½œï¼Œå‘ä¿¡é“ä¸­ä»‹å‘èµ·è®¢é˜…</li></ul></li></ul><h1>å‘å¸ƒ â€” è®¢é˜…æ¨¡å¼çš„åº”ç”¨</h1><p>åœ¨ä¸Šé¢ä¹Ÿä»‹ç»åˆ°äº†å‘å¸ƒè®¢é˜…æ¨¡å¼åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ä»¥åŠå‰ç«¯å¼€å‘å·¥ä½œä¸­çš„ä½¿ç”¨åœºæ™¯ï¼Œä¾‹å¦‚åŸç”Ÿ DOM äº‹ä»¶ï¼Œæš´éœ²äº†è®¢é˜…æ¥å£åï¼Œå¼€å‘è€…ä¸éœ€è¦åå¤æŸ¥è¯¢è¯¥äº‹ä»¶æ˜¯å¦å®Œæˆï¼›å¼‚æ­¥ç¼–ç¨‹çš„è¯·æ±‚ä¸­ï¼Œå¼€å‘è€…æ— éœ€è½®è¯¢ HTTP è¯·æ±‚çš„çŠ¶æ€ï¼Œå¯ä»¥é€šè¿‡è®¢é˜…è¯·æ±‚çš„ successã€errorã€update ç­‰äº‹ä»¶ã€‚åœ¨ç¼–ç¨‹é£æ ¼ä¸Šï¼Œå‘å¸ƒè®¢é˜…æ¨¡å¼è®©ä¸¤ä¸ªå¯¹è±¡åœ¨æ¾è€¦åˆçš„æƒ…å†µä¸‹å»ºç«‹è”ç³»ï¼Œä¸å†éœ€è¦æ˜¾å¼çš„å°†æ¥å£è°ƒç”¨ç¡¬ç¼–ç è€¦åˆè¿›å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå‘å¸ƒè€…å’Œè®¢é˜…è€…å‘ç”Ÿå„è‡ªä»£ç çš„å˜æ›´éƒ½ä¸ä¼šå½±å“åˆ°å¯¹æ–¹ï¼Œä¸‹é¢æ¥çœ‹çœ‹å‰ç«¯å¼€å‘æœ€å¸¸è§çš„å‘å¸ƒè®¢é˜…æ¨¡å¼åº”ç”¨ï¼š DOM äº‹ä»¶å’Œè‡ªå®šä¹‰äº‹ä»¶ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/006APoFYly8gx7yenv02qg30b90b9qhj.gif" alt="çŒ«å’ªæ‹äº†æ‹ä½ "></p><h2 id="DOM-äº‹ä»¶">DOM äº‹ä»¶</h2><blockquote><p>ç”±ç®€å…¥ç¹ï¼Œ DOM äº‹ä»¶æ˜¯å‰ç«¯å¼€å‘ä¸­æœ€å¸¸è§ã€ç®€å•çš„å‘å¸ƒè®¢é˜…æ¨¡å¼åº”ç”¨</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.body.addEventListener(</span><br><span class="line">  <span class="string">&#x27;click&#x27;</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="number">1</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="literal">false</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¢åŠ è®¢é˜…è€…å‰è€…ä¹Ÿä¸å—å½±å“</span></span><br><span class="line"><span class="built_in">document</span>.body.addEventListener(</span><br><span class="line">  <span class="string">&#x27;click&#x27;</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="number">2</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="literal">false</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.body.click(); <span class="comment">// æ¨¡æ‹Ÿç”¨æˆ·ç‚¹å‡»</span></span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰äº‹ä»¶">è‡ªå®šä¹‰äº‹ä»¶</h2><blockquote><p>ç”±ä¸Šè¿°è®¢é˜…å·ä¸ºä¾‹å­å®ç°ä¸€ä¸ªç®€æ˜“çš„è‡ªå®šä¹‰äº‹ä»¶ï¼Œè¿›é˜¶å‘å¸ƒè®¢é˜…æ¨¡å¼åº”ç”¨</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> subscription = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢é˜…è€…åˆ—è¡¨</span></span><br><span class="line">subscription.subscriber = [];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢é˜…å‡½æ•°</span></span><br><span class="line">subscription.subscribe = <span class="function"><span class="keyword">function</span> (<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.subscriber.push(fn);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¸ƒå‡½æ•°</span></span><br><span class="line">subscription.publish = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.subscriber.forEach(<span class="function">(<span class="params">fn</span>) =&gt;</span> &#123;</span><br><span class="line">    fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç²‰ä¸ 1 è®¢é˜…</span></span><br><span class="line">subscription.subscribe(<span class="function">(<span class="params">article</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`fans1 receive <span class="subst">$&#123;article&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç²‰ä¸ 2 è®¢é˜…</span></span><br><span class="line">subscription.subscribe(<span class="function">(<span class="params">article</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`fans2 receive <span class="subst">$&#123;article&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢é˜…å·å‘å¸ƒ</span></span><br><span class="line"><span class="keyword">const</span> article = <span class="string">&#x27;article&#x27;</span>;</span><br><span class="line">subscription.publish(article);</span><br><span class="line"><span class="comment">// fans1 receive article</span></span><br><span class="line"><span class="comment">// fans2 receive article</span></span><br></pre></td></tr></table></figure><h2 id="é€šç”¨å‘å¸ƒ-è®¢é˜…æ¨¡å¼">é€šç”¨å‘å¸ƒ - è®¢é˜…æ¨¡å¼</h2><blockquote><p>ä¸Šé¢è‡ªå®šä¹‰äº‹ä»¶çš„ä¾‹å­ï¼Œä»…èƒ½å±€é™åœ¨å•ä¸ªè®¢é˜…å·åœºæ™¯</p><p>ä¸‹é¢é€šè¿‡ key å°†äº‹ä»¶çš„å‘å¸ƒå’Œè®¢é˜…è¿›è¡Œéš”ç¦»ï¼Œå®ç°é€šç”¨çš„å‘å¸ƒè®¢é˜…æ¨¡å¼</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/0065btHFly1gvzh4jb626g306o06otzd.gif" alt="å…ƒæ°”æ»¡æ»¡!å¼€å¹²å§! - kittyé…±è¡¨æƒ…åŒ…_å¡é€š_å¡é€šè¡¨æƒ…"></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é€šç”¨å‘å¸ƒè®¢é˜…æ¨¡å¼</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventEmitter</span> </span>&#123;</span><br><span class="line">  <span class="comment">// è®¢é˜…è€…åˆ—è¡¨</span></span><br><span class="line">  subscriber = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è®¢é˜…</span></span><br><span class="line">  <span class="function"><span class="title">subscribe</span>(<span class="params">key, fn</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(<span class="built_in">this</span>.subscriber[key])) &#123;</span><br><span class="line">      <span class="built_in">this</span>.subscriber[key] = [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">this</span>.subscriber[key].push(fn);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å–æ¶ˆå•ä¸ªè®¢é˜…</span></span><br><span class="line">  <span class="function"><span class="title">unsubscribe</span>(<span class="params">key, fn</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> subscribers = <span class="built_in">this</span>.subscriber[key] || [];</span><br><span class="line">    <span class="built_in">this</span>.subscriber[key] = subscribers.filter(<span class="function">(<span class="params">_fn</span>) =&gt;</span> _fn !== fn);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å–æ¶ˆæ‰€æœ‰è®¢é˜…</span></span><br><span class="line">  <span class="function"><span class="title">unsubscribeAll</span>(<span class="params">key</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.subscriber[key] = [];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å‘å¸ƒ</span></span><br><span class="line">  <span class="function"><span class="title">publish</span>(<span class="params">key, ...args</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> subscribers = <span class="built_in">this</span>.subscriber[key] || [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (subscribers.length === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;has&#x27;t subscriber&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    subscribers.forEach(<span class="function">(<span class="params">subscriber</span>) =&gt;</span> &#123;</span><br><span class="line">      subscriber.apply(<span class="built_in">this</span>, args);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºå‘å¸ƒè®¢é˜…ä¿¡é“ä¸­ä»‹</span></span><br><span class="line"><span class="keyword">const</span> e = <span class="keyword">new</span> EventEmitter();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¸ƒè€…</span></span><br><span class="line"><span class="keyword">const</span> publisher = &#123;</span><br><span class="line">  article1: <span class="string">&#x27;article1&#x27;</span>,</span><br><span class="line">  article2: <span class="string">&#x27;article2&#x27;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢é˜…è€…</span></span><br><span class="line"><span class="keyword">const</span> subscriber1 = <span class="function">(<span class="params">article</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`fans1 receive <span class="subst">$&#123;article&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> subscriber2 = <span class="function">(<span class="params">article</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`fans2 receive <span class="subst">$&#123;article&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢é˜…æ“ä½œ</span></span><br><span class="line">e.subscribe(<span class="string">&#x27;event1&#x27;</span>, subscriber1);</span><br><span class="line">e.subscribe(<span class="string">&#x27;event1&#x27;</span>, subscriber2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¸ƒæ“ä½œ</span></span><br><span class="line">e.publish(<span class="string">&#x27;event1&#x27;</span>, publisher.article1);</span><br><span class="line"><span class="comment">// fans1 receive article1</span></span><br><span class="line"><span class="comment">// fans2 receive article1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤šäº‹ä»¶å‘å¸ƒè®¢é˜…</span></span><br><span class="line">e.subscribe(<span class="string">&#x27;event2&#x27;</span>, subscriber1);</span><br><span class="line">e.publish(<span class="string">&#x27;event2&#x27;</span>, publisher.article1);</span><br><span class="line"><span class="comment">// fans1 receive article1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å–æ¶ˆå•ä¸ªè®¢é˜…</span></span><br><span class="line">e.unsubscribe(<span class="string">&#x27;event1&#x27;</span>, subscriber1);</span><br><span class="line">e.publish(<span class="string">&#x27;event1&#x27;</span>, publisher.article2);</span><br><span class="line"><span class="comment">// fans2 receive article2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å–æ¶ˆæ‰€æœ‰è®¢é˜…</span></span><br><span class="line">e.unsubscribeAll(<span class="string">&#x27;event1&#x27;</span>);</span><br><span class="line">e.publish(<span class="string">&#x27;event1&#x27;</span>);</span><br><span class="line"><span class="comment">// has&#x27;t subscriber</span></span><br></pre></td></tr></table></figure><h2 id="æ¨¡å—é—´é€šä¿¡">æ¨¡å—é—´é€šä¿¡</h2><p>æ¨¡æ‹Ÿå¦‚ä¸‹åœºæ™¯ï¼Œåœ¨ä¸€ä¸ªä¸­å°å‹å¹³å°ä¸Šå¯ä»¥æ¥å…¥å¤šæ¬¾åº”ç”¨ï¼Œåˆ‡æ¢ä¸åŒçš„åº”ç”¨æ—¶éœ€è¦ï¼š</p><ul><li>æ‹‰å–æ–°çš„åº”ç”¨ä¿¡æ¯</li><li>æ‹‰å–æ–°çš„åº”ç”¨è®¾ç½®</li><li>æ‹‰å–ç”¨æˆ·å¯¹æ–°åº”ç”¨çš„æƒé™ä¿¡æ¯</li><li>é‡ç½®ç³»åˆ—ç¼“å­˜æ•°æ®</li></ul><p>è€Œè¿™äº›ä¸šåŠ¡é€»è¾‘å’Œæ“ä½œåˆå°è£…åœ¨å„è‡ªçš„ store æˆ–è€…ç»„ä»¶é‡Œï¼Œå¦‚æœæ²¡æœ‰åº”ç”¨å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œå¯èƒ½ä»£ç æ˜¯ä¸‹é¢è¿™ç§æƒ…å†µï¼›å¦‚æœæœ‰æ–°å¢ä¸€ä¸ªåˆ‡æ¢åº”ç”¨çš„å…¥å£ï¼Œåˆéœ€è¦ CV ä¸€éåŒæ ·çš„ä»£ç ï¼›</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/ceeb653ely8h4lawhh9scg206o06o4kv.gif" alt="èœç‹—åƒèœåŠ¨å›¾è¡¨æƒ…åŒ…_èœç‹—_èœåŠ¨è¡¨æƒ…-å‘è¡¨æƒ…"></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ§åˆ¶å°é¡µé¢</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">openApp</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  userStore.getPermission();</span><br><span class="line">  appStore.getAppInfo();</span><br><span class="line">  settingStore.getAppSetting();</span><br><span class="line">  dataStore.resetDataCache();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œå¦‚æœåº”ç”¨äº†å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œåªéœ€åœ¨å„è‡ªçš„æ¨¡å—å†…æ‰§è¡Œè®¢é˜…å’Œå‘å¸ƒæ“ä½œå³å¯ï¼Œé™ä½æ¨¡å—é—´çš„è€¦åˆåº¦</p><p>å¦‚æœæ–°å¢åˆ‡æ¢åº”ç”¨çš„å…¥å£ï¼Œä¹Ÿåªéœ€è¦æ–°å¢ä¸€è¡Œâ€œå‘å¸ƒâ€æ“ä½œçš„ä»£ç </p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/ceeb653ely8h4hf7rdpltj206c06cq2v.jpg" alt="å¯ä»¥å•Šå°ä¼™å„¿_å°ä¼™å„¿_å¯ä»¥è¡¨æƒ…-å‘è¡¨æƒ…"></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// event.js</span></span><br><span class="line"><span class="comment">// åˆ›å»ºå…¨å±€å‘å¸ƒè®¢é˜…ä¿¡é“</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> event = <span class="keyword">new</span> EventEmitter();</span><br><span class="line"><span class="comment">// é›†ä¸­ç»´æŠ¤äº‹ä»¶åç§°  é¿å…å‘½åå†²çª</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> EVENT_TYPE = &#123;</span><br><span class="line">  OPEN_APP: <span class="string">&#x27;OPEN_APP&#x27;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// user.js</span></span><br><span class="line">event.subscribe(EVENT_TYPE.OPEN_APP, getPermission);</span><br><span class="line"><span class="comment">// app.js</span></span><br><span class="line">event.subscribe(EVENT_TYPE.OPEN_APP, getAppInfo);</span><br><span class="line"><span class="comment">// setting.js</span></span><br><span class="line">event.subscribe(EVENT_TYPE.OPEN_APP, getAppSetting);</span><br><span class="line"><span class="comment">// data.js</span></span><br><span class="line">event.subscribe(EVENT_TYPE.OPEN_APP, resetDataCache);</span><br><span class="line"></span><br><span class="line"><span class="comment">// console.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">openApp</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  event.publish(EVENT_TYPE.OPEN_APP);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>è§‚å¯Ÿè€…æ¨¡å¼å’Œå‘å¸ƒ â€” è®¢é˜…æ¨¡å¼</h1><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/image-20221010192001316.png" alt="image-20221010192001316"></p><p>è§‚å¯Ÿè€…æ¨¡å¼å’Œå‘å¸ƒ â€” è®¢é˜…æ¨¡å¼æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼š</p><ul><li>è§‚å¯Ÿè€…æ¨¡å¼ç”±å…·ä½“ç›®æ ‡ï¼ˆè¢«è§‚å¯Ÿå¯¹è±¡ï¼‰è°ƒåº¦</li><li>å‘å¸ƒ â€” è®¢é˜…æ¨¡å¼ç”±è°ƒåº¦ä¸­å¿ƒï¼ˆä¿¡é“ä¸­ä»‹ï¼‰ç»Ÿä¸€è°ƒåº¦</li><li>å‘å¸ƒ â€” è®¢é˜…æ¨¡å¼æ¯”è§‚å¯Ÿè€…æ¨¡å¼å¤šä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒï¼ˆä¿¡é“ä¸­ä»‹ï¼‰</li></ul><blockquote><p>ä¹Ÿå¯ä»¥ç†è§£ä¸ºå‘å¸ƒ â€” è®¢é˜…æ¨¡å¼æ˜¯åŸºäºè§‚å¯Ÿè€…æ¨¡å¼è¿›è¡Œé€šç”¨åŒ–è®¾è®¡ï¼Œæ¾æ•£è€¦åˆï¼Œçµæ´»åº¦æ›´é«˜</p><p>è§‚å¯Ÿè€…æ¨¡å¼å’Œå‘å¸ƒ â€” è®¢é˜…æ¨¡å¼çš„å‰ç«¯å®è·µåˆ†åˆ«æœ‰ Vue çš„æ•°æ®åŒå‘ç»‘å®šå’Œäº‹ä»¶æ€»çº¿ EventBus</p></blockquote><p>å¯¹ Vue ç›¸å…³å®ç°æ„Ÿå…´è¶£å¯ä»¥çœ‹çœ‹ä»¥ä¸‹å‡ ç¯‡æ–‡ç« </p><ul><li><a href="https://juejin.cn/post/6945634348464865317">Vue çš„å‰ä¸–ä»Šç”Ÿ</a></li><li><a href="https://juejin.cn/post/6944887985531781133">Vue è¿›é˜¶ Diff ç®—æ³•è¯¦è§£</a></li><li><a href="https://juejin.cn/post/6982004709145968677">[å»ºè®®æ”¶è—] ä½ æƒ³çŸ¥é“çš„ Vue3 æ ¸å¿ƒæºç è¿™é‡Œéƒ½æœ‰</a></li><li><a href="https://juejin.cn/post/7004635792446324749">[æºç è§£è¯»]ä¸€æ–‡è¯»æ‡‚ Vuex4 æºç </a></li></ul><h1>å°ç»“</h1><p>é˜…è¯»å®Œæœ¬æ–‡ï¼Œæˆ‘ä»¬å¯¹å‘å¸ƒ â€” è®¢é˜…æ¨¡å¼æœ‰äº†ä¸€ä¸ªå¤§è‡´çš„äº†è§£ã€‚å®ƒçš„ä¼˜ç‚¹éå¸¸æ˜æ˜¾ï¼Œæ—¶æœºå’Œå¯¹è±¡ä¸Šçš„è§£è€¦ï¼Œå¹¿æ³›åº”ç”¨äºå¼‚æ­¥ç¼–ç¨‹ï¼ŒåŒæ—¶å¸®åŠ©æˆ‘ä»¬å®Œæˆæ¾è€¦åˆçš„ä»£ç ç¼–å†™ã€‚ä½†ä¹Ÿä¸æ˜¯æ²¡æœ‰ç¼ºç‚¹ï¼Œå¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„å¿…è¦è”ç³»å°†è¢«æ·±åŸ‹åœ¨èƒŒåï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºéš¾ä»¥è·Ÿè¸ªç»´æŠ¤å’Œç†è§£ã€‚åˆ›å»ºè®¢é˜…è€…å¯¹è±¡å’Œå­˜å‚¨åˆ—è¡¨éœ€è¦æ¶ˆè€—ä¸€å®šçš„æ—¶é—´å’Œå†…å­˜ï¼Œè€Œä¸”å­˜åœ¨å¾ˆå¤šè®¢é˜…è€…è®¢é˜…äº†ä¸€ä¸ªäº‹ä»¶ä¹‹åï¼Œè¿™ä¸ªäº‹ä»¶æ²¡æœ‰è§¦å‘ï¼Œè€Œè¿™å—å†…å­˜å´ä¸€ç›´è¢«å ç”¨ã€‚ä¼˜ç¼ºç‚¹éƒ½æœ‰ï¼Œä¸è¦ä¸ºäº†ç”¨è€Œç”¨ï¼Œé€‚åˆåœºæ™¯å’Œä¸šåŠ¡çš„æ‰æ˜¯æœ€å¥½çš„ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/008h4Hg2gy1h2j4m3yf3vg306o06ozz5.gif" alt="ç‚¹èµ - å¯è¾¾é¸­è¡¨æƒ…åŒ…-å‘è¡¨æƒ…"></p><h1>è®¾è®¡æ¨¡å¼ç³»åˆ—æ–‡ç« æ¨è</h1><ul><li><a href="https://www.lebronchao.com/2022/08/21/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” å•ä¾‹æ¨¡å¼</a></li><li><a href="https://www.lebronchao.com/2022/08/21/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” ç­–ç•¥æ¨¡å¼</a></li><li><a href="https://www.lebronchao.com/2022/10/10/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” ä»£ç†æ¨¡å¼</a></li><li><a href="https://www.lebronchao.com/2022/10/12/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” å‘å¸ƒè®¢é˜…æ¨¡å¼</a></li></ul><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;ä»€ä¹ˆæ˜¯å‘å¸ƒ â€” è®¢é˜…æ¨¡å¼&lt;/h1&gt;
&lt;p&gt;å‘å¸ƒ â€” è®¢é˜…æ¨¡å¼ï¼Œå®ƒå®šä¹‰ç¨‹åºå¯¹è±¡ä¹‹é—´ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–å®ƒçš„å¯¹è±¡éƒ½å°†å¾—åˆ°é€šçŸ¥å¹¶æ‰§è¡Œç›¸åº”æ“ä½œã€‚åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œå¸¸è§çš„å‘å¸ƒè®¢é˜…æ¨¡å¼æœ‰ï¼šè®¢é˜…å·ï¼Œç”¨æˆ·å…³æ³¨è®¢é˜…å·ï¼Œå†…å®¹åˆ›ä½œè€…åœ¨å¹³å°å‘å¸ƒå†…å®¹åï¼Œå¹³å°éå†ç²‰</summary>
      
    
    
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://lebronchao.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Front End" scheme="https://lebronchao.com/tags/Front-End/"/>
    
    <category term="JavaScript" scheme="https://lebronchao.com/tags/JavaScript/"/>
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://lebronchao.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="å‘å¸ƒè®¢é˜…æ¨¡å¼" scheme="https://lebronchao.com/tags/%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>JavaScriptè®¾è®¡æ¨¡å¼-ä»£ç†æ¨¡å¼</title>
    <link href="https://lebronchao.com/2022/10/10/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
    <id>https://lebronchao.com/2022/10/10/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/</id>
    <published>2022-10-09T16:24:29.000Z</published>
    <updated>2022-10-09T16:24:29.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¥½ä¹…ä¸è§ï¼Œæ€ä¹ˆè¿™ä¹ˆä¹…æ²¡æ›´æ–°äº†å‘¢ï¼Ÿ</p><p>Emmâ€¦æœ€è¿‘ç»©æ•ˆè¯„ä¼°å­£ï¼Œç»©æ•ˆæ€»ç»“ã€360 è¯„ä¼°ï¼Œè¦å†™çš„ä¸œè¥¿æ¯”è¾ƒå¤šåš¯ï¼Œè€½æäº†ä¸€æ®µæ—¶é—´</p><p>åºŸè¯ä¸å¤šè¯´ï¼Œè¿æ¥ JavaScript è®¾è®¡æ¨¡å¼ç¬¬ä¸‰ç¯‡ï¼šä»£ç†æ¨¡å¼ ~</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/bef3df8agy1fcnwggurzej208c08c74y.jpg" alt="ç¾å¥½çš„ä¸€å¤©ä»å­¦ä¹ å¼€å§‹ - åšä¸ªçˆ±å­¦ä¹ çš„ doge_å­¦ä¹ _doge_è£…é€¼_èŒèŒå“’è¡¨æƒ…"></p><h1>ä»£ç†æ¨¡å¼æ¦‚å¿µ</h1><p>ä»£ç†æ¨¡å¼ç»™æŸä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†å¯¹è±¡æˆ–è€…å ä½ç¬¦ï¼Œå¹¶ç”±ä»£ç†å¯¹è±¡æ§åˆ¶åŸå¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºå¯¹å¤–æš´éœ²çš„æ¥å£å¹¶ä¸æ˜¯åŸå¯¹è±¡ã€‚é€šä¿—åœ°è®²ï¼Œç”Ÿæ´»ä¸­ä¹Ÿæœ‰æ¯”è¾ƒå¸¸è§çš„ä»£ç†æ¨¡å¼ï¼šä¸­ä»‹ã€å¯„å–ã€ç»çºªäººç­‰ç­‰ã€‚è€Œè¿™ç§æ¨¡å¼å­˜åœ¨çš„æ„ä¹‰åœ¨äºå½“è®¿é—®è€…ä¸è¢«è®¿é—®è€…ä¸æ–¹ä¾¿ç›´æ¥è®¿é—®/æ¥è§¦çš„æƒ…å†µä¸‹ï¼Œæä¾›ä¸€ä¸ªæ›¿èº«æ¥å¤„ç†äº‹åŠ¡æµç¨‹ï¼Œå®é™…è®¿é—®çš„æ˜¯æ›¿èº«ï¼Œæ›¿èº«å°†äº‹åŠ¡åšäº†ä¸€äº›å¤„ç†/è¿‡æ»¤ä¹‹åï¼Œå†è½¬äº¤ç»™æœ¬ä½“å¯¹è±¡ä»¥å‡è½»æœ¬ä½“å¯¹è±¡çš„è´Ÿæ‹…ã€‚</p><h1>æœ€ç®€ä»£ç†æ¨¡å¼å®ç°</h1><blockquote><p>ç”±ç®€å…¥ç¹</p></blockquote><p>ä¸Šé¢äº†è§£äº†ä»£ç†æ¨¡å¼çš„ç›¸å…³æ¦‚å¿µï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç”¨ä¸€ä¸ªæœ€ç®€ä»£ç†æ¨¡å¼çš„ä¾‹å­å®ç°ä¸€ä¸‹ä»£ç†æ¨¡å¼ï¼Œä»ä»£ç ä¸­æ„Ÿå—ä»£ç†æ¨¡å¼çš„æµç¨‹</p><blockquote><p>Talk is Cheap. Show me the code!</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/image-20220919195415997.png" alt="image-20220919195415997"></p><ul><li>client å‘æœåŠ¡ç«¯å‘é€ä¸€ä¸ªè¯·æ±‚</li><li>proxy ä»£ç†è¯·æ±‚è½¬å‘ç»™æœåŠ¡ç«¯</li><li>æœåŠ¡ç«¯å¤„ç†è¯·æ±‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Request = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> client = &#123;</span><br><span class="line">  requestTo: <span class="function">(<span class="params">server</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> req = <span class="keyword">new</span> Request();</span><br><span class="line">    server.receiveRequest(req);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = &#123;</span><br><span class="line">  handleRequest: <span class="function">(<span class="params">request</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;receive request: &#x27;</span>, request);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proxy = &#123;</span><br><span class="line">  receiveRequest: <span class="function">(<span class="params">request</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;proxy request: &#x27;</span>, request);</span><br><span class="line">    server.handleRequest(request);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">client.requestTo(proxy);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * proxy request:  Request &#123;&#125;</span></span><br><span class="line"><span class="comment"> * receive request:  Request &#123;&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h1>ä¿æŠ¤ä»£ç†</h1><blockquote><p>ä¿æŠ¤ä»£ç†ï¼Œé¡¾åæ€ä¹‰æ˜¯ä¸ºäº†ä¿æŠ¤æœ¬ä½“</p><p>åŸºäºæƒé™æ§åˆ¶å¯¹èµ„æºçš„è®¿é—®</p></blockquote><p>ä¸‹é¢ç”¨ä¸€ä¸ªåœºæ™¯å’Œä¾‹å­æ¥å®é™…æ„Ÿå—ä¸€ä¸‹ï¼ŒåŸºäºä¸Šé¢æœ€ç®€ä»£ç†æ¨¡å¼è¿›è¡Œæ‰©å±•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¿æŠ¤ä»£ç†å®ç°ï¼Œè¿‡æ»¤æœªé€šè¿‡èº«ä»½æ ¡éªŒçš„è¯·æ±‚ã€ç›‘å¬æœåŠ¡ç«¯ ready æ‰å‘é€è¯·æ±‚ç­‰æ“ä½œï¼Œä¿æŠ¤å®ä½“æœåŠ¡ç«¯ä¸è¢«éæ³•è¯·æ±‚æ”»å‡»å’Œé™ä½æœåŠ¡ç«¯è´Ÿæ‹…ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> proxy = &#123;</span><br><span class="line">  receiveRequest: <span class="function">(<span class="params">request</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒèº«ä»½</span></span><br><span class="line">    <span class="keyword">const</span> pass = validatePassport(request);</span><br><span class="line">    <span class="keyword">if</span> (pass) &#123;</span><br><span class="line">      <span class="comment">// ç›‘å¬æœåŠ¡ç«¯ ready åä»£ç†è¯·æ±‚</span></span><br><span class="line">      server.listenReady(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;proxy request: &#x27;</span>, request);</span><br><span class="line">        server.handleRequest(request);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1>è™šæ‹Ÿä»£ç†</h1><blockquote><p>è™šæ‹Ÿä»£ç†ä½œä¸ºåˆ›å»ºå¼€é”€å¤§çš„å¯¹è±¡çš„ä»£è¡¨ï¼ŒååŠ©æ§åˆ¶åˆ›å»ºå¼€é”€å¤§çš„èµ„æºï¼Œç›´åˆ°çœŸæ­£éœ€è¦ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™å†å»åˆ›å»ºå®ƒï¼Œç”±è™šæ‹Ÿä»£ç†æ¥æ‰®æ¼”å¯¹è±¡çš„æ›¿èº«ï¼Œå¯¹è±¡åˆ›å»ºåï¼Œå†å°†èµ„æºç›´æ¥å§”æ‰˜ç»™å®ä½“å¯¹è±¡</p></blockquote><p>ä¸‹é¢å°†ä¼šå®ç°ä¸€ä¸ªè™šæ‹Ÿä»£ç†å®ç°å›¾ç‰‡é¢„åŠ è½½çš„ä¾‹å­ï¼Œä»ä»£ç å’Œå®é™…åœºæ™¯ä¸­æ„Ÿå—è™šæ‹Ÿä»£ç†çš„ä½œç”¨ã€‚</p><ul><li>å®ä½“å›¾ç‰‡å¯¹è±¡æŒ‚è½½åœ¨ body ä¸­</li><li>ç”±äºåŠ è½½å›¾ç‰‡è€—æ—¶è¾ƒé«˜ï¼Œå¼€é”€è¾ƒå¤§ï¼ŒåŠ è½½å›¾ç‰‡èµ„æºæ—¶<ul><li>å°†å®ä½“å›¾ç‰‡å¯¹è±¡è®¾ç½®ä¸º loading çŠ¶æ€</li><li>ä½¿ç”¨æ›¿èº«å¯¹è±¡æ‰§è¡Œå›¾ç‰‡èµ„æºåŠ è½½</li><li>ç›‘å¬æ›¿èº«å¯¹è±¡èµ„æºåŠ è½½å®Œæˆï¼Œå°†èµ„æºæ›¿æ¢ç»™å®ä½“å¯¹è±¡</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> img = (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> imgNode = <span class="built_in">document</span>.createElement(<span class="string">&#x27;img&#x27;</span>);</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(img);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    setSrc: <span class="function">(<span class="params">src</span>) =&gt;</span> &#123;</span><br><span class="line">      imgNode.src = src;</span><br><span class="line">    &#125;,</span><br><span class="line">    setLoading: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      imgNode.src = <span class="string">&#x27;loading.gif&#x27;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proxyImg = (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// æ›¿èº«å›¾ç‰‡å¯¹è±¡</span></span><br><span class="line">  <span class="keyword">const</span> tempImg = <span class="keyword">new</span> Image();</span><br><span class="line">  <span class="comment">// ç›‘å¬èµ„æºåŠ è½½å®Œæˆï¼Œå°†èµ„æºæ›¿æ¢ç»™å®ä½“å›¾ç‰‡å¯¹è±¡</span></span><br><span class="line">  tempImg.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    img.setSrc(<span class="built_in">this</span>.src);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// ä»£ç†å¼€å§‹å°†å®ä½“å¯¹è±¡è®¾ç½®ä¸ºloadingçŠ¶æ€ï¼Œä½¿ç”¨æ›¿èº«å¯¹è±¡å¼€å§‹åŠ è½½å›¾ç‰‡èµ„æº</span></span><br><span class="line">    setSrc: <span class="function">(<span class="params">src</span>) =&gt;</span> &#123;</span><br><span class="line">      img.setLoading();</span><br><span class="line">      tempImg.src = src;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">proxyImg.setSrc(<span class="string">&#x27;file.jpg&#x27;</span>);</span><br></pre></td></tr></table></figure><h1>ä»£ç†æ¨¡å¼çš„åº”ç”¨</h1><blockquote><p>çœ‹å®Œä¿æŠ¤ä»£ç†å’Œè™šæ‹Ÿä»£ç†ä¹‹åï¼Œä¸‹é¢æ¥çœ‹çœ‹ä»£ç†æ¨¡å¼åœ¨å‰ç«¯ä¸­çš„ä¸€äº›å…·ä½“åº”ç”¨</p></blockquote><h2 id="è¯·æ±‚ä¼˜åŒ–ï¼ˆåŸ‹ç‚¹ã€é”™è¯¯èšåˆä¸ŠæŠ¥ï¼‰">è¯·æ±‚ä¼˜åŒ–ï¼ˆåŸ‹ç‚¹ã€é”™è¯¯èšåˆä¸ŠæŠ¥ï¼‰</h2><p>å‰æ®µæ—¶é—´æœ‰å¹¸å—é‚€å‚åŠ äº† ByteTech å­—èŠ‚é’è®­è¥çš„è¯„å§”ï¼Œä¸»è¦å‚åŠ è¯„å®¡çš„æ˜¯å‰ç«¯ç›‘æ§ç³»ç»Ÿä¸»é¢˜é¡¹ç›®ã€‚å‰ç«¯ç›‘æ§å°±ä¼šæ¶‰åŠä¸€äº›é”™è¯¯ç­‰ä¿¡æ¯çš„ä¸ŠæŠ¥ï¼Œéƒ¨åˆ†é¡¹ç›®åªå®ç°äº†æœ€ç®€çš„ HTTP è¯·æ±‚ä¸ŠæŠ¥ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/008h4Hg2gy1h243zghtz6j30u00u078d.jpg" alt="ä¸è¯·è‡ªæ¥ä½ ä»¬çœŸèƒ½å·é¾™å·é£éƒ½è¢«ä½ ä»¬å·æ¥äº†"></p><p>è€Œæœ‰éƒ¨åˆ†é¡¹ç›®å¯¹è¿™å—å†…å®¹åšäº†ä»¥ä¸‹ä¼˜åŒ–ï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒè´´åˆ‡çš„ä»£ç†æ¨¡å¼å®è·µåœºæ™¯ï¼š</p><ul><li>Navigator.sendBeacon<ul><li>ä½¿ç”¨æˆ·ä»£ç†åœ¨æœ‰æœºä¼šæ—¶å¼‚æ­¥åœ°å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼ˆ HTTP POST ï¼‰ï¼Œä¸å½±å“äº¤äº’æ€§èƒ½</li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Navigator/sendBeacon">https://developer.mozilla.org/zh-CN/docs/Web/API/Navigator/sendBeacon</a></li></ul></li><li>æ•°æ®èšåˆä¸ŠæŠ¥ï¼ˆæœªä½¿ç”¨ä»£ç†æ¨¡å¼ä¼˜åŒ–ç‰ˆæœ¬ä¸ºï¼Œæ¯æ¬¡ report éƒ½ä½¿ç”¨è¯·æ±‚ä¸ŠæŠ¥ï¼‰<ul><li>é™ä½è¯·æ±‚æ¬¡æ•°ï¼Œèšåˆå¤šäº‹ä»¶/ä¿¡æ¯è¿›è¡Œä¸ŠæŠ¥<ul><li>å®šæ—¶</li><li>å®šé‡åˆ†ç»„</li></ul></li></ul></li></ul><blockquote><p>ä¸‹é¢ç®€å•å®ç°ä¸€ä¸‹ä¸¤ç§ä¸ŠæŠ¥çš„ç¤ºæ„ä»£ç </p></blockquote><ul><li>å®šæ—¶</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> events = [];</span><br><span class="line"><span class="keyword">const</span> TIMER = <span class="number">10000</span>;</span><br><span class="line"><span class="keyword">let</span> timer = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> init = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–æ—¶å¯åŠ¨å®šæ—¶å™¨</span></span><br><span class="line">  timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// å®šæ—¶ä½¿ç”¨ sendBeacon ä¸ŠæŠ¥</span></span><br><span class="line">    <span class="keyword">const</span> evts = events.splice(<span class="number">0</span>, events.length);</span><br><span class="line">    navigator.sendBeacon(<span class="string">&#x27;/path&#x27;</span>, &#123; <span class="attr">events</span>: evts &#125;);</span><br><span class="line">  &#125;, TIMER);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> destroyed = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// é”€æ¯æ—¶æ¸…é™¤å®šæ—¶å™¨</span></span><br><span class="line">  <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> report = <span class="function">(<span class="params">eventName, data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// sdk ä¸ŠæŠ¥å·¥å…·å‡½æ•°ï¼Œèšåˆäº‹ä»¶</span></span><br><span class="line">  events.push(&#123;</span><br><span class="line">    eventName,</span><br><span class="line">    data,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>å®šé‡åˆ†ç»„</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> events = [];</span><br><span class="line"><span class="keyword">const</span> LIMIT = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> reportRequest = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// å®šé‡åˆ†ç»„ä½¿ç”¨ sendBeacon ä¸ŠæŠ¥</span></span><br><span class="line">  <span class="keyword">const</span> evts = events.splice(<span class="number">0</span>, LIMIT);</span><br><span class="line">  navigator.sendBeacon(<span class="string">&#x27;/path&#x27;</span>, &#123; <span class="attr">events</span>: evts &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> report = <span class="function">(<span class="params">eventName, data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// sdk ä¸ŠæŠ¥å·¥å…·å‡½æ•°ï¼Œèšåˆäº‹ä»¶</span></span><br><span class="line">  events.push(&#123;</span><br><span class="line">    eventName,</span><br><span class="line">    data,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">if</span> (events.length &gt;= LIMIT) &#123;</span><br><span class="line">    reportRequest();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="æ•°æ®ç¼“å­˜ä»£ç†">æ•°æ®ç¼“å­˜ä»£ç†</h2><ul><li><p>ä¹‹å‰çœ‹åˆ°è¿‡ä¸€é“é¢è¯•é¢˜ï¼šå‰ç«¯æ€ä¹ˆå®ç°ç¼“å­˜åˆ°æœŸè‡ªåŠ¨åˆ é™¤ç¼“å­˜ï¼Ÿ</p><ul><li><p>å¦‚æœæ­£å‘åœ°å»æ€è€ƒï¼Œç¼“å­˜åˆ°æœŸäº†ï¼Œç¨‹åºéƒ½å…³é—­äº†ï¼Œæ€ä¹ˆåˆ ï¼Ÿ</p></li><li><p>æ¢ä¸ªè§’åº¦ï¼šä¸åœ¨è¿‡æœŸæ—¶ç«‹å³ set ï¼Œget æ—¶æ‰éœ€è¦åˆ¤æ–­ç¼“å­˜æ˜¯å¦è¿‡æœŸ</p><p>åœ¨ get æ—¶åˆ¤æ–­ä¸‹æ˜¯å¦è¿‡æœŸï¼Œè¿‡æœŸäº†å†åˆ é™¤ä¸å°±å¾—äº† ~</p></li></ul></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/b64da6adly1h4voq4w7nlj20j60iv0tg.jpg" alt="å°çŒ«å’ªè§‰å¾—å¾ˆèµ(çŒ«çŒ«ç‚¹èµè¡¨æƒ…åŒ…)_ç‚¹èµ_å¾ˆèµ_å°çŒ«å’ªè¡¨æƒ…"></p><ul><li>é€šè¿‡ ProxyStorage ä»£ç†ç¼“å­˜ä¸­é—´ä»¶ï¼Œå®ç°æ”¯æŒè®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´</li><li>ä»£ç†ä¸€å±‚ï¼Œä¾¿äºåˆ‡æ¢ç¼“å­˜ä¸­é—´ä»¶ï¼Œå¢åŠ å¯ç»´æŠ¤æ€§</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Storage = &#123;</span><br><span class="line">  <span class="function"><span class="title">set</span>(<span class="params">key, value, maxAge</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">localStorage</span>.setItem(</span><br><span class="line">      key,</span><br><span class="line">      <span class="built_in">JSON</span>.stringify(&#123;</span><br><span class="line">        maxAge,</span><br><span class="line">        value,</span><br><span class="line">        time: <span class="built_in">Date</span>.now(),</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">get</span>(<span class="params">key</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> v = <span class="built_in">localStorage</span>.getItem(key);</span><br><span class="line">    <span class="keyword">if</span> (!v) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> &#123; maxAge, value, time &#125; = <span class="built_in">JSON</span>.parse(v);</span><br><span class="line">    <span class="keyword">const</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line">    <span class="keyword">if</span> (now &lt; time + maxAge * <span class="number">1000</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> value;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">localStorage</span>.removeItem(key);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">has</span>(<span class="params">key</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> v = <span class="built_in">localStorage</span>.getItem(key);</span><br><span class="line">    <span class="keyword">if</span> (!v) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> &#123; maxAge, time &#125; = <span class="built_in">JSON</span>.parse(v);</span><br><span class="line">    <span class="keyword">const</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line">    <span class="keyword">if</span> (now &lt; time + maxAge * <span class="number">1000</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">localStorage</span>.removeItem(key);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="è¯·æ±‚å‡½æ•°çš„å°è£…">è¯·æ±‚å‡½æ•°çš„å°è£…</h2><p>é€šè¿‡ä»£ç†æ¨¡å¼å°è£…è¯·æ±‚å‡½æ•°ï¼Œå¯ä»¥å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li>æ¤å…¥é€šç”¨å‚æ•°ã€é€šç”¨è¯·æ±‚å¤´</li><li>å…¨å±€è¯·æ±‚åŸ‹ç‚¹ä¸ŠæŠ¥</li><li>å…¨å±€å¼‚å¸¸çŠ¶æ€ç å¤„ç†å™¨</li><li>å…¨å±€è¯·æ±‚é”™è¯¯ã€å¼‚å¸¸ä¸ŠæŠ¥å’Œå¤„ç†</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/006APoFYly8h58u4ejh44g3050050my0-20220919200313364.gif" alt=""></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> SUCCESS_STATUS_CODE = <span class="number">200</span>,</span><br><span class="line">  FAIL_STATUS_CODE = <span class="number">400</span>;</span><br><span class="line"><span class="keyword">const</span> isValidHttpStatus = <span class="function">(<span class="params">statusCode</span>) =&gt;</span></span><br><span class="line">  statusCode &gt;= SUCCESS_STATUS_CODE &amp;&amp; statusCode &lt; FAIL_STATUS_CODE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ErrorCode = &#123;</span><br><span class="line">  NotLogin: <span class="number">2022</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> ErrorHandler = &#123;</span><br><span class="line">  [ErrorCode.NotLogin]: redirectToLoginPage,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> request = <span class="keyword">async</span> (reqParams) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; headers, method, data, params, url &#125; = reqParams;</span><br><span class="line">  <span class="comment">// å°è£…è¯·æ±‚å‚æ•°ï¼Œæ¤å…¥é€šç”¨å‚æ•°ã€é€šç”¨è¯·æ±‚å¤´</span></span><br><span class="line">  <span class="keyword">const</span> requestObj = &#123;</span><br><span class="line">    url: url + <span class="string">`?<span class="subst">$&#123;qs.stringify(&#123; ...commonParams, ...params &#125;)&#125;</span>`</span>,</span><br><span class="line">    headers: &#123; ...commonHeaders, ...headers &#125;,</span><br><span class="line">    data,</span><br><span class="line">    method,</span><br><span class="line">    start: <span class="built_in">Date</span>.now(),</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// ä¸ŠæŠ¥è¯·æ±‚å¼€å§‹åŸ‹ç‚¹</span></span><br><span class="line">    reportEvent(AJAX_START, requestObj);</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> ajax(requestObj);</span><br><span class="line">    requestObj.end = <span class="built_in">Date</span>.now();</span><br><span class="line">    requestObj.response = res;</span><br><span class="line">    <span class="comment">// ä¸ŠæŠ¥è¯·æ±‚ç»“æŸåŸ‹ç‚¹</span></span><br><span class="line">    reportEvent(AJAX_END, requestObj);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> &#123; statusCode, <span class="attr">data</span>: resData &#125; = res;</span><br><span class="line">    <span class="keyword">const</span> &#123; errorCode &#125; = resData;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!isValidHttpStatus(statusCode)) &#123;</span><br><span class="line">      <span class="comment">// å¼‚å¸¸çŠ¶æ€ç åŸ‹ç‚¹ä¸ŠæŠ¥</span></span><br><span class="line">      reportEvent(AJAX_ERROR, requestObj);</span><br><span class="line">      <span class="keyword">throw</span> resData;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (errorCode) &#123;</span><br><span class="line">      <span class="comment">// é”™è¯¯ç å…¨å±€å¤„ç†å™¨å®šä¹‰ï¼Œæœªå®šä¹‰åˆ™æŠŠé”™è¯¯æŠ›å‡ºç»™ä¸Šå±‚ä¸šåŠ¡å¤„ç†</span></span><br><span class="line">      reportEvent(AJAX_WARNING, requestObj);</span><br><span class="line">      <span class="keyword">if</span> (ErrorHandler(errorCode)) &#123;</span><br><span class="line">        ErrorHandler(errorCode)();</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> resData;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// æ­£å¸¸è¿”å›è¯·æ±‚æ•°æ®</span></span><br><span class="line">      <span class="keyword">return</span> resData;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="comment">// æ•è·é”™è¯¯å¹¶è¿›è¡ŒåŸ‹ç‚¹ä¸ŠæŠ¥ï¼ŒæŠ›ç»™ä¸Šå±‚ä¸šåŠ¡å¤„ç†</span></span><br><span class="line">    requestObj.error = error;</span><br><span class="line">    reportEvent(AJAX_ERROR, requestObj);</span><br><span class="line">    <span class="keyword">throw</span> error;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="Vue-ä¸­çš„ä»£ç†æ¨¡å¼">Vue ä¸­çš„ä»£ç†æ¨¡å¼</h2><blockquote><p>å°†æ•°æ®ã€æ–¹æ³•ã€è®¡ç®—å±æ€§ç­‰ä»£ç†åˆ°ç»„ä»¶å®ä¾‹ä¸Š</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    msg: <span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">    vue: <span class="string">&#x27;vue&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    <span class="function"><span class="title">helloVue</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.msg + <span class="string">&#x27; &#x27;</span> + <span class="built_in">this</span>.vue;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.helloVue);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="Koa-ä¸­çš„ä»£ç†æ¨¡å¼">Koa ä¸­çš„ä»£ç†æ¨¡å¼</h2><blockquote><p>context ä¸Šä¸‹æ–‡ä»£ç†å°è£…åœ¨ request å’Œ response é‡Œçš„å±æ€§</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">app.use(<span class="function">(<span class="params">context</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(context.request.url);</span><br><span class="line">  <span class="built_in">console</span>.log(context.url);</span><br><span class="line">  <span class="built_in">console</span>.log(context.response.body);</span><br><span class="line">  <span class="built_in">console</span>.log(context.body);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1>å…¶ä»–ä»£ç†æ¨¡å¼</h1><blockquote><p>é™¤äº†æœ¬æ–‡æåˆ°çš„ä»£ç†æ¨¡å¼åº”ç”¨ï¼Œè¿˜æœ‰å…¶ä»–éå¸¸å¤šçš„å˜ä½“å’Œåº”ç”¨</p><p>è¿™é‡Œç®€è¦åˆ—ä¸¾å’Œä»‹ç»ä¸€ä¸‹ï¼Œå°±ä¸ä¸€ä¸€è¯¦ç»†å±•å¼€è¯´æ˜äº†</p></blockquote><ul><li>é˜²ç«å¢™ä»£ç†ï¼šæ§åˆ¶ç½‘ç»œèµ„æºè®¿é—®ï¼Œä¿æŠ¤ä¸»ä½“ä¸è®©â€åäººâ€œæ¥è¿‘</li><li>è¿œç¨‹ä»£ç†ï¼ˆç§‘å­¦ä¸Šç½‘ï¼‰ï¼šä¸ºä¸€ä¸ªå¯¹è±¡åœ¨ä¸åŒçš„åœ°å€ç©ºé—´æä¾›å±€éƒ¨ä»£è¡¨ï¼Œæ¯”å¦‚å¤§å®¶çš„â€ç§‘å­¦ä¸Šç½‘â€œ</li><li>ä¿æŠ¤ä»£ç†ï¼šç”¨äºå¯¹è±¡åº”è¯¥æœ‰ä¸åŒçš„è®¿é—®æƒé™çš„æƒ…å†µ</li><li>æ™ºèƒ½å¼•ç”¨ä»£ç†ï¼šå–ä»£äº†ç®€å•çš„æŒ‡é’ˆï¼Œå®ƒåœ¨è®¿é—®å¯¹è±¡æ—¶æ‰§è¡Œä¸€äº›é™„åŠ çš„æ“ä½œï¼Œæ¯”å¦‚è®¡ç®—ä¸€ä¸ªå¯¹è±¡è¢«å¼•ç”¨çš„æ¬¡æ•°ï¼ˆå¯èƒ½ç”¨äº GC çš„å¼•ç”¨è®¡æ•°</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/006APoFYly8h2r81r46eag306o06oq35.gif" alt="æ‹¿æäº†_æ‹¿æè¡¨æƒ…"></p><h1>å°ç»“</h1><p>ä»£ç†æ¨¡å¼æœ‰ç€è®¸å¤šçš„å°åˆ†ç±»ï¼Œå‰ç«¯å¼€å‘å·¥ä½œä¸­å¸¸ç”¨çš„æœ‰è™šæ‹Ÿä»£ç†ã€ä¿æŠ¤ä»£ç†å’Œç¼“å­˜ä»£ç†ç­‰ã€‚å…¶å®è¯»åˆ°è¿™é‡Œï¼Œå¤§å®¶ä¹Ÿèƒ½æ„Ÿå—åˆ°ï¼Œæ—¥å¸¸å¼€å‘å·¥ä½œä¸­å¸¸åšçš„ä¸€ä¸ªåŠ¨ä½œ â€”â€” â€å°è£…â€œ ï¼Œå…¶å®å°±æ˜¯ä»£ç†æ¨¡å¼çš„è¿ç”¨ ~</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/bef3df8agy1fcnwgf3012j208c08c0tb.jpg" alt="åˆ»è‹¦å­¦ä¹ äº†ä¸€å¤©ï¼Œå¥½å……å®ã€å¥½å¹¸ç¦ - åšä¸ªçˆ±å­¦ä¹ çš„ doge_å­¦ä¹ _doge_è£…é€¼_èŒèŒå“’è¡¨æƒ…"></p><h1>è®¾è®¡æ¨¡å¼ç³»åˆ—æ–‡ç« æ¨è</h1><ul><li><a href="https://www.lebronchao.com/2022/08/21/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” å•ä¾‹æ¨¡å¼</a></li><li><a href="https://www.lebronchao.com/2022/08/21/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” ç­–ç•¥æ¨¡å¼</a></li><li><a href="https://www.lebronchao.com/2022/10/10/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” ä»£ç†æ¨¡å¼</a></li><li><a href="https://www.lebronchao.com/2022/10/12/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” å‘å¸ƒè®¢é˜…æ¨¡å¼</a></li></ul><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å¥½ä¹…ä¸è§ï¼Œæ€ä¹ˆè¿™ä¹ˆä¹…æ²¡æ›´æ–°äº†å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;Emmâ€¦æœ€è¿‘ç»©æ•ˆè¯„ä¼°å­£ï¼Œç»©æ•ˆæ€»ç»“ã€360 è¯„ä¼°ï¼Œè¦å†™çš„ä¸œè¥¿æ¯”è¾ƒå¤šåš¯ï¼Œè€½æäº†ä¸€æ®µæ—¶é—´&lt;/p&gt;
&lt;p&gt;åºŸè¯ä¸å¤šè¯´ï¼Œè¿æ¥ JavaScript è®¾è®¡æ¨¡å¼ç¬¬ä¸‰ç¯‡ï¼šä»£ç†æ¨¡å¼ ~&lt;/p&gt;
&lt;p&gt;&lt;img src= &quot;/img/loadin</summary>
      
    
    
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://lebronchao.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Front End" scheme="https://lebronchao.com/tags/Front-End/"/>
    
    <category term="JavaScript" scheme="https://lebronchao.com/tags/JavaScript/"/>
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://lebronchao.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="ä»£ç†æ¨¡å¼" scheme="https://lebronchao.com/tags/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript è®¾è®¡æ¨¡å¼ â€”â€” ç­–ç•¥æ¨¡å¼</title>
    <link href="https://lebronchao.com/2022/08/21/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
    <id>https://lebronchao.com/2022/08/21/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/</id>
    <published>2022-08-21T13:11:23.000Z</published>
    <updated>2022-08-21T13:11:23.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å¾ˆå¿«ï¼Œè¿æ¥äº† JavaScript è®¾è®¡æ¨¡å¼ç³»åˆ—çš„ç¬¬äºŒç¯‡ â€”â€” ç­–ç•¥æ¨¡å¼ â€¦</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/eeef21c8afaf4d89857f31ba2644ad36~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><h1>ä»€ä¹ˆæ˜¯ç­–ç•¥æ¨¡å¼</h1><blockquote><p>ç­–ç•¥æ¨¡å¼å®šä¹‰ï¼š</p><p>å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼ŒæŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢</p></blockquote><p>ç­–ç•¥æ¨¡å¼ä¸€èˆ¬ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š</p><ol><li><p>å°è£…ä¸åŒç­–ç•¥çš„ç­–ç•¥ç»„ï¼ˆä½¿å¾—ä»£ç å¤ç”¨æ€§ã€å¯æ‰©å±•ã€å¯ç»´æŠ¤æ€§æé«˜ï¼Œé¿å…å¤§é‡ CV ä»£ç çš„æƒ…å†µï¼‰</p></li><li><p>Contextï¼ˆå§”æ‰˜ç®—æ³•ï¼Œæ‰§è¡Œç­–ç•¥ï¼‰</p></li></ol><h1>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ç­–ç•¥æ¨¡å¼ ï¼Ÿ</h1><blockquote><p>ç­–ç•¥æ¨¡å¼å¹¿æ³›åº”ç”¨äºç¨‹åºç ”å‘ä¸­ï¼Œå½“å‡ºç°éœ€è¦æ ¹æ®ä¸åŒçš„å‰ç½®æ¡ä»¶æ‰§è¡Œä¸åŒçš„ç®—æ³•å¾—åˆ°ç»“æœæ—¶ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥è®©ä½ çš„ä»£ç æ›´åŠ ä¼˜é›…</p></blockquote><p>æ€ä¹ˆï¼Ÿä¸ä¿¡ï¼Ÿ é‚£å°±ä¸Šç‚¹ä»£ç è®©ä½ æ„Ÿå—ä¸€ä¸‹ ğŸ’© å±±çš„åŠ›é‡ï¼</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/5cab40c1005d40c6a578a60fb43e836a~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><blockquote><p>å‡è®¾ä¸€ä¸ªå‡½æ•°è´Ÿè´£ Consul ï¼ˆæœåŠ¡å‘ç°ï¼‰å’Œ LB ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰</p><p>è¿™é‡Œ Consul å‡½æ•°å°±æ˜¯ Contextï¼Œå„ç§ LB ç®—æ³•å°±æ˜¯ç­–ç•¥ç»„</p><p>ä¼ å…¥æœåŠ¡å”¯ä¸€æ ‡è¯†å’Œè´Ÿè½½å‡è¡¡ç®—æ³•</p><p>è¿”å›æœåŠ¡å™¨å®ä¾‹ IP åœ°å€</p><p>å¦‚æƒ³äº†è§£ LB ç›¸å…³çŸ¥è¯†ï¼Œå¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç«  <a href="https://juejin.cn/post/6987196608161005581">[æ·±å…¥æµ…å‡º LB]æ‰‹æŠŠæ‰‹å¸¦ä½ å®ç°ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨</a></p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">consul</span>(<span class="params">serviceId, algorithm</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (algorithm === <span class="string">&#x27;random&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// random flow</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;xxx.xxx.xxx.xxx&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (algorithm === <span class="string">&#x27;weightedRoundRobin&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// weightedRoundRobin flow</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;xxx.xxx.xxx.xxx&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (algorithm === <span class="string">&#x27;ipHash&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// ipHash flow</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;xxx.xxx.xxx.xxx&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (algorithm === <span class="string">&#x27;urlHash&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// urlHash flow</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;xxx.xxx.xxx.xxx&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (algorithm === <span class="string">&#x27;leastConnection&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// leastConnection flow</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;xxx.xxx.xxx.xxx&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (algorithm === <span class="string">&#x27;fair&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// fair flow</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;xxx.xxx.xxx.xxx&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ï¼Œè¿™æ®µä»£ç å­˜åœ¨ç€ä¸€äº›æ˜æ˜¾çš„é—®é¢˜</p><ol><li><p>Consul å‡½æ•°è¿‡äºåºå¤§ï¼Œä¸ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ï¼Œéš¾ç»´æŠ¤</p></li><li><p>å †ç Œäº†è¿‡å¤šçš„ IF-ELSE è¯­å¥ï¼Œä»£ç çœ‹èµ·æ¥æ¯”è¾ƒå†—ä½™</p></li><li><p>è´Ÿè½½å‡è¡¡ç®—æ³•å¤ç”¨æ€§è¾ƒå·®ï¼Œå¦‚æœå…¶ä»–åœ°æ–¹éœ€è¦ç”¨åˆ°â€¦ï¼ˆä½ ä¸ä¼šç›´æ¥ CV å§ ğŸ¤“</p></li></ol><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/6167b9b2dc57444cbbbbd660b86ae406~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><blockquote><p>é’ˆå¯¹ä»¥ä¸Šé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç­–ç•¥æ¨¡å¼åŠ ä»¥ä¼˜åŒ–</p></blockquote><ol><li><p>é¦–å…ˆå°†å„ LB ç®—æ³•å°è£…æˆç‹¬ç«‹çš„å‡½æ•°ï¼Œæé«˜å¤ç”¨æ€§</p></li><li><p>å»ºç«‹ç®—æ³•åç§° -&gt; ç®—æ³•æ‰§è¡Œå‡½æ•°æ˜ å°„ï¼Œå¹²æ‰å†—ä½™çš„ IF-ELSEï¼ˆç®€ç›´å°±æ˜¯ IF-ELSE çš„æ•‘ä¸–ä¸»</p></li><li><p>ç®€åŒ– Consul å‡½æ•°ï¼Œå…·ä½“ç®—æ³•å¯¹äº Consul æ¥è¯´æ˜¯â€œéšå½¢â€çš„ï¼Œå•ä¸€èŒè´£</p></li><li><p>å¯æ‹“å±•æ€§æé«˜ï¼Œå¦‚éœ€æ‹“å±•æ›´å¤šç®—æ³•ï¼Œä»…éœ€å¼•å…¥ç®—æ³•å’Œæ·»åŠ  Map ä¸­çš„é…ç½®</p></li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">random</span>(<span class="params">serviceId</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// random flow</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;xxx.xxx.xxx.xxx&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">weightedRoundRobin</span>(<span class="params">serviceId</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// weightedRoundRobin flow</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;xxx.xxx.xxx.xxx&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ipHash</span>(<span class="params">serviceId</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// IPHash flow</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;xxx.xxx.xxx.xxx&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">urlHash</span>(<span class="params">serviceId</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// URL Hash flow</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;xxx.xxx.xxx.xxx&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">leastConnection</span>(<span class="params">serviceId</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// leaseConnection flow</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;xxx.xxx.xxx.xxx&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fair</span>(<span class="params">serviceId</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// fair flow</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;xxx.xxx.xxx.xxx&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ALGORITHM = &#123;</span><br><span class="line">  RANDOM: <span class="string">&#x27;random&#x27;</span>,</span><br><span class="line">  WEIGHTED_ROUND_ROBIN: <span class="string">&#x27;weightedRoundRobin&#x27;</span>,</span><br><span class="line">  IP_HASH: <span class="string">&#x27;ipHash&#x27;</span>,</span><br><span class="line">  URL_HASH: <span class="string">&#x27;urlHash&#x27;</span>,</span><br><span class="line">  LEAST_CONNECTION: <span class="string">&#x27;leastConnection&#x27;</span>,</span><br><span class="line">  FAIR: <span class="string">&#x27;fair&#x27;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ALGORITHM_MAP = &#123;</span><br><span class="line">  [ALGORITHM.RANDOM]: random,</span><br><span class="line">  [ALGORITHM.WEIGHTED_ROUND_ROBIN]: weightedRoundRobin,</span><br><span class="line">  [ALGORITHM.IP_HASH]: ipHash,</span><br><span class="line">  [ALGORITHM.URL_HASH]: urlHash,</span><br><span class="line">  [ALGORITHM.LEAST_CONNECTION]: leastConnection,</span><br><span class="line">  [ALGORITHM.FAIR]: fair,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">consul</span>(<span class="params">serviceId, algorithm</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ALGORITHM_MAP[algorithm](serviceId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>ç­–ç•¥æ¨¡å¼åº”ç”¨åœºæ™¯ä¹‹è¡¨å•æ ¡éªŒ</h1><h2 id="ç²—ç³™çš„è¡¨å•æ ¡éªŒ">ç²—ç³™çš„è¡¨å•æ ¡éªŒ</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç²—ç³™çš„è¡¨å•æ ¡éªŒ</span></span><br><span class="line"><span class="keyword">let</span> loginFrom = <span class="built_in">document</span>.getElementId(<span class="string">&#x27;loginFrom&#x27;</span>);</span><br><span class="line">loginFrom.onsubmit = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> username = <span class="built_in">document</span>.getElementId(<span class="string">&#x27;username&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> pwd = <span class="built_in">document</span>.getElementId(<span class="string">&#x27;pwd&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> mobile = <span class="built_in">document</span>.getElementId(<span class="string">&#x27;mobile&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (username === <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    alert(<span class="string">&#x27;ç”¨æˆ·åä¸å¯ä¸ºç©º&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (pwd.length &lt; <span class="number">6</span>) &#123;</span><br><span class="line">    alert(<span class="string">&#x27;å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6ä½&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    !<span class="regexp">/^1(3\d|4[5-9]|5[0-35-9]|6[2567]|7[0-8]|8\d|9[0-35-9])\d&#123;8&#125;$/</span>.test(mobile)</span><br><span class="line">  ) &#123;</span><br><span class="line">    alert(<span class="string">&#x27;æ‰‹æœºå·ç æ ¼å¼ä¸æ­£ç¡®&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨ç­–ç•¥æ¨¡å¼ä¼˜åŒ–åçš„è¡¨å•æ ¡éªŒ">ä½¿ç”¨ç­–ç•¥æ¨¡å¼ä¼˜åŒ–åçš„è¡¨å•æ ¡éªŒ</h2><blockquote><p>Contextï¼švalidate</p><p>ç­–ç•¥ç»„ï¼šstrategy</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ç­–ç•¥æ¨¡å¼ä¼˜åŒ–</span></span><br><span class="line"><span class="keyword">const</span> strategy = &#123;</span><br><span class="line">  isEmpty: <span class="function"><span class="keyword">function</span> (<span class="params">&#123; value &#125;, errMsg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (value === <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> errMsg;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  isMobile: <span class="function"><span class="keyword">function</span> (<span class="params">&#123; value &#125;, errMsg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      !<span class="regexp">/^1(3\d|4[5-9]|5[0-35-9]|6[2567]|7[0-8]|8\d|9[0-35-9])\d&#123;8&#125;$/</span>.test(value)</span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="keyword">return</span> errMsg;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  isLongerThanMinLength: <span class="function"><span class="keyword">function</span> (<span class="params">&#123; value, len &#125;, errMsg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (value.length &lt; len) &#123;</span><br><span class="line">      <span class="keyword">return</span> errMsg;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Validator</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.validateItems = [];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">add</span>(<span class="params">params, strategyKey, errMsg</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.validateItems.push(&#123; params, strategyKey, errMsg &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">start</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> <span class="built_in">this</span>.validateItems) &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; params, strategyKey, errMsg &#125; = item;</span><br><span class="line">      <span class="keyword">const</span> msg = strategy[strategyKey](params, errMsg);</span><br><span class="line">      <span class="keyword">if</span> (msg) &#123;</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validate</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> username = <span class="built_in">document</span>.getElementId(<span class="string">&#x27;username&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> pwd = <span class="built_in">document</span>.getElementId(<span class="string">&#x27;pwd&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> mobile = <span class="built_in">document</span>.getElementId(<span class="string">&#x27;mobile&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> validator = <span class="keyword">new</span> Validator();</span><br><span class="line">  validator.add(&#123; <span class="attr">value</span>: username &#125;, <span class="string">&#x27;isEmpty&#x27;</span>, <span class="string">&#x27;ç”¨æˆ·åä¸å¯ä¸ºç©º&#x27;</span>);</span><br><span class="line">  validator.add(</span><br><span class="line">    &#123; <span class="attr">value</span>: pwd, <span class="attr">len</span>: <span class="number">6</span> &#125;,</span><br><span class="line">    <span class="string">&#x27;isLongerThanMinLength&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6ä½&#x27;</span></span><br><span class="line">  );</span><br><span class="line">  validator.add(&#123; <span class="attr">value</span>: mobile &#125;, <span class="string">&#x27;isMobile&#x27;</span>, <span class="string">&#x27;æ‰‹æœºå·ç æ ¼å¼ä¸æ­£ç¡®&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> errMsg = validator.start();</span><br><span class="line">  <span class="keyword">if</span> (errMsg) &#123;</span><br><span class="line">    alert(errMsg);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    alert(<span class="string">&#x27;æ ¡éªŒé€šè¿‡&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">validate();</span><br></pre></td></tr></table></figure><h1>ç­–ç•¥æ¨¡å¼å’Œå¤šæ€çš„åŒºåˆ«</h1><ul><li><p>ç­–ç•¥æ¨¡å¼å®šä¹‰äº†ç®—æ³•ç»„ï¼Œåˆ†åˆ«å°è£…ï¼Œå®ƒä»¬ä¹‹é—´å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œæ­¤æ¨¡å¼çš„å˜åŒ–ç‹¬ç«‹äºä½¿ç”¨ç®—æ³•çš„å®¢æˆ·</p></li><li><p>å¤šæ€å¸¸ç”¨ç»§æ‰¿ã€æ–¹æ³•é‡å†™ã€çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ç­‰æ–¹æ³•å®ç°</p></li></ul><blockquote><p>ç­–ç•¥æ¨¡å¼å¼ºè°ƒçš„æ˜¯åšåŒä¸€ä»¶äº‹çš„ä¸åŒä¸”ä¸é‡å¤çš„æ–¹æ³•</p><p>å¤šæ€æ˜¯ä¸€ç§è¯­è¨€æœºåˆ¶ï¼Œæœ‰çš„ä¸æ”¯æŒå¤šæ€çš„è¯­è¨€ä¹Ÿä¸€æ ·è¦å®ç°ç­–ç•¥æ¨¡å¼</p><p>ç­–ç•¥å¤„äºç¨‹åºè®¾è®¡å±‚æ¬¡ï¼Œå¤šæ€å¤„äºè¯­è¨€è¯­æ³•å±‚æ¬¡</p></blockquote><h1>æ€»ç»“</h1><h2 id="ç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹">ç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹</h2><ul><li><p>ç­–ç•¥æ¨¡å¼åˆ©ç”¨ç»„åˆã€å§”æ‰˜å’Œå¤šæ€ç­‰æŠ€æœ¯å’Œæ€æƒ³ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…å¤šé‡ä¸”å†—ä½™çš„ IF-ELSE</p></li><li><p>ç­–ç•¥æ¨¡å¼æä¾›äº†å¯¹å¼€æ”¾â€”â€”å°é—­åŸåˆ™çš„å®Œç¾æ”¯æŒï¼Œå°†ç®—æ³•å°è£…åœ¨ç‹¬ç«‹çš„ç­–ç•¥ä¸­ã€‚å¯ä»¥åœ¨ä¸ä¿®æ”¹åŸä»£ç çš„æƒ…å†µä¸‹ï¼Œçµæ´»å¢åŠ æ–°ç®—æ³•ã€‚æé«˜äº†å®ƒä»¬çš„å¤ç”¨æ€§ã€å’Œå¯æ‹“å±•æ€§ï¼Œä¹Ÿæ›´å®¹æ˜“åˆ‡æ¢å’Œç†è§£ã€‚</p></li><li><p>ç­–ç•¥æ¨¡å¼ä¸­çš„ç®—æ³•ä¹Ÿå¯ä»¥å¤ç”¨åœ¨å·¥ç¨‹çš„å…¶ä»–åœ°æ–¹ï¼Œé¿å…å¤§é‡é‡å¤çš„ CV å·¥ä½œ</p></li><li><p>åœ¨ç­–ç•¥æ¨¡å¼ä¸­åˆ©ç”¨ç»„åˆå’Œå§”æ‰˜æ¥è®© Context æ‹¥æœ‰æ‰§è¡Œç®—æ³•çš„èƒ½åŠ›ï¼Œè¿™ä¹Ÿæ˜¯ç»§æ‰¿çš„ä¸€ç§æ›´è½»ä¾¿çš„æ›¿ä»£æ–¹æ¡ˆ</p></li></ul><h2 id="ç­–ç•¥æ¨¡å¼çš„ç¼ºç‚¹">ç­–ç•¥æ¨¡å¼çš„ç¼ºç‚¹</h2><ul><li><p>ç­–ç•¥æ¨¡å¼ä¼šåœ¨ç¨‹åºä¸­å¢åŠ è®¸å¤šç­–ç•¥å‡½æ•°ã€ç±»ã€å¯¹è±¡ï¼Œä½†å®é™…ä¸Šæ¯”æŠŠå®ƒä»¬å †ç Œåœ¨ Context ä¸­è¦æ›´å¥½</p></li><li><p>ä½¿ç”¨ç­–ç•¥æ¨¡å¼å¿…é¡»äº†è§£æ‰€æœ‰çš„ç­–ç•¥ï¼Œå¿…é¡»äº†è§£å®ƒä»¬çš„ç»†èŠ‚æ¯”è¾ƒå®ƒä»¬ä¹‹é—´çš„ä¸åŒç‚¹ï¼Œæ‰èƒ½é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ç­–ç•¥ã€‚æ­¤æ—¶éœ€è¦å‘ç”¨æˆ·æš´éœ²å®ƒçš„æ‰€æœ‰å®ç°ï¼Œè¿åæœ€å°‘çŸ¥è¯†åŸåˆ™ã€‚</p></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/a16be28e58b54115b4bc17ebc45b7cd0~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><h1>è®¾è®¡æ¨¡å¼ç³»åˆ—æ–‡ç« æ¨è</h1><ul><li><a href="https://www.lebronchao.com/2022/08/21/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” å•ä¾‹æ¨¡å¼</a></li><li><a href="https://www.lebronchao.com/2022/08/21/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” ç­–ç•¥æ¨¡å¼</a></li><li><a href="https://www.lebronchao.com/2022/10/10/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” ä»£ç†æ¨¡å¼</a></li><li><a href="https://www.lebronchao.com/2022/10/12/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” å‘å¸ƒè®¢é˜…æ¨¡å¼</a></li></ul><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å¾ˆå¿«ï¼Œè¿æ¥äº† JavaScript è®¾è®¡æ¨¡å¼ç³»åˆ—çš„ç¬¬äºŒç¯‡ â€”â€” ç­–ç•¥æ¨¡å¼ â€¦&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src= &quot;/img/loading.gif&quot; data-lazy-src=&quot;https://lebronchao-1</summary>
      
    
    
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://lebronchao.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Front End" scheme="https://lebronchao.com/tags/Front-End/"/>
    
    <category term="JavaScript" scheme="https://lebronchao.com/tags/JavaScript/"/>
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://lebronchao.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="ç­–ç•¥æ¨¡å¼" scheme="https://lebronchao.com/tags/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript è®¾è®¡æ¨¡å¼ â€”â€” å•ä¾‹æ¨¡å¼</title>
    <link href="https://lebronchao.com/2022/08/21/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
    <id>https://lebronchao.com/2022/08/21/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</id>
    <published>2022-08-21T13:11:14.000Z</published>
    <updated>2022-08-21T13:11:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>åœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆ â€”â€” è®¾è®¡æ¨¡å¼</p><p>è®¾è®¡æ¨¡å¼åŸåˆ™ï¼šâ€œæ‰¾å‡ºç¨‹åºä¸­å˜åŒ–çš„åœ°æ–¹ï¼Œå¹¶å°†å˜åŒ–å°è£…èµ·æ¥â€</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/e424e745d4e545a8bb75e14a563dbe70~tplv-k3u1fbpfcp-watermark.image" alt="imagepng"></p><h1>ä¸ºä»€ä¹ˆè¦å­¦ä¹ è®¾è®¡æ¨¡å¼?</h1><p>ä»äº‹å¼€å‘å²—ä½ä¹Ÿæœ‰ä¸€å¹´å¤šçš„æ—¶é—´äº†ï¼Œè§è¯†è¿‡é™ˆå¹´è€é¡¹ç›®ï¼Œä¹Ÿä»é›¶åˆ°ä¸€æ­å»ºè¿‡ä¸€ä¸ªé¡¹ç›®ã€‚éšç€é¡¹ç›®å’Œä¸šåŠ¡çš„ä¸æ–­æ‰©å¼ ï¼Œå†™ä¸‹çš„ä»£ç å¦‚æœæ²¡æœ‰è¿›è¡Œè®¾è®¡ï¼Œå°±æ¸æ¸å˜æˆäº† emm â€¦ x å±±ï¼Œæ€ä¹ˆå†™éƒ½ä¸å¯¹åŠ²ï¼Œè¿‡æ®µæ—¶é—´å°±æƒ³ç€é‡æ„ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/bf5f5a7bb5c440db89c525db7044a7ba~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><p>äººä¹‹æ‰€ä»¥å¯ä»¥èµ°åˆ°é£Ÿç‰©é“¾çš„é¡¶ç«¯ï¼Œæ˜¯å› ä¸ºä¼šå­¦ä¹ ã€æ€»ç»“ï¼Œä¼šä½¿ç”¨â€œåå­—â€å’Œâ€œå·¥å…·â€ã€‚è€Œè®¾è®¡æ¨¡å¼å¹¶ä¸æ˜¯å‡­ç©ºå‘æ˜å‡ºæ¥çš„ï¼Œæ˜¯ç»è¿‡äº†å¤§é‡çš„é¡¹ç›®å®è·µæ€»ç»“å‡ºæ¥çš„å¯¹æŸç§ä¸šåŠ¡åœºæ™¯ä¸‹çš„ç¨‹åºç¼–å†™æœ€ä½³å®è·µï¼Œæ€»ç»“å‡ºæ¥çš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶ç»™å®ƒå–äº†ä¸ªåå­—ï¼Œå°±å˜æˆäº†ä¸€ä¸ªè®¾è®¡æ¨¡å¼ã€‚å°±å¥½æ¯”ç¯®çƒåœºä¸Šçš„æˆ˜æœ¯ï¼Œç»„ç»‡åå«å¸¸å–Šå‡ºæ‰“å‡ å·æˆ˜æœ¯ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªäººä¸€ä¸ªäººåœ°æŒ‡æŒ¥ï¼Œç®€æ´çš„ä»£å·å¾€å¾€æ¯”å†—æ‚çš„æè¿°æ›´ä¼˜é›…ã€‚æœ‰å¯èƒ½ä½ ç»å¸¸å†™ç¨‹åºçš„ä¸€ç§æ–¹å¼ï¼Œå¯ä»¥æè¿°å‡ºæ¥ï¼Œä½†ä¸çŸ¥é“å®ƒå«ä»€ä¹ˆåå­—ï¼Œæœ‰å¯èƒ½å°±æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šæœ‰è¿™ç§æ„Ÿå—ï¼š ooooo ï¼ï¼è¿™ç©æ„å„¿æˆ‘ç»å¸¸ç”¨ï¼Œç»å¸¸è¿™ä¹ˆå†™ï¼ŒåŸæ¥è¿™ä¸ªæ˜¯ xx æ¨¡å¼ï¼</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/eac8ed0ef6544b3489bff9d17ee7870b~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><p>æœ€åï¼Œä¸ºä»€ä¹ˆè¦å­¦è®¾è®¡æ¨¡å¼å‘¢ï¼Ÿè™½ç„¶æœ‰æ—¶å€™è®¾è®¡æ¨¡å¼ä¼šä½¿ä»£ç å¤æ‚åº¦å‡é«˜ï¼Œå¢åŠ å¼€å‘çš„æˆæœ¬ï¼Œä½†æå¤§åœ°é™ä½äº†ç»´æŠ¤æˆæœ¬ã€‚å°±å¥½æ¯”å›¾ä¹¦é¦†ä¸­çš„ä¹¦å¦‚æœæ— åºåœ°æ•£è½åœ¨å„ä¸ªè§’è½ï¼Œæ‰¾èµ·æ¥å¦‚åŒå¤§æµ·æé’ˆï¼›è€Œå¦‚æœæ ‡å·ä¸”å½’ç±»ã€æœ‰åºåœ°æ”¾åœ¨æŒ‡å®šä¹¦æ¶ä¸Šï¼Œæ‰¾èµ·æ¥å°±å®¹æ˜“äº†è®¸å¤šã€‚æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼ŒæŸå¤©ï¼Œä½ æŒ‡ç€ä¸€æ®µä»£ç å¼€å§‹éª‚ï¼Œè¿™è°å†™çš„ x å±±ï¼é¼ æ ‡ç§»äº†ä¸Šå»ï¼Œ git ä¿®æ”¹è®°å½•æ˜¾ç¤ºï¼Œå“¦ï¼æˆ‘å†™çš„ï¼Œé‚£æ²¡äº‹äº†ã€‚èµ¶ç´§è®¾è®¡æ¨¡å¼å­¦èµ·æ¥ï¼Œä¼˜é›…åœ°ç¼–å†™ç®€æ´ã€å¯å¤ç”¨ã€æ˜“ç»´æŠ¤çš„ç¨‹åº ~</p><h1>å•ä¾‹æ¨¡å¼</h1><blockquote><p>1ã€ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹</p><p>2ã€ä¸»è¦è§£å†³ä¸€ä¸ªå…¨å±€ä½¿ç”¨çš„ç±»é¢‘ç¹åœ°åˆ›å»ºå’Œé”€æ¯ï¼Œå ç”¨å†…å­˜</p></blockquote><h2 id="å®ç°å•ä¾‹æ¨¡å¼">å®ç°å•ä¾‹æ¨¡å¼</h2><blockquote><p>å®ç°ä¸€ä¸ªç®€æ´çš„å•ä¾‹æ¨¡å¼å¹¶ä¸å¤æ‚ï¼Œæ— éå°±æ˜¯å°†å®ä¾‹å¯¹è±¡ä¿å­˜èµ·æ¥ï¼Œä¸‹ä¸€æ¬¡è·å–/åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ï¼Œç›´æ¥è¿”å›ä¹‹å‰åˆ›å»ºçš„å®ä¾‹</p></blockquote><h3 id="æœ€ç®€å•ä¾‹æ¨¡å¼">æœ€ç®€å•ä¾‹æ¨¡å¼</h3><blockquote><ul><li><p>é—­åŒ…å®ç°</p></li><li><p>ES6 å®ç°</p></li></ul></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ©ç”¨é—­åŒ…å®ç°</span></span><br><span class="line"><span class="keyword">var</span> Singleton = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> instance;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Instance</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!instance) &#123;</span><br><span class="line">      instance = <span class="keyword">new</span> Instance();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> single1 = Singleton();</span><br><span class="line"><span class="keyword">var</span> single2 = Singleton();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(single1 === single2); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6å®ç°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!Singleton.instance) &#123;</span><br><span class="line">      Singleton.instance = <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Singleton.instance;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> single1 = <span class="keyword">new</span> Singleton();</span><br><span class="line"><span class="keyword">const</span> single2 = <span class="keyword">new</span> Singleton();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(single1 === single2); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h3 id="æƒ°æ€§å•ä¾‹">æƒ°æ€§å•ä¾‹</h3><blockquote><p>æƒ°æ€§å•ä¾‹ï¼šåˆå§‹åŒ–æ—¶ä¸è¿›è¡Œå®ä¾‹åˆ›å»ºï¼Œåˆ°è·å–å®ä¾‹æ—¶æ‰è¿›è¡Œå®ä¾‹åˆ›å»ºï¼Œç±»ä¼¼å‰ç«¯çš„èµ„æºæ‡’åŠ è½½æ€æƒ³</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// éæƒ°æ€§å•ä¾‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tool</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingleTon</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name, ...args</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="keyword">if</span> (!SingleTon.instance) &#123;</span><br><span class="line">      SingleTon.instance = <span class="keyword">new</span> Tool(args);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">getName</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="function"><span class="title">getInstance</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.instance;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æƒ°æ€§å•ä¾‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tool</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingleTon</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">getName</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="function"><span class="title">getInstance</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">this</span>.instance) &#123;</span><br><span class="line">      <span class="built_in">this</span>.instance = <span class="keyword">new</span> Tool(<span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.instance;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é€æ˜å•ä¾‹å’Œä»£ç†å•ä¾‹">é€æ˜å•ä¾‹å’Œä»£ç†å•ä¾‹</h3><blockquote><ul><li><p>é€æ˜å•ä¾‹</p><ul><li>å°†å®ä¾‹çš„åˆ›å»ºå’Œæ–¹æ³•çš„æ‰§è¡Œå°è£…åˆ°äº†ä¸€ä¸ªç±»ä¸­</li><li>ä¸å¤ªç¬¦åˆâ€œå•ä¸€èŒè´£åŸåˆ™â€ï¼Œä»£ç ä¸æ˜“è¯»ã€ä¸æ˜“æ”¹</li></ul></li><li><p>ä»£ç†å•ä¾‹</p><ul><li>ä»£ç†æ¨¡å¼ï¼šå°†å®ä¾‹åˆ›å»ºå’Œæ–¹æ³•åˆ†ç¦»ï¼Œå§”æ‰˜å‡ºå»</li><li>Person ä½œä¸ºæ™®é€šç±»ï¼Œå¯ä»¥åˆ›å»ºå¯¹è±¡å®ä¾‹</li><li>createPerson ä½œä¸ºå•ä¾‹åˆ›å»ºä»£ç†ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªå•ä¾‹</li><li>ç¬¦åˆâ€œå•ä¸€èŒè´£åŸåˆ™â€ï¼Œä»£ç æ˜“è¯»ã€æ˜“æ”¹</li></ul></li></ul></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é€æ˜ å•ä¾‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">createPerson</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (createPerson.instance) &#123;</span><br><span class="line">      <span class="keyword">return</span> createPerson.instance;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.init();</span><br><span class="line">    <span class="keyword">return</span> (createPerson.instance = <span class="built_in">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">init</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;My name is &#x27;</span>, <span class="built_in">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> createPerson(<span class="string">&#x27;lebron&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> createPerson(<span class="string">&#x27;james&#x27;</span>);</span><br><span class="line">p1.init(); <span class="comment">// My name is  lebron</span></span><br><span class="line">p2.init(); <span class="comment">// My name is  lebron</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»£ç†å•ä¾‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">init</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;My name is &#x27;</span>, <span class="built_in">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">createPerson</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!createPerson.instance) &#123;</span><br><span class="line">      createPerson.instance = <span class="keyword">new</span> Person(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> createPerson.instance;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> createPerson(<span class="string">&#x27;lebron&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> createPerson(<span class="string">&#x27;james&#x27;</span>);</span><br><span class="line">p1.init(); <span class="comment">// My name is  lebron</span></span><br><span class="line">p2.init(); <span class="comment">// My name is  lebron</span></span><br></pre></td></tr></table></figure><h3 id="æœ€ç»ˆç‰ˆæœ¬">æœ€ç»ˆç‰ˆæœ¬</h3><blockquote><p>æ¯æ¬¡å®ç°ä¸€ä¸ªç±»çš„å•ä¾‹æ¨¡å¼éƒ½å» CV é‡å¤çš„æ¨¡æ¿ä»£ç ï¼Œä¸å¤ªç¬¦åˆé¢„æœŸã€‚</p><p>äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è®¾è®¡æ¨¡å¼çš„åŸåˆ™â€œæ‰¾å‡ºç¨‹åºå˜åŒ–çš„åœ°æ–¹ï¼Œå¹¶å°†å˜åŒ–å°è£…èµ·æ¥â€</p><p>å¯ä»¥åšå¦‚ä¸‹æ”¹é€ </p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingleTon</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">fn</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> singleInstance;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">singleConstructor</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–</span></span><br><span class="line">      <span class="keyword">if</span> (!singleInstance) &#123;</span><br><span class="line">        singleInstance = <span class="keyword">new</span> fn(...args);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// å¤šæ¬¡å®ä¾‹åŒ–ç›´æ¥è¿”å›</span></span><br><span class="line">      <span class="keyword">return</span> singleInstance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    singleConstructor.prototype = <span class="built_in">Object</span>.create(fn.prototype);</span><br><span class="line">    <span class="keyword">return</span> singleConstructor;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">init</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;My name is &#x27;</span>, <span class="built_in">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> createPerson = <span class="keyword">new</span> SingleTon(Person);</span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> createPerson(<span class="string">&#x27;lebron&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> createPerson(<span class="string">&#x27;james&#x27;</span>);</span><br><span class="line">p1.init(); <span class="comment">// My name is  lebron</span></span><br><span class="line">p2.init(); <span class="comment">// My name is  lebron</span></span><br><span class="line"><span class="built_in">console</span>.log(p1 === p2); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tool</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">number</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.number = number;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">init</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;This is tool &#x27;</span>, <span class="built_in">this</span>.number);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> createTool = <span class="keyword">new</span> SingleTon(Tool);</span><br><span class="line"><span class="keyword">const</span> t1 = <span class="keyword">new</span> createTool(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">const</span> t2 = <span class="keyword">new</span> createTool(<span class="number">2</span>);</span><br><span class="line">t1.init(); <span class="comment">// This is tool  1</span></span><br><span class="line">t2.init(); <span class="comment">// This is tool  1</span></span><br><span class="line"><span class="built_in">console</span>.log(t1 === t2); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h2 id="å•ä¾‹æ¨¡å¼çš„åº”ç”¨åœºæ™¯">å•ä¾‹æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h2><h3 id="ç™»å½•çª—å£">ç™»å½•çª—å£</h3><blockquote><p>ç™»å½•çª—å£åœ¨æˆ‘ä»¬çš„è½¯ä»¶ä¸­å¾ˆå¸¸è§ï¼Œä¹Ÿå¾ˆé€‚åˆä½¿ç”¨å•ä¾‹æ¨¡å¼åˆ›å»ºï¼ˆå…¨å±€å”¯ä¸€ã€é¢‘ç¹ä½¿ç”¨ï¼‰</p><p>ä½¿ç”¨å•ä¾‹æ¨¡å¼åˆ›å»ºå¯ä»¥é¿å…å¤šæ¬¡èŠ‚ç‚¹åˆ›å»ºå’Œé”€æ¯</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Login</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.element = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">    <span class="built_in">this</span>.element.innerHTML = <span class="string">`</span></span><br><span class="line"><span class="string">           ç”¨æˆ·å &lt;input name=&quot;username&quot;/&gt;</span></span><br><span class="line"><span class="string">           å¯†ç  &lt;input name=&quot;password&quot;/&gt;</span></span><br><span class="line"><span class="string">           &lt;input type=&quot;submit&quot; value=&quot;ç™»å½•&quot;/&gt;</span></span><br><span class="line"><span class="string">          `</span>;</span><br><span class="line">    <span class="built_in">this</span>.element.style.cssText = <span class="string">`width:100px;height:100px;position:absolute;left:50%;top:50%;margin-top:-50px;margin-left:-50px;display:none`</span>;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(<span class="built_in">this</span>.element);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">show</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.element.style.display = <span class="string">&#x27;block&#x27;</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;show&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">hide</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.element.style.display = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;hide&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡‡ç”¨ä¸Šæ–‡æœ€ç»ˆç‰ˆæœ¬åˆ›å»ºå•ä¾‹ä»£ç </span></span><br><span class="line"><span class="keyword">const</span> createLogin = <span class="keyword">new</span> SingleTon(Login);</span><br><span class="line"><span class="keyword">const</span> loginInstance = createLogin();</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;show-btn&#x27;</span>).addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  loginInstance.show();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;hide-btn&#x27;</span>).addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  loginInstance.hide();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="Store">Store</h3><blockquote><p>å…¨å±€çŠ¶æ€ç®¡ç†ï¼Œå…¨å±€å”¯ä¸€å®ä¾‹ï¼Œä¾‹å¦‚ Vuex / Redux / Mobx</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å·²çœç•¥ä¸€äº›æ— å…³ä»£ç </span></span><br><span class="line"><span class="keyword">if</span> (!Vue &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="built_in">window</span>.Vue) &#123;</span><br><span class="line">  install(<span class="built_in">window</span>.Vue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">install</span>(<span class="params">_Vue</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (Vue &amp;&amp; _Vue === Vue) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(</span><br><span class="line">      <span class="string">&#x27;[vuex] already installed. Vue.use(Vuex) should be called only once.&#x27;</span></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  Vue = _Vue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Jquery">Jquery</h3><blockquote><p>Jquery ä¹Ÿæ˜¯åº”ç”¨çš„å•ä¾‹æ¨¡å¼ï¼Œè™½ç„¶å®ƒå·²ç»æ¸æ¸æ·¡å‡ºäº†æˆ‘ä»¬çš„è§†é‡ ğŸ˜‚</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">window</span>.jQuery != <span class="literal">null</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">window</span>.jQuery;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">//init~~~~~~~</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><h3 id="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</h3><ul><li>ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹</li></ul><h3 id="ä¼˜ç‚¹">ä¼˜ç‚¹</h3><ul><li><p>åœ¨å†…å­˜é‡Œåªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†å†…å­˜çš„å¼€é”€ï¼Œå°¤å…¶æ˜¯é¢‘ç¹åœ°åˆ›å»ºå’Œé”€æ¯å®ä¾‹</p></li><li><p>é¿å…å¯¹èµ„æºçš„å¤šé‡å ç”¨</p></li></ul><h1>é—²è°ˆ</h1><blockquote><p>ä¸ŠåŠå¹´ä¸€ç›´åœ¨å¿™æ¯•ä¸šçš„äº‹æƒ…ï¼Œç„¶åä¹Ÿä¼‘æ¯äº†ä¸€æ®µæ—¶é—´ï¼Œå·²ç»å¤§åŠå¹´æ²¡å†™æŠ€æœ¯æ–‡ç« äº†ã€‚</p><p>è¿‘æœŸæ­£å¼å…¥èŒäº†ï¼Œå¼€å§‹é€æ­¥è°ƒæ•´åˆ°ä¸€ä¸ªæ¯”è¾ƒå¥½çš„å­¦ä¹ å’Œå·¥ä½œçŠ¶æ€ã€‚åˆ¶å®šä¸€äº›å­¦ä¹ è®¡åˆ’ï¼Œæ¢å¤æ›´æ–°æ–‡ç« ï¼ˆå¾ˆä¹…æ²¡å†™è¿˜æ˜¯æœ‰ç‚¹ä¸å¤ªä¹ æƒ¯å“ˆå“ˆ</p><p>ç¬¬ä¸€ä¸ªç³»åˆ—ã€Šè®¾è®¡æ¨¡å¼ã€‹ç¬¬ä¸€ç¯‡å¢¨è¿¹äº†åŠå¤©ï¼Œä½†ä¹Ÿç»ˆäºäº§å‡ºäº†ã€‚åç»­ä¼šæŒç»­æ›´æ–°ï¼Œæ›´æ–°é¢‘ç‡å’Œè¿›åº¦çœ‹ç©ºé—²æ—¶é—´æƒ…å†µäº†å“ˆå“ˆï¼Œæ¬¢è¿å…³æ³¨~</p><p>ä¸€ä¸ªè¿˜åœ¨åŠªåŠ›çš„å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆï¼Œç»§ç»­åŠ æ²¹ï¼</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/cce8553a6ec8415690f43252e508eb09~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><h1>è®¾è®¡æ¨¡å¼ç³»åˆ—æ–‡ç« æ¨è</h1><ul><li><a href="https://www.lebronchao.com/2022/08/21/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” å•ä¾‹æ¨¡å¼</a></li><li><a href="https://www.lebronchao.com/2022/08/21/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” ç­–ç•¥æ¨¡å¼</a></li><li><a href="https://www.lebronchao.com/2022/10/10/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” ä»£ç†æ¨¡å¼</a></li><li><a href="https://www.lebronchao.com/2022/10/12/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F/">JavaScript è®¾è®¡æ¨¡å¼ â€”â€” å‘å¸ƒè®¢é˜…æ¨¡å¼</a></li></ul><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;åœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆ â€”â€” è®¾è®¡æ¨¡å¼&lt;/p&gt;
&lt;p&gt;è®¾è®¡æ¨¡å¼åŸåˆ™ï¼šâ€œæ‰¾å‡ºç¨‹åºä¸­å˜åŒ–çš„åœ°æ–¹ï¼Œå¹¶å°†å˜åŒ–å°è£…èµ·æ¥â€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src= &quot;/img/loading.gif&quot; </summary>
      
    
    
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://lebronchao.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Front End" scheme="https://lebronchao.com/tags/Front-End/"/>
    
    <category term="JavaScript" scheme="https://lebronchao.com/tags/JavaScript/"/>
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="https://lebronchao.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="å•ä¾‹æ¨¡å¼" scheme="https://lebronchao.com/tags/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>æ‘„å½± | æ¢§æ¡å±±</title>
    <link href="https://lebronchao.com/2022/02/20/%E6%91%84%E5%BD%B1-%E6%A2%A7%E6%A1%90%E5%B1%B1/"/>
    <id>https://lebronchao.com/2022/02/20/%E6%91%84%E5%BD%B1-%E6%A2%A7%E6%A1%90%E5%B1%B1/</id>
    <published>2022-02-19T16:24:49.000Z</published>
    <updated>2022-02-19T16:24:49.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœºèº«ï¼šSONY A7M2<br>é•œå¤´ï¼šSONY 24-70GM<br>å‡ºé•œï¼šæ— <br>åœ°ç‚¹ï¼šæ¢§æ¡å±±</p></blockquote><div class="justified-gallery"><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00244.JPG" alt="DSC00244"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00248.JPG" alt="DSC00248"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00249.JPG" alt="DSC00249"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00250.JPG" alt="DSC00250"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00251.JPG" alt="DSC00251"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00253.JPG" alt="DSC00253"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00260.JPG" alt="DSC00260"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00287.JPG" alt="DSC00287"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00302.JPG" alt="DSC00302"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00271.JPG" alt="DSC00271"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00278.JPG" alt="DSC00278"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/IMG_0086.JPG" alt="IMG_0086"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00266.JPG" alt="DSC00266"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00237.JPG" alt="DSC00237"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00242.JPG" alt="DSC00242"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00232.JPG" alt="DSC00232"></p>          </div>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;æœºèº«ï¼šSONY A7M2&lt;br&gt;
é•œå¤´ï¼šSONY 24-70GM&lt;br&gt;
å‡ºé•œï¼šæ— &lt;br&gt;
åœ°ç‚¹ï¼šæ¢§æ¡å±±&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;justified-gallery&quot;&gt;&lt;p&gt;&lt;img src= &quot;/img/loa</summary>
      
    
    
    
    <category term="æ‘„å½±" scheme="https://lebronchao.com/categories/%E6%91%84%E5%BD%B1/"/>
    
    
    <category term="äººæ–‡" scheme="https://lebronchao.com/tags/%E4%BA%BA%E6%96%87/"/>
    
    <category term="æ‘„å½±" scheme="https://lebronchao.com/tags/%E6%91%84%E5%BD%B1/"/>
    
    <category term="é£å…‰" scheme="https://lebronchao.com/tags/%E9%A3%8E%E5%85%89/"/>
    
  </entry>
  
  <entry>
    <title>æ‘„å½± | å—å±±å¤œæ™¯</title>
    <link href="https://lebronchao.com/2022/02/07/%E6%91%84%E5%BD%B1-%E5%8D%97%E5%B1%B1%E5%A4%9C%E6%99%AF/"/>
    <id>https://lebronchao.com/2022/02/07/%E6%91%84%E5%BD%B1-%E5%8D%97%E5%B1%B1%E5%A4%9C%E6%99%AF/</id>
    <published>2022-02-06T16:16:47.000Z</published>
    <updated>2022-02-06T16:16:47.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœºèº«ï¼š SONY A7M2<br>é•œå¤´ï¼š SONY 24-70 GM<br>å‡ºé•œï¼š æ— <br>åœ°ç‚¹ï¼š æ·±åœ³å¤§å—å±±å…¬å›­</p></blockquote><div class="justified-gallery"><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00174.JPG" alt="DSC00174"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00175.JPG" alt="DSC00175"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00229.JPG" alt="DSC00229"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00230.JPG" alt="DSC00230"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/DSC00167.JPG" alt="DSC00167"></p>          </div>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;æœºèº«ï¼š SONY A7M2&lt;br&gt;
é•œå¤´ï¼š SONY 24-70 GM&lt;br&gt;
å‡ºé•œï¼š æ— &lt;br&gt;
åœ°ç‚¹ï¼š æ·±åœ³å¤§å—å±±å…¬å›­&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;justified-gallery&quot;&gt;&lt;p&gt;&lt;img src= </summary>
      
    
    
    
    <category term="æ‘„å½±" scheme="https://lebronchao.com/categories/%E6%91%84%E5%BD%B1/"/>
    
    
    <category term="æ‘„å½±" scheme="https://lebronchao.com/tags/%E6%91%84%E5%BD%B1/"/>
    
    <category term="é£å…‰" scheme="https://lebronchao.com/tags/%E9%A3%8E%E5%85%89/"/>
    
    <category term="åŸå¸‚å¤œæ™¯" scheme="https://lebronchao.com/tags/%E5%9F%8E%E5%B8%82%E5%A4%9C%E6%99%AF/"/>
    
  </entry>
  
  <entry>
    <title>NodeJSåŠ è§£å¯†ä¹‹Crypto</title>
    <link href="https://lebronchao.com/2021/12/22/NodeJS%E5%8A%A0%E8%A7%A3%E5%AF%86%E4%B9%8BCrypto/"/>
    <id>https://lebronchao.com/2021/12/22/NodeJS%E5%8A%A0%E8%A7%A3%E5%AF%86%E4%B9%8BCrypto/</id>
    <published>2021-12-22T15:50:51.000Z</published>
    <updated>2021-12-22T15:50:51.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>äº’è”ç½‘æ—¶ä»£ï¼Œç½‘ç»œä¸Šçš„æ•°æ®é‡æ¯å¤©éƒ½åœ¨ä»¥æƒŠäººçš„é€Ÿåº¦å¢é•¿ã€‚åŒæ—¶ï¼Œå„ç±»ç½‘ç»œå®‰å…¨é—®é¢˜å±‚å‡ºä¸ç©·ã€‚åœ¨ä¿¡æ¯å®‰å…¨é‡è¦æ€§æ—¥ç›Šå‡¸æ˜¾çš„ä»Šå¤©ï¼Œä½œä¸ºä¸€åå¼€å‘è€…ï¼Œéœ€è¦åŠ å¼ºå¯¹å®‰å…¨çš„è®¤è¯†ï¼Œå¹¶é€šè¿‡æŠ€æœ¯æ‰‹æ®µå¢å¼ºæœåŠ¡çš„å®‰å…¨æ€§ã€‚crypto æ¨¡å—çš„ç›®çš„æ˜¯ä¸ºäº†æä¾›é€šç”¨çš„åŠ å¯†å’Œå“ˆå¸Œç®—æ³•ã€‚ç”¨çº¯ JavaScript ä»£ç å®ç°è¿™äº›åŠŸèƒ½ä¸æ˜¯ä¸å¯èƒ½ï¼Œä½†é€Ÿåº¦ä¼šéå¸¸æ…¢ã€‚Nodejs ç”¨ C/C++å®ç°è¿™äº›ç®—æ³•åï¼Œé€šè¿‡ cypto è¿™ä¸ªæ¨¡å—æš´éœ²ä¸º JavaScript æ¥å£ï¼Œè¿™æ ·ç”¨èµ·æ¥æ–¹ä¾¿ï¼Œè¿è¡Œé€Ÿåº¦ä¹Ÿå¿«ã€‚</p></blockquote><h1>ç¼–ç æ–¹å¼</h1><blockquote><p>ä¸ºä»€ä¹ˆä¿¡æ¯ä¼ è¾“éœ€è¦ç¼–ç ï¼Ÿ</p><p>åœ¨å¼€å‘åŠ å¯†è§£å¯†æ•°æ®çš„æ—¶å€™ç¢°åˆ°éœ€è¦æŠŠåŠ å¯†å¥½çš„å­—èŠ‚æ•°ç»„è½¬æ¢æˆ String å¯¹è±¡ç”¨äºç½‘ç»œä¼ è¾“çš„éœ€æ±‚ï¼Œå¦‚æœæŠŠå­—èŠ‚æ•°ç»„ç›´æ¥è½¬æ¢æˆ UTF-8 ç­‰ç¼–ç æ–¹å¼çš„è¯è‚¯å®šä¼šå­˜åœ¨æŸäº›ç¼–ç æ²¡æœ‰å¯¹åº”çš„å­—ç¬¦(8bit åªèƒ½è¡¨ç¤º 128 ä¸ªå­—ç¬¦)ï¼Œåœ¨ç¼–ç å’Œè§£æè¿‡ç¨‹ä¸­ä¼šå‡ºé”™ï¼Œä¸èƒ½æ­£ç¡®åœ°è¡¨è¾¾ä¿¡æ¯ã€‚è¿™æ—¶å°±å¯ä»¥é€šè¿‡å¸¸ç”¨çš„äºŒè¿›åˆ¶æ•°æ®ç¼–ç æ–¹å¼ Base64 ç¼–ç æˆ–è€… Hex ç¼–ç æ¥å®ç°ã€‚</p></blockquote><h2 id="hex-ç¼–ç "><strong>hex ç¼–ç </strong></h2><ul><li>ç¼–ç åŸç†</li></ul><p>å°†ä¸€ä¸ª 8 ä½çš„å­—èŠ‚æ•°æ®ç”¨ä¸¤ä¸ª 16 è¿›åˆ¶æ•°è¡¨ç¤ºå‡ºæ¥</p><ol><li>å°† 8 ä½äºŒè¿›åˆ¶ç é‡æ–°åˆ†ç»„æˆä¸¤ä¸ª 4 ä½çš„å­—èŠ‚</li><li>å…¶ä¸­ä¸€ä¸ªå­—èŠ‚çš„ä½ 4 ä½æ˜¯åŸå­—èŠ‚çš„é«˜ 4 ä½ï¼Œå¦ä¸€ä¸ªå­—èŠ‚çš„ä½ 4 ä½æ˜¯åŸæ•°æ®çš„ä½ 4 ä½</li><li>é«˜ 4 ä½éƒ½è¡¥ 0ï¼Œç„¶åè¾“å‡ºè¿™ä¸¤ä¸ªå­—èŠ‚å¯¹åº”çš„åå…­è¿›åˆ¶æ•°å­—ä½œä¸ºç¼–ç </li></ol><ul><li>ä¾‹å­</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">ASCIIç ï¼šA(<span class="number">65</span>)</span><br><span class="line"></span><br><span class="line">äºŒè¿›åˆ¶ç :<span class="number">0100</span> <span class="number">0001</span></span><br><span class="line"></span><br><span class="line">é‡æ–°åˆ†ç»„: <span class="number">00000100</span>  <span class="number">00000001</span></span><br><span class="line"></span><br><span class="line">åå…­è¿›åˆ¶: <span class="number">4</span>         <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Hexç¼–ç ï¼š<span class="number">41</span></span><br></pre></td></tr></table></figure><p>å°±ç®—åŸæ–‡ä»¶æ˜¯çº¯è‹±æ–‡å†…å®¹ï¼Œç¼–ç åå†…å®¹ä¹Ÿå’ŒåŸæ–‡å®Œå…¨ä¸ä¸€æ ·ï¼Œæ™®é€šäººéš¾ä»¥é˜…è¯»ä½†ç”±äºåªæœ‰ 16 ä¸ªå­—ç¬¦ï¼Œå¬è¯´ä¸€äº›ç¨‹åºå‘˜å¤§ç‰›èƒ½å¤Ÿè®°ä¸‹ä»–ä»¬çš„æ˜ å°„å…³ç³»ï¼Œä»è€Œè¾¾åˆ°è¯» hex ç¼–ç å’Œè¯»åŸæ–‡ä¸€æ ·çš„æ•ˆæœã€‚å¦å¤–ï¼Œæ•°æ®åœ¨ç»è¿‡ hex ç¼–ç åï¼Œç©ºé—´å ç”¨å˜æˆäº†åŸæ¥çš„ 2 å€ã€‚</p><h2 id="base64-ç¼–ç "><strong>base64 ç¼–ç </strong></h2><ul><li>ç¼–ç åŸç†</li></ul><p>Base64 ç¼–ç æ˜¯é€šè¿‡ 64 ä¸ªå­—ç¬¦æ¥è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®ï¼Œ64 ä¸ªå­—ç¬¦è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®åªèƒ½è¡¨ç¤º 6 ä½ï¼Œæ‰€ä»¥å®ƒå¯ä»¥é€šè¿‡ 4 ä¸ª Base64 å­—ç¬¦æ¥è¡¨ç¤º 3 ä¸ªå­—èŠ‚ï¼Œå¦‚ä¸‹æ˜¯ Base64 çš„å­—ç¬¦ç¼–ç è¡¨</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202230237552.(null)" alt="img"></p><ul><li>ä¸¾ä¸ª Base64 ç¼–ç çš„ä¾‹å­ï¼Œå›¾å°±å¾ˆæµ…æ˜¾æ˜“æ‡‚äº†</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202230244003.(null)" alt="img"></p><ul><li>å­—ç¬¦ä¸²é•¿åº¦ä¸æ˜¯ 3 çš„å€æ•°æ—¶è¡¥ 0ï¼Œä¹Ÿå°±æ˜¯â€œ=â€</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202230248378.(null)" alt="img"></p><p>ç”± 64 ä¸ªå­—ç¬¦ç»„æˆï¼Œæ¯” hex ç¼–ç æ›´éš¾é˜…è¯»ï¼Œä½†ç”±äºæ¯ 3 ä¸ªå­—èŠ‚ä¼šè¢«ç¼–ç ä¸º 4 ä¸ªå­—ç¬¦ã€‚</p><p>æ‰€ä»¥ï¼Œç©ºé—´å ç”¨ä¼šæ˜¯åŸæ¥çš„ 4/3ï¼Œæ¯” hex è¦èŠ‚çœç©ºé—´ã€‚å¦å¤–è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶ Base64 ç¼–ç åçš„æ•°æ®éš¾ä»¥é˜…è¯»ï¼Œä½†ä¸èƒ½å°†å…¶ä½œä¸ºåŠ å¯†ç®—æ³•ä½¿ç”¨ï¼Œå› ä¸ºå®ƒè§£ç éƒ½ä¸éœ€è¦ä½ æä¾›å¯†é’¥å•Š</p><h2 id="urlencode-ç¼–ç "><strong>urlencode ç¼–ç </strong></h2><ul><li>ç¼–ç åŸç†</li></ul><p>urlencode ç¼–ç ï¼Œçœ‹åå­—å°±å°±çŸ¥é“æ˜¯è®¾è®¡ç»™ url ç¼–ç çš„å¯¹äº<code>a-z</code>ï¼Œ<code>A-Z</code>ï¼Œ<code>0-9</code>ï¼Œ<code>.</code>ï¼Œ<code>-</code>å’Œ<code>_</code> ï¼Œurlencode éƒ½ä¸ä¼šåšä»»ä½•å¤„ç†åŸæ ·è¾“å‡ºï¼Œè€Œå…¶å®ƒå­—èŠ‚ä¼šè¢«ç¼–ç ä¸º<code>%xx</code>(16 è¿›åˆ¶)çš„å½¢å¼ï¼Œå…¶ä¸­<code>xx</code>å°±æ˜¯è¿™ä¸ªå­—èŠ‚å¯¹åº”çš„ hex ç¼–ç ã€‚ ç”±äºè‹±æ–‡å­—ç¬¦åŸæ ·ä¿ç•™ï¼Œå¯¹äºä»¥è‹±æ–‡ä¸ºä¸»çš„å†…å®¹ï¼Œå¯è¯»æ€§æœ€å¥½ï¼Œç©ºé—´å ç”¨å‡ ä¹ä¸å˜ï¼Œè€Œå¯¹äºéè‹±æ–‡å†…å®¹ï¼Œæ¯ä¸ªå­—èŠ‚ä¼šè¢«ç¼–ç ä¸º%xx çš„ 3 ä¸ªå­—ç¬¦ï¼Œç©ºé—´å ç”¨æ˜¯åŸæ¥çš„ 3 å€ï¼Œæ‰€ä»¥ urlencode æ˜¯ä¸€ä¸ªå¯¹è‹±æ–‡å‹å¥½çš„ç¼–ç æ–¹æ¡ˆã€‚</p><h1><strong>Hash</strong></h1><blockquote><p>æ‘˜è¦ï¼šå°†ä¸å›ºå®šé•¿åº¦çš„æ¶ˆæ¯ä½œä¸ºè¾“å…¥ Hash å‡½æ•°ï¼Œç”Ÿæˆå›ºå®šé•¿åº¦çš„è¾“å‡ºï¼Œè¿™æ®µè¾“å‡ºç§°ä¹‹ä¸ºæ‘˜è¦</p><p>é€‚ç”¨åœºæ™¯ï¼šæ•æ„Ÿä¿¡æ¯çš„æ ¡éªŒå’Œå­˜å‚¨ã€éªŒè¯æ¶ˆæ¯å®Œæ•´ &amp; æœªè¢«ç¯¡æ”¹</p></blockquote><h2 id="ç‰¹ç‚¹"><strong>ç‰¹ç‚¹</strong></h2><ol><li>è¾“å‡ºé•¿åº¦å›ºå®šï¼šè¾“å…¥é•¿åº¦ä¸å›ºå®šï¼Œè¾“å‡ºé•¿åº¦å›ºå®šï¼ˆå› ç®—æ³•è€Œå¼‚ï¼Œå¸¸è§çš„æœ‰ MD5ã€SHA ç³»åˆ—ï¼‰ã€‚</li><li>è¿ç®—ä¸å¯é€†ï¼šå·²çŸ¥è¿ç®—ç»“æœçš„æƒ…å†µä¸‹ï¼Œæ— æ³•é€šè¿‡é€šè¿‡é€†è¿ç®—å¾—åˆ°åŸå§‹å­—ç¬¦ä¸²ã€‚</li><li>é«˜åº¦ç¦»æ•£ï¼šè¾“å…¥çš„å¾®å°å˜åŒ–ï¼Œå¯å¯¼è‡´è¿ç®—ç»“æœå·®å¼‚å·¨å¤§ã€‚</li><li>å¼±ç¢°æ’æ€§ï¼šä¸åŒè¾“å…¥çš„æ•£åˆ—å€¼å¯èƒ½ç›¸åŒã€‚</li></ol><h2 id="ä»¥-MD5-ä¸ºä¾‹">ä»¥ MD5 ä¸ºä¾‹</h2><blockquote><p>MD5ï¼ˆMessage-Digest Algorithmï¼‰æ˜¯è®¡ç®—æœºå®‰å…¨é¢†åŸŸå¹¿æ³›ä½¿ç”¨çš„æ•£åˆ—å‡½æ•°ï¼ˆåˆç§°å“ˆå¸Œç®—æ³•ã€æ‘˜è¦ç®—æ³•ï¼‰ï¼Œä¸»è¦ç”¨æ¥ç¡®ä¿æ¶ˆæ¯çš„å®Œæ•´å’Œä¸€è‡´æ€§ã€‚</p><p>å¸¸è§çš„åº”ç”¨åœºæ™¯ï¼šå¯†ç ä¿æŠ¤ã€ä¸‹è½½æ–‡ä»¶æ ¡éªŒç­‰ã€‚</p></blockquote><h2 id="åº”ç”¨åœºæ™¯"><strong>åº”ç”¨åœºæ™¯</strong></h2><ol><li>æ–‡ä»¶å®Œæ•´æ€§æ ¡éªŒï¼šæ¯”å¦‚ä»ç½‘ä¸Šä¸‹è½½ä¸€ä¸ªè½¯ä»¶ï¼Œä¸€èˆ¬ç½‘ç«™éƒ½ä¼šå°†è½¯ä»¶çš„ md5 å€¼é™„åœ¨ç½‘é¡µä¸Šï¼Œç”¨æˆ·ä¸‹è½½å®Œè½¯ä»¶åï¼Œå¯å¯¹ä¸‹è½½åˆ°æœ¬åœ°çš„è½¯ä»¶è¿›è¡Œ md5 è¿ç®—ï¼Œç„¶åè·Ÿç½‘ç«™ä¸Šçš„ md5 å€¼è¿›è¡Œå¯¹æ¯”ï¼Œç¡®ä¿è½¯ä»¶çš„å®Œæ•´æ€§</li><li>å¯†ç ä¿æŠ¤ï¼šå°† md5 åçš„å¯†ç ä¿å­˜åˆ°æ•°æ®åº“ï¼Œè€Œä¸æ˜¯ä¿å­˜æ˜æ–‡å¯†ç ï¼Œé¿å…æ‹–åº“ç­‰äº‹ä»¶å‘ç”Ÿåï¼Œæ˜æ–‡å¯†ç æ³„æ¼ã€‚</li><li>é˜²ç¯¡æ”¹ï¼šæ¯”å¦‚æ•°å­—è¯ä¹¦çš„é˜²ç¯¡æ”¹ï¼Œå°±ç”¨åˆ°äº†æ‘˜è¦ç®—æ³•ã€‚ï¼ˆå½“ç„¶è¿˜è¦ç»“åˆæ•°å­—ç­¾åç­‰æ‰‹æ®µï¼‰</li></ol><h2 id="ç®€å•çš„-md5-è¿ç®—">ç®€å•çš„ md5 è¿ç®—</h2><ul><li>hash.digest([encoding])</li></ul><p>è®¡ç®—æ‘˜è¦ã€‚encoding å¯ä»¥æ˜¯<code>hex</code>ã€<code>base64</code>æˆ–å…¶ä»–ã€‚å¦‚æœå£°æ˜äº† encodingï¼Œé‚£ä¹ˆè¿”å›å­—ç¬¦ä¸²ã€‚å¦åˆ™ï¼Œè¿”å› Buffer å®ä¾‹ã€‚æ³¨æ„ï¼Œè°ƒç”¨ hash.digest()åï¼Œhash å¯¹è±¡å°±ä½œåºŸäº†ï¼Œå†æ¬¡è°ƒç”¨å°±ä¼šæŠ¥é”™ã€‚</p><ul><li>hash.update(data[, input_encoding])</li></ul><p>input_encoding å¯ä»¥æ˜¯<code>utf8</code>ã€<code>ascii</code>æˆ–è€…å…¶ä»–ã€‚å¦‚æœ data æ˜¯å­—ç¬¦ä¸²ï¼Œä¸”æ²¡æœ‰æŒ‡å®š input_encodingï¼Œåˆ™é»˜è®¤æ˜¯<code>utf8</code>ã€‚æ³¨æ„ï¼Œhash.update()æ–¹æ³•å¯ä»¥è°ƒç”¨å¤šæ¬¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> FILE_PATH = <span class="string">&#x27;./index.txt&#x27;</span></span><br><span class="line"><span class="keyword">const</span> ENCODING = <span class="string">&#x27;hex&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> md5 = crypto.createHash(<span class="string">&#x27;md5&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> content = fs.readFileSync(FILE_PATH);</span><br><span class="line"><span class="keyword">const</span> result = md5.update(content).digest(ENCODING);</span><br><span class="line"><span class="built_in">console</span>.log(result);</span><br><span class="line"></span><br><span class="line"><span class="comment">// f62091d58876a322864f5a522eb05052</span></span><br></pre></td></tr></table></figure><h2 id="å¯†ç ä¿æŠ¤">å¯†ç ä¿æŠ¤</h2><blockquote><p>å‰é¢æåˆ°ï¼Œå°†æ˜æ–‡å¯†ç ä¿å­˜åˆ°æ•°æ®åº“æ˜¯å¾ˆä¸å®‰å…¨çš„</p><p>æœ€ä¸æµä¹Ÿè¦è¿›è¡Œ md5 åè¿›è¡Œä¿å­˜</p><p>æ¯”å¦‚ç”¨æˆ·å¯†ç æ˜¯<code>123456</code>ï¼Œmd5 è¿è¡Œåï¼Œå¾—åˆ°<code>è¾“å‡ºï¼še10adc3949ba59abbe56e057f20f883e</code></p></blockquote><p>è¿™æ ·è‡³å°‘æœ‰ä¸¤ä¸ªå¥½å¤„ï¼š</p><ol><li>é˜²å†…éƒ¨æ”»å‡»ï¼šç½‘ç«™å¼€å‘è€…ä¹Ÿä¸çŸ¥é“ç”¨æˆ·çš„æ˜æ–‡å¯†ç ï¼Œé¿å…å¼€å‘è€…æ‹¿ç€ç”¨æˆ·æ˜æ–‡å¯†ç å¹²åäº‹ï¼Œä»¥è¿™ç§å½¢å¼æ¥ä¿æŠ¤ç”¨æˆ·çš„éšç§</li><li>é˜²å¤–éƒ¨æ”»å‡»ï¼šå¦‚ç½‘ç«™è¢«é»‘å®¢å…¥ä¾µï¼Œé»‘å®¢ä¹Ÿåªèƒ½æ‹¿åˆ° md5 åçš„å¯†ç ï¼Œè€Œä¸æ˜¯ç”¨æˆ·çš„æ˜æ–‡å¯†ç ï¼Œä¿è¯äº†å¯†ç çš„å®‰å…¨æ€§</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cryptPwd = <span class="function">(<span class="params">password</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> md5 = crypto.createHash(<span class="string">&#x27;md5&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> md5.update(password).digest(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> password = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> cryptPassword = cryptPwd(password);</span><br><span class="line"><span class="built_in">console</span>.log(cryptPassword);</span><br><span class="line"></span><br><span class="line"><span class="comment">// e10adc3949ba59abbe56e057f20f883e</span></span><br></pre></td></tr></table></figure><ul><li>å‰é¢æåˆ°ï¼Œé€šè¿‡å¯¹ç”¨æˆ·å¯†ç è¿›è¡Œ md5 è¿ç®—æ¥æé«˜å®‰å…¨æ€§ã€‚<ul><li>ä½†å®é™…ä¸Šï¼Œè¿™æ ·çš„å®‰å…¨æ€§æ˜¯å¾ˆå·®çš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</li><li>ç¨å¾®ä¿®æ”¹ä¸‹ä¸Šé¢çš„ä¾‹å­ï¼Œå¯èƒ½ä½ å°±æ˜ç™½äº†ã€‚ç›¸åŒçš„æ˜æ–‡å¯†ç ï¼Œmd5 å€¼ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚</li></ul></li><li>ä¹Ÿå°±æ˜¯è¯´å½“æ”»å‡»è€…çŸ¥é“ç®—æ³•æ˜¯ md5ï¼Œä¸”æ•°æ®åº“é‡Œå­˜å‚¨çš„å¯†ç å€¼ä¸º<code>e10adc3949ba59abbe56e057f20f883e</code>æ—¶ï¼Œç†è®ºä¸Šå¯ä»¥å¯ä»¥çŒœåˆ°ï¼Œç”¨æˆ·çš„æ˜æ–‡å¯†ç å°±æ˜¯<code>123456</code>ã€‚</li><li>äº‹å®ä¸Šï¼Œå½©è™¹è¡¨å°±æ˜¯è¿™ä¹ˆè¿›è¡Œæš´åŠ›ç ´è§£çš„ï¼šäº‹å…ˆå°†å¸¸è§æ˜æ–‡å¯†ç çš„ md5 å€¼è¿ç®—å¥½å­˜èµ·æ¥ï¼Œç„¶åè·Ÿç½‘ç«™æ•°æ®åº“é‡Œå­˜å‚¨çš„å¯†ç è¿›è¡ŒåŒ¹é…ï¼Œå°±èƒ½å¤Ÿå¿«é€Ÿæ‰¾åˆ°ç”¨æˆ·çš„æ˜æ–‡å¯†ç ã€‚</li></ul><blockquote><p>é‚£ä¹ˆæœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥è¿›ä¸€æ­¥æå‡å®‰å…¨æ€§å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ï¼šå¯†ç åŠ ç›ã€‚</p></blockquote><h2 id="å¯†ç åŠ ç›"><strong>å¯†ç åŠ ç›</strong></h2><blockquote><p>â€œåŠ ç›â€è¿™ä¸ªè¯çœ‹ä¸Šå»å¾ˆç„ä¹ï¼Œå…¶å®åŸç†å¾ˆç®€å•</p><p>å°±æ˜¯åœ¨å¯†ç ç‰¹å®šä½ç½®æ’å…¥ç‰¹å®šå­—ç¬¦ä¸²åï¼Œå†å¯¹ä¿®æ”¹åçš„å­—ç¬¦ä¸²è¿›è¡Œ md5 è¿ç®—ã€‚</p></blockquote><p>åŒæ ·çš„å¯†ç ï¼Œå½“â€œç›â€å€¼ä¸ä¸€æ ·æ—¶ï¼Œmd5 å€¼çš„å·®å¼‚éå¸¸å¤§</p><p>é€šè¿‡å¯†ç åŠ ç›ï¼Œå¯ä»¥é˜²æ­¢æœ€åˆçº§çš„æš´åŠ›ç ´è§£ï¼Œå¦‚æœæ”»å‡»è€…äº‹å…ˆä¸çŸ¥é“â€ç›â€œå€¼ï¼Œç ´è§£çš„éš¾åº¦å°±ä¼šéå¸¸å¤§</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cryptPwd = <span class="function">(<span class="params">password, salt</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> saltPassword = <span class="string">`<span class="subst">$&#123;password&#125;</span>:<span class="subst">$&#123;salt&#125;</span>`</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`åŸå§‹å¯†ç ï¼š<span class="subst">$&#123;password&#125;</span>`</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`åŠ ç›å¯†ç ï¼š<span class="subst">$&#123;saltPassword&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> md5 = crypto.createHash(<span class="string">&#x27;md5&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> result = md5.update(password).digest(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`åŠ ç›å¯†ç çš„MD5å€¼ï¼š<span class="subst">$&#123;result&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> password = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> salt = <span class="string">&#x27;abc&#x27;</span></span><br><span class="line">cryptPwd(password, salt);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">åŸå§‹å¯†ç ï¼š123456</span></span><br><span class="line"><span class="comment">åŠ ç›å¯†ç ï¼š123456:abc</span></span><br><span class="line"><span class="comment">åŠ ç›å¯†ç çš„MD5å€¼ï¼še10adc3949ba59abbe56e057f20f883e</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="å¯†ç åŠ ç›ï¼šéšæœºç›å€¼"><strong>å¯†ç åŠ ç›ï¼šéšæœºç›å€¼</strong></h2><blockquote><p>é€šè¿‡å¯†ç åŠ ç›ï¼Œå¯†ç çš„å®‰å…¨æ€§å·²ç»æé«˜äº†ä¸å°‘</p><p>ä½†å…¶å®ä¸Šé¢çš„ä¾‹å­å­˜åœ¨ä¸å°‘é—®é¢˜</p></blockquote><ul><li>å‡è®¾å­—ç¬¦ä¸²æ‹¼æ¥ç®—æ³•ã€ç›å€¼å·²å¤–æ³„ï¼Œä¸Šé¢çš„ä»£ç è‡³å°‘å­˜åœ¨ä¸‹é¢é—®é¢˜ï¼š</li></ul><ol><li>çŸ­ç›å€¼ï¼šéœ€è¦ç©·ä¸¾çš„å¯èƒ½æ€§è¾ƒå°‘ï¼Œå®¹æ˜“æš´åŠ›ç ´è§£ï¼Œä¸€èˆ¬é‡‡ç”¨é•¿ç›å€¼æ¥è§£å†³ã€‚</li><li>ç›å€¼å›ºå®šï¼šç±»ä¼¼çš„ï¼Œæ”»å‡»è€…åªéœ€è¦æŠŠå¸¸ç”¨å¯†ç +ç›å€¼çš„ hash å€¼è¡¨ç®—å‡ºæ¥ã€‚</li></ol><ul><li>çŸ­ç›å€¼è‡ªä¸å¿…è¯´ï¼Œåº”è¯¥é¿å…<ul><li>å¯¹äºä¸ºä»€ä¹ˆä¸åº”è¯¥ä½¿ç”¨å›ºå®šç›å€¼ï¼Œè¿™é‡Œéœ€è¦å¤šè§£é‡Šä¸€ä¸‹ã€‚å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬çš„ç›å€¼æ˜¯ç¡¬ç¼–ç åˆ°æˆ‘ä»¬çš„ä»£ç é‡Œçš„ï¼ˆæ¯”å¦‚é…ç½®æ–‡ä»¶ï¼‰ï¼Œä¸€æ—¦æ”»å‡»è€…é€šè¿‡æŸç§æ‰‹æ®µè·çŸ¥äº†ç›å€¼ï¼Œé‚£ä¹ˆï¼Œåªéœ€è¦é’ˆå¯¹è¿™ä¸²å›ºå®šçš„ç›å€¼è¿›è¡Œæš´åŠ›ç©·ä¸¾å°±è¡Œäº†</li></ul></li><li>æ¯”å¦‚ä¸Šé¢çš„ä»£ç ï¼Œå½“ä½ çŸ¥é“ç›å€¼æ˜¯<code>abc</code>æ—¶ï¼Œç«‹åˆ»å°±èƒ½çŒœåˆ°<code>51011af1892f59e74baf61f3d4389092</code>å¯¹åº”çš„æ˜æ–‡å¯†ç æ˜¯<code>123456</code>ã€‚</li></ul><blockquote><p>é‚£ä¹ˆï¼Œè¯¥æ€ä¹ˆä¼˜åŒ–å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼šéšæœºç›å€¼ã€‚</p></blockquote><p>å¯ä»¥çœ‹åˆ°ï¼Œå¯†ç åŒæ ·æ˜¯ 123456ï¼Œç”±äºé‡‡ç”¨äº†éšæœºç›å€¼ï¼Œå‰åè¿ç®—å¾—å‡ºçš„ç»“æœæ˜¯ä¸åŒçš„</p><p>è¿™æ ·å¸¦æ¥çš„å¥½å¤„æ˜¯ï¼Œå¤šä¸ªç”¨æˆ·ï¼ŒåŒæ ·çš„å¯†ç ï¼Œæ”»å‡»è€…éœ€è¦è¿›è¡Œå¤šæ¬¡è¿ç®—æ‰èƒ½å¤Ÿå®Œå…¨ç ´è§£</p><p>åŒæ ·æ˜¯çº¯æ•°å­— 3 ä½çŸ­ç›å€¼ï¼Œéšæœºç›å€¼ç ´è§£æ‰€éœ€çš„è¿ç®—é‡ &gt;&gt; å›ºå®šç›å€¼</p><blockquote><p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getRandomSalt = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.random().toString().slice(<span class="number">2</span>,<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cryptPwd = <span class="function">(<span class="params">password, salt</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> saltPassword = <span class="string">`<span class="subst">$&#123;password&#125;</span>:<span class="subst">$&#123;salt&#125;</span>`</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`åŸå§‹å¯†ç ï¼š<span class="subst">$&#123;password&#125;</span>`</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`åŠ ç›å¯†ç ï¼š<span class="subst">$&#123;saltPassword&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> md5 = crypto.createHash(<span class="string">&#x27;md5&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> result = md5.update(saltPassword).digest(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`åŠ ç›å¯†ç çš„MD5å€¼ï¼š<span class="subst">$&#123;result&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> password = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line">cryptPwd(password, getRandomSalt());</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">åŸå§‹å¯†ç ï¼š123456</span></span><br><span class="line"><span class="comment">åŠ ç›å¯†ç ï¼š123456:126</span></span><br><span class="line"><span class="comment">åŠ ç›å¯†ç çš„MD5å€¼ï¼š3aeb1848ff63aa32b262bc3f8dd5bd82</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">cryptPwd(password, getRandomSalt());</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">åŸå§‹å¯†ç ï¼š123456</span></span><br><span class="line"><span class="comment">åŠ ç›å¯†ç ï¼š123456:232</span></span><br><span class="line"><span class="comment">åŠ ç›å¯†ç çš„MD5å€¼ï¼š21a427268a5094322146e18e47b135fb</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="HMAC-åŠŸèƒ½"><strong>HMAC åŠŸèƒ½</strong></h2><blockquote><p>HMAC çš„å…¨ç§°æ˜¯ Hash-based Message Authentication Codeï¼Œä¹Ÿå³åœ¨ hash çš„åŠ ç›è¿ç®—ã€‚</p><p>å…·ä½“åˆ°ä½¿ç”¨çš„è¯ï¼Œè·Ÿ hash æ¨¡å—å·®ä¸å¤šï¼Œé€‰å®š hash ç®—æ³•ï¼ŒæŒ‡å®šâ€œç›â€å³å¯ã€‚</p><p>å’Œä¸Šé¢çš„ä¾‹å­çš„åŒºåˆ«æ˜¯ä¸€ä¸ªæ˜¯æ‰‹åŠ¨æ‹¼ç›å€¼ï¼Œä¸€ä¸ªæ˜¯åˆ©ç”¨ HMAC æ¨¡å—</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&quot;crypto&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> FILE_PATH = <span class="string">&quot;./index.txt&quot;</span></span><br><span class="line"><span class="keyword">const</span> SECRET = <span class="string">&#x27;secret&#x27;</span></span><br><span class="line"><span class="keyword">const</span> content = fs.readFileSync(FILE_PATH,&#123;<span class="attr">encoding</span>:<span class="string">&#x27;utf8&#x27;</span>&#125;)</span><br><span class="line"><span class="keyword">const</span> hmac = crypto.createHmac(<span class="string">&#x27;sha256&#x27;</span>, SECRET);</span><br><span class="line"></span><br><span class="line">hmac.update(content)</span><br><span class="line"><span class="keyword">const</span> output = hmac.digest(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`Hmac: <span class="subst">$&#123;output&#125;</span>`</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Hmac: 6f438ef66d3806ae14d6692d9610e55c41ebb4eb3ee73911a4d512bd1cade976</span></span><br></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼šå¤§æ–‡ä»¶å¯æµå¼å¤„ç†</p></blockquote><h1>åŠ å¯† / è§£å¯†</h1><blockquote><p>åŠ è§£å¯†ä¸»è¦ç”¨åˆ°ä¸‹é¢ä¸¤ç»„æ–¹æ³•ï¼š</p></blockquote><ul><li><p>åŠ å¯†ï¼š</p><ul><li>crypto.createCipher(algorithm, password)</li></ul></li><li><p>crypto.createCipheriv(algorithm, key, iv)</p></li><li><p>è§£å¯†ï¼š</p><ul><li>crypto.createDecipher(algorithm, password)</li></ul></li><li><p>crypto.createDecipheriv(algorithm, key, iv)</p></li></ul><h2 id="crypto-createCipher-crypto-createDecipher"><strong>crypto.createCipher / crypto.createDecipher</strong></h2><blockquote><p>å…ˆæ¥çœ‹ä¸‹ crypto.createCipher(algorithm, password)ï¼Œä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯åŠ å¯†ç®—æ³•ã€å¯†ç </p></blockquote><ul><li><p>algorithmï¼šåŠ å¯†ç®—æ³•ï¼Œæ¯”å¦‚<code>aes192</code></p><ul><li>å…·ä½“æœ‰å“ªäº›å¯é€‰çš„ç®—æ³•ï¼Œä¾èµ–äºæœ¬åœ°<code>openssl</code>çš„ç‰ˆæœ¬</li></ul></li><li><p>å¯ä»¥é€šè¿‡<code>openssl list-cipher-algorithms</code>å‘½ä»¤æŸ¥çœ‹æ”¯æŒå“ªäº›ç®—æ³•</p></li><li><p>passwordï¼šç”¨æ¥ç”Ÿæˆå¯†é’¥(key)ã€åˆå§‹åŒ–å‘é‡(IV)</p></li></ul><blockquote><p>crypto.createDecipher(algorithm, password)å¯ä»¥çœ‹ä½œ crypto.createCipher(algorithm, password) é€†å‘æ“ä½œ</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&quot;crypto&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> SECRET = <span class="string">&#x27;secret&#x27;</span></span><br><span class="line"><span class="keyword">const</span> ALGORITHM = <span class="string">&#x27;aes192&#x27;</span></span><br><span class="line"><span class="keyword">const</span> content = <span class="string">&#x27;Hello Node.js&#x27;</span></span><br><span class="line"><span class="keyword">const</span> encoding = <span class="string">&#x27;hex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ å¯†</span></span><br><span class="line"><span class="keyword">const</span> cipher = crypto.createCipher(ALGORITHM, SECRET)</span><br><span class="line">cipher.update(content)</span><br><span class="line"><span class="keyword">const</span> output = cipher.final(encoding)</span><br><span class="line"><span class="built_in">console</span>.log(output)</span><br><span class="line"><span class="comment">// 944e6e3c21d6eb8568bd6a9716631eã€e</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£å¯†</span></span><br><span class="line"><span class="keyword">const</span> decipher = crypto.createDecipher(ALGORITHM, SECRET)</span><br><span class="line">decipher.update(output, encoding)</span><br><span class="line"><span class="keyword">const</span> input = decipher.final(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(input)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Hello Node.js</span></span><br></pre></td></tr></table></figure><h2 id="crypto-createCipheriv-crypto-createDecipheriv"><strong>crypto.createCipheriv / crypto.createDecipheriv</strong></h2><blockquote><p>ç›¸å¯¹äº crypto.createCipher() æ¥è¯´ï¼Œcrypto.createCipheriv() éœ€è¦æä¾›<code>key</code>å’Œ<code>iv</code>ï¼Œè€Œ crypto.createCipher() æ˜¯æ ¹æ®ç”¨æˆ·æä¾›çš„ password ç®—å‡ºæ¥çš„</p><p>keyã€iv å¯ä»¥æ˜¯ Bufferï¼Œä¹Ÿå¯ä»¥æ˜¯ utf8 ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œè¿™é‡Œéœ€è¦å…³æ³¨çš„æ˜¯å®ƒä»¬çš„é•¿åº¦ï¼š</p></blockquote><ul><li><p>keyï¼šæ ¹æ®é€‰æ‹©çš„ç®—æ³•æœ‰å…³</p><ul><li>æ¯”å¦‚ aes128ã€aes192ã€aes256ï¼Œé•¿åº¦åˆ†åˆ«æ˜¯ 128ã€192ã€256 ä½ï¼ˆ16ã€24ã€32 å­—èŠ‚ï¼‰</li></ul></li><li><p>ivï¼šåˆå§‹åŒ–å‘é‡ï¼Œéƒ½æ˜¯ 128 ä½ï¼ˆ16 å­—èŠ‚ï¼‰ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºå¯†ç ç›çš„ä¸€ç§</p></li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&quot;crypto&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> key = crypto.randomBytes(<span class="number">192</span> / <span class="number">8</span>)</span><br><span class="line"><span class="keyword">const</span> iv = crypto.randomBytes(<span class="number">128</span> / <span class="number">8</span>)</span><br><span class="line"><span class="keyword">const</span> algorithm = <span class="string">&#x27;aes192&#x27;</span></span><br><span class="line"><span class="keyword">const</span> encoding = <span class="string">&#x27;hex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> encrypt = <span class="function">(<span class="params">text</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> cipher = crypto.createCipheriv(algorithm, key, iv)</span><br><span class="line">    cipher.update(text)</span><br><span class="line">    <span class="keyword">return</span> cipher.final(encoding)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> decrypt = <span class="function">(<span class="params">encrypted</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> decipher = crypto.createDecipheriv(algorithm, key, iv)</span><br><span class="line">    decipher.update(encrypted, encoding)</span><br><span class="line">    <span class="keyword">return</span> decipher.final(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> content = <span class="string">&#x27;Hello Node.js&#x27;</span></span><br><span class="line"><span class="keyword">const</span> crypted = encrypt(content)</span><br><span class="line"><span class="built_in">console</span>.log(crypted)</span><br><span class="line"></span><br><span class="line"><span class="comment">// db75f3e9e78fba0401ca82527a0bbd62</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> decrypted = decrypt(crypted)</span><br><span class="line"><span class="built_in">console</span>.log(decrypted)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Hello Node.js</span></span><br></pre></td></tr></table></figure><h2 id="æ•°å­—ç­¾å-ç­¾åæ ¡éªŒ"><strong>æ•°å­—ç­¾å</strong> <strong>/ ç­¾åæ ¡éªŒ</strong></h2><ul><li>å‡è®¾ï¼š<ul><li>æœåŠ¡ç«¯åŸå§‹ä¿¡æ¯ä¸º Mï¼Œæ‘˜è¦ç®—æ³•ä¸º Hashï¼ŒHash(M)å¾—å‡ºçš„æ‘˜è¦æ˜¯ H</li><li>å…¬é’¥ä¸º Pubï¼Œç§é’¥ä¸º Pivï¼Œéå¯¹ç§°åŠ å¯†ç®—æ³•ä¸º Encryptï¼Œéå¯¹ç§°è§£å¯†ç®—æ³•ä¸º Decrypt</li><li>Encrypt(H)å¾—åˆ°çš„ç»“æœæ˜¯ S</li><li>å®¢æˆ·ç«¯æ‹¿åˆ°çš„ä¿¡æ¯ä¸º M1ï¼Œåˆ©ç”¨ Hash(M1)å¾—å‡ºçš„ç»“æœæ˜¯ H1</li></ul></li><li>æ•°å­—ç­¾åçš„äº§ç”Ÿã€æ ¡éªŒæ­¥éª¤åˆ†åˆ«å¦‚ä¸‹ï¼š<ul><li>æ•°å­—ç­¾åçš„äº§ç”Ÿæ­¥éª¤ï¼š<ul><li>åˆ©ç”¨æ‘˜è¦ç®—æ³• Hash ç®—å‡º M çš„æ‘˜è¦ï¼Œå³ Hash(M) == H</li><li>åˆ©ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•å¯¹æ‘˜è¦è¿›è¡ŒåŠ å¯† Encrypt( H, Piv )ï¼Œå¾—åˆ°æ•°å­—ç­¾å S</li></ul></li><li>æ•°å­—ç­¾åçš„æ ¡éªŒæ­¥éª¤ï¼š<ul><li>åˆ©ç”¨è§£å¯†ç®—æ³• D å¯¹æ•°å­—ç­¾åè¿›è¡Œè§£å¯†ï¼Œå³ Decrypt(S) == H</li><li>è®¡ç®— M1 çš„æ‘˜è¦ Hash(M1) == H1ï¼Œå¯¹æ¯” Hã€H1ï¼Œå¦‚æœä¸¤è€…ç›¸åŒï¼Œåˆ™é€šè¿‡æ ¡éªŒ</li></ul></li></ul></li></ul><p>ç§é’¥å¦‚ä½•ç”Ÿæˆä¸æ˜¯è¿™é‡Œçš„é‡ç‚¹ï¼Œè¿™é‡Œé‡‡ç”¨ç½‘ä¸Šçš„æœåŠ¡æ¥ç”Ÿæˆã€‚</p><p>äº†è§£äº†æ•°å­—ç­¾åäº§ç”Ÿã€æ ¡éªŒçš„åŸç†åï¼Œç›¸ä¿¡ä¸‹é¢çš„ä»£ç å¾ˆå®¹æ˜“ç†è§£ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> privateKey = fs.readFileSync(<span class="string">&#x27;./private-key.pem&#x27;</span>);  <span class="comment">// ç§é’¥</span></span><br><span class="line"><span class="keyword">const</span> publicKey = fs.readFileSync(<span class="string">&#x27;./public-key.pem&#x27;</span>);  <span class="comment">// å…¬é’¥</span></span><br><span class="line"><span class="keyword">const</span> algorithm = <span class="string">&#x27;RSA-SHA256&#x27;</span>;  <span class="comment">// åŠ å¯†ç®—æ³• vs æ‘˜è¦ç®—æ³•</span></span><br><span class="line"><span class="keyword">const</span> encoding = <span class="string">&#x27;hex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•°å­—ç­¾å</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sign</span>(<span class="params">text</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> sign = crypto.createSign(algorithm);</span><br><span class="line">    sign.update(text);</span><br><span class="line">    <span class="keyword">return</span> sign.sign(privateKey, encoding);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¡éªŒç­¾å</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">verify</span>(<span class="params">oriContent, signature</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> verifier = crypto.createVerify(algorithm);</span><br><span class="line">    verifier.update(oriContent);</span><br><span class="line">    <span class="keyword">return</span> verifier.verify(publicKey, signature, encoding);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹å†…å®¹è¿›è¡Œç­¾å</span></span><br><span class="line"><span class="keyword">const</span> content = <span class="string">&#x27;hello world&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> signature = sign(content);</span><br><span class="line"><span class="built_in">console</span>.log(signature);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¡éªŒç­¾åï¼Œå¦‚æœé€šè¿‡ï¼Œè¿”å›true</span></span><br><span class="line"><span class="keyword">const</span> verified = verify(content, signature);</span><br><span class="line"><span class="built_in">console</span>.log(verified);</span><br></pre></td></tr></table></figure><h2 id="DH-DiffieHellman">DH(DiffieHellman)</h2><blockquote><p>DiffieHellmanï¼šDiffieâ€“Hellman key exchangeï¼Œç¼©å†™ä¸º D-Hï¼Œæ˜¯ä¸€ç§å®‰å…¨åè®®ï¼Œå¸¸ç”¨äºå¯†é’¥äº¤æ¢ï¼Œè®©é€šä¿¡åŒæ–¹åœ¨é¢„å…ˆæ²¡æœ‰å¯¹æ–¹ä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ä¸å®‰å…¨é€šä¿¡ä¿¡é“ï¼Œåˆ›å»ºä¸€ä¸ªå¯†é’¥ã€‚è¿™ä¸ªå¯†é’¥å¯ä»¥åœ¨åç»­çš„é€šä¿¡ä¸­ï¼Œä½œä¸ºå¯¹ç§°åŠ å¯†çš„å¯†é’¥åŠ å¯†ä¼ é€’çš„ä¿¡æ¯ã€‚</p></blockquote><ul><li>åŸç†è§£æ</li></ul><p>å‡è®¾å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯æŒ‘é€‰ä¸¤ä¸ªç´ æ•° aã€pï¼ˆéƒ½å…¬å¼€ï¼‰ï¼Œç„¶å</p><ul><li><p>å®¢æˆ·ç«¯ï¼šé€‰æ‹©è‡ªç„¶æ•° Xaï¼ŒYa = a^Xa mod pï¼Œå¹¶å°† Ya å‘é€ç»™æœåŠ¡ç«¯ï¼›</p></li><li><p>æœåŠ¡ç«¯ï¼šé€‰æ‹©è‡ªç„¶æ•° Xbï¼ŒYb = a^Xb mod pï¼Œå¹¶å°† Yb å‘é€ç»™å®¢æˆ·ç«¯ï¼›</p></li><li><p>å®¢æˆ·ç«¯ï¼šè®¡ç®— Ka = Yb^Xa mod p</p></li><li><p>æœåŠ¡ç«¯ï¼šè®¡ç®— Kb = Ya^Xb mod p</p></li></ul><blockquote><p>Ka = Yb^Xa mod p</p><p>= (a^Xb mod p)^Xa mod p</p><p>= a^(Xb * Xa) mod p</p><p>= (a^Xa mod p)^Xb mod p</p><p>= Ya^Xb mod p</p><p>= Kb</p><p>å¯ä»¥çœ‹åˆ°ï¼Œå°½ç®¡å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯å½¼æ­¤ä¸çŸ¥é“å¯¹æ–¹çš„ Xaã€Xbï¼Œä½†ç®—å‡ºäº†ç›¸ç­‰çš„ secret</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> primeLength = <span class="number">1024</span>;  <span class="comment">// ç´ æ•°pçš„é•¿åº¦</span></span><br><span class="line"><span class="keyword">const</span> generator = <span class="number">5</span>;  <span class="comment">// ç´ æ•°a</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºå®¢æˆ·ç«¯çš„DHå®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> client = crypto.createDiffieHellman(primeLength, generator);</span><br><span class="line"><span class="comment">// äº§ç”Ÿå…¬ã€ç§é’¥å¯¹ï¼ŒYa = a^Xa mod p</span></span><br><span class="line"><span class="keyword">const</span> clientKey = client.generateKeys();</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºæœåŠ¡ç«¯çš„DHå®ä¾‹ï¼Œé‡‡ç”¨è·Ÿå®¢æˆ·ç«¯ç›¸åŒçš„ç´ æ•°aã€p</span></span><br><span class="line"><span class="keyword">const</span> server = crypto.createDiffieHellman(client.getPrime(), client.getGenerator());</span><br><span class="line"><span class="comment">// äº§ç”Ÿå…¬ã€ç§é’¥å¯¹ï¼ŒYb = a^Xb mod p</span></span><br><span class="line"><span class="keyword">const</span> serverKey = server.generateKeys();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¡ç®— Ka = Yb^Xa mod p</span></span><br><span class="line"><span class="keyword">const</span> clientSecret = client.computeSecret(server.getPublicKey());</span><br><span class="line"><span class="comment">// è®¡ç®— Kb = Ya^Xb mod p</span></span><br><span class="line"><span class="keyword">const</span> serverSecret = server.computeSecret(client.getPublicKey());</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”±äºç´ æ•°pæ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼Œæ‰€ä»¥æ¯æ¬¡æ‰“å°éƒ½ä¸ä¸€æ ·</span></span><br><span class="line"><span class="comment">// ä½†æ˜¯ clientSecret === serverSecret</span></span><br><span class="line"><span class="built_in">console</span>.log(clientSecret.toString(<span class="string">&#x27;hex&#x27;</span>));</span><br><span class="line"><span class="built_in">console</span>.log(serverSecret.toString(<span class="string">&#x27;hex&#x27;</span>));</span><br><span class="line"><span class="comment">// 39edfedad4f1be731977436936ca844e50ebc90953ad208c71d7f2dc1772409962ec3eb90eaf99db5948f089e1d4951f148bd7ff76c18b53ff6be32f267fc54535928ce4acf15d923cfd0caec45db95b206e7636128210ea6813a20fb09cbfb06214b2f488716fea32788023d98cb4cb7fe39b68bd3563b3b34257e37f6b7fb7</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 39edfedad4f1be731977436936ca844e50ebc90953ad208c71d7f2dc1772409962ec3eb90eaf99db5948f089e1d4951f148bd7ff76c18b53ff6be32f267fc54535928ce4acf15d923cfd0caec45db95b206e7636128210ea6813a20fb09cbfb06214b2f488716fea32788023d98cb4cb7fe39b68bd3563b3b34257e37f6b7fb7</span></span><br></pre></td></tr></table></figure><h2 id="ECDH-Elliptic-Curve-Diffie-Hellma">ECDH(Elliptic Curve Diffie-Hellma)</h2><blockquote><p>ECDH å’Œ DH åŸç†ç±»ä¼¼ï¼Œéƒ½æ˜¯å®‰å…¨å¯†é’¥åå•†åè®®ã€‚</p><p>ç›¸å¯¹äº DH åè®®ï¼Œç»“åˆæ¤­åœ†æ›²çº¿å¯†ç å­¦ ECC åŠ é€Ÿï¼Œè¿ç®—æ›´èŠ‚çœ CPU èµ„æº</p></blockquote><ul><li>ECDHï¼ˆ<strong>Elliptic Curve Diffie-Hellman</strong> ï¼‰åŸç†å¦‚ä¸‹</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202230722255.(null)" alt="img"></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> G = <span class="string">&#x27;secp521r1&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> encoding = <span class="string">&#x27;hex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = crypto.createECDH(G);</span><br><span class="line"><span class="keyword">const</span> serverKey = server.generateKeys();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> client = crypto.createECDH(G);</span><br><span class="line"><span class="keyword">const</span> clientKey = client.generateKeys();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> serverSecret = server.computeSecret(clientKey);</span><br><span class="line"><span class="keyword">const</span> clientSecret = client.computeSecret(serverKey);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(serverSecret.toString(encoding));</span><br><span class="line"><span class="built_in">console</span>.log(clientSecret.toString(encoding));</span><br><span class="line"><span class="comment">// 01c418be1b479f936397d4c1653ad77fa28fade67ff058dc18264a72bd1fc208ea6cac4dad996fda55bf271e84f0faef085173257b67bf21f95b09acee4d0a204517</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 01c418be1b479f936397d4c1653ad77fa28fade67ff058dc18264a72bd1fc208ea6cac4dad996fda55bf271e84f0faef085173257b67bf21f95b09acee4d0a204517</span></span><br></pre></td></tr></table></figure><h2 id="ECDHE-Elliptic-Curve-Diffie-Hellma-Ephemeral">ECDHE(Elliptic Curve Diffie-Hellma Ephemeral)</h2><blockquote><p>æ™®é€šçš„ ECDH ç®—æ³•ä¹Ÿå­˜åœ¨ä¸€å®šç¼ºé™·ï¼Œæ¯”å¦‚å¯†é’¥åå•†çš„æ—¶å€™æœ‰ä¸€æ–¹çš„ç§é’¥æ€»æ˜¯ä¸€æ ·çš„ï¼Œä¸€èˆ¬éƒ½æ˜¯ Server æ–¹å›ºå®šï¼ŒClient æ–¹ç§é’¥éšæœºç”Ÿæˆã€‚éšç€æ—¶é—´çš„å»¶é•¿ï¼Œé»‘å®¢å¯ä»¥æˆªè·åˆ°æµ·é‡çš„å¯†é’¥åå•†è¿‡ç¨‹ï¼ˆæœ‰äº›æ•°æ®æ˜¯å…¬å¼€çš„ï¼‰ï¼Œé»‘å®¢å°±å¯ä»¥ä¾æ®è¿™äº›æ•°æ®æš´åŠ›ç ´è§£å‡º Server çš„ç§é’¥ï¼Œç„¶åå°±å¯ä»¥è®¡ç®—å‡ºä¼šè¯å¯†é’¥äº†ï¼ŒåŠ å¯†çš„æ•°æ®ä¹Ÿä¼šéšä¹‹è¢«ç ´è§£ã€‚å›ºå®šä¸€æ–¹çš„ç§é’¥ä¼šæœ‰è¢«ç ´è§£çš„é£é™©ï¼Œé‚£ä¹ˆå°±è®©åŒæ–¹çš„ç§é’¥åœ¨æ¯æ¬¡å¯†é’¥äº¤æ¢é€šä¿¡æ—¶ï¼Œéƒ½æ˜¯éšæœºç”Ÿæˆçš„ã€ä¸´æ—¶çš„ï¼Œè¿™ä¸ªç®—æ³•å°±æ˜¯ ECDH çš„å¢å¼ºç‰ˆï¼šECDHEï¼Œ E å…¨ç§°æ˜¯ Ephemeralï¼ˆä¸´æ—¶æ€§çš„ï¼‰ã€‚</p></blockquote><h1>æ‰©å±•</h1><blockquote><p>å­¦ä¹ è¿™å—å„¿çŸ¥è¯†çš„åŒæ—¶ä¹Ÿå­¦ä¹ äº†å¾ˆå¤šå¯†ç å­¦ç›¸å…³çŸ¥è¯†ï¼Œå‘ç°è¶ŠæŒ–è¶Šæ·±å¿«é™·è¿›å»äº† ğŸ˜‚ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥ç»§ç»­å±•å¼€çœ‹çœ‹ç›¸å…³åŠ å¯†ç®—æ³•å’Œä»–ä»¬ä¹‹é—´çš„åŒºåˆ«ä»¥åŠåº”ç”¨åœºæ™¯ï¼Œä¾‹å¦‚ï¼š</p></blockquote><ul><li>éå¯¹ç§°åŠ å¯† DSAã€RSAã€DHã€DHEã€ECDHE</li><li>å¯¹ç§°åŠ å¯† AESã€DES</li></ul><blockquote><p><a href="https://mp.weixin.qq.com/s/U9SRLE7jZTB6lUZ6c8gTKg">RSA ç®—æ³•åŸç†ï¼ˆäºŒï¼‰ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a></p><p><a href="https://www.cnblogs.com/xiaolincoding/p/14318338.html">å›¾è§£ ECDHE å¯†é’¥äº¤æ¢ç®—æ³• - å°æ— coding</a></p><p>èµ„æ–™åŠ å¯†æ ‡å‡†(DES) - ç»´åŸºç™¾ç§‘](<a href="https://zh.wikipedia.org/wiki/%E8%B3%87%E6%96%99%E5%8A%A0%E5%AF%86%E6%A8%99%E6%BA%96">https://zh.wikipedia.org/wiki/è³‡æ–™åŠ å¯†æ¨™æº–</a>)</p><p><a href="https://zh.wikipedia.org/wiki/%E9%AB%98%E7%BA%A7%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86">é«˜çº§åŠ å¯†æ ‡å‡†(AES) - ç»´åŸºç™¾ç§‘</a></p></blockquote><h1><strong>ç›¸å…³æœ¯è¯­</strong></h1><p>SPKACï¼šSigned Public Key and Challenge</p><p>MD5ï¼šMessage-Digest Algorithm 5ï¼Œä¿¡æ¯-æ‘˜è¦ç®—æ³•ã€‚</p><p>SHAï¼šSecure Hash Algorithmï¼Œå®‰å…¨æ•£åˆ—ç®—æ³•ã€‚</p><p>HMACï¼šHash-based Message Authentication Codeï¼Œå¯†é’¥ç›¸å…³çš„å“ˆå¸Œè¿ç®—æ¶ˆæ¯è®¤è¯ç ã€‚</p><p>å¯¹ç§°åŠ å¯†ï¼šæ¯”å¦‚ AESã€DES</p><p>éå¯¹ç§°åŠ å¯†ï¼šæ¯”å¦‚ RSAã€DSA</p><p>AESï¼šAdvanced Encryption Standardï¼ˆé«˜çº§åŠ å¯†æ ‡å‡†ï¼‰ï¼Œå¯†é’¥é•¿åº¦å¯ä»¥æ˜¯ 128ã€192 å’Œ 256 ä½ã€‚</p><p>DESï¼šData Encryption Standardï¼Œæ•°æ®åŠ å¯†æ ‡å‡†ï¼Œå¯¹ç§°å¯†é’¥åŠ å¯†ç®—æ³•ï¼ˆç°åœ¨è®¤ä¸ºä¸å®‰å…¨ï¼‰ã€‚</p><p>DiffieHellmanï¼šDiffieâ€“Hellman key exchangeï¼Œç¼©å†™ä¸º D-Hï¼Œæ˜¯ä¸€ç§å®‰å…¨åè®®ï¼Œè®©é€šä¿¡åŒæ–¹åœ¨é¢„å…ˆæ²¡æœ‰å¯¹æ–¹ä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ä¸å®‰å…¨é€šä¿¡ä¿¡é“ï¼Œåˆ›å»ºä¸€ä¸ªå¯†é’¥ã€‚è¿™ä¸ªå¯†é’¥å¯ä»¥åœ¨åç»­çš„é€šä¿¡ä¸­ï¼Œä½œä¸ºå¯¹ç§°åŠ å¯†çš„å¯†é’¥åŠ å¯†ä¼ é€’çš„ä¿¡æ¯ã€‚ï¼ˆå¤‡æ³¨ï¼Œæ˜¯ä½¿ç”¨åè®®çš„å‘æ˜è€…å‘½åï¼‰</p><p><strong>å¯†é’¥äº¤æ¢ç®—æ³•</strong></p><p>å¸¸è§çš„å¯†é’¥äº¤æ¢ç®—æ³•æœ‰ RSAï¼ŒECDHEï¼ŒDHï¼ŒDHE ç­‰ç®—æ³•ã€‚å®ƒä»¬çš„ç‰¹æ€§å¦‚ä¸‹ï¼š</p><ul><li><p>RSAï¼šç®—æ³•å®ç°ç®€å•ï¼Œè¯ç”Ÿäº 1977 å¹´ï¼Œå†å²æ‚ ä¹…ï¼Œç»è¿‡äº†é•¿æ—¶é—´çš„ç ´è§£æµ‹è¯•ï¼Œå®‰å…¨æ€§é«˜ã€‚ç¼ºç‚¹å°±æ˜¯éœ€è¦æ¯”è¾ƒå¤§çš„ç´ æ•°ï¼ˆç›®å‰å¸¸ç”¨çš„æ˜¯ 2048 ä½ï¼‰æ¥ä¿è¯å®‰å…¨å¼ºåº¦ï¼Œå¾ˆæ¶ˆè€— CPU è¿ç®—èµ„æºã€‚RSA æ˜¯ç›®å‰å”¯ä¸€ä¸€ä¸ªæ—¢èƒ½ç”¨äºå¯†é’¥äº¤æ¢åˆèƒ½ç”¨äºè¯ä¹¦ç­¾åçš„ç®—æ³•ã€‚</p></li><li><p>DHï¼šdiffie-hellman å¯†é’¥äº¤æ¢ç®—æ³•ï¼Œè¯ç”Ÿæ—¶é—´æ¯”è¾ƒæ—©ï¼ˆ1977 å¹´ï¼‰ï¼Œä½†æ˜¯ 1999 å¹´æ‰å…¬å¼€ã€‚ç¼ºç‚¹æ˜¯æ¯”è¾ƒæ¶ˆè€— CPU æ€§èƒ½ã€‚</p></li><li><p>ECDHEï¼šä½¿ç”¨æ¤­åœ†æ›²çº¿ï¼ˆECCï¼‰çš„ DH ç®—æ³•ï¼Œä¼˜ç‚¹æ˜¯èƒ½ç”¨è¾ƒå°çš„ç´ æ•°ï¼ˆ256 ä½ï¼‰å®ç° RSA ç›¸åŒçš„å®‰å…¨ç­‰çº§ã€‚ç¼ºç‚¹æ˜¯ç®—æ³•å®ç°å¤æ‚ï¼Œç”¨äºå¯†é’¥äº¤æ¢çš„å†å²ä¸é•¿ï¼Œæ²¡æœ‰ç»è¿‡é•¿æ—¶é—´çš„å®‰å…¨æ”»å‡»æµ‹è¯•ã€‚</p></li><li><p>ECDHï¼šä¸æ”¯æŒ PFSï¼Œå®‰å…¨æ€§ä½ï¼ŒåŒæ—¶æ— æ³•å®ç° false startã€‚</p></li><li><p>DHEï¼šä¸æ”¯æŒ ECCã€‚éå¸¸æ¶ˆè€— CPU èµ„æº ã€‚</p></li></ul><p>å»ºè®®ä¼˜å…ˆæ”¯æŒ RSA å’Œ ECDH_RSA å¯†é’¥äº¤æ¢ç®—æ³•ã€‚åŸå› æ˜¯ï¼š</p><ul><li><p>ECDHE æ”¯æŒ ECC åŠ é€Ÿï¼Œè®¡ç®—é€Ÿåº¦æ›´å¿«ã€‚æ”¯æŒ PFSï¼Œæ›´åŠ å®‰å…¨ã€‚æ”¯æŒ false startï¼Œç”¨æˆ·è®¿é—®é€Ÿåº¦æ›´å¿«ã€‚</p></li><li><p>ç›®å‰è¿˜æœ‰è‡³å°‘ 20% ä»¥ä¸Šçš„å®¢æˆ·ç«¯ä¸æ”¯æŒ ECDHEï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ RSA è€Œä¸æ˜¯ DH æˆ–è€… DHEï¼Œå› ä¸º DH ç³»åˆ—ç®—æ³•éå¸¸æ¶ˆè€— CPUï¼ˆç›¸å½“äºè¦åšä¸¤æ¬¡ RSA è®¡ç®—ï¼‰ã€‚</p></li></ul><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;äº’è”ç½‘æ—¶ä»£ï¼Œç½‘ç»œä¸Šçš„æ•°æ®é‡æ¯å¤©éƒ½åœ¨ä»¥æƒŠäººçš„é€Ÿåº¦å¢é•¿ã€‚åŒæ—¶ï¼Œå„ç±»ç½‘ç»œå®‰å…¨é—®é¢˜å±‚å‡ºä¸ç©·ã€‚åœ¨ä¿¡æ¯å®‰å…¨é‡è¦æ€§æ—¥ç›Šå‡¸æ˜¾çš„ä»Šå¤©ï¼Œä½œä¸ºä¸€åå¼€å‘è€…ï¼Œéœ€è¦åŠ å¼ºå¯¹å®‰å…¨çš„è®¤è¯†ï¼Œå¹¶é€šè¿‡æŠ€æœ¯æ‰‹æ®µå¢å¼ºæœåŠ¡çš„å®‰å…¨æ€§ã€‚crypto æ¨¡å—çš„ç›®çš„æ˜¯ä¸ºäº†æä¾›é€šç”¨çš„åŠ å¯†å’Œå“ˆå¸Œç®—æ³•ã€‚ç”¨çº¯ </summary>
      
    
    
    
    <category term="Back End" scheme="https://lebronchao.com/categories/Back-End/"/>
    
    
    <category term="JavaScript" scheme="https://lebronchao.com/tags/JavaScript/"/>
    
    <category term="Node" scheme="https://lebronchao.com/tags/Node/"/>
    
    <category term="æœåŠ¡ç«¯" scheme="https://lebronchao.com/tags/%E6%9C%8D%E5%8A%A1%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>æ‘„å½± | å¹¿å·è¡Œ</title>
    <link href="https://lebronchao.com/2021/12/11/%E6%91%84%E5%BD%B1-%E5%B9%BF%E5%B7%9E%E8%A1%8C/"/>
    <id>https://lebronchao.com/2021/12/11/%E6%91%84%E5%BD%B1-%E5%B9%BF%E5%B7%9E%E8%A1%8C/</id>
    <published>2021-12-11T07:51:35.000Z</published>
    <updated>2021-12-11T07:51:35.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœºèº«ï¼šIPhone 13 Pro Max<br>é•œå¤´ï¼šIPhone 13 Pro Max<br>å‡ºé•œï¼šæ— <br>åœ°ç‚¹ï¼šå¹¿å·</p></blockquote><div class="justified-gallery"><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/IMG_9240.JPG" alt="IMG_9240"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/IMG_9244.JPG" alt="IMG_9244"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/IMG_9246.JPG" alt="IMG_9246"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/IMG_9257.JPG" alt="IMG_9257"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/IMG_9265.JPG" alt="IMG_9265"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/IMG_9271.JPG" alt="IMG_9271"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/IMG_9290.JPG" alt="IMG_9290"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/IMG_9296.JPG" alt="IMG_9296"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/IMG_9306.JPG" alt="IMG_9306"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/IMG_9300.JPG" alt="IMG_9300"></p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/IMG_9305.JPG" alt="IMG_9305"></p>          </div>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;æœºèº«ï¼šIPhone 13 Pro Max&lt;br&gt;
é•œå¤´ï¼šIPhone 13 Pro Max&lt;br&gt;
å‡ºé•œï¼šæ— &lt;br&gt;
åœ°ç‚¹ï¼šå¹¿å·&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;justified-gallery&quot;&gt;&lt;p&gt;&lt;img sr</summary>
      
    
    
    
    <category term="æ‘„å½±" scheme="https://lebronchao.com/categories/%E6%91%84%E5%BD%B1/"/>
    
    
    <category term="æ‘„å½±" scheme="https://lebronchao.com/tags/%E6%91%84%E5%BD%B1/"/>
    
    <category term="é£å…‰" scheme="https://lebronchao.com/tags/%E9%A3%8E%E5%85%89/"/>
    
    <category term="å¹¿å·" scheme="https://lebronchao.com/tags/%E5%B9%BF%E5%B7%9E/"/>
    
  </entry>
  
  <entry>
    <title>å¸¦ä½ é‡æ–°è®¤è¯†Node</title>
    <link href="https://lebronchao.com/2021/12/11/%E5%B8%A6%E4%BD%A0%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86Node/"/>
    <id>https://lebronchao.com/2021/12/11/%E5%B8%A6%E4%BD%A0%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86Node/</id>
    <published>2021-12-11T07:38:45.000Z</published>
    <updated>2021-12-11T07:38:45.000Z</updated>
    
    <content type="html"><![CDATA[<h1>æœ€åˆåš Node çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</h1><blockquote><p>Node ä½œè€… Ryan Dahlï¼š</p><p>åŸºäº V8 åˆ›å»ºä¸€ä¸ªè½»é‡çº§çš„é«˜æ€§èƒ½ Web æœåŠ¡å™¨å¹¶æä¾›ä¸€å¥—åº“</p></blockquote><h1>ä¸ºä»€ä¹ˆæ˜¯ JavaScriptï¼Ÿ</h1><blockquote><p>Ryan Dahl æ˜¯ä¸€åèµ„æ·±çš„ C/C++ç¨‹åºå‘˜ï¼Œåˆ›é€ å‡º Node ä¹‹å‰ä¸»è¦å·¥ä½œæ˜¯å›´ç»• Web é«˜æ€§èƒ½æœåŠ¡å™¨è¿›è¡Œçš„</p><p>ä»–å‘ç° Web é«˜æ€§èƒ½æœåŠ¡å™¨çš„ä¸¤ä¸ªè¦ç‚¹ï¼š</p></blockquote><ul><li>äº‹ä»¶é©±åŠ¨</li><li>éé˜»å¡ I / O</li></ul><p>Ryan Dahl ä¹Ÿæ›¾è¯„ä¼°è¿‡ä½¿ç”¨ Cã€Luaã€Haskellã€Ruby ç­‰è¯­è¨€ä½œä¸ºå¤‡é€‰å®ç°ï¼Œå¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š</p><ul><li>C çš„å¼€å‘é—¨æ§›é«˜ï¼Œå¯ä»¥é¢„è§ä¸ä¼šæœ‰å¤ªå¤šçš„å¼€å‘è€…èƒ½å°†å®ƒç”¨äºä¸šåŠ¡å¼€å‘</li><li>Ryan Dahl è§‰å¾—è‡ªå·±è¿˜ä¸è¶³å¤Ÿç©è½¬ Haskellï¼Œæ‰€ä»¥èˆå¼ƒå®ƒ</li><li>Lua è‡ªèº«å·²ç»å«æœ‰å¾ˆå¤šé˜»å¡ I / O åº“ï¼Œä¸ºå…¶æ„å»ºéé˜»å¡ I / O åº“ä¸èƒ½æ”¹å˜å¼€å‘è€…ä½¿ç”¨ä¹ æƒ¯</li><li>Ruby çš„è™šæ‹Ÿæœºæ€§èƒ½ä¸ä½³</li></ul><p>JavaScript çš„ä¼˜åŠ¿ï¼š</p><ul><li>å¼€å‘é—¨æ§›ä½</li><li>åœ¨åç«¯é¢†åŸŸæ²¡æœ‰å†å²åŒ…è¢±</li><li>ç¬¬äºŒæ¬¡æµè§ˆå™¨å¤§æˆ˜æ¸æ¸åˆ†å‡ºé«˜ä¸‹ï¼ŒChrome æµè§ˆå™¨çš„ JavaScript å¼•æ“ V8 æ‘˜å¾—æ€§èƒ½ç¬¬ä¸€çš„æ¡‚å† </li></ul><h1>Node ç»™ JavaScript å¸¦æ¥çš„æ„ä¹‰</h1><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225039105.(null)" alt="img"></p><blockquote><p>é™¤äº† HTMLã€Webkit å’Œæ˜¾å¡è¿™äº› UI ç›¸å…³æŠ€æœ¯æ²¡æœ‰æ”¯æŒå¤–ï¼ŒNode çš„ç»“æ„ä¸ Chrome ååˆ†ç›¸ä¼¼ã€‚ä»–ä»¬éƒ½æ˜¯åŸºäºäº‹ä»¶é©±åŠ¨çš„å¼‚æ­¥æ¶æ„ï¼š</p></blockquote><ul><li>æµè§ˆå™¨é€šè¿‡äº‹ä»¶é©±åŠ¨æ¥æœåŠ¡ç•Œé¢ä¸Šçš„äº¤äº’</li><li>Node é€šè¿‡äº‹ä»¶é©±åŠ¨æ¥æœåŠ¡ I / O</li></ul><blockquote><p>åœ¨ Node ä¸­ï¼ŒJavaScript è¿˜è¢«èµ‹äºˆäº†æ–°çš„èƒ½åŠ›ï¼š</p></blockquote><ul><li>éšå¿ƒæ‰€æ¬²åœ°è®¿é—®æœ¬åœ°æ–‡ä»¶</li><li>æ­å»º WebSocket æœåŠ¡ç«¯</li><li>è¿æ¥æ•°æ®åº“ï¼Œè¿›è¡Œä¸šåŠ¡ç ”å‘</li><li>åƒ Web Worker ä¸€æ ·ç©è½¬å¤šè¿›ç¨‹</li></ul><blockquote><p>Node ä½¿ JavaScript å¯ä»¥è¿è¡Œåœ¨ä¸åŒçš„åœ°æ–¹ï¼Œä¸å†é™åˆ¶åœ¨æµè§ˆå™¨ä¸­ã€DOM æ ‘æ‰“äº¤é“ã€‚å¦‚æœ HTTP åè®®æ˜¯æ°´å¹³é¢ï¼ŒNode å°±æ˜¯æµè§ˆå™¨åœ¨åè®®æ ˆå¦ä¸€è¾¹çš„å€’å½±ã€‚</p><p>Node ä¸å¤„ç† UIï¼Œä½†ç”¨ä¸æµè§ˆå™¨ç›¸åŒçš„æœºåˆ¶å’ŒåŸç†è¿è¡Œï¼Œæ‰“ç ´äº† JavaScript åªèƒ½åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„å±€é¢ã€‚å‰åç«¯ç¼–ç¨‹ç¯å¢ƒç»Ÿä¸€ï¼Œå¯ä»¥å¤§å¤§é™ä½å‰åç«¯è½¬æ¢æ‰€éœ€è¦çš„ä¸Šä¸‹æ–‡ä»£ä»·ã€‚</p></blockquote><h1>Node çš„ç‰¹ç‚¹</h1><h2 id="å¼‚æ­¥-I-O">å¼‚æ­¥ I / O</h2><ul><li>ä»¥è¯»å–æ–‡ä»¶ä¸ºä¾‹</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225046783.(null)" alt="img"></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">&#x27;/path&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, file</span>) </span>&#123;</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">&#x27;è¯»å–æ–‡ä»¶å®Œæˆ&#x27;</span>)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;å‘èµ·è¯»å–æ–‡ä»¶&#x27;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>ç†Ÿæ‚‰çš„ç”¨æˆ·å¿…çŸ¥é“ï¼Œâ€œè¯»å–æ–‡ä»¶å®Œæˆâ€æ˜¯åœ¨â€œå‘èµ·è¯»å–æ–‡ä»¶â€ä¹‹åè¾“å‡ºçš„</p><p>fs.readFile åçš„ä»£ç æ˜¯è¢«ç«‹å³æ‰§è¡Œçš„ï¼Œè€Œâ€œè¯»å–æ–‡ä»¶å®Œæˆâ€çš„æ‰§è¡Œæ—¶é—´æ˜¯ä¸è¢«é¢„æœŸçš„</p><p>åªçŸ¥é“å®ƒå°†åœ¨è¿™ä¸ªå¼‚æ­¥æ“ä½œåæ‰§è¡Œï¼Œä½†å¹¶ä¸çŸ¥é“å…·ä½“çš„æ—¶é—´ç‚¹</p><p>å¼‚æ­¥è°ƒç”¨ä¸­å¯¹äºç»“æœå€¼çš„æ•è·æ˜¯ç¬¦åˆâ€œDonâ€™t call me, I will call youâ€åŸåˆ™çš„</p><p>è¿™ä¹Ÿæ˜¯æ³¨é‡ç»“æœï¼Œä¸å…³å¿ƒè¿‡ç¨‹çš„ä¸€ç§è¡¨ç°</p></blockquote><p>Node ä¸­ï¼Œç»å¤§å¤šæ•°æ“ä½œéƒ½ä»¥å¼‚æ­¥çš„æ–¹å¼è¿›è¡Œè°ƒç”¨ï¼ŒRyan Dahl æ’é™¤ä¸‡éš¾ï¼Œåœ¨åº•å±‚æ„å»ºäº†å¾ˆå¤šå¼‚æ­¥ I / O çš„ APIï¼Œä»æ–‡ä»¶è¯»å–åˆ°ç½‘ç»œè¯·æ±‚ç­‰ã€‚ä½¿å¼€å‘è€…å¾ˆå·²ä»è¯­è¨€å±‚é¢å¾ˆè‡ªç„¶åœ°è¿›è¡Œå¹¶è¡Œ I / O æ“ä½œï¼Œåœ¨æ¯ä¸ªè°ƒç”¨ä¹‹é—´æ— éœ€ç­‰å¾…ä¹‹å‰çš„ I / O è°ƒç”¨ç»“æŸï¼Œåœ¨ç¼–ç¨‹æ¨¡å‹ä¸Šå¯ä»¥æå¤§æå‡æ•ˆç‡</p><blockquote><p><strong>æ³¨ï¼šå¼‚æ­¥ I / O æœºåˆ¶å°†åœ¨ä¸‹æ–‡ä¸­è¯¦ç»†é˜è¿°</strong></p></blockquote><h2 id="äº‹ä»¶ä¸å›è°ƒå‡½æ•°">äº‹ä»¶ä¸å›è°ƒå‡½æ•°</h2><p><strong>äº‹ä»¶</strong></p><p>éšç€ Web2.0 çš„åˆ°æ¥ï¼ŒJavaScript åœ¨å‰ç«¯æ‹…ä»»äº†æ›´å¤šçš„èŒè´£ï¼Œæ—¶é—´ä¹Ÿå¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ã€‚å°†å‰ç«¯æµè§ˆå™¨ä¸­å¹¿æ³›åº”ç”¨ä¸”æˆç†Ÿçš„äº‹ä»¶ä¸å›åˆ°å‡½æ•°å¼•å…¥åç«¯ï¼Œé…åˆå¼‚æ­¥ I / O ï¼Œå¯ä»¥å¾ˆå¥½åœ°å°†äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´ç‚¹æš´éœ²ç»™ä¸šåŠ¡é€»è¾‘ã€‚</p><ul><li>æœåŠ¡ç«¯ä¾‹å­</li></ul><blockquote><p>å¯¹äºæœåŠ¡å™¨ç»‘å®šäº† request äº‹ä»¶</p></blockquote><blockquote><p>å¯¹äºè¯·æ±‚å¯¹è±¡ï¼Œç»‘å®šäº† data å’Œ end äº‹ä»¶</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> querystring = <span class="built_in">require</span>(<span class="string">&#x27;querystring&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¾¦å¬æœåŠ¡å™¨çš„requestäº‹ä»¶</span></span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line"> <span class="keyword">var</span> postData = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"> req.setEncoding(<span class="string">&#x27;utf8&#x27;</span>);</span><br><span class="line"> <span class="comment">// ä¾¦å¬è¯·æ±‚çš„dataäº‹ä»¶</span></span><br><span class="line"> req.on(<span class="string">&#x27;data&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">trunk</span>) </span>&#123;</span><br><span class="line"> postData += trunk;</span><br><span class="line"> &#125;);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// ä¾¦å¬è¯·æ±‚çš„endäº‹ä»¶</span></span><br><span class="line"> req.on(<span class="string">&#x27;end&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"> res.end(postData);</span><br><span class="line"> &#125;);</span><br><span class="line">&#125;).listen(<span class="number">8080</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;æœåŠ¡å™¨å¯åŠ¨å®Œæˆ&#x27;</span>);</span><br></pre></td></tr></table></figure><ul><li>å‰ç«¯ä¾‹å­</li></ul><blockquote><p>å‘å‡ºè¯·æ±‚åï¼Œåªéœ€å…³å¿ƒè¯·æ±‚æˆåŠŸæ—¶æ‰§è¡Œç›¸åº”çš„ä¸šåŠ¡é€»è¾‘å³å¯</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">request(&#123;</span><br><span class="line"> url: <span class="string">&#x27;/url&#x27;</span>,</span><br><span class="line"> method: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line"> data: &#123;&#125;,</span><br><span class="line"> success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line"> <span class="comment">// successäº‹ä»¶</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>äº‹ä»¶çš„ç¼–ç¨‹æ–¹å¼å…·æœ‰è½»é‡çº§ã€æ¾è€¦åˆã€åªå…³æ³¨äº‹åŠ¡ç‚¹ç­‰ä¼˜åŠ¿ï¼Œä½†æ˜¯åœ¨å¤šä¸ªå¼‚æ­¥ä»»åŠ¡çš„åœºæ™¯ä¸‹ï¼Œäº‹ä»¶ä¸äº‹ä»¶ä¹‹é—´å„è‡ªç‹¬ç«‹ï¼Œå¦‚ä½•åä½œæ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œåç»­ä¹Ÿå‡ºç°äº†ä¸€ç³»åˆ—å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆ:</p></blockquote><ul><li>äº‹ä»¶å‘å¸ƒ/è®¢é˜…æ¨¡å¼</li><li>Promiseã€async / await</li><li>æµç¨‹æ§åˆ¶åº“</li></ul><p><strong>å›è°ƒå‡½æ•°</strong></p><ul><li>Node é™¤äº†å¼‚æ­¥å’Œäº‹ä»¶å¤–ï¼Œå›è°ƒå‡½æ•°ä¹Ÿæ˜¯ä¸€å¤§ç‰¹è‰²</li><li>çºµè§‚ä¸‹æ¥ï¼Œå›è°ƒå‡½æ•°ä¹Ÿæ˜¯æœ€å¥½çš„æ¥æ”¶å¼‚æ­¥è°ƒç”¨è¿”å›æ•°æ®çš„æ–¹å¼<ul><li>ä½†æ˜¯è¿™ç§ç¼–ç¨‹æ–¹å¼å¯¹äºå¾ˆå¤šä¹ æƒ¯åŒæ­¥æ€è·¯ç¼–ç¨‹çš„äººæ¥è¯´ï¼Œä¹Ÿè®¸æ˜¯ååˆ†ä¸ä¹ æƒ¯çš„</li><li>ä»£ç çš„ç¼–å†™é¡ºåºä¸æ‰§è¡Œé¡ºåºå¹¶æ— å…³ç³»ï¼Œè¿™å¯¹ä»–ä»¬å¯èƒ½é€ æˆé˜…è¯»ä¸Šçš„éšœç¢</li></ul></li><li>åœ¨æµç¨‹æ§åˆ¶æ–¹é¢ï¼Œå› ä¸ºç©¿æ’äº†å¼‚æ­¥æ–¹æ³•å’Œå›è°ƒå‡½æ•°ï¼Œä¸å¸¸è§„çš„åŒæ­¥æ–¹å¼ç›¸æ¯”å˜å¾—ä¸é‚£ä¹ˆä¸€ç›®äº†ç„¶äº†<ul><li>è½¬å˜ä¸ºå¼‚æ­¥ç¼–ç¨‹æ€ç»´åï¼Œé€šè¿‡å¯¹ä¸šåŠ¡çš„åˆ’åˆ†å’Œå¯¹äº‹ä»¶çš„æç‚¼ï¼Œåœ¨æµç¨‹æ§åˆ¶æ–¹é¢å¤„ç†ä¸šåŠ¡çš„å¤æ‚åº¦æ˜¯ä¸åŒæ­¥æ–¹å¼å®é™…ä¸Šæ˜¯ä¸€è‡´çš„</li></ul></li></ul><h2 id="å•çº¿ç¨‹">å•çº¿ç¨‹</h2><blockquote><p>Node ä¿æŒäº† JavaScript åœ¨æµè§ˆå™¨ä¸­å•çº¿ç¨‹çš„ç‰¹ç‚¹</p><p>JavaScript ä¸å…¶ä»–çº¿ç¨‹æ˜¯æ— æ³•å…±äº«ä»»ä½•çŠ¶æ€çš„ï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯ä¸ç”¨åƒå¤šçº¿ç¨‹ç¼–ç¨‹é‚£æ ·å¤„å¤„åœ¨æ„çŠ¶æ€çš„åŒæ­¥é—®é¢˜ï¼Œè¿™é‡Œæ²¡æœ‰æ­»é”çš„å­˜åœ¨ï¼Œä¹Ÿæ²¡æœ‰çº¿ç¨‹ä¸Šä¸‹æ–‡äº¤æ¢æ‰€å¸¦æ¥çš„æ€§èƒ½ä¸Šçš„å¼€é”€</p></blockquote><ul><li>å•çº¿ç¨‹çš„ç¼ºç‚¹<ul><li>æ— æ³•åˆ©ç”¨å¤šæ ¸ CPU</li><li>é”™è¯¯ä¼šå¼•èµ·æ•´ä¸ªåº”ç”¨é€€å‡ºï¼Œå¥å£®æ€§è¾ƒå·®</li><li>å¤§é‡è®¡ç®—å ç”¨ CPU å¯¼è‡´æ— æ³•ç»§ç»­è°ƒç”¨å¼‚æ­¥ I / O</li></ul></li><li>åç»­ä¹Ÿæ¨å‡ºäº† child_process å’Œ cluster æ¨¡å—è¾ƒå¥½åœ°ç¼“è§£äº†ä»¥ä¸Šç¼ºç‚¹</li></ul><h2 id="è·¨å¹³å°">è·¨å¹³å°</h2><blockquote><p>èµ·åˆ Node åªèƒ½åœ¨ Linux å¹³å°ä¸Šè¿è¡Œï¼Œå¦‚æœæƒ³åœ¨ Windows å¹³å°ä¸Šå­¦ä¹ å’Œä½¿ç”¨ Nodeï¼Œåˆ™å¿…é¡»é€šè¿‡ Cygwin / MinGWï¼Œåå¾®è½¯æŠ•å…¥é€šè¿‡åŸºäº libuv å®ç°è·¨å¹³å°æ¶æ„</p></blockquote><ul><li>libuv</li></ul><blockquote><p>åœ¨æ“ä½œç³»ç»Ÿä¸ Node ä¸Šå±‚æ¨¡å—ç³»ç»Ÿä¹‹é—´æ„å»ºäº†ä¸€å±‚å¹³å°æ¶æ„</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225633500.(null)" alt="img"></p><blockquote><p>é€šè¿‡è‰¯å¥½çš„æ¶æ„ï¼ŒNode çš„ç¬¬ä¸‰æ–¹ C++æ¨¡å—ä¹Ÿå¯ä»¥å€ŸåŠ© libuv å®ç°è·¨å¹³å°</p></blockquote><h1>Node æ¨¡å—æœºåˆ¶ - CommonJS</h1><blockquote><p>èƒŒæ™¯ï¼š</p><p>åœ¨å…¶ä»–é«˜çº§è¯­è¨€ä¸­ï¼ŒJava æœ‰ç±»æ–‡ä»¶ï¼ŒPython æœ‰ import æœºåˆ¶ï¼ŒRuby æœ‰ requireï¼ŒPHP æœ‰ include å’Œ requireã€‚è€Œ JavaScript é€šè¿‡ script æ ‡ç­¾å¼•å…¥ä»£ç çš„æ–¹å¼æ˜¾å¾—æ‚ä¹±æ— ç« ï¼Œã€‚äººä»¬ä¸å¾—ä¸ç”¨å‘½åç©ºé—´ç­‰æ–¹å¼äººä¸ºåœ°çº¦æŸä»£ç ï¼Œä»¥è¾¾åˆ°å®‰å…¨å’Œæ˜“ç”¨çš„ç›®çš„ã€‚</p><p>ç›´åˆ°åæ¥å‡ºç°äº† CommonJSâ€¦</p></blockquote><h2 id="æ„¿æ™¯">æ„¿æ™¯</h2><blockquote><p>å¸Œæœ› JavaScript èƒ½æ¬§åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œ</p></blockquote><h2 id="å‡ºå‘ç‚¹">å‡ºå‘ç‚¹</h2><p>å¯¹äº JavaScript è‡ªèº«è€Œè¨€ï¼Œå®ƒçš„è§„èŒƒä¾ç„¶æ˜¯è–„å¼±çš„ï¼Œè¿˜æœ‰ä»¥ä¸‹ç¼ºé™·ï¼š</p><ul><li>æ²¡æœ‰æ¨¡å—ç³»ç»Ÿ</li><li>æ ‡å‡†åº“è¾ƒå°‘<ul><li>ECMAScript ä»…å®šä¹‰äº†éƒ¨åˆ†æ ¸å¿ƒåº“</li><li>å¯¹äºæ–‡ä»¶ç³»ç»Ÿ I / O æµç­‰å¸¸è§éœ€æ±‚æ²¡æœ‰æ ‡å‡† API</li></ul></li><li>æ²¡æœ‰æ ‡å‡†æ¥å£<ul><li>åœ¨ JavaScript ä¸­ï¼Œå‡ ä¹æ²¡æœ‰å®šä¹‰è¿‡å¦‚ Web æœåŠ¡å™¨æˆ–è€…æ•°æ®åº“ä¹‹ç±»çš„æ ‡å‡†ç»Ÿä¸€æ¥å£</li></ul></li><li>ç¼ºä¹åŒ…ç®¡ç†ç³»ç»Ÿ<ul><li>å¯¼è‡´ JavaScript åº”ç”¨ä¸­åŸºæœ¬æ²¡æœ‰è‡ªåŠ¨åŠ è½½å’Œå®‰è£…ä»¥æ¥çš„èƒ½åŠ›</li></ul></li></ul><p>CommonJS çš„æå‡ºï¼Œä¸»è¦æ˜¯ä¸ºäº†å¼¥è¡¥å½“å‰ JavaScript æ²¡æœ‰æ ‡å‡†çš„ç¼ºé™·ï¼Œä»¥è¾¾åˆ°åƒ Pythonã€Ruby å’Œ Java å…·å¤‡å¼€å‘å¤§å‹åº”ç”¨çš„åŸºç¡€èƒ½åŠ›ï¼Œè€Œä¸æ˜¯åœç•™åœ¨å°è„šæœ¬ç¨‹åºçš„é˜¶æ®µï¼Œå¸Œæœ›å¯ä»¥åˆ©ç”¨ JavaScript å¼€å‘ï¼š</p><ul><li>æœåŠ¡ç«¯ JavaScript ç¨‹åº</li><li>å‘½ä»¤è¡Œå·¥å…·</li><li>æ¡Œé¢å›¾å½¢ç•Œé¢åº”ç”¨ç¨‹åº</li><li>æ··åˆåº”ç”¨</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225637966.(null)" alt="img"></p><p>CommonJS è§„èŒƒæ¶µç›–äº†ï¼š</p><ul><li>æ¨¡å—</li><li>äºŒè¿›åˆ¶</li><li>Buffer</li><li>å­—ç¬¦é›†ç¼–ç </li><li>I / O æµ</li><li>è¿›ç¨‹ç¯å¢ƒ</li><li>æ–‡ä»¶ç³»ç»Ÿ</li><li>å¥—æ¥å­—</li><li>å•å…ƒæµ‹è¯•</li><li>Web æœåŠ¡å™¨ç½‘å…³æ¥å£</li><li>åŒ…ç®¡ç†</li></ul><blockquote><p>Node ä¸æµè§ˆå™¨ä»¥åŠ W3C ç»„ç»‡ã€CommonJS ç»„ç»‡ã€ECMAScript ä¹‹é—´çš„å…³ç³»ï¼Œå…±åŒæ„æˆäº†ä¸€ä¸ªç¹è£çš„ç”Ÿæ€ç³»ç»Ÿ</p></blockquote><h2 id="æ¨¡å—è§„èŒƒ">æ¨¡å—è§„èŒƒ</h2><ul><li>æ¨¡å—å®šä¹‰</li></ul><blockquote><p>ä¸Šä¸‹æ–‡æä¾›äº† exports å¯¹è±¡ç”¨äºå¯¼å‡ºå½“å‰æ¨¡å—çš„æ–¹æ³•æˆ–è€…å˜é‡ï¼Œå¹¶ä¸”å®ƒæ˜¯å¯¼å‡ºçš„å”¯ä¸€å‡ºå£</p><p>åœ¨æ¨¡å—ä¸­ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ª module å¯¹è±¡ï¼Œå®ƒä»£è¡¨æ¨¡å—è‡ªèº«ï¼Œè€Œ exports æ˜¯ module çš„å±æ€§</p><p>åœ¨ Node ä¸­ï¼Œä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œå°†æ–¹æ³•æŒ‚è½½åœ¨ exports å¯¹è±¡ä¸Šä½œä¸ºå±æ€§å³å¯å®šä¹‰å¯¼å‡ºçš„æ–¹å¼</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// math.js</span></span><br><span class="line"><span class="built_in">exports</span>.add = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ¨¡å—å¼•ç”¨</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> math = <span class="built_in">require</span>(<span class="string">&#x27;./math&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> res = math.add(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line"><span class="built_in">console</span>.log(res);</span><br><span class="line"><span class="comment">// 2</span></span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ CommonJS è§„èŒƒä¸­ï¼Œå­˜åœ¨ require æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ¥å—æ¨¡å—æ ‡è¯†ï¼Œä»¥æ­¤å¼•å…¥ä¸€ä¸ªæ¨¡å—çš„ API åˆ°å½“å‰ä¸Šä¸‹æ–‡ä¸­</p></blockquote><ul><li>æ¨¡å—æ ‡è¯†</li></ul><p>æ¨¡å—æ ‡è¯†å°±æ˜¯ä¼ é€’ç»™ require æ–¹æ³•çš„å‚æ•°ï¼Œå¯ä»¥æ˜¯ï¼š</p><ul><li>å¦‚ä½•å°é©¼å³°å‘½åçš„å­—ç¬¦ä¸²</li><li>ä»¥./ ã€â€¦/ å¼€å¤´çš„ç›¸å¯¹è·¯å¾„ or ç»å¯¹è·¯å¾„</li><li>å¯ä»¥æ²¡æœ‰æ–‡ä»¶ååç¼€.js</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225641404.(null)" alt="img"></p><blockquote><p>æ¨¡å—çš„å®šä¹‰ååˆ†ç®€å•ï¼Œæ¥å£ä¹Ÿååˆ†ç®€æ´</p></blockquote><blockquote><p>æ¯ä¸ªæ¨¡å—å…·æœ‰ç‹¬ç«‹çš„ç©ºé—´ï¼Œå®ƒä»¬äº’ä¸å¹²æ‰°ï¼Œåœ¨å¼•ç”¨æ—¶ä¹Ÿæ˜¾å¾—å¹²å‡€åˆ©è½</p></blockquote><ul><li>æ„ä¹‰ï¼š</li></ul><blockquote><p>å°†ç±»èšçš„æ–¹æ³•å’Œå˜é‡ç­‰é™å®šåœ¨ç§æœ‰çš„ä½œç”¨åŸŸä¸­ï¼ŒåŒæ—¶æ”¯æŒå¼•å…¥å’Œå¯¼å‡ºåŠŸèƒ½ä»¥é¡ºç•…åœ°è¿æ¥ä¸Šä¸‹æ¸¸ä¾èµ–</p></blockquote><h2 id="æ¨¡å—å®ç°">æ¨¡å—å®ç°</h2><blockquote><p>åœ¨ Node å¼•å…¥æ¨¡å—ï¼Œéœ€è¦ç»å†ä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤</p></blockquote><ul><li>è·¯å¾„åˆ†æ</li><li>æ–‡ä»¶å®šä½</li><li>ç¼–è¯‘æ‰§è¡Œ</li></ul><p>Node ä¸­æ¨¡å—åˆ†ä¸ºä¸¤ç±»ï¼š</p><ul><li>æ ¸å¿ƒæ¨¡å—</li></ul><blockquote><p>ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œç¼–è¯‘è¿›äº†äºŒè¿›åˆ¶æ‰§è¡Œæ–‡ä»¶</p><p>åœ¨ Node è¿›ç¨‹å¯åŠ¨æ—¶ï¼Œéƒ¨åˆ†æ ¸å¿ƒæ¨¡å—å°±ç›´æ¥è¢«åŠ è½½è¿›å†…å­˜ä¸­ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†æ ¸å¿ƒæ¨¡å—å¼•å…¥æ—¶ï¼Œæ–‡ä»¶å®šä½å’Œç¼–è¯‘æ‰§è¡Œè¿™ä¸¤ä¸ªæ­¥éª¤å¯ä»¥çœç•¥ï¼Œå¹¶ä¸”åœ¨è·¯å¾„åˆ†æä¸­ä¼˜å…ˆåˆ¤æ–­ï¼Œæ‰€ä»¥å®ƒçš„åŠ è½½é€Ÿåº¦æ˜¯æœ€å¿«çš„ã€‚</p></blockquote><ul><li>ç”¨æˆ·ç¼–å†™çš„æ–‡ä»¶æ¨¡å—</li></ul><blockquote><p>è¿è¡Œæ—¶åŠ¨æ€åŠ è½½ï¼Œéœ€è¦å®Œæ•´çš„è·¯å¾„åˆ†æã€æ–‡ä»¶å®šä½ã€ç¼–è¯‘æ‰§è¡Œè¿‡ç¨‹ï¼Œé€Ÿåº¦æ¯”æ ¸å¿ƒæ¨¡å—æ…¢</p></blockquote><h3 id="ä¼˜å…ˆä»ç¼“å­˜åŠ è½½">ä¼˜å…ˆä»ç¼“å­˜åŠ è½½</h3><blockquote><p>ä¸æµè§ˆå™¨ä¼šç¼“å­˜é™æ€è„šæœ¬æ–‡ä»¶ä»¥æé«˜æ€§èƒ½ä¸€æ ·ï¼ŒNode å¯¹å¼•å…¥è¿‡çš„æ¨¡å—éƒ½ä¼šè¿›è¡ŒäºŒæ¬¡ç¼“å­˜ï¼Œä»¥å‡å°‘äºŒæ¬¡å¼•å…¥æ—¶çš„å¼€é”€ã€‚ä¸åŒç‚¹åœ¨äº:</p></blockquote><ul><li>æµè§ˆå™¨ä»…ç¼“å­˜æ–‡ä»¶</li><li>Node ç¼“å­˜çš„æ˜¯ç¼–è¯‘å’Œæ‰§è¡Œä¹‹åçš„å¯¹è±¡</li></ul><blockquote><p>æ— è®ºæ ¸å¿ƒæ¨¡å—è¿˜æ˜¯æ–‡ä»¶æ¨¡å—ï¼Œrequire æ–¹æ³•å¯¹ç›¸åŒæ¨¡å—çš„äºŒæ¬¡åŠ è½½éƒ½ä¸€å¾‹é‡‡ç”¨ç¼“å­˜ä¼˜å…ˆçš„æ–¹å¼</p></blockquote><h3 id="è·¯å¾„åˆ†æå’Œæ–‡ä»¶å®šä½">è·¯å¾„åˆ†æå’Œæ–‡ä»¶å®šä½</h3><p><strong>æ ‡è¯†ç¬¦åˆ†æï¼ˆè·¯å¾„ï¼‰</strong></p><p>å‰é¢è¯´åˆ°è¿‡ï¼Œrequire æ–¹æ³•æ¥å—ä¸€ä¸ªå‚æ•°ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œåˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š</p><ul><li>æ ¸å¿ƒæ¨¡å—</li></ul><blockquote><p>ä¼˜å…ˆçº§ä»…æ¬¡äºç¼“å­˜åŠ è½½ï¼Œåœ¨ Node çš„æºä»£ç ç¼–è¯‘è¿‡ç¨‹ä¸­å·²ç¼–è¯‘ä¸ºäºŒè¿›åˆ¶ä»£ç ï¼ŒåŠ è½½è¿‡ç¨‹æœ€å¿«</p><p><strong>æ³¨ï¼šåŠ è½½ä¸€ä¸ªä¸æ ¸å¿ƒæ¨¡å—æ ‡è¯†ç¬¦ç›¸åŒçš„è‡ªå®šä¹‰æ¨¡å—æ˜¯ä¸ä¼šæˆåŠŸçš„ï¼Œåªèƒ½é€šè¿‡é€‰æ‹©ä¸åŒçš„æ ‡è¯†ç¬¦ / æ¢ç”¨è·¯å¾„çš„æ–¹å¼å®ç°</strong></p></blockquote><ul><li>è·¯å¾„å½¢å¼çš„æ–‡ä»¶æ¨¡å—</li></ul><blockquote><p>ä»¥ ./ ã€â€¦/ å¼€å¤´çš„æ ‡è¯†ç¬¦éƒ½è¢«å½“åšæ–‡ä»¶æ¨¡å—å¤„ç†</p><p>require æ–¹æ³•ä¼šå°†è·¯å¾„è½¬ä¸ºçœŸå®è·¯å¾„ï¼Œå¹¶ä»¥çœŸå®è·¯å¾„ä¸ºç´¢å¼•ï¼Œå°†ç¼–è¯‘æ‰§è¡Œåçš„ç»“æœå­˜æ”¾åˆ°ç¼“å­˜ä¸­ï¼Œä»¥ä½¿äºŒæ¬¡åŠ è½½æ›´å¿«</p><p>æ–‡ä»¶æ¨¡å—ç»™ Node æŒ‡æ˜äº†ç¡®åˆ‡çš„æ–‡ä»¶ä½ç½®ï¼Œæ‰€ä»¥åœ¨æŸ¥æ‰¾è¿‡ç¨‹ä¸­å¯ä»¥èŠ‚çº¦å¤§é‡æ—¶é—´ï¼Œå…¶åŠ è½½é€Ÿåº¦ä»…æ…¢äºæ ¸å¿ƒæ¨¡å—</p></blockquote><ul><li>è‡ªå®šä¹‰æ¨¡å—</li></ul><blockquote><p>æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶æ¨¡å—ï¼Œæ˜¯ä¸€ä¸ªæ–‡ä»¶æˆ–è€…åŒ…çš„å½¢å¼</p><p>è¿™ç±»æ¨¡å—çš„æŸ¥æ‰¾æ˜¯æœ€è´¹æ—¶çš„ï¼Œä¹Ÿæ˜¯æœ€æ…¢çš„ä¸€ç§</p></blockquote><p>å…ˆä»‹ç»ä¸€ä¸‹æ¨¡å—è·¯å¾„è¿™ä¸ªæ¦‚å¿µï¼Œä¹Ÿæ˜¯å®šä½æ–‡ä»¶æ¨¡å—æ—¶åˆ¶å®šçš„æŸ¥æ‰¾ç­–ç•¥ï¼Œå…·ä½“è¡¨ç°ä¸ºä¸€ä¸ªè·¯å¾„ç»„æˆçš„æ•°ç»„</p><ul><li><code>console.log(module.path)</code></li><li>ä½ å¯ä»¥å¾—åˆ°ä¸€ä¸ªè·¯å¾„æ•°ç»„</li></ul><p>[â€˜/home/bytedance/reasearch/node_modulesâ€™,</p><p>â€˜/home/bytedance/node_modulesâ€™,</p><p>â€˜home/node_moduleâ€™, /node_modulesâ€™]</p><p>å¯ä»¥çœ‹å‡ºè§„åˆ™å¦‚ä¸‹ï¼š</p><ul><li>å½“å‰æ–‡ä»¶ç›®å½•ä¸‹çš„ node_modules ç›®å½•</li><li>çˆ¶ç›®å½•ä¸‹çš„ node_modules ç›®å½•</li><li>çˆ¶ç›®å½•çš„çˆ¶ç›®å½•ä¸‹çš„ node_modules ç›®å½•</li><li>æ²¿è·¯å¾„å‘ä¸Šé€çº§é€’å½’ï¼Œç›´åˆ°æ ¹ç›®å½•ä¸‹çš„ node_modules ç›®å½•</li></ul><blockquote><p>å®ƒçš„ç”Ÿæˆæ–¹å¼ä¸ JavaScript åŸå‹é“¾ / ä½œç”¨åŸŸé“¾çš„æŸ¥æ‰¾æ–¹å¼ååˆ†ç±»ä¼¼</p><p>åœ¨åŠ è½½è¿‡ç¨‹ä¸­ï¼ŒNode ä¼šé€ä¸ªå°è¯•æ¨¡å—è·¯å¾„ä¸­çš„è·¯å¾„ï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶</p><p>æ–‡ä»¶è·¯å¾„è¶Šæ·±ï¼Œæ¨¡å—æŸ¥æ‰¾è€—æ—¶ä¼šè¶Šå¤šï¼Œè¿™æ˜¯è‡ªå®šä¹‰æ¨¡å—çš„åŠ è½½é€Ÿåº¦æœ€æ…¢çš„åŸå› </p></blockquote><p><strong>æ–‡ä»¶å®šä½</strong></p><ul><li>æ–‡ä»¶æ‰©å±•ååˆ†æ</li></ul><blockquote><p>require åˆ†ææ ‡è¯†ç¬¦ä¼šå‡ºç°ä¸åŒ…å«æ–‡ä»¶æ‰©å±•åçš„æƒ…å†µ</p><p>ä¼šæŒ‰.jsã€.jsonã€.node çš„æ¬¡åºè¡¥è¶³æ‰©å±•åï¼Œä¸€æ¬¡å°è¯•</p><p>è¿‡ç¨‹ä¸­ï¼Œéœ€è°ƒç”¨ fs æ¨¡å—åŒæ­¥é˜»å¡åœ°åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼ŒNode å•çº¿ç¨‹å› æ­¤ä¼šå¼•èµ·æ€§èƒ½é—®é¢˜</p><p>å¦‚æœæ˜¯.node / .json æ–‡ä»¶å¸¦ä¸Šæ‰©å±•åèƒ½åŠ å¿«ç‚¹é€Ÿåº¦ï¼Œé…åˆç¼“å­˜æœºåˆ¶ï¼Œå¯å¤§å¹…ç¼“è§£ Node å•çº¿ç¨‹é˜»å¡è°ƒç”¨çš„ç¼ºé™·</p></blockquote><ul><li>ç›®å½•åˆ†æå’ŒåŒ…</li></ul><blockquote><p>åˆ†ææ ‡è¯†ç¬¦çš„è¿‡ç¨‹ä¸­å¯èƒ½æ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶ï¼Œå´å¾—åˆ°ä¸€ä¸ªç›®å½•ï¼Œåˆ™ä¼šå°†ç›®å½•å½“åšä¸€ä¸ªåŒ…æ¥å¤„ç†</p><p>é€šè¿‡è§£æ package.json æ–‡ä»¶å¯¹åº”è¯¥åŒ…çš„ main å±æ€§æŒ‡å®šçš„æ–‡ä»¶å</p><p>å¦‚æœ main ç›¸åº”æ–‡ä»¶è§£æé”™è¯¯ / æ²¡æœ‰ package.json æ–‡ä»¶ï¼Œnode ä¼šå°† index ä½œä¸ºæ–‡ä»¶å</p><p>ä¸€æ¬¡æŸ¥æ‰¾ index.js index.json index.node</p><p>è¯¥ç›®å½•æ²¡æœ‰å®šä½æˆåŠŸåˆ™è¿›è¡Œä¸‹ä¸€ä¸ªæ¨¡å—è·¯å¾„è¿›è¡ŒæŸ¥æ‰¾</p><p>ç›´åˆ°æ¨¡å—è·¯å¾„æ•°ç»„éƒ½è¢«éå†å®Œä¾ç„¶æ²¡æœ‰æŸ¥æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶åˆ™æŠ›å‡ºå¼‚å¸¸</p></blockquote><h3 id="æ¨¡å—ç¼–è¯‘">æ¨¡å—ç¼–è¯‘</h3><blockquote><p>åœ¨ Node ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶æ¨¡å—éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Module</span>(<span class="params">id, parent</span>) </span>&#123;</span><br><span class="line"> <span class="built_in">this</span>.id = id;</span><br><span class="line"> <span class="built_in">this</span>.exports = &#123;&#125;;</span><br><span class="line"> <span class="built_in">this</span>.parent = parent;</span><br><span class="line"> <span class="keyword">if</span> (parent &amp;&amp; parent.children) &#123;</span><br><span class="line">     parent.children.push(<span class="built_in">this</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="built_in">this</span>.filename = <span class="literal">null</span>;</span><br><span class="line"> <span class="built_in">this</span>.loaded = <span class="literal">false</span>;</span><br><span class="line"> <span class="built_in">this</span>.children = [];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>js æ–‡ä»¶<ul><li>é€šè¿‡ fs æ¨¡å—åŒæ­¥è¯»å–æ–‡ä»¶åç¼–è¯‘æ‰§è¡Œ</li></ul></li><li>node æ–‡ä»¶<ul><li>è¿™æ˜¯ç”¨ C/C++ç¼–å†™çš„æ‰©å±•æ–‡ä»¶ï¼Œé€šè¿‡ dlopen æ–¹æ³•åŠ åœ¨æœ€åç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶</li></ul></li><li>json æ–‡ä»¶<ul><li>é€šè¿‡ fs æ¨¡å—åŒæ­¥è¯»å–æ–‡ä»¶åï¼ŒJSON.parse è§£æè¿”å›çš„ç»“æœ</li></ul></li><li>å…¶ä»–<ul><li>éƒ½è¢«å½“ä½œ js æ–‡ä»¶è½½å…¥</li></ul></li></ul><blockquote><p>æ¯ä¸€ä¸ªç¼–è¯‘æˆåŠŸçš„æ¨¡å—éƒ½ä¼šå°†å…¶æ–‡ä»¶è·¯å¾„ä½œä¸ºç´¢å¼•å­˜åœ¨ Module.cache å¯¹è±¡ä¸Šï¼Œä»¥æé«˜äºŒæ¬¡å¼•å…¥çš„æ€§èƒ½</p></blockquote><h1>åŒ…ä¸ NPM</h1><blockquote><p>Node ç»„ç»‡äº†è‡ªèº«æ ¸å¿ƒæ¨¡å—ï¼Œä¹Ÿä½¿å¾—ç¬¬ä¸‰æ–¹æ–‡ä»¶æ¨¡å—å¯ä»¥æœ‰åºåœ°ç¼–å†™å’Œä½¿ç”¨</p><p>ä½†æ˜¯åœ¨ç¬¬ä¸‰æ–¹æ¨¡å—ä¸­ï¼Œæ¨¡å—ä¸æ¨¡å—ä¹‹é—´ä»ç„¶æ˜¯æ•£åˆ—åœ¨å„åœ°çš„ï¼Œç›¸äº’ä¹‹é—´ä¸èƒ½ç›´æ¥å¼•ç”¨</p><p>è€Œåœ¨æ¨¡å—ä¹‹å¤–ï¼ŒåŒ…å’Œ NPM åˆ™æ˜¯å°†æ¨¡å—è”ç³»èµ·æ¥çš„ä¸€ç§æœºåˆ¶</p><p>ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†å˜é‡ä¾èµ–ã€ä¾èµ–å…³ç³»ç­‰ä»£ç ç»„ç»‡æ€§é—®é¢˜</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225646448.(null)" alt="img"></p><h2 id="åŒ…ç»“æ„">åŒ…ç»“æ„</h2><blockquote><p>åŒ…å®é™…ä¸Šæ˜¯ä¸€ä¸ªå­˜æ¡£æ–‡ä»¶ï¼Œå³ä¸€ä¸ªç›®å½•ç›´æ¥æ‰“åŒ…ä¸ºä¸€ä¸ª.zip/tar.gz æ ¼å¼çš„æ–‡ä»¶ï¼Œå®‰è£…åè§£å‹è¿˜åŸä¸ºç›®å½•</p></blockquote><ul><li>ç¬¦åˆ CommonJS è§„èŒƒçš„åŒ…ç›®å½•åº”è¯¥åŒ…å«å¦‚ä¸‹æ–‡ä»¶<ul><li>package.json åŒ…æè¿°æ–‡ä»¶</li><li>bin ç”¨äºå­˜æ”¾å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶</li><li>lib ç”¨äºå­˜æ”¾ JavaScript ä»£ç çš„ç›®å½•</li><li>doc ç”¨äºå­˜æ”¾æ–‡æ¡£çš„ç›®å½•</li><li>test ç”¨äºå­˜æ”¾å•å…ƒæµ‹è¯•ç”¨ä¾‹çš„ä»£ç </li></ul></li></ul><h2 id="åŒ…æè¿°æ–‡ä»¶">åŒ…æè¿°æ–‡ä»¶</h2><blockquote><p>package.json</p></blockquote><p>CommonJS ä¸º package.json å®šä¹‰äº†å¦‚ä¸‹ä¸€äº›å¿…é¡»çš„å­—æ®µ</p><ul><li>name åŒ…å</li><li>description åŒ…ç®€ä»‹</li><li>version ç‰ˆæœ¬å·</li><li>keywords å…³é”®è¯æ•°ç»„ï¼Œç”¨äºåš npm æœç´¢</li><li>maintainers åŒ…ç»´æŠ¤è€…åˆ—è¡¨</li><li>contributors è´¡çŒ®è€…åˆ—è¡¨</li><li>bugs ä¸€ä¸ªå¯ä»¥åé¦ˆ bug çš„ç½‘é¡µåœ°å€ / é‚®ä»¶åœ°å€</li><li>licenses è®¸å¯è¯åˆ—è¡¨</li><li>repositories æ‰˜ç®¡æºä»£ç çš„ä½ç½®åˆ—è¡¨</li><li>dependencies ä½¿ç”¨å½“å‰åŒ…æ‰€éœ€è¦ä¾èµ–çš„åŒ…</li><li>homepage å½“å‰åŒ…çš„ç½‘ç«™åœ°å€</li><li>os æ“ä½œç³»ç»Ÿæ”¯æŒåˆ—è¡¨<ul><li>aixã€freebsdã€linuxã€macosã€solarisã€vxworksã€windows</li></ul></li><li>cpu CPU æ¶æ„çš„æ”¯æŒåˆ—è¡¨<ul><li>armã€mipsã€ppcã€sparcã€x86ã€x86_64</li></ul></li><li>builtin æ ‡å¿—å½“å‰åŒ…æ˜¯å¦æ˜¯å†…å»ºåœ¨åº•å±‚ç³»ç»Ÿçš„æ ‡å‡†ç»„ä»¶</li><li>implements å®ç°è§„èŒƒçš„åˆ—è¡¨</li><li>scripts è„šæœ¬è¯´æ˜å¯¹è±¡</li></ul><blockquote><p>åŒ…è§„èŒƒçš„å®šä¹‰å¯ä»¥å¸®åŠ© Node è§£å†³ä¾èµ–åŒ…å®‰è£…çš„é—®é¢˜ï¼Œè€Œ NPM æ­£æ˜¯åŸºäºè¯¥è§„èŒƒè¿›è¡Œäº†å®ç°</p></blockquote><h2 id="NPM-å¸¸ç”¨åŠŸèƒ½">NPM å¸¸ç”¨åŠŸèƒ½</h2><blockquote><p>CommonJS åŒ…è§„èŒƒæ˜¯ç†è®ºï¼ŒNPM æ˜¯å…¶ä¸­ä¸€ç§å®è·µ</p><p>NPM äº Nodeï¼Œç›¸å½“äº gem äº Rubyï¼Œpear äº PHP</p><p>å¸®åŠ©å®Œæˆäº†ç¬¬ä¸‰æ–¹æ¨¡å—çš„å‘å¸ƒã€å®‰è£…å’Œä¾èµ–ç­‰</p></blockquote><ol><li>æŸ¥çœ‹å¸®åŠ©</li></ol><ul><li>æŸ¥çœ‹ç‰ˆæœ¬ <code>npm -v</code></li><li>æŸ¥çœ‹å‘½ä»¤ <code>npm</code></li></ul><ol start="2"><li>å®‰è£…ä¾èµ–åŒ…</li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install &#123;packageName&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ‰§è¡Œè¯¥å‘½ä»¤åï¼ŒNPM ä¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»º node_modules ç›®å½•ä¸‹åˆ›å»ºåŒ…ç›®å½•ï¼Œæ¥ç€å°†ç›¸åº”çš„åŒ…è§£å‹åˆ°è¿™ä¸ªç›®å½•ä¸‹</p></blockquote><ul><li>å…¨å±€å®‰è£…æ¨¡å¼</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install &#123;packageName&#125; -g</span><br></pre></td></tr></table></figure><blockquote><p>å…¨å±€æ¨¡å¼å¹¶ä¸æ˜¯å°†ä¸€ä¸ªæ¨¡å—åŒ…å®‰è£…ä¸ºä¸€ä¸ªå…¨å±€åŒ…çš„æ„æ€ï¼Œå®ƒå¹¶ä¸æ„å‘³ç€å¯ä»¥ä»ä»»ä½•åœ°æ–¹ reuqire å®ƒ</p><p>å…¨å±€æ¨¡å¼è¿™ä¸ªæˆä¸ºå¹¶ä¸ç²¾ç¡®ï¼Œ-g å®é™…ä¸Šæ˜¯å°†ä¸€ä¸ªåŒ…å®‰è£…ä¸ºå…¨å±€å¯ç”¨çš„æ‰§è¡Œå‘½ä»¤</p><p>å®ƒæ ¹æ®åŒ…æè¿°æ–‡ä»¶ä¸­çš„ bin å­—æ®µé…ç½®ï¼Œå°†å®é™…è„šæœ¬é“¾æ¥åˆ°ä¸ Node å¯æ‰§è¡Œæ–‡ä»¶ç›¸åŒçš„è·¯å¾„ä¸‹</p></blockquote><ul><li>ä»æœ¬åœ°å®‰è£…</li></ul><blockquote><p>å¯¹äºä¸€äº›æ²¡æœ‰å‘å¸ƒåˆ° NPM ä¸Šçš„åŒ…ï¼Œæˆ–è€…å› ä¸ºç½‘ç»œåŸå› æ— æ³•ç›´æ¥å®‰è£…çš„åŒ…</p><p>å¯ä»¥é€šè¿‡å°†åŒ…ä¸‹æŒ‰åœ¨åˆ°æœ¬åœ°ï¼Œç„¶åæœ¬åœ°å®‰è£…</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install &lt;tarball file&gt;</span><br><span class="line">npm install &lt;tarball url&gt;</span><br><span class="line">npm install folder&gt;</span><br></pre></td></tr></table></figure><ul><li>ä»éå®˜æ–¹æºå®‰è£…</li></ul><blockquote><p>å¦‚æœä¸èƒ½é€šè¿‡å®˜æ–¹æºå®‰è£…ï¼Œå¯ä»¥é€šè¿‡é•œåƒæºå®‰è£…</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --registry=&#123;urlResource&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœä½¿ç”¨è¿‡ç¨‹ä¸­å‡ ä¹å…¨ä½¿ç”¨é•œåƒæºï¼Œå¯ä»¥æŒ‡å®šé»˜è®¤æº</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry &#123;urlResource&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>NPM é’©å­å‘½ä»¤</li></ol><blockquote><p>package.json ä¸­ scripts å­—æ®µçš„æå‡ºå°±æ˜¯è®©åŒ…åœ¨å®‰è£…æˆ–è€…å¸è½½ç­‰è¿‡ç¨‹ä¸­æä¾›é’©å­æœºåˆ¶</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>:&#123;</span><br><span class="line">    <span class="string">&quot;preinstall&quot;</span>: <span class="string">&quot;preinstall.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;install&quot;</span>: <span class="string">&quot;install.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;uninstall&quot;</span>: <span class="string">&quot;uninstall.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;test&quot;</span>: <span class="string">&quot;test.js&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Install<ul><li>åœ¨ä»¥ä¸Šå­—æ®µæ‰§è¡Œ<code>npm install &lt;package&gt;</code>æ—¶ï¼Œpreinstall æŒ‡å‘çš„è„šæœ¬ä¼šè¢«åŠ è½½æ‰§è¡Œï¼Œç„¶å install æŒ‡å‘çš„è„šæœ¬ä¼šè¢«æ‰§è¡Œ</li></ul></li><li>Uninstall<ul><li>æ‰§è¡Œ<code>npm uninstall &lt;package&gt;</code>æ—¶ï¼Œuninstall æŒ‡å‘çš„è„šæœ¬ä¹Ÿè®¸ä¼šåšä¸€äº›æ¸…ç†å·¥ä½œ</li></ul></li><li>Test<ul><li>æ‰§è¡Œ<code>npm test</code>å°†ä¼šè¿è¡Œ test æŒ‡å‘çš„è„šæœ¬ï¼Œä¸€ä¸ªä¼˜ç§€çš„åŒ…åº”å½“åŒ…å«æµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶åœ¨ package.json æ–‡ä»¶æ­£é…ç½®å¥½è¿è¡Œæµ‹è¯•çš„å‘½ä»¤ï¼Œæ–¹ä¾¿ç”¨æˆ·è¿è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œä»¥ä¾¿æ£€éªŒåŒ…æ˜¯å¦ç¨³å®šå¯é </li></ul></li></ul><h2 id="å±€åŸŸ-NPM">å±€åŸŸ NPM</h2><ul><li>èƒŒæ™¯</li></ul><p>ä¼ä¸šçš„é™åˆ¶åœ¨äºï¼Œä¸€æ–¹é¢éœ€è¦äº«å—åˆ°æ¨¡å—å¼€å‘å¸¦æ¥çš„ä½è€¦åˆå’Œé¡¹ç›®ç»„ç»‡ä¸Šçš„å¥½å¤„ï¼Œå¦ä¸€æ–¹é¢å´è¦è€ƒè™‘æ¨¡å—ä¿å¯†æ€§çš„é—®é¢˜ã€‚æ‰€ä»¥ï¼Œé€šè¿‡ NPM å…±äº«å’Œå‘å¸ƒå­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚</p><ul><li>è§£å†³æ–¹æ¡ˆ</li></ul><p>ä¸ºäº†åŒæ—¶èƒ½å¤Ÿäº«å—åˆ° NPM ä¸Šä¼—å¤šçš„åŒ…ï¼ŒåŒæ—¶å¯¹è‡ªå·±çš„åŒ…è¿›è¡Œä¿å¯†å’Œé™åˆ¶ï¼Œç°æœ‰çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯ä¼ä¸šæ­å»ºè‡ªå·±çš„ NPM ä»“åº“ï¼ŒNPM æ— è®ºæ˜¯å®ƒçš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½æ˜¯å¼€æºçš„ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225651308.(null)" alt="img"></p><blockquote><p>å±€åŸŸ NPM ä»“åº“çš„æ­å»ºæ–¹æ³•ä¸æ­å»ºé•œåƒç«™çš„æ–¹å¼å‡ ä¹ä¸€æ ·ï¼Œä¸é•œåƒä»“åº“ä¸åŒçš„åœ°æ–¹åœ¨äºå¯ä»¥é€‰æ‹©ä¸åŒæ­¥å®˜æ–¹æºä»“åº“ä¸­çš„åŒ…</p></blockquote><ul><li>ä½œç”¨<ul><li>ç§æœ‰çš„å¯é‡ç”¨æ¨¡å—å¯ä»¥æ‰“åŒ…åˆ°å±€åŸŸ NPM ä»“åº“ä¸­ï¼Œè¿™æ ·å¯ä»¥ä¿æŒæ›´æ–°çš„ä¸­å¿ƒåŒ–ï¼Œä¸è‡³äºè®©å„ä¸ªå°é¡¹ç›®ç»´æŠ¤ç›¸åŒåŠŸèƒ½çš„æ¨¡å—</li><li>æœç»é€šè¿‡å¤åˆ¶ç²˜è´´å®ç°ä»£ç å…±äº«çš„è¡Œä¸º</li></ul></li></ul><h1>å¼‚æ­¥ I / O</h1><h2 id="ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥-I-O-ï¼Ÿ">ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥ I / O ï¼Ÿ</h2><ul><li>ç”¨æˆ·ä½“éªŒ</li></ul><blockquote><p>æµè§ˆå™¨ä¸­ JavaScript åœ¨å•çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œè¿˜å’Œ UI æ¸²æŸ“å…±ç”¨ä¸€ä¸ªçº¿ç¨‹</p><p>ã€Šé«˜æ€§èƒ½ JavaScriptã€‹æ›¾æ€»ç»“è¿‡ï¼Œå¦‚æœè„šæœ¬æ‰§è¡Œçš„æ—¶é—´è¶…è¿‡ 100ms ç”¨æˆ·å°±ä¼šæ„Ÿåˆ°é¡µé¢å¡é¡¿</p><p>å¦‚æœç½‘é¡µä¸´æ—¶éœ€è¦è·å–ä¸€ä¸ªç½‘ç»œèµ„æºï¼Œé€šè¿‡åŒæ­¥çš„æ–¹å¼è·å–ï¼ŒJS éœ€è¦ç­‰èµ„æºå®Œå…¨ä»æœåŠ¡å™¨è·å–åæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œè¿™æœŸé—´ UI å°†åœé¡¿ï¼Œä¸å“åº”ç”¨æˆ·çš„äº¤äº’è¡Œä¸ºã€‚å¯ä»¥æƒ³è±¡ï¼Œè¿™æ ·çš„ç”¨æˆ·ä½“éªŒå°†ä¼šå¤šå·®ã€‚</p><p>è€Œé‡‡ç”¨å¼‚æ­¥è¯·æ±‚ï¼ŒJavaScript å’Œ UI çš„æ‰§è¡Œéƒ½ä¸ä¼šå¤„äºç­‰å¾…çŠ¶æ€ï¼Œç»™ç”¨æˆ·ä¸€ä¸ªé²œæ´»çš„é¡µé¢</p><p>I / O æ˜¯æ˜‚è´µçš„ï¼Œåˆ†å¸ƒå¼ I / O æ˜¯æ›´æ˜‚è´µçš„</p><p>åªæœ‰åç«¯èƒ½å¤Ÿå¿«é€Ÿå“åº”èµ„æºï¼Œæ‰èƒ½è®©å‰ç«¯ä½“éªŒå˜å¥½</p></blockquote><ul><li>èµ„æºåˆ†é…</li></ul><blockquote><p>è®¡ç®—æœºåœ¨å‘å±•è¿‡ç¨‹ä¸­å°†ç»„ä»¶è¿›è¡Œäº†æŠ½è±¡ï¼Œåˆ†ä¸ºäº† I / O è®¾å¤‡å’Œè®¡ç®—è®¾å¤‡</p><p>å‡è®¾ä¸šåŠ¡åœºæ™¯æœ‰ä¸€ç»„äº’ä¸ç›¸å…³çš„ä»»åŠ¡éœ€è¦å®Œæˆï¼Œä¸»æµæ–¹æ³•æœ‰ä¸¤ç§ï¼š</p></blockquote><ol><li>å¤šçº¿ç¨‹å¹¶è¡Œå®Œæˆ</li></ol><p>å¤šçº¿ç¨‹çš„ä»£ä»·åœ¨äºåˆ›å»ºçº¿ç¨‹å’Œæ‰§è¡Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€è¾ƒå¤§ã€‚</p><p>åœ¨å¤æ‚çš„ä¸šåŠ¡ä¸­ç»å¸¸é¢ä¸´é”ã€çŠ¶æ€åŒæ­¥ç­‰é—®é¢˜ã€‚ä½†æ˜¯å¤šçº¿ç¨‹åœ¨å¤šæ ¸ CPU ä¸Šèƒ½å¤Ÿæœ‰æ•ˆæå‡ CPU åˆ©ç”¨ç‡</p><ol start="2"><li>å•çº¿ç¨‹ä¸²è¡Œä¾æ¬¡æ‰§è¡Œ</li></ol><p>å•çº¿ç¨‹é¡ºåºæ‰§è¡Œä»»åŠ¡æ¯”è¾ƒç¬¦åˆç¼–ç¨‹äººå‘˜æŒ‰é¡ºåºæ€è€ƒçš„æ€ç»´æ–¹å¼ï¼Œä¾ç„¶æ˜¯ä¸»æµçš„ç¼–ç¨‹æ–¹å¼</p><p>ä¸²è¡Œæ‰§è¡Œçš„ç¼ºç‚¹åœ¨äºæ€§èƒ½ï¼Œä»»æ„ä¸€ä¸ªç•¥æ…¢çš„ä»»åŠ¡éƒ½ä¼šå¯¼è‡´åç»­æ‰§è¡Œä»£ç è¢«é˜»å¡</p><p>åœ¨è®¡ç®—æœºèµ„æºä¸­ï¼Œé€šå¸¸ I / O ä¸ CPU è®¡ç®—æ˜¯å¯ä»¥å¹¶è¡Œçš„ï¼ŒåŒæ­¥ç¼–ç¨‹æ¨¡å‹å¯¼è‡´çš„é—®é¢˜æ˜¯ï¼ŒI / O çš„è¿›è¡Œä¼šè®©åç»­ä»»åŠ¡ç­‰å¾…ï¼Œè¿™é€ æˆèµ„æºä¸èƒ½æ›´å¥½åœ°è¢«åˆ©ç”¨</p><ol start="3"><li>Node åœ¨ä¸¤è€…ä¹‹é—´ç»™å‡ºäº†å®ƒçš„ç­”æ¡ˆ</li></ol><blockquote><p>åˆ©ç”¨å•çº¿ç¨‹ï¼Œè¿œç¦»å¤šçº¿ç¨‹æ­»é”ã€çŠ¶æ€åŒæ­¥ç­‰é—®é¢˜ï¼›</p><p>åˆ©ç”¨å¼‚æ­¥ I / Oï¼Œè®©å•çº¿ç¨‹å¯ä»¥è¿œç¦»é˜»å¡ï¼Œæ›´å¥½åœ°ä½¿ç”¨ CPU</p><p>ä¸ºäº†å¼¥è¡¥å•çº¿ç¨‹æ— æ³•åˆ©ç”¨å¤šæ ¸ CPU çš„ç¼ºç‚¹ï¼ŒNode æä¾›äº†ç±»ä¼¼å‰ç«¯æµè§ˆå™¨ä¸­ Web Workers çš„å­è¿›ç¨‹ï¼Œè¯¥å­è¿›ç¨‹å¯ä»¥é€šè¿‡å·¥ä½œè¿›ç¨‹é«˜æ•ˆåœ°åˆ©ç”¨ CPU å’Œ I / O</p><p>å¼‚æ­¥ I / O çš„æå‡ºæ˜¯æœŸæœ› I / O çš„è°ƒç”¨ä¸å†é˜»å¡åç»­è¿ç®—ï¼Œå°†åŸæœ‰ç­‰å¾… I / O å®Œæˆçš„è¿™æ®µæ—¶é—´åˆ†é…ç»™å…¶ä½™éœ€è¦çš„ä¸šåŠ¡å»æ‰§è¡Œ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225655015.(null)" alt="img"></p><h2 id="å¼‚æ­¥-I-O-ç°çŠ¶">å¼‚æ­¥ I / O ç°çŠ¶</h2><h3 id="å¼‚æ­¥-I-O-ä¸éé˜»å¡-I-O">å¼‚æ­¥ I / O ä¸éé˜»å¡ I / O</h3><blockquote><p>æ“ä½œç³»ç»Ÿå†…æ ¸å¯¹äº I / O æ–¹å¼åªæœ‰ä¸¤ç§ï¼šé˜»å¡ä¸éé˜»å¡</p><p>åœ¨è°ƒç”¨é˜»å¡ I / O æ—¶ï¼Œåº”ç”¨ç¨‹åºéœ€è¦ç­‰å¾… I / O å®Œæˆæ‰è¿”å›ç»“æœ</p><p>ç‰¹ç‚¹ï¼šè°ƒç”¨ä¹‹åä¸€å®šè¦ç­‰åˆ°ç³»ç»Ÿå†…æ ¸å±‚é¢å®Œæˆæ‰€æœ‰æ“ä½œåè°ƒç”¨æ‰ç»“æŸ</p><p>ä¾‹å­ï¼šç³»ç»Ÿå†…æ ¸åœ¨å®Œæˆç£ç›˜å¯»é“ã€è¯»å–æ•°æ®ã€å¤åˆ¶æ•°æ®åˆ°å†…å¹•æ‰èƒ½ä¸­ä¹‹åï¼Œè¿™ä¸ªè°ƒç”¨æ‰ç»“æŸã€‹</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202224957133.(null)" alt="img"></p><blockquote><p>éé˜»å¡ I / O ä¸é˜»å¡ I / O çš„å·®åˆ«ä¸ºè°ƒç”¨ä¹‹åä¼šç«‹å³è¿”å›</p><p>éé˜»å¡ I / O è¿”å›ä¹‹åï¼ŒCPU çš„æ—¶é—´ç‰‡å¯ä»¥ç”¨æ¥å¤„ç†å…¶ä»–äº‹åŠ¡ï¼Œæ­¤æ—¶çš„æ€§èƒ½æå‡æ˜¯æ˜æ˜¾çš„</p><p>å­˜åœ¨çš„é—®é¢˜ï¼š</p></blockquote><ul><li>ç”±äºå®Œæ•´çš„ I / O æ²¡æœ‰å®Œæˆï¼Œç«‹å³è¿”å›çš„å¹¶ä¸æ˜¯ä¸šåŠ¡å±‚æœŸæœ›çš„æ•°æ®è€Œä»…ä»…æ˜¯å½“å‰è°ƒç”¨çš„çŠ¶æ€</li><li>ä¸ºäº†è·å–å®Œæ•´çš„æ•°æ®ï¼Œåº”ç”¨ç¨‹åºéœ€è¦é‡å¤è°ƒç”¨ I / O æ“ä½œæ¥ç¡®è®¤æ˜¯å¦å®Œæˆï¼Œç§°ä¹‹ä¸ºâ€œè½®è¯¢â€ã€‚</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225703091.(null)" alt="img"></p><h3 id="ä¸»è¦çš„è½®è¯¢æŠ€æœ¯">ä¸»è¦çš„è½®è¯¢æŠ€æœ¯</h3><ul><li>read</li></ul><blockquote><p>å®ƒæ˜¯æœ€åŸå§‹ã€æ€§èƒ½æœ€ä½çš„ä¸€ç§ï¼Œé€šè¿‡é‡å¤è°ƒç”¨æ£€æŸ¥ I / O çš„çŠ¶æ€æ¥å®Œæˆæ•°æ®çš„å®Œæ•´è¯»å–</p><p>åœ¨å¾—åˆ°æœ€ç»ˆæ•°æ®å‰ï¼ŒCPU ä¸€ç›´è€—ç”¨åœ¨ç­‰å¾…ä¸Š</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225706724.(null)" alt="img"></p><ul><li>select</li></ul><blockquote><p>å®ƒæ˜¯åœ¨ read çš„åŸºç¡€ä¸Šæ”¹è¿›çš„ä¸€ç§æ–¹æ¡ˆï¼Œé€šè¿‡å¯¹æ–‡ä»¶æè¿°ç¬¦ä¸Šçš„äº‹ä»¶çŠ¶æ€æ¥è¿›è¡Œåˆ¤æ–­</p><p>é™åˆ¶ï¼šå®ƒé‡‡ç”¨ä¸€ä¸ª 1024 é•¿åº¦çš„æ•°ç»„æ¥å­˜å‚¨çŠ¶æ€ï¼Œæœ€å¤šå¯ä»¥åŒæ—¶æ£€æŸ¥ 1024 ä¸ªæ–‡ä»¶æè¿°ç¬¦</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225711576.(null)" alt="img"></p><ul><li>poll</li></ul><blockquote><p>è¾ƒ select æœ‰æ‰€æ”¹è¿›ï¼Œé‡‡ç”¨é“¾è¡¨çš„æ–¹å¼é¿å…æ•°ç»„é•¿åº¦çš„é™åˆ¶ï¼Œå…¶æ¬¡å®ƒèƒ½é¿å…ä¸éœ€è¦çš„æ£€æŸ¥</p><p>æ–‡ä»¶æè¿°ç¬¦è¾ƒå¤šæ—¶ï¼Œå®ƒçš„æ€§èƒ½è¿˜æ˜¯ååˆ†ä½ä¸‹çš„</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225714602.(null)" alt="img"></p><ul><li>epoll</li></ul><blockquote><p>è¯¥æ–¹æ¡ˆæ˜¯ Linux ä¸‹æ•ˆç‡æœ€é«˜çš„ I / O äº‹ä»¶é€šçŸ¥æœºåˆ¶ï¼Œåœ¨è¿›å…¥è½®è¯¢çš„æ—¶å€™å¦‚æœæ²¡æœ‰æ£€æŸ¥åˆ° I / O äº‹ä»¶ï¼Œå°†ä¼šè¿›è¡Œä¼‘çœ ï¼Œç›´åˆ°äº‹ä»¶å°†å®ƒå”¤é†’ã€‚å®ƒæ˜¯çœŸå®åˆ©ç”¨äº†äº‹ä»¶é€šçŸ¥ã€æ‰§è¡Œå›è°ƒçš„æ–¹å¼ï¼Œè€Œä¸æ˜¯éå†æŸ¥è¯¢ï¼Œæ‰€ä»¥ä¸ä¼šæµªè´¹ CPUï¼Œæ‰§è¡Œæ•ˆç‡è¾ƒé«˜</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225718042.(null)" alt="img"></p><h3 id="ç†æƒ³çš„éé˜»å¡å¼‚æ­¥-I-O">ç†æƒ³çš„éé˜»å¡å¼‚æ­¥ I / O</h3><blockquote><p>å°½ç®¡ epoll å·²ç»åˆ©ç”¨äº†æ—¶é—´æ¥é™ä½ CPU çš„è€—ç”¨ï¼Œä½†æ˜¯ä¼‘çœ æœŸé—´ CPU å‡ ä¹æ˜¯é™åˆ¶çš„ï¼Œå¯¹äºå½“å‰çº¿ç¨‹è€Œè¨€åˆ©ç”¨ç‡ä¸å¤Ÿ</p></blockquote><p>å®Œç¾çš„å¼‚æ­¥ I / O åº”è¯¥æ˜¯åº”ç”¨ç¨‹åºå‘èµ·éé˜»å¡è°ƒç”¨ï¼Œæ— éœ€é€šè¿‡éå†æˆ–è€…æ—¶é—´å”¤é†’ç­‰æ–¹å¼è½®è¯¢</p><p>å¯ä»¥ç›´æ¥å¤„ç†ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œåªéœ€åœ¨ I / O å®Œæˆåé€šè¿‡ä¿¡å·æˆ–å›è°ƒå°†æ•°æ®ä¼ é€’ç»™åº”ç”¨ç¨‹åºå³å¯</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225721234.(null)" alt="img"></p><p>Linux ä¸‹å­˜åœ¨åŸç”Ÿæä¾›çš„ä¸€ç§å¼‚æ­¥ I / O æ–¹å¼ï¼ˆAIOï¼‰å°±æ˜¯é€šè¿‡ä¿¡å·æˆ–è€…å›è°ƒæ¥ä¼ é€’æ•°æ®çš„</p><p>ç¼ºç‚¹ï¼š</p><ul><li>ä»… Linux ä¸‹æœ‰</li><li>ä»…æ”¯æŒ I / O ä¸­çš„ O_DIRECT æ–¹å¼è¯»å–ï¼Œå¯¼è‡´æ— æ³•åˆ©ç”¨ç³»ç»Ÿç¼“å­˜</li></ul><blockquote><p>æ³¨ï¼š<a href="https://blog.csdn.net/AXW2013/article/details/70242228">å…³äº O_DIRECT</a></p></blockquote><h3 id="ç°å®çš„å¼‚æ­¥-I-O">ç°å®çš„å¼‚æ­¥ I / O</h3><blockquote><p>é€šè¿‡è®©éƒ¨åˆ†çº¿ç¨‹è¿›è¡Œé˜»å¡ I / O æˆ–è€…éé˜»å¡ I / O åŠ è½®è¯¢æŠ€æœ¯æ¥å®Œæˆæ•°æ®è·å–ï¼Œè®©ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œè®¡ç®—å¤„ç†ï¼Œé€šè¿‡çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡å°† I / O å¾—åˆ°çš„æ•°æ®è¿›è¡Œä¼ é€’ï¼Œè¿™å°±è½»æ¾å®ç°äº†å¼‚æ­¥ I / Oï¼ˆå°½ç®¡å®ƒæ˜¯æ¨¡æ‹Ÿçš„</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225724648.(null)" alt="img"></p><ul><li>libeio å®è´¨ä¸Šæ˜¯é‡‡ç”¨çº¿ç¨‹æ± ä¸é˜»å¡ I / O æ¨¡æ‹Ÿå¼‚æ­¥ I / O</li><li>Node æœ€åˆåœ¨*nix å¹³å°ä¸‹é‡‡ç”¨ libeio é…åˆ libev å®ç°å¼‚æ­¥ I / Oï¼Œåé€šè¿‡è‡ªè¡Œå®ç°çº¿ç¨‹æ± å®Œæˆ</li><li>Windows ä¸‹çš„ IOCP<ul><li>è°ƒç”¨å¼‚æ­¥æ–¹æ³•ï¼Œç­‰å¾… I / O å®Œæˆä¹‹åçš„é€šçŸ¥ï¼Œæ‰§è¡Œå›è°ƒï¼Œç”¨æˆ·æ— éœ€è€ƒè™‘è½®è¯¢</li><li>å†…éƒ¨å…¶å®ä»æ˜¯çº¿ç¨‹æ± çš„åŸç†ï¼Œä¸åŒä¹‹å¤„åœ¨äºè¿™äº›çº¿ç¨‹æ± ç”±ç³»ç»Ÿå†…æ ¸æ¥æ‰‹ç®¡ç†</li><li>ä¸ Node å¼‚æ­¥è°ƒç”¨æ¨¡å‹ååˆ†è¿‘ä¼¼</li></ul></li><li>ç”±äº Windows å¹³å°å’Œ*nix å¹³å°çš„å·®å¼‚ï¼ŒNode æä¾›äº† libuv ä½œä¸ºæŠ½è±¡å°è£…å±‚ï¼Œåšå…¼å®¹æ€§åˆ¤æ–­<ul><li>ä¿è¯ä¸Šå±‚ Node ä¸ä¸‹å±‚çš„è‡ªå®šä¹‰çº¿ç¨‹æ± å’Œ IOCP å„è‡ªç‹¬ç«‹</li></ul></li><li>æˆ‘ä»¬æ—¶å¸¸æåˆ° Node æ˜¯å•çº¿ç¨‹çš„<ul><li>è¿™é‡Œçš„å•çº¿ç¨‹ä»…ä»…åªæ˜¯ JavaScript æ‰§è¡Œåœ¨å•çº¿ç¨‹ä¸­ç½¢äº†</li><li>æ— è®ºæ˜¯*nix è¿˜æ˜¯ Windows å¹³å°ï¼Œå†…éƒ¨å®Œæˆ I / O ä»»åŠ¡çš„å¦æœ‰çº¿ç¨‹æ± </li></ul></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225728300.(null)" alt="img"></p><h2 id="Node-çš„å¼‚æ­¥-I-O">Node çš„å¼‚æ­¥ I / O</h2><blockquote><p>Node å®Œæˆæ•´ä¸ªå¼‚æ­¥ I / O ç¯èŠ‚çš„æœ‰äº‹ä»¶å¾ªç¯ã€è§‚å¯Ÿè€…å’Œè¯·æ±‚å¯¹è±¡ç­‰</p></blockquote><h3 id="äº‹ä»¶å¾ªç¯">äº‹ä»¶å¾ªç¯</h3><blockquote><p>ç€é‡å¼ºè°ƒä¸€ä¸‹ Node è‡ªèº«çš„æ‰§è¡Œæ¨¡å‹â€”â€”äº‹ä»¶å¾ªç¯</p></blockquote><p>Node è¿›ç¨‹å¯åŠ¨æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªç±»ä¼¼ while(true)çš„å¾ªç¯</p><p>æ¯æ¬¡å¾ªç¯ä½“çš„è¿‡ç¨‹ç§°ä¹‹ä¸º Tickï¼Œæ¯ä¸ª Tick çš„è¿‡ç¨‹å°±æ˜¯æŸ¥çœ‹æ˜¯å¦æœ‰äº‹ä»¶å¾…å¤„ç†</p><p>å¦‚æœæœ‰å°±å–å‡ºäº‹ä»¶åŠå…¶ç›¸å…³çš„å›è°ƒå‡½æ•°ï¼Œå¹¶æ‰§è¡Œå®ƒä»¬</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225732500.(null)" alt="img"></p><h3 id="è§‚å¯Ÿè€…">è§‚å¯Ÿè€…</h3><blockquote><p>æ¯ä¸ªäº‹ä»¶å¾ªç¯ä¸­æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè§‚å¯Ÿè€…ï¼Œè€Œåˆ¤æ–­æ˜¯å¦æœ‰äº‹ä»¶è¦å¤„ç†çš„è¿‡ç¨‹å°±æ˜¯å‘è¿™äº›è§‚å¯Ÿè€…è¯¢é—®æ˜¯å¦æœ‰è¦å¤„ç†çš„äº‹ä»¶</p></blockquote><ul><li>æµè§ˆå™¨é‡‡ç”¨äº†ç±»ä¼¼çš„æœºåˆ¶<ul><li>äº‹ä»¶å¯èƒ½æ¥è‡ªç”¨æˆ·çš„ç‚¹å‡»æˆ–è€…åŠ è½½æŸäº›æ–‡ä»¶æ—¶äº§ç”Ÿï¼Œè€Œè¿™äº›äº§ç”Ÿçš„äº‹ä»¶éƒ½æœ‰å¯¹åº”çš„è§‚å¯Ÿè€…</li></ul></li><li>Node ä¸­äº‹ä»¶ä¸»è¦æ¥æºäºç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶ I / O ç­‰<ul><li>è¿™äº›æ—¶é—´å¯¹åº”çš„è§‚å¯Ÿè€…æœ‰æ–‡ä»¶ I / O è§‚å¯Ÿè€…ã€ç½‘ç»œ I / O è§‚å¯Ÿè€…ç­‰ï¼Œå°†äº‹ä»¶è¿›è¡Œäº†åˆ†ç±»</li></ul></li><li>äº‹ä»¶å¾ªç¯æ˜¯ä¸€ä¸ªå…¸å‹çš„ç”Ÿäº§è€… / æ¶ˆè´¹è€…æ¨¡å‹<ul><li>å¼‚æ­¥ I / Oã€ç½‘ç»œè¯·æ±‚ç­‰åˆ™æ˜¯äº‹ä»¶çš„ç”Ÿäº§è€…</li><li>è¿™äº›äº‹ä»¶è¢«ä¼ é€’åˆ°å¯¹åº”çš„è§‚å¯Ÿè€…ï¼Œäº‹ä»¶å¾ªç¯åˆ™ä»è§‚å¯Ÿè€…é‚£å–å‡ºäº‹ä»¶å¹¶å¤„ç†</li></ul></li></ul><h3 id="å°ç»“">å°ç»“</h3><blockquote><p>äº‹ä»¶å¾ªç¯ã€è§‚å¯Ÿè€…ã€è¯·æ±‚å¯¹è±¡ã€I / O çº¿ç¨‹æ± è¿™å››è€…å…±åŒæ„æˆäº† NOde å¼‚æ­¥ I / O æ¨¡å‹çš„åŸºæœ¬è¦ç´ </p></blockquote><p>ç”±äºæˆ‘ä»¬çŸ¥é“ JavaScipt æ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥æŒ‰å°è¯•å¾ˆå®¹æ˜“ç†è§£å®ƒä¸èƒ½å……åˆ†åˆ©ç”¨å¤šæ ¸ CPU</p><p>äº‹å®ä¸Šåœ¨ Node ä¸­ï¼Œé™¤äº† JavaScript æ˜¯å•çº¿ç¨‹å¤–ï¼ŒNode è‡ªèº«å…¶å®æ˜¯å¤šå–œçˆ±æ˜µç§°çš„ï¼Œåªæ˜¯ I / O çº¿ç¨‹ä½¿ç”¨çš„ CPU è¾ƒå°‘</p><p>å¦ä¸€ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼Œé™¤äº†ç”¨æˆ·ä»£ç æ— æ³•å¹¶è¡Œæ‰§è¡Œä»¥å¤–ï¼Œæ‰€æœ‰çš„ I / O æ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„</p><blockquote><p>æ³¨ï¼šå›¾ä¸º Node æ•´ä¸ªå¼‚æ­¥ I / O è¿‡ç¨‹</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20211202225736774.(null)" alt="img"></p><h1>äº‹ä»¶é©±åŠ¨ä¸é«˜æ€§èƒ½æœåŠ¡å™¨</h1><blockquote><p>å‰é¢å¯¹å¼‚æ­¥çš„è®²è§£ï¼Œä¹ŸåŸºæœ¬å‹¾å‹’å‡ºäº†äº‹ä»¶é©±åŠ¨çš„å®è´¨ï¼Œå³é€šè¿‡ä¸»å¾ªç¯åŠ äº‹ä»¶è§¦å‘çš„æ–¹å¼æ¥è¿è¡Œç¨‹åº</p></blockquote><p>ä¸‹é¢ä¸ºå‡ ç§ç»å…¸çš„æœåŠ¡å™¨æ¨¡å‹ï¼š</p><ul><li>åŒæ­¥å¼<ul><li>ä¸€æ¬¡åªèƒ½å¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œå¹¶ä¸”å…¶ä½™è¯·æ±‚éƒ½å¤„äºç­‰å¾…çŠ¶æ€</li></ul></li><li>è¿›ç¨‹ / è¯·æ±‚<ul><li>è¿™æ ·å¯ä»¥å¤„ç†å¤šä¸ªè¯·æ±‚ï¼Œä½†æ˜¯å®ƒä¸å…·å¤‡æ‰©å±•æ€§ï¼Œå› ä¸ºç³»ç»Ÿèµ„æºåªæœ‰é‚£ä¹ˆå¤š</li></ul></li><li>çº¿ç¨‹ / è¯·æ±‚<ul><li>å°½ç®¡çº¿ç¨‹æ¯”è¿›ç¨‹è¦æ¸…å‡‰ï¼Œä½†æ˜¯ç”±äºæ¯ä¸ªçº¿ç¨‹éƒ½å ç”¨ä¸€å®šå†…å­˜ï¼Œå½“å¤§å¹¶å‘è¯·æ±‚åˆ°æ¥æ—¶ï¼Œå†…å­˜å°†ä¼šå¾ˆå¿«ç”¨å…‰ï¼Œå¯¼è‡´æœåŠ¡å™¨ç¼“æ…¢</li><li>æ¯”è¿›ç¨‹ / è¯·æ±‚è¦å¥½ï¼Œä½†å¯¹äºå¤§å‹ç«™ç‚¹è€Œè¨€ä¾ç„¶ä¸å¤Ÿ</li></ul></li><li>æ€»ç»“<ul><li>çº¿ç¨‹ / è¯·æ±‚çš„æ–¹å¼ç›®å‰è¿˜è¢« Apache æ‰€é‡‡ç”¨</li><li>Node é€šè¿‡äº‹ä»¶é©±åŠ¨çš„æ–¹å¼å¤„ç†è¯·æ±‚ï¼Œæ— éœ€ä¸ºæ¯ä¸€ä¸ªè¯·æ±‚åˆ›å»ºé¢å¤–çš„çº¿ç¨‹ï¼Œå¯ä»¥çœæ‰åˆ›å»ºçº¿ç¨‹å’Œé”€æ¯çº¿ç¨‹çš„å¼€é”€</li><li>åŒæ—¶æ“ä½œç³»ç»Ÿåœ¨è°ƒåº¦ä»»åŠ¡æ—¶å› ä¸ºçº¿ç¨‹è¾ƒå°‘ï¼Œä¸Šä¸‹æ–‡çš„ä»£ä»·å¾ˆä½<ul><li>è¿™ä½¿å¾—æœåŠ¡å™¨èƒ½å¤Ÿæœ‰æ¡ä¸ç´Šåœ°å¤„ç†è¯·æ±‚ï¼Œå³ä½¿åœ¨å¤§é‡è¿æ¥çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¸å—ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€çš„å½±å“ï¼Œè¿™ä¹Ÿæ˜¯ Node é«˜æ€§èƒ½çš„ä¸€ä¸ªåŸå› </li></ul></li></ul></li></ul><blockquote><p>äº‹ä»¶é©±åŠ¨å¸¦æ¥çš„é«˜æ•ˆå·²ç»æ¸æ¸å¼€å§‹ä¸ºä¸šç•Œæ‰€é‡è§†</p><p>çŸ¥åæœåŠ¡å™¨ Nginx ä¹Ÿæ‘’å¼ƒäº†å¤šçº¿ç¨‹çš„æ–¹å¼ï¼Œé‡‡ç”¨å’Œ Node ç›¸åŒçš„äº‹ä»¶é©±åŠ¨</p><p>ä¸åŒä¹‹å¤„åœ¨äº Nginx é‡‡ç”¨çº¯ C å†™æˆï¼Œæ€§èƒ½è¾ƒé«˜ï¼Œä½†æ˜¯å®ƒä»…é€‚åˆäºåš Web æœåŠ¡å™¨ï¼Œç”¨äºåå‘ä»£ç†æˆ–è€…è´Ÿè½½å‡è¡¡æœåŠ¡ï¼Œåœ¨ä¸šåŠ¡å¤„ç†æ–¹é¢è¾ƒä¸ºæ¬ ç¼º</p><p>Node åˆ™æ˜¯ä¸€å¥—é«˜æ€§èƒ½å¹³å°ï¼Œå¯ä»¥åˆ©ç”¨å®ƒæ„å»ºä¸ Nginx ç›¸åŒçš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥å¤„ç†å„ç§å…·ä½“ä¸šåŠ¡</p><p>Node æ²¡æœ‰ Nginx åœ¨ Web æœåŠ¡å™¨æ–¹é¢é‚£ä¹ˆä¸“ä¸šï¼Œä½†åœºæ™¯æ›´å¤§ï¼Œè‡ªèº«æ€§èƒ½ä¹Ÿä¸é”™</p><p>åœ¨å®é™…é¡¹ç›®ä¸­å¯ä»¥ç»“åˆå®ƒä»¬å„è‡ªçš„ä¼˜ç‚¹ä»¥è¾¾åˆ°åº”ç”¨çš„æœ€ä¼˜æ€§èƒ½</p><p>JavaScript åœ¨æœåŠ¡å™¨ç«¯è¿‘ä¹ç©ºç™½ï¼Œä½¿å¾— Node æ²¡æœ‰ä»»ä½•å†å²åŒ…è¢±ï¼Œè€Œ Node åœ¨æ€§èƒ½ä¼˜åŒ–ä¸Šçš„è¡¨ç°ä½¿å¾—å®ƒä¸€ä¸‹å­å°±åœ¨ç¤¾åŒºä¸­æµè¡Œäº†èµ·æ¥~</p></blockquote><h1>å†™åœ¨æœ€å</h1><p>æœ¬æ–‡ä»‹ç»äº† Node è¢«åˆ›é€ çš„ç›®çš„ã€è¯­è¨€é€‰å‹ã€ç‰¹ç‚¹ã€æ¨¡å—æœºåˆ¶ã€åŒ…ç®¡ç†æœºåˆ¶ä»¥åŠå¼‚æ­¥ I / O ç­‰ç›¸å…³çŸ¥è¯†ï¼Œå¸Œæœ›èƒ½è®©ä½ å¯¹ Node æœ‰ä¸€ä¸ªæ–°çš„è®¤è¯†ã€‚æœ€è¿‘ä¸€ç›´ä¹Ÿåœ¨è®¡åˆ’å­¦ä¹  Node å’ŒæœåŠ¡ç«¯ç›¸å…³çŸ¥è¯†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥ä¸€èµ·å­¦ä¹ å’Œäº¤æµ~</p><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;æœ€åˆåš Node çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;Node ä½œè€… Ryan Dahlï¼š&lt;/p&gt;
&lt;p&gt;åŸºäº V8 åˆ›å»ºä¸€ä¸ªè½»é‡çº§çš„é«˜æ€§èƒ½ Web æœåŠ¡å™¨å¹¶æä¾›ä¸€å¥—åº“&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1&gt;ä¸ºä»€ä¹ˆæ˜¯ JavaScriptï¼Ÿ&lt;/</summary>
      
    
    
    
    <category term="Back End" scheme="https://lebronchao.com/categories/Back-End/"/>
    
    
    <category term="JavaScript" scheme="https://lebronchao.com/tags/JavaScript/"/>
    
    <category term="Node" scheme="https://lebronchao.com/tags/Node/"/>
    
    <category term="æœåŠ¡ç«¯" scheme="https://lebronchao.com/tags/%E6%9C%8D%E5%8A%A1%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>[é¢ç»åˆ†äº«] æ”¶è·å¤šå®¶å¤§å‚offer | åˆ†äº«æˆ‘çš„2022ç§‹æ‹›ç»å†</title>
    <link href="https://lebronchao.com/2021/11/02/%E7%A7%8B%E6%8B%9B%E5%88%86%E4%BA%AB/"/>
    <id>https://lebronchao.com/2021/11/02/%E7%A7%8B%E6%8B%9B%E5%88%86%E4%BA%AB/</id>
    <published>2021-11-02T15:06:11.000Z</published>
    <updated>2021-11-02T15:06:11.000Z</updated>
    
    <content type="html"><![CDATA[<h1>å‰è¨€</h1><p>å¥½ä¹…ä¸è§ï¼Œæˆ‘æ˜¯ LeBronï¼Œæœ‰æ®µæ—¶é—´æ²¡å†™åšå®¢äº†ã€‚æœ€è¿‘å‡ ä¸ªæœˆçš„å¤§éƒ¨åˆ†ç²¾åŠ›éƒ½æ”¾åœ¨ç§‹æ‹›ä¸Šäº†ï¼Œè¾¹å®ä¹ è¾¹ç§‹æ‹›è¿˜æ˜¯æŒºåƒåŠ›çš„ï¼Œæ€»ç®—ç»“æœè¿˜æ˜¯ä¸é”™ã€‚</p><p>å…ˆä»‹ç»ä¸€ä¸‹ä¸ªäººæƒ…å†µï¼š2022 å±ŠåŒéæœ¬ç§‘åº”å±Šç”Ÿï¼Œé¡¹ç›®ç»éªŒå’Œç»å†è¿˜ç®—ä¸°å¯Œï¼Œåœ¨å­—èŠ‚å®ä¹ è‡³ä»Šä¹Ÿå¿« 8 ä¸ªæœˆäº†ï¼Œè¯¦ç»†æƒ…å†µå¯ä»¥æ¥æˆ‘çš„åšå®¢çœ‹çœ‹å“ˆ : <a href="https://www.lebronchao.com/about/">LeBronChaoâ€™s Blog</a></p><p>ç§‹æ‹›ä» 7.19 ~ 10.24 å†æ—¶ä¸‰ä¸ªå¤šæœˆï¼Œè…¾è®¯ã€é˜¿é‡Œã€å­—èŠ‚ã€ç™¾åº¦ã€å¤§ç–†ã€åä¸ºã€Shopeeã€æ»´æ»´ã€ç¾å›¢ã€æ‹¼å¤šå¤š 10 å®¶å…¬å¸ï¼Œå°†è¿‘ 40 åœºç¬”è¯• / é¢è¯•ï¼ˆè‡ªæˆ‘ä»‹ç»éƒ½å¿«å¿µéº»äº†)ï¼ŒåŸºæœ¬å…¨éƒ¨é€šè¿‡æ”¶åˆ° offerï¼Œå€Ÿæ­¤æœºä¼šåšä¸ªæ€»ç»“å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹é¢ç»ã€‚</p><h1>é¢è¯•å‰çš„å‡†å¤‡</h1><h2 id="ç®€å†">ç®€å†</h2><blockquote><p>å¯ä»¥å‚è€ƒ<a href="https://juejin.cn/post/6952679000422498318">å‰ç«¯ Offer æé€Ÿï¼šå¦‚ä½•å†™å‡ºæœ‰äº®ç‚¹çš„ç®€å†</a></p><p>è¿™ä¸ªå…¶å®ä¸ç”¨è®²å¤ªå¤šäº†ï¼Œå°½é‡åœ°å†™å‡ºäº®ç‚¹ï¼Œæ¯”å¦‚</p></blockquote><ul><li>å¼€æºé¡¹ç›®ç»éªŒ</li><li>å®ä¹ ç»å† &amp; é‡ç‚¹äº§å‡º</li><li>æŠ€æœ¯æ·±åº¦å±•ç° / çŸ¥åå¼€æºæ¡†æ¶ PR</li><li>æŠ€æœ¯çƒ­æƒ… / å½±å“åŠ›</li><li>çŸ¥è¯†äº§æƒ / è®ºæ–‡</li><li>æ ¡å›­é¡¹ç›®ç»éªŒ / äº®ç‚¹ç»å†</li><li>ç­‰ç­‰â€¦</li><li>é‡ç‚¹ï¼šWord æ ¼å¼å®¹æ˜“å‡ºé—®é¢˜ å°½é‡ç”¨ PDF æ ¼å¼</li></ul><h2 id="ç›¸åº”å²—ä½çŸ¥è¯†">ç›¸åº”å²—ä½çŸ¥è¯†</h2><blockquote><p>è¿™ä¸ªå…¶å®é å¹³æ—¶ç§¯ç´¯ä¼šæ¯”è¾ƒå¤šä¸€ç‚¹ï¼Œé¢è¯•å‰å¯ä»¥é€šè¿‡é¢ç»åšä¸ªè‡ªæµ‹ï¼Œæˆ‘é¢è¯•çš„å¤§éƒ¨åˆ†æ˜¯å‰ç«¯å²—ä½ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ–¹é¢</p></blockquote><ul><li><p>è®¡ç®—æœºç½‘ç»œ</p><ul><li>TCP / UDP</li><li>HTTP / HTTPS / WebSocket</li><li>LB / CDN / DNS / IP</li><li>ç½‘ç»œå®‰å…¨</li><li>â€¦</li></ul></li><li><p>æ“ä½œç³»ç»Ÿ</p></li><li><p>å¼€å‘æŠ€èƒ½ &amp; åŸç†</p><ul><li>HTML / CSS(LESS) / JS / TS</li><li>Vueã€Reactã€Nodeã€Webpack ç­‰</li><li>æµè§ˆå™¨ / å°ç¨‹åº / è·¨ç«¯</li><li>æ€§èƒ½ä¼˜åŒ– / å®‰å…¨ç­–ç•¥</li><li>è¿™ä¸ªæ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µæ¥å®šï¼Œ<strong>ä¸ç†Ÿæ‚‰çš„ä¸è¦å†™åˆ°ç®€å†é‡Œ</strong></li></ul></li><li><p>ç®—æ³•é¢˜ / æ™ºåŠ›é¢˜</p><ul><li><p>ç³»ç»Ÿå­¦ä¹ æ•°æ®ç»“æ„å’Œç®—æ³•</p></li><li><p>ç„¶åå°±æ˜¯åˆ·é¢˜äº†ï¼ŒHot100 å’Œå¸¸è§é¢˜åˆ·èµ·æ¥å§ï¼Œä¸»è¦åˆ· easy å’Œ middleï¼Œhard æ²¡å¿…è¦</p></li><li><p>åŸ¹å…»ä¸¾ä¸€åä¸‰çš„èƒ½åŠ›</p></li><li><p>é¢˜åº“</p><ul><li><a href="https://leetcode-cn.com/">åŠ›æ‰£</a></li><li><a href="https://codetop.cc/home">CodeTop ä¼ä¸šé¢˜åº“</a></li></ul></li></ul></li><li><p>ç›¸åº”çš„æŠ€æœ¯å¹¿åº¦æ‰©å±•å’Œæ·±åº¦æ¢ç´¢</p></li><li><p>æ–°çš„æŠ€æœ¯åŠ¨æ€å…³æ³¨ç¨‹åº¦ï¼Œæ¯”å¦‚</p><ul><li>ES æ–°ç‰¹æ€§</li><li>Vue3 çš„æ›´æ–°å’Œå¯¹æ¯”</li><li>å­—èŠ‚çš„ Modern.js</li><li>é˜¿é‡Œçš„ Kraken</li><li>â€¦</li></ul></li><li><p>æå‰æƒ³å¥½å¸¸è§é—®é¢˜çš„ç­”æ¡ˆå’Œå¯¹é¢è¯•çš„å…¬å¸åšåˆæ­¥çš„äº†è§£ï¼Œæ¯”å¦‚</p><ul><li>ä½ çš„é¡¹ç›®æœ‰ä»€ä¹ˆäº®ç‚¹å’Œéš¾ç‚¹</li><li>ä½ ä¼šä»å“ªäº›è§’åº¦å»è€ƒè™‘é€‰æ‹©æ¯•ä¸šåçš„ç¬¬ä¸€å®¶å…¬å¸</li><li>ä½ è§‰å¾— XXX æ˜¯ä¸€å®¶æ€ä¹ˆæ ·çš„å…¬å¸</li><li>ä½ æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹</li><li>ä¸ºä»€ä¹ˆæƒ³åšå…¨æ ˆå·¥ç¨‹å¸ˆ</li><li>ä½ çš„èŒä¸šè§„åˆ’æ˜¯æ€ä¹ˆæ ·çš„</li><li>â€¦</li></ul></li></ul><blockquote><p>æ„Ÿå…´è¶£çš„è¯å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href="https://juejin.cn/post/6953116014678638629">[å»ºè®®æ”¶è—] åˆä¸­çº§å‰ç«¯åº”è¯¥æŒæ¡çš„åŸºç¡€çŸ¥è¯†</a></p><p>æˆ‘çš„å…¬ä¼—å·ã€åšå®¢é‡Œä¹Ÿæœ‰æŒºå¤šç›¸å…³çŸ¥è¯†çš„è®²è§£ï¼Œæ„Ÿå…´è¶£å¯ä»¥çœ‹çœ‹ï¼š<a href="">å‰ç«¯ LeBron</a></p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/62cfe8552fa3405b9370000ec256ef8a~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p></blockquote><h2 id="è‡ªæˆ‘ä»‹ç»">è‡ªæˆ‘ä»‹ç»</h2><p>ä½ å’Œé¢è¯•å®˜ä¸€èˆ¬éƒ½æ˜¯åˆæ¬¡è§é¢ï¼Œä»–åªèƒ½é€šè¿‡ä½ çš„ç®€å†å’Œè‡ªæˆ‘ä»‹ç»æ¥äº†è§£ä½ ã€‚<strong>æ‰€ä»¥è¯´ä¸æ˜¯ç‰¹åˆ«ç†Ÿæ‚‰çš„ä¸œè¥¿ä¸è¦å†™åˆ°ç®€å†é‡Œï¼Œè‡ªæˆ‘ä»‹ç»ä¹Ÿä¸è¦è¯´</strong>ã€‚é¢è¯•å®˜ä¸€èˆ¬ä¹ŸåŸºæœ¬ä¸ä¼šé€å­—é€å¥åœ°çœ‹ä½ çš„ç®€å†ï¼Œå¯èƒ½æ²¡æ³•å‘ç°ä½ çš„äº®ç‚¹ï¼Œè‡ªæˆ‘ä»‹ç»è¿™ä¸æ˜¯æŠŠæœºä¼šç»™ä½ äº†å—ï¼ˆå¼€å§‹è£…é€¼å“ˆå“ˆå“ˆã€‚è‡ªæˆ‘ä»‹ç»å¯ä»¥ç”±ä½ çš„åŸºæœ¬ä¿¡æ¯ã€é¡¹ç›®ç»éªŒã€æŠ€æœ¯äº®ç‚¹å’Œè§£å†³å“ªäº›æ¯”è¾ƒå¤æ‚çš„é—®é¢˜ã€ä¸ªäººç»å†çš„äº®ç‚¹å’Œæœªæ¥çš„è§„åˆ’ç®€è¿°ç»„æˆã€‚ä¹Ÿå¯ä»¥å°è¯•å¼•å¯¼é¢è¯•å®˜é—®ä½ é—®é¢˜ï¼Œä¸€èˆ¬é¢è¯•å®˜éƒ½ä¼šä»ç®€å† / è‡ªæˆ‘ä»‹ç»ä¸­å¼€å§‹å‘é—®ã€‚è‡ªæˆ‘ä»‹ç»è¦ç®€æ˜å¹²ç»ƒï¼Œä¸€èˆ¬ 1min å·¦å³å°±å¥½äº†ã€‚</p><h1>æ€»ç»“</h1><p>ä¸‰ä¸ªå¤šæœˆçš„ç§‹æ‹›ç”Ÿæ´»å‘Šä¸€æ®µè½ï¼Œæœ€ç»ˆé€‰æ‹©äº†ç•™åœ¨å­—èŠ‚å·¥ä½œã€‚æ–°æ—¶æœŸçš„å·¥ä½œå¸¦æ¥äº†æ–°çš„æŒ‘æˆ˜ï¼Œæ²¡æœ‰èººèµ¢çš„å‘½é‚£å°±ç«™èµ·æ¥å¥”è·‘å§ï¼åŠªåŠ›æ˜¯ä¼šæœ‰ç»“æœçš„ï¼</p><p>æˆ‘æ˜¯ä¸€ä¸ªå³å°†æ¯•ä¸šçš„ 22 å±ŠåŒéæœ¬ç§‘åº”å±Šç”Ÿï¼Œåœ¨å­—èŠ‚æ¸¸æˆä¸­å°åšå‰ç«¯å¼€å‘å·¥ä½œã€‚å¸Œæœ›æˆ‘çš„ç§‹æ‹›é¢è¯•ç»éªŒå¯ä»¥ç»™äºˆæ­£åœ¨æ‰¾å·¥ä½œçš„ä½ ä¸€ç‚¹å¸®åŠ©ï¼Œç‰¹åˆ«æ˜¯æ­£åœ¨å¥‹æˆ˜ç§‹æ‹›/å®ä¹ çš„åŒå­¦ã€å­¦å¼Ÿå’Œå­¦å¦¹ä»¬ã€‚å­—èŠ‚æ¸¸æˆä¸­å°å‰ç«¯éƒ¨é—¨æ±‚è´¤è‹¥æ¸´ï¼ŒæŒç»­æ‹›äººä¸­ã€‚æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥é€šè¿‡å†…æ¨é“¾æ¥æŠ•é€’ï¼Œæœ‰é—®é¢˜ä¹Ÿå¯ä»¥åŠ å¾®ä¿¡æ²Ÿé€šã€‚Vx:LeBronChao-</p><p>æ¸¸æˆä¸­å°å†…æ¨ï¼š</p><ul><li><p>æ·±åœ³</p><ul><li>ç¤¾æ‹›ï¼š<a href="https://job.toutiao.com/s/R6gm31s">å‰ç«¯å¼€å‘ï¼ˆé«˜çº§ï¼‰å·¥ç¨‹å¸ˆ-æ¸¸æˆä¸­å°</a></li><li>æ ¡æ‹› &amp; å®ä¹ ï¼š<a href="https://job.toutiao.com/s/R6gBGHA">å‰ç«¯å¼€å‘å®ä¹ ç”Ÿ â€” æœ‰è½¬æ­£æœºä¼š</a></li></ul></li><li><p>ä¸Šæµ·</p><ul><li>ç¤¾æ‹›ï¼š<a href="https://job.toutiao.com/s/R6gVo9r">å‰ç«¯å¼€å‘ï¼ˆé«˜çº§ï¼‰å·¥ç¨‹å¸ˆ-æ¸¸æˆä¸­å°</a></li><li>æ ¡æ‹› &amp; å®ä¹ ï¼š<a href="https://job.toutiao.com/s/R6gmupU">å‰ç«¯å¼€å‘å®ä¹ ç”Ÿ-ç‹¬ç«‹é—­ç¯ä¸šåŠ¡ï¼ˆå¯è½¬æ­£ï¼‰</a></li></ul></li><li><p>ã€ç¤¾æ‹›æ€»å†…æ¨é“¾æ¥ã€‘</p><ul><li><a href="https://job.toutiao.com/s/R6qQccL">https://job.toutiao.com/s/R6qQccL</a></li></ul></li><li><p>ã€å†…æ¨ç ã€‘</p><ul><li>4FCV6BV</li></ul></li><li><p>ã€æˆ‘çš„é‚®ç®±ã€‘</p><ul><li><a href="mailto:chaoweiwen@bytedance.com">chaoweiwen@bytedance.com</a></li></ul></li></ul><h1>åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šé¢ç» â†“</h1><h1>å­—èŠ‚</h1><h2 id="10-9-å®ä¹ è½¬æ­£ç­”è¾©-é€šè¿‡">10.9 å®ä¹ è½¬æ­£ç­”è¾© é€šè¿‡</h2><h1>è…¾è®¯</h1><h2 id="8-17-WXG-æ¸¸æˆä¸€é¢-60min-é€šè¿‡">8.17 WXG æ¸¸æˆä¸€é¢ 60min é€šè¿‡</h2><ol start="0"><li>å®ä¹ å·¥ä½œä¸»è¦è´Ÿè´£ä»€ä¹ˆ</li><li>å°ç¨‹åºå¼€å‘ä¸­é‡åˆ°è¿‡ä»€ä¹ˆé—®é¢˜ï¼Ÿæ€ä¹ˆè§£å†³çš„</li><li>å®ä¹ é¡¹ç›®çš„éš¾ç‚¹ã€äº®ç‚¹</li><li>å­—èŠ‚å°ç¨‹åºå’Œå¾®ä¿¡å°ç¨‹åºæœ‰ä»€ä¹ˆåŒºåˆ«</li><li>Uni-app æ¡†æ¶åšäº†ä»€ä¹ˆå·¥ä½œã€å¤„ç†ï¼Ÿ</li><li>ç”¨ Uni-app å¼€å‘çš„è¿‡ç¨‹ä¸­é‡åˆ°è¿‡ä»€ä¹ˆé—®é¢˜ï¼Ÿæ€ä¹ˆè§£å†³çš„ï¼Ÿ</li><li>ä»è¾“å…¥ç½‘å€åˆ°æ•´ä¸ªæ¸²æŸ“è¿‡ç¨‹æè¿°</li><li>é™¤äº† HTTP ç¼“å­˜è¿˜æœ‰ä»€ä¹ˆç¼“å­˜æ–¹å¼ï¼Ÿ</li><li>HTTP ç¼“å­˜ã€localstorgeã€sessionstorgeã€cookieã€indexDB è¿™äº›æ–¹å¼å®ç°ç¼“å­˜æœ‰ä»€ä¹ˆåŒºåˆ«ã€ç‰¹ç‚¹</li><li>åšè¿‡ CDN ç›¸å…³çš„å·¥ä½œå—ï¼Ÿ</li><li>CDN æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ</li><li>èŠå‚ä¸çš„å¼€æºé¡¹ç›®æŠ€æœ¯æ ˆã€äº‘å¼€å‘</li><li>è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«ï¼Ÿ</li><li>è¿›ç¨‹é—´é€šä¿¡æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</li><li>æœ‰ç”¨è¿‡ Mysqlï¼Ÿè®²è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ</li><li>äºŒå‰æ ‘æœ‰å“ªäº›éå†æ–¹å¼ï¼Ÿå“ªäº›å±äº DFS?</li><li>æœ‰ç”¨è¿‡é¢„å¤„ç†å™¨å—ï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ</li><li>æœ‰è€ƒè™‘è¿‡å¤šä¸»é¢˜æ ·å¼å—ï¼Ÿæ€ä¹ˆå®ç°ï¼Ÿ</li><li>Node ç”¨è¿‡å—ï¼Ÿç”¨è¿‡å“ªäº›ç›¸å…³æ¡†æ¶ï¼Ÿåšè¿‡å“ªäº›ä¸œè¥¿ï¼Ÿ</li><li>æ‰‹æ’• jsonStringfy</li><li>å®ç° JSON.parse çš„æ€è·¯ï¼Ÿé™¤äº† eval å’Œ new Functionï¼ˆASTã€ç¼–è¯‘åŸç†ï¼‰</li><li>è·¨ç«¯æ–¹å¼æœ‰å“ªå‡ ç§è§£å†³æ–¹æ¡ˆï¼Ÿ</li></ol><h2 id="8-18-WXG-æ¸¸æˆäºŒé¢-40min-é€šè¿‡">8.18 WXG æ¸¸æˆäºŒé¢ 40min é€šè¿‡</h2><ol start="0"><li>ä¸ºä»€ä¹ˆé€‰æ‹©åšå‰ç«¯ï¼Ÿ</li><li>å‰ç«¯å’Œå…¶ä»–æ–¹å‘ç›¸æ¯”ï¼Œæ¯”å¦‚æœºå™¨å­¦ä¹ ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«å’Œç‰¹ç‚¹</li><li>æ€ä¹ˆæ ·æ‰ç®—å‰ç«¯åšå¾—æ¯”è¾ƒå¥½ï¼Ÿ</li><li>æœ‰åšè¿‡æ€§èƒ½ä¼˜åŒ–å—ï¼Ÿæ€ä¹ˆåšå¾—ï¼Ÿ</li><li>å°ç¨‹åºæ˜¯æ€ä¹ˆè·‘åœ¨å®¢æˆ·ç«¯çš„?</li><li>åŒçº¿ç¨‹æ¶æ„æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ</li><li>å¦‚æœä¸ä½¿ç”¨åŒçº¿ç¨‹æ¶æ„ä¼šæ€ä¹ˆæ ·ï¼Ÿåœ¨æŠ€æœ¯æŒ‡æ ‡ä¸Šä¼šæœ‰ä»€ä¹ˆå˜åŒ–?</li><li>ä½“éªŒå¡é¡¿é—®é¢˜ï¼Ÿä¸€å¸§å¤§æ¦‚å¤šå°‘æ¯«ç§’ï¼Ÿ</li><li>JS å’Œæ¸²æŸ“ï¼Œä½ è§‰å¾—ä¸€å¸§å„å å¤šå°‘æ¯«ç§’æ¯”è¾ƒåˆé€‚ï¼Ÿ</li><li>è¯´ä¸€è¯´å„ç§è·¨ç«¯çš„æ–¹å¼ï¼ŸJSB æ˜¯æ€ä¹ˆè¿›è¡Œæ¡¥æ¥çš„ï¼Ÿ</li><li>é™¤äº† JSB è¿˜æœ‰ä»€ä¹ˆè¿æ¥æ–¹å¼å—ï¼Ÿ</li><li>åšè¿‡æ€§èƒ½ä¼˜åŒ–ï¼Œæœ‰å“ªäº›æ“ä½œï¼Ÿé¦–å±æ¸²æŸ“ä¼˜åŒ–äº†å¤šå°‘ç§’ï¼Ÿè¾¾åˆ°ç›®æ ‡äº†å—ï¼Ÿè¾¾åˆ°ä½ è‡ªå·±çš„ç›®æ ‡äº†å—ï¼Ÿ</li><li>å„ä¸ªæ“ä½œåˆ†åˆ«ä¼˜åŒ–äº†å¤šå°‘æ¯«ç§’ï¼Ÿ</li><li>CDN çš„åŸç†ï¼Ÿä¸ºä»€ä¹ˆèµ„æºåŠ è½½å¿«ï¼Ÿ</li><li>å¦‚æœä½ æ˜¯ä¸€ä¸ª CDN æœåŠ¡å•†ï¼Œä½ ä¼šæ€ä¹ˆè®¾è®¡ä½ çš„ CDN æ¥å¸å¼•å¼€å‘è€…ã€‚</li><li>ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå­˜åœ¨è·¨åŸŸé—®é¢˜ï¼Ÿ</li><li>ä½ åœ¨å­—èŠ‚æ„Ÿå—æ€ä¹ˆæ ·ï¼Ÿä¸ºä»€ä¹ˆä¼šé€‰æ‹©æ¥å¾®ä¿¡ï¼Ÿ</li><li>ä½ è§‰å¾—é¦–å±æ¸²æŸ“å¤šå°‘ç§’æ˜¯ä¸€ä¸ªåˆæ ¼çš„æ ‡å‡†ï¼Ÿ</li><li>ä¹‹å‰æœ‰æŠ•é€’è¿‡è…¾è®¯å—ï¼Ÿä¸ºä»€ä¹ˆæ²¡æœ‰æ¥ï¼Ÿ</li><li>åé¢å¯ä»¥è¿‡æ¥å®ä¹ å—ï¼Ÿå®ä¹ å¤šä¹…ï¼Ÿåç»­åœ¨å“ªä¸ªåŸå¸‚å‘å±•ï¼Ÿ</li><li>åé—®ç¯èŠ‚ã€ä¸šåŠ¡ä»‹ç»</li></ol><h2 id="8-30-WXG-æ¸¸æˆä¸‰é¢-30min-é€šè¿‡">8.30 WXG æ¸¸æˆä¸‰é¢ 30min é€šè¿‡</h2><ol start="0"><li>å®ä¹ å¤šä¹…äº†ï¼Ÿä¸ºä»€ä¹ˆæŠ•é€’è…¾è®¯ï¼Ÿ</li><li>èŠå®ä¹ ä¸šåŠ¡ã€æŠ€æœ¯éš¾ç‚¹ã€äº®ç‚¹ï¼Œå®ä¹ å¯¹ä¸ªäººçš„æå‡</li><li>å°ç¨‹åºæ€ä¹ˆè°ƒç”¨å®¢æˆ·ç«¯èƒ½åŠ›ï¼ŸJSBridge åˆå§‹åŒ–éœ€è¦å¤šå°‘æ—¶é—´ï¼Ÿ</li><li>Faas å’Œæ™®é€šçš„åç«¯å·¥ç¨‹æœåŠ¡æœ‰ä»€ä¹ˆåŒºåˆ«å’Œç‰¹ç‚¹ï¼Ÿ</li><li>åŸå­æœåŠ¡ä¹‹é—´çš„è°ƒç”¨ä¼šæœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ</li><li>ä½ è‡ªå·±èµ·ä¸€ä¸ª Node åç«¯é¡¹ç›®ï¼Ÿéœ€è¦åšä»€ä¹ˆæ“ä½œèƒ½è®©å®ƒæ›´å¥½æ›´ç¨³å®šåœ°è¿è¡Œå‘¢ï¼Ÿ</li><li>ç®—æ³•é¢˜ LeetCode middle 122 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II</li><li>åé—®ç¯èŠ‚ã€æ–°äººåŸ¹å…»ã€ä¸šåŠ¡äº†è§£</li></ol><h2 id="9-7-WXG-æ¸¸æˆ-hc-ä¸è¶³æµç¨‹ç»“æŸ">9.7 WXG æ¸¸æˆ hc ä¸è¶³æµç¨‹ç»“æŸ</h2><h2 id="9-14-TEG-è…¾è®¯å¤§æ•°æ®ï¼ˆæ•°å¹³ï¼‰ä¸€é¢-40min">9.14 TEG è…¾è®¯å¤§æ•°æ®ï¼ˆæ•°å¹³ï¼‰ä¸€é¢ 40min</h2><ol start="0"><li>å­—èŠ‚å®ä¹ é¡¹ç›®ä»‹ç»ã€éš¾ç‚¹ã€äº®ç‚¹ã€æŒ‘æˆ˜</li><li>ä¼ä¸šé¡¹ç›®æ€§èƒ½å¦‚ä½•ï¼ŸFCPã€FMP å¦‚ä½•?æ˜¯å¦è¿›è¡Œäº†åˆ†åŒ…åŠ è½½ï¼ŸåŒ…ä½“ç§¯å¤§å°å¦‚ä½•ï¼Ÿ</li><li>Vue è·¯ç”±æ¨¡å¼æœ‰å‡ ç§ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li><li>Vue æœ€å¤§çš„ä¼˜ç‚¹å’Œç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</li><li>æœ‰å®æˆ˜è¿‡ React å—ï¼Ÿå’Œ Vue å¯¹æ¯”æœ‰ä»€ä¹ˆåŒºåˆ«å’Œä¼˜ç¼ºç‚¹ï¼Ÿ</li><li>Class ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li><li>React ç»„ä»¶é—´æ•°æ®ä¼ é€’æ–¹å¼</li><li>ç”¨è¿‡æ‰“åŒ…å·¥å…·å—ï¼Ÿä»‹ç»ä¸€ä¸‹ Webpack</li><li>ç”¨è¿‡å“ªäº› Loader å’Œ Pluginï¼Ÿ</li><li>Plugin çš„åŸç†å’Œç¼–å†™æ€è·¯æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</li><li>å‰ç«¯å¼‚å¸¸å’Œæ€§èƒ½ç›‘æ§æ€ä¹ˆåšï¼Ÿè®©ä½ è®¾è®¡ä¸€ä¸ªå¼‚å¸¸å’Œæ€§èƒ½ç›‘æ§å¹³å°ä½ ä¼šæ€ä¹ˆè®¾è®¡ï¼Ÿ</li><li>LocalStorge å’Œ cookie æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li><li>ES6 å®ç°æ’åºæœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ</li><li>äº†è§£ Set å—ï¼Ÿä»‹ç»ä¸€ä¸‹</li><li>è§£å†³è·¨åŸŸçš„æ–¹å¼æœ‰å“ªå‡ ç§ï¼Ÿåˆ†åˆ«æ˜¯ä»€ä¹ˆåŸç†å’Œå®ç°å½¢å¼ï¼Ÿ</li><li>æœ‰ç”¨è¿‡ä»£ç†å·¥å…·/æŠ“åŒ…å—ï¼Ÿ</li><li>ä¸ªäººèŒä¸šè§„åˆ’</li><li>ç”¨è¿‡ Node å—ï¼Ÿæœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ</li><li>å­—èŠ‚è½¬æ­£äº†å—ï¼Ÿä¼šå› ä¸ºä»€ä¹ˆé€‰æ‹©ä¸€å®¶å…¬å¸ï¼Ÿè€ƒè™‘å“ªäº›å› ç´ ï¼Ÿ</li><li>åé—®ç¯èŠ‚ã€ä¸šåŠ¡ä»‹ç»</li></ol><h2 id="9-15-TEG-è…¾è®¯å¤§æ•°æ®ï¼ˆæ•°å¹³ï¼‰äºŒé¢-60min-é€šè¿‡">9.15 TEG è…¾è®¯å¤§æ•°æ®ï¼ˆæ•°å¹³ï¼‰äºŒé¢ 60min é€šè¿‡</h2><ol start="0"><li><p>ç‰©è”ç½‘å·¥ç¨‹å’Œè®¡ç®—æœºæ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ</p></li><li><p>å¤§å­¦å­¦ä¹ äº†å“ªäº›è¯¾ç¨‹ï¼Ÿè®¡ç®—æœºç³»åˆ—è¯¾ç¨‹å­¦è¿‡å—ï¼Ÿ</p></li><li><p>ç®€å†ä¸Šå„ä¸ªé¡¹ç›®æŒ¨ä¸ªèŠ</p></li><li><p>æ•°ç»„å’Œé“¾è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«å’Œç‰¹ç‚¹</p></li><li><p>é“¾è¡¨æœ‰å¤šå°‘ç§ç±»å‹ï¼Ÿ</p></li><li><p>åŒå‘é“¾è¡¨çš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›?</p></li><li><p>ä¸€é“è´ªå¿ƒç®—æ³•é¢˜</p><p>æœ‰ 1ã€5ã€10ã€50ã€100 é¢å€¼ç¡¬å¸ï¼Œè¾“å…¥ä¸€ä¸ªé•¿åº¦ä¸º 5 çš„æ•°ç»„ï¼Œè¡¨ç¤ºæœ‰å¤šå°‘æšå¯¹åº”é¢å€¼çš„ç¡¬å¸ï¼Œå†è¾“å…¥ä¸€ä¸ªéœ€è¦å‡‘é½çš„æ•°å€¼ï¼Œè¾“å‡ºæœ€å°‘éœ€è¦å¤šå°‘æš</p></li><li><p>å¸¸è§çš„æ’åºç®—æ³•æœ‰å“ªäº›ï¼Ÿ</p></li><li><p>å¿«æ’çš„å®ç°æ€è·¯æ˜¯ï¼Ÿæ—¶é—´å¤æ‚åº¦æ˜¯ï¼Ÿå†’æ³¡å‘¢ï¼Ÿ</p></li><li><p>æœ‰ç”¨è¿‡å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿä»‹ç»ä¸€ä¸‹</p></li><li><p>å¸¸ç”¨ Vue çš„å“ªä¸ªç‰ˆæœ¬ï¼ŸnextTick æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿä»€ä¹ˆåŸç†ï¼ŸçŸ¥é“ process.nextTick å—ï¼Ÿ</p></li><li><p>Vue å¼‚æ­¥æ›´æ–°ä»‹ç»ä¸€ä¸‹</p></li><li><p>èŠæµè§ˆå™¨æ‰§è¡Œæœºåˆ¶ã€äº‹ä»¶å¾ªç¯ã€å¤šçº¿ç¨‹æ¶æ„</p></li><li><p>Vue æ€ä¹ˆå®ç°æ•°æ®åŒå‘ç»‘å®šå’Œè§†å›¾æ›´æ–°</p></li><li><p>æœ‰ç”¨è¿‡ ts å—ï¼Ÿæœ‰ä»€ä¹ˆå¥½å¤„å’Œç‰¹ç‚¹ï¼Ÿ</p></li><li><p>èŠå­—èŠ‚å®ä¹ é¡¹ç›®</p></li><li><p>èŠå°ç¨‹åº WebView é¢„åŠ è½½ã€çƒ­æ›´æ–°æœºåˆ¶</p></li><li><p>åé—®ç¯èŠ‚ã€ä¸šåŠ¡ä»‹ç»</p></li></ol><h2 id="9-23-TEG-è…¾è®¯å¤§æ•°æ®ï¼ˆæ•°å¹³ï¼‰GM-ä¸‰é¢-20min-é€šè¿‡">9.23 TEG è…¾è®¯å¤§æ•°æ®ï¼ˆæ•°å¹³ï¼‰GM ä¸‰é¢ 20min é€šè¿‡</h2><ol start="0"><li>æœ¬ç§‘æœŸé—´äº§å‡ºäº†å¾ˆå¤šè®ºæ–‡å’ŒçŸ¥è¯†äº§æƒï¼Ÿæ˜¯å¾ˆæ—©å°±å¼€å§‹åšäº†å—ï¼Ÿ</li><li>ä½ æ˜¯ä¸€ä¸ªå­¦éœ¸å—ï¼Ÿè¿˜æ˜¯å®è·µèƒ½åŠ›æ¯”è¾ƒå¼ºï¼Ÿ</li><li>èŠå­—èŠ‚å®ä¹ é¡¹ç›®å’Œå·¥ä½œ</li><li>èŠèŒä¸šè§„åˆ’ã€ä¸ªäººå‘å±•</li><li>ä¸ºä»€ä¹ˆæƒ³è½¬å…¨æ ˆï¼Ÿ</li><li>å»å­—èŠ‚å®ä¹ çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</li><li>å­—èŠ‚å¦‚ä½•è¯„ä¼°ä½ çš„å®ä¹ å·¥ä½œï¼Ÿ</li><li>ä½ å¦‚ä½•åšä½ çš„è¿°èŒç­”è¾©ï¼Ÿ</li><li>ä½ å¦‚ä½•è€ƒè™‘ä½ çš„æ ¡æ‹›å»å‘ï¼Œä¼šå› ä¸ºå“ªäº›å› ç´ é€‰æ‹©ä¸€å®¶å…¬å¸ï¼Ÿç›®å‰æ›´å€¾å‘å“ªå®¶å…¬å¸ï¼Ÿè¯´è¯´ä½ çš„æƒ³æ³•</li><li>ä½ è§‰å¾—è…¾è®¯å’Œå­—èŠ‚æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</li><li>åé—®ç¯èŠ‚</li></ol><h2 id="9-26-TEG-è…¾è®¯å¤§æ•°æ®ï¼ˆæ•°å¹³ï¼‰-HR-é¢-20min-é€šè¿‡">9.26 TEG è…¾è®¯å¤§æ•°æ®ï¼ˆæ•°å¹³ï¼‰ HR é¢ 20min é€šè¿‡</h2><ol start="0"><li>ä¸ºä»€ä¹ˆä¸è€ƒè™‘è€ƒç ”ï¼Ÿ</li><li>ä»‹ç»ä¸€ä¸‹è·å¾—å›½ä¸€ç­‰å¥–çš„é¡¹ç›®å’Œå‘æ˜ä¸“åˆ©</li><li>ä»‹ç»ä¸€ä¸‹å¼€æºé¡¹ç›®</li><li>ä½ è§‰å¾—å­—èŠ‚æ˜¯ä¸€å®¶ä»€ä¹ˆæ ·çš„å…¬å¸ï¼Ÿ</li><li>ä½ è§‰å¾—è…¾è®¯æ˜¯ä¸€å®¶ä»€ä¹ˆæ ·çš„å…¬å¸ï¼Ÿ</li><li>ä½ è§‰å¾— TEGï¼ˆæŠ€æœ¯å·¥ç¨‹äº‹ä¸šç¾¤ï¼‰çš„ä»·å€¼æ€ä¹ˆä½“ç°ï¼Ÿ</li><li>ä½ è§‰å¾—åŠ å…¥è…¾è®¯ TEG å·¥ä½œæœ‰ä»€ä¹ˆæŒ‘æˆ˜</li><li>ä¸ºä»€ä¹ˆæƒ³è½¬å…¨æ ˆï¼Ÿ</li><li>æ‰‹é‡Œè¿˜æœ‰å…¶ä»– offer å—ï¼Ÿæ€ä¹ˆè€ƒè™‘å’Œé€‰æ‹©</li><li>å“ªé‡Œäººï¼Ÿåç»­åœ¨å“ªä¸ªåŸå¸‚å‘å±•ï¼Ÿ</li><li>æœ‰æ— äº²å±åœ¨è…¾è®¯</li><li>åé—®ç¯èŠ‚</li></ol><h1>é˜¿é‡Œ</h1><h2 id="8-13-æ·˜ç³»ä¸€é¢-60min-é€šè¿‡">8.13 æ·˜ç³»ä¸€é¢ 60min é€šè¿‡</h2><blockquote><p>ä¸€é¢è€æ¿ç›´æ¥ä¸Šäº†æˆ‘æ˜¯æ²¡æƒ³åˆ°çš„</p></blockquote><ol start="0"><li><p>ä¸ºä»€ä¹ˆæƒ³æ¥é˜¿é‡Œï¼Ÿ</p></li><li><p>èŠä¸€ä¸‹ä½ è§‰å¾—åšå¾—æ¯”è¾ƒå¥½çš„é¡¹ç›®ï¼Œæœ‰ä»€ä¹ˆéš¾ç‚¹å’Œäº®ç‚¹ï¼Ÿ</p></li><li><p>èŠè´Ÿè½½å‡è¡¡å™¨é¡¹ç›®</p><ol start="0"><li>Node è¿›ç¨‹é—´é€šä¿¡æ–¹å¼æ˜¯æ€ä¹ˆå®ç°çš„?</li><li>Node å¤šè¿›ç¨‹æ¶æ„æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿæ€ä¹ˆç›‘å¬åŒä¸€ä¸ªç«¯å£</li><li>ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•çš„å®ç°åŸç†æ˜¯ï¼Ÿ</li><li>æœ€å°è¿æ¥æ•°ç®—æ³•çš„å®ç°æ–¹å¼æ˜¯ï¼Ÿ</li><li>ä»‹ç»ä¸€ä¸‹ ARP åè®®çš„ä½œç”¨</li><li>ä½ çš„è´Ÿè½½å‡è¡¡å™¨æœ‰ç”¨åˆ° ARP åº”ç”¨å—ï¼Ÿæ€ä¹ˆåº”ç”¨ï¼Ÿ</li></ol></li><li><p>èŠä¼ä¸šé¡¹ç›®äº®ç‚¹</p></li><li><p>è®²è®² Faas çš„ç†è§£ï¼Œä¼˜ç¼ºç‚¹</p></li><li><p>å°ç¨‹åºçš„æŠ€æœ¯æ¶æ„åŸç†æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</p></li><li><p>å°ç¨‹åºä¸ºä»€ä¹ˆè¦ä½¿ç”¨åŒçº¿ç¨‹+JSB çš„æ¶æ„ï¼Ÿ</p></li><li><p>Vue3 çš„ hooks åŸç†ï¼Ÿ</p></li><li><p>Vue3 æœ‰å“ªäº› hooks APIï¼Ÿ</p></li><li><p>è®²ä¸€è®² Webpack çš„åŸç†</p></li><li><p>åé—®ç¯èŠ‚</p></li></ol><h2 id="9-7-æ·˜ç³»-æ‹–äº†ä¸€ä¸ªæœˆå‘ŠçŸ¥-hc-ä¸è¶³â€¦">9.7 æ·˜ç³» æ‹–äº†ä¸€ä¸ªæœˆå‘ŠçŸ¥ hc ä¸è¶³â€¦</h2><h1>åä¸º</h1><h2 id="10-16-ä¸€é¢-60min-é€šè¿‡">10.16 ä¸€é¢ 60min é€šè¿‡</h2><ol start="0"><li><p>ç®—æ³•é¢˜</p><p>ç¢°æ’æ£€æµ‹ç®—æ³•ï¼Œç»™å®šä¸€ä¸ªæ•°ç»„è¡¨ç¤ºä¸€ç³»åˆ—è¡Œæ˜Ÿã€‚å¯¹äºæ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå…¶ç»å¯¹å€¼è¡¨ç¤ºè¡Œæ˜Ÿçš„å¤§å°ï¼Œæ­£è´Ÿè¡¨ç¤ºè¡Œæ˜Ÿç§»åŠ¨çš„æ–¹å‘ï¼ˆæ­£è¡¨ç¤ºå‘å³ç§»åŠ¨ï¼Œè´Ÿè¡¨ç¤ºå‘å·¦ç§»åŠ¨ï¼‰æ‰¾å‡ºç¢°æ’åå‰©ä¸‹çš„æ‰€æœ‰è¡Œæ˜Ÿã€‚ç¢°æ’è§„åˆ™ï¼šä¸¤ä¸ªè¡Œæ˜Ÿç›¸äº’ç¢°æ’ï¼Œè¾ƒå°çš„è¡Œæ˜Ÿä¼šçˆ†ç‚¸ã€‚å¦‚æœä¸¤é¢—è¡Œæ˜Ÿå¤§å°ç›¸åŒï¼Œåˆ™ä¸¤é¢—è¡Œæ˜Ÿéƒ½ä¼šçˆ†ç‚¸ã€‚ä¸¤é¢—ç§»åŠ¨æ–¹å‘ç›¸åŒçš„è¡Œæ˜Ÿæ°¸è¿œä¸ä¼šå‘ç”Ÿç¢°æ’</p><p>ç”¨ä¾‹ï¼š</p><p>[5, 10, -5] =&gt; [5,10]</p><p>[8, -8] =&gt; []</p><p>[10, 2, -5] =&gt; [10]</p><p>[-2, -1, 1, 2] =&gt; [-2, -1, 1, 2]</p></li><li><p>Vue å£°æ˜å‘¨æœŸæœ‰å“ªäº›</p></li><li><p>è®²ä¸€è®²ä»€ä¹ˆæ˜¯ MVC</p></li><li><p>Vue å’Œ React æœ‰ä»€ä¹ˆåŒºåˆ«</p></li><li><p>Vuex æœ‰å“ªäº›ä½¿ç”¨åœºæ™¯ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨ï¼ŸVuex çš„å®ç°åŸç†æ˜¯ï¼Ÿ</p></li><li><p>Vue çš„è·¯ç”±æ¨¡å¼æœ‰å“ªäº›ï¼ŸåŒºåˆ«å’Œå®ç°åŸç†æ˜¯ï¼Ÿ</p></li><li><p>ç‰©è”ç½‘åœºæ™¯ Web å’Œå¸¸è§„ Web åœºæ™¯æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p></li><li><p>HTTPS åŠ å¯†åŸç†æ˜¯ï¼Ÿ</p></li><li><p>è®²è®²ä½ åšçš„è´Ÿè½½å‡è¡¡å™¨</p></li><li><p>å°ç¨‹åºå’Œ h5 æœ‰å•¥åŒºåˆ«ï¼Ÿ</p></li><li><p>Uni-app çš„è½¬è¯‘åŸç†ä»‹ç»ä¸€ä¸‹</p></li><li><p>åé—®ç¯èŠ‚ã€ä¸šåŠ¡ä»‹ç»</p></li></ol><h2 id="10-16-äºŒé¢-45min-é€šè¿‡">10.16 äºŒé¢ 45min é€šè¿‡</h2><ol start="0"><li><p>ç®—æ³•é¢˜</p><p>ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢æœ‰ 6 ä¸ªæ•´æ•°ï¼Œæ±‚è¿™ä¸ªæ•°ç»„èƒ½å¤Ÿè¡¨ç¤ºçš„æœ€å¤§ 24 è¿›åˆ¶çš„æ—¶é—´æ˜¯å¤šå°‘ï¼Œè¾“å‡ºè¿™ä¸ªæ—¶é—´ï¼Œæ— æ³•è¡¨ç¤ºè¾“å‡º invalidã€‚</p><p>è¾“å…¥æè¿°:</p><p>è¾“å…¥ä¸ºä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œæ•°ç»„å†…æœ‰å…­ä¸ªæ•´æ•°ã€‚è¾“å…¥æ•°ç»„é•¿åº¦ä¸º 6ï¼Œä¸éœ€è¦è€ƒè™‘å…¶å®ƒé•¿åº¦ï¼Œå…ƒç´ å€¼ä¸º 0 æˆ–è€…æ­£æ•´æ•°ï¼Œ6 ä¸ªæ•°å­—æ¯ä¸ªæ•°å­—åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚</p><p>è¾“å‡ºæè¿°:</p><p>è¾“å‡ºä¸ºä¸€ä¸ª 24 è¿›åˆ¶æ ¼å¼çš„æ—¶é—´ï¼Œæˆ–è€…å­—ç¬¦ä¸²&quot;invalid&quot;ã€‚</p><p>å¤‡æ³¨:è¾“å‡ºæ—¶é—´æ ¼å¼ä¸º xx:xx:xx æ ¼å¼ã€‚</p><p>ç¤ºä¾‹ 1 è¾“å…¥[0,2,3,0,5,6]</p><p>è¾“å‡º 23:56:00</p><p>ç¤ºä¾‹ 2 è¾“å…¥[9,9,9,9,9,9]</p><p>è¾“å‡º invalid</p></li><li><p>ä»‹ç»çŸ¥è¯†äº§æƒï¼ˆå‘æ˜ä¸“åˆ©ã€å®ç”¨æ–°å‹ä¸“åˆ©ã€è½¯ä»¶è‘—ä½œæƒï¼‰ï¼Œå¦‚ä½•äº§å‡ºï¼Œå›¢é˜Ÿæ„æˆå’Œä¸ªäººè§’è‰²ã€‚</p></li><li><p>ä»‹ç»ä¸ªäººå›½å¥–é¡¹ç›®</p></li><li><p>å¤§å­¦å››å¹´çš„è§„åˆ’ã€ç»å†å’ŒèŒä¸šè§„åˆ’</p></li><li><p>å®ä¹ è¿‡ç¨‹ä¸­é‡åˆ°çš„æŠ€æœ¯éš¾ç‚¹ã€äº®ç‚¹</p></li><li><p>åé—®ç¯èŠ‚ã€ä¸šåŠ¡ä»‹ç»</p></li></ol><h2 id="10-24-ä¸‰é¢-40min-é€šè¿‡">10.24 ä¸‰é¢ 40min é€šè¿‡</h2><ol start="0"><li>è€ƒè™‘ç•™åœ¨å­—èŠ‚å—ï¼Ÿä»å“ªäº›æ–¹é¢è€ƒè™‘é€‰æ‹©ä¸€å®¶å…¬å¸ï¼Ÿ</li><li>è®²ä¸€è®²ä½ æ˜¯æ€ä¹ˆå­¦ä¹ å‰ç«¯å¼€å‘çš„ï¼Ÿé‡åˆ°è¿‡å“ªäº›éš¾ç‚¹ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿå­¦ä¹ å‘¨æœŸå¤šä¹…ï¼Ÿ</li><li>èŠå­—èŠ‚å®ä¹ é¡¹ç›®ã€å·¥ä½œã€äº§å‡º</li><li>å®ä¹ å·¥ä½œåˆä½œè¿‡ç¨‹ä¸­æœ‰é‡åˆ°ä»€ä¹ˆé—®é¢˜å—ï¼Ÿæ€ä¹ˆè§£å†³è¿™äº›é—®é¢˜ï¼Ÿ</li><li>åˆä½œè¿‡ç¨‹ä¸­çš„æ²Ÿé€šæ—¶é—´å æ¯”å¤šå°‘ï¼Ÿ</li><li>å®ä¹ å’Œå­¦ä¸šæ€ä¹ˆå¹³è¡¡çš„ï¼Ÿ</li><li>èŒä¸šè§„åˆ’æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</li><li>æ„å‘åŸå¸‚</li><li>åé—®ç¯èŠ‚</li></ol><h1>å¤§ç–†</h1><h2 id="8-1-ç¬”è¯•-90minï¼ˆ60min-å®Œæˆï¼‰é€šè¿‡">8.1 ç¬”è¯• 90minï¼ˆ60min å®Œæˆï¼‰é€šè¿‡</h2><p>3 å•é€‰</p><ol><li>ä»¥ä¸‹åˆ¤æ–­å•é“¾è¡¨æœ‰ç¯æ–¹æ³•é”™è¯¯çš„æ˜¯ æš´åŠ›ç©·ä¸¾ã€æ‰¾ç›¸åŒå°¾ç»“ç‚¹ã€å“ˆå¸Œç¼“å­˜ã€å¿«æ…¢æŒ‡é’ˆæ‰¾äº¤ç‚¹</li><li>æ ¹æ®å‰åºå’Œä¸­åºé€‰åç»­éå†çš„ç»“æœ</li><li>JavaScript è§£é‡Šå™¨è¿è¡Œåˆ°ä»€ä¹ˆé˜¶æ®µå¯ä»¥åˆ¤æ–­å‡ºä¸éœ€è¦è¿è¡Œ func2 è¯­æ³•è§£æã€è¯æ³•è§£æã€è¯­ä¹‰åˆ†æã€ç”Ÿæˆå­—èŠ‚ç </li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;å·²çŸ¥</span><br><span class="line">&#x2F;&#x2F;b.jsåŒ…å«å¦‚ä¸‹ä»£ç </span><br><span class="line">import &#123; func1 &#125; from &#39;.&#x2F;a&#39;</span><br><span class="line">&#x2F;&#x2F;a.jsåŒ…å«å¦‚ä¸‹ä»£ç </span><br><span class="line">export function func1()&#123;&#125;</span><br><span class="line">export function func2()&#123;&#125;</span><br></pre></td></tr></table></figure><p>6 å¤šé€‰</p><ol><li><p>ç©ºé—´å¤æ‚åº¦ä¸º Oï¼ˆ1ï¼‰çš„ç®—æ³•æœ‰ å½’å¹¶æ’åºã€å †æ’åºã€å†’æ³¡æ’åºã€å¿«é€Ÿæ’åº</p></li><li><p>å…³äº HTTP 1.0/1.1/2.0 è¯´æ³•æ­£ç¡®çš„äº‹</p><ol><li>HTTP1.0 æ¯æ¬¡è¯·æ±‚éœ€è¦å»ºç«‹ä¸€ä¸ª TCP è¿æ¥</li><li>HTTP/1.1 æ”¯æŒå¤šè·¯å¤ç”¨</li><li>HTTP/2.0 æ”¯æŒäºŒè¿›åˆ¶è§£æ</li><li>HTTP/2.0 æ”¯æŒæœåŠ¡ç«¯æ¨é€</li></ol></li><li><p>Chrome é‡‡ç”¨äº†å¤šè¿›ç¨‹æ¶æ„ï¼Œåˆ›å»ºå°‘é‡ tab æ—¶ä¼šå¯åŠ¨ç‹¬ç«‹çš„å·¥ä½œè¿›ç¨‹ï¼Œä»¥ä¸‹å…³äºçº¿ç¨‹ã€è¿›ç¨‹å¯¹æ¯”æè¿°æ­£ç¡®çš„æ˜¯</p><ol><li>è¿›ç¨‹å®‰å…¨æ€§æ›´é«˜ï¼Œtab å´©æºƒä¸ä¼šäº’ç›¸å½±å“</li><li>è¿›ç¨‹å¯åŠ¨æˆæœ¬æ›´ä½ï¼Œå¯ä»¥å¿«é€Ÿåˆ›å»º tab</li><li>è¿›ç¨‹é—´é€šä¿¡æ•ˆç‡æ›´é«˜ï¼Œæ›´å®¹æ˜“æ”¯æŒæ’ä»¶åŒ–</li><li>è¿›ç¨‹ç®¡ç†æ›´å®¹æ˜“ï¼Œtab ç‹¬ç«‹æ¸²æŸ“æ›´å¿«ã€‚</li></ol></li><li><p>å¯¹äº JS åŸå‹é“¾æè¿°æ­£ç¡®çš„æ˜¯</p><ol><li>ä»»ä½•ä¸€ä¸ªå‡½æ•°éƒ½æœ‰ prototype å±æ€§</li><li>ä»»ä½•ä¸€ä¸ªé null å¯¹è±¡éƒ½æœ‰****proto****å±æ€§ï¼Œç­‰åŒäº prototype</li><li>åŸå‹é“¾å±æ€§æŸ¥æ‰¾ä¼˜å…ˆçº§ä¸ºï¼šå®ä¾‹****proto___ &gt; å®ä¾‹æœ¬èº«</li><li>ä¸¥æ ¼æ¨¡å¼ä¸­ï¼Œå…¨å±€ä½œç”¨åŸŸ this ä¸º undefined</li></ol></li><li></li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">let a &#x3D; 2;</span><br><span class="line">function func() &#123;</span><br><span class="line"> Â let a &#x3D; 1;</span><br><span class="line"> Â return (b) &#x3D;&gt; &#123;</span><br><span class="line"> Â  Â return (c) &#x3D;&gt; &#123;</span><br><span class="line"> Â  Â  Â const ret &#x3D; a + b + c;</span><br><span class="line"> Â  Â  Â a *&#x3D; 2;</span><br><span class="line"> Â  Â  Â return ret;</span><br><span class="line"> Â   &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">let f1 &#x3D; func();</span><br><span class="line">let f2 &#x3D; func();</span><br><span class="line"></span><br><span class="line">console.log(func()(1)(2), func()(1)(2)); &#x2F;&#x2F; 4 4</span><br><span class="line"></span><br><span class="line">console.log(f1(1)(2), f2(1)(2)); &#x2F;&#x2F; 4 4</span><br><span class="line"></span><br><span class="line">console.log(f1(1)(2),f1(1)(2)); &#x2F;&#x2F; 4 4</span><br><span class="line"></span><br><span class="line">console.log(func()(1)(2), func()(1)(2)); &#x2F;&#x2F; 4 5</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><p>å¯¹äº Promiseã€asyncã€await æè¿°æ­£ç¡®çš„æ˜¯</p><ol><li>Promise ç”¨äºè§£å†³å›è°ƒåµŒå¥—è¿‡æ·±çš„é—®é¢˜</li><li>await å¯ä»¥ä»¥â€åŒæ­¥â€œçš„æ–¹å¼å®ç°å¼‚æ­¥çš„é€»è¾‘</li><li>Promise rejected çŠ¶æ€å¯ä»¥å˜ä¸º pending çŠ¶æ€</li><li>Promise æ‰§è¡Œè¿‡ç¨‹ä¸­å¯ä»¥å–æ¶ˆ</li></ol></li></ol><p>5 é—®ç­”</p><ol><li>EventLoop çœ‹ä»£ç å†™è¾“å‡º</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">new Promise((resolve) &#x3D;&gt; &#123;</span><br><span class="line"> Â console.log(1);</span><br><span class="line"> Â setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line"> Â  Â console.log(2);</span><br><span class="line"> Â  Â resolve();</span><br><span class="line">  &#125;, 0);</span><br><span class="line">&#125;).then(() &#x3D;&gt; &#123;</span><br><span class="line"> Â console.log(3);</span><br><span class="line">&#125;);</span><br><span class="line">â€‹</span><br><span class="line">console.log(4);</span><br><span class="line">â€‹</span><br><span class="line">setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line"> Â console.log(5);</span><br><span class="line">&#125;, 0);</span><br><span class="line">â€‹</span><br><span class="line">setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line"> Â console.log(6);</span><br><span class="line">&#125;, 1);</span><br></pre></td></tr></table></figure><ol start="2"><li>ç®€è¿°æµè§ˆå™¨çš„åƒåœ¾å›æ”¶æœºåˆ¶</li><li>ä»‹ç» Vue çš„åŒå‘ç»‘å®šå®ç°åŸç†åŠæµç¨‹</li><li></li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">enum WidgetType &#123;</span><br><span class="line"> Â Button,</span><br><span class="line"> Â Text,</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">class Widget &#123;</span><br><span class="line"> Â draw() &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">class WButton extends Widget &#123;</span><br><span class="line"> Â type: WidgetType &#x3D; WidgetType.Button;</span><br><span class="line"> Â draw() &#123;</span><br><span class="line"> Â  Â console.log(&quot;draw Button&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">class WText extends Widget &#123;</span><br><span class="line"> Â type: WidgetType &#x3D; WidgetType.Text;</span><br><span class="line"> Â draw() &#123;</span><br><span class="line"> Â  Â console.log(&quot;draw Text&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">class WButtonText&#123;</span><br><span class="line"> Â button: WButton</span><br><span class="line"> Â text: WText</span><br><span class="line"> Â constructor(button: WButton, text: WText) &#123;</span><br><span class="line"> Â  Â this.button &#x3D; button;</span><br><span class="line"> Â  Â this.text &#x3D; text;</span><br><span class="line">  &#125;</span><br><span class="line"> Â draw() &#123;</span><br><span class="line"> Â  Â this.button.draw();</span><br><span class="line"> Â  Â this.text.draw();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">function render() &#123;</span><br><span class="line"> Â let btext &#x3D; new WButtonText(new WButton(), new WText());</span><br><span class="line"> Â btext.draw();</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">&#x2F;*</span><br><span class="line">è¯·å°è¯•ä½¿ç”¨è®¾è®¡æ¨¡å¼æ”¹å†™ä»£ç ï¼Œä½¿å¾—renderä¸­å¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼è°ƒç”¨ï¼Œå¾—åˆ°ç›¸åŒçš„è¾“å‡º</span><br><span class="line">*&#x2F;</span><br><span class="line">â€‹</span><br><span class="line">function render() &#123;</span><br><span class="line"> Â let btext &#x3D; new WText(new WButton());</span><br><span class="line"> Â btext.draw();</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">â€‹</span><br></pre></td></tr></table></figure><ol start="2"><li>å®ç°ä¸€ä¸ªæœç´¢å™¨ï¼Œè¾“å…¥ä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œè°ƒç”¨æœç´¢å™¨çš„ next()æ–¹æ³•ï¼Œå°†è¿”å›äºŒå‰æ ‘ä¸­ä¸‹ä¸€ä¸ªæœ€å°çš„æ•°ï¼›è°ƒç”¨æœç´¢å™¨çš„ hasNext æ–¹æ³•ï¼Œå°†è¿”å›æ˜¯å¦å­˜åœ¨ä¸‹ä¸€ä¸ªæ•°ã€‚äºŒå‰æ ‘èŠ‚ç‚¹æ˜¯æ— éœ€æ•´æ•°</li></ol><p>é™„åŠ é¢˜ï¼š</p><blockquote><p>èƒ½ä¸èƒ½ç»™éå¯è§†åŒ–æ–¹å‘çš„åŒå­¦ä¸€ç‚¹æœºä¼šâ€¦</p></blockquote><ol><li>ï¼ˆå¯è§†åŒ–æ–¹å‘é™„åŠ é¢˜ï¼‰ç®€è¿° WebGL æ¸²æŸ“ç®¡çº¿</li><li>ï¼ˆå¯è§†åŒ–æ–¹å‘é™„åŠ é¢˜ï¼‰ç®€è¿°ä½ äº†è§£çš„ 3D åœºæ™¯ç®¡ç†æ•°æ®ç»“æ„åŠå…¶å®ç°åŸç†</li><li>ï¼ˆå¯è§†åŒ–æ–¹å‘é™„åŠ é¢˜ï¼‰åœ¨ WebGL 3D åœºæ™¯ä¸­ï¼Œè¦å®ç°ç‰©ä½“é˜´å½±æ•ˆæœï¼Œè¯·ç®€è¿°å®ç°åŸç†ã€‚å‡è®¾åœºæ™¯åŒºåŸŸå¾ˆå¤§ï¼Œè¦å¦‚ä½•ä¼˜åŒ–é˜´å½±æ•ˆæœã€‚</li></ol><h2 id="8-19-ä¸€é¢-60min-é€šè¿‡">8.19 ä¸€é¢ 60min é€šè¿‡</h2><ol><li>ä¸ºä»€ä¹ˆé€‰æ‹©æ¥å¤§ç–†ï¼Ÿä¸ç•™åœ¨å­—èŠ‚å—ï¼Ÿ</li><li>ä½ ä¼šå› ä¸ºä»€ä¹ˆå› ç´ é€‰æ‹©ä¸€å®¶å…¬å¸ï¼Ÿ</li><li>æœ‰å…¶ä»–å…¬å¸çš„ offer å—ï¼Ÿ</li><li>ä»‹ç»ä¸€ä¸‹ V8 åƒåœ¾å›æ”¶æœºåˆ¶ï¼Ÿ</li><li>çŸ¥é“ V8 åƒåœ¾å›æ”¶æœºåˆ¶å¯¹æ¯”ç¼–ç æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</li><li>ä»€ä¹ˆæƒ…å†µä¼šå‡ºç°å†…å­˜æ³„æ¼ï¼Ÿ</li><li>ä½ ç¼–ç æœ‰å‡ºç°è¿‡å†…å­˜æ³„æ¼æˆ–è€…æœ‰æ’æŸ¥è¿‡å—ï¼Ÿ</li><li>æ€ä¹ˆé˜²æ­¢å†…å­˜æ³„æ¼ï¼Ÿæ’æŸ¥è§£å†³æ²»æ ‡ä¸æ²»æœ¬</li><li>ç”¨çš„ä»€ä¹ˆæŠ€æœ¯æ ˆï¼Ÿæœ‰ç”¨è¿‡ TS å—ï¼Ÿ</li><li>ä»‹ç»ä¸€ä¸‹ä½ çš„å®ä¹ é¡¹ç›®ä¸šåŠ¡</li><li>é¡¹ç›®æœ‰ä»€ä¹ˆéš¾ç‚¹ï¼Ÿäº®ç‚¹ï¼Ÿ</li><li>å¤šä¸»é¢˜çš„å®ç°ä½ æœ‰è°ƒç ”è¿‡å…¶ä»–çš„è§£å†³æ–¹æ¡ˆå—ï¼Ÿè¿™ä¸ªéœ€æ±‚çš„èƒŒæ™¯æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸è°ƒç ”åˆ«çš„æ–¹æ¡ˆï¼Ÿä¸ºä»€ä¹ˆä¸å’Œç»„å†…åŒæ—¶è®¨è®ºï¼Ÿä¸ºä»€ä¹ˆæ²¡å»çœ‹ antd çš„æºç å®ç°ï¼Ÿ</li><li>ä½ çš„é¡¹ç›®é‡Œé¢æœ‰æ¶‰åŠåˆ°æƒé™ç­‰çº§ç³»ç»Ÿçš„è®¾è®¡å—ï¼Ÿ</li><li>è®©ä½ è®¾è®¡ä¸€ä¸ªçœå¸‚åŒºçš„çº§è”é€‰æ‹©å™¨ä½ ä¼šè€ƒè™‘å“ªäº›ç‚¹ï¼Ÿ</li><li>è¯´è¯´ä½ çš„å¼€æºé¡¹ç›®ï¼Ÿ</li><li>æœ‰ç”¨è¿‡å“ªäº› ES6 æ–°ç‰¹æ€§ï¼Œéƒ½è¯´ä¸€è¯´</li><li>ç®­å¤´å‡½æ•° this æŒ‡å‘å“ªé‡Œï¼Ÿåœ¨ä¸åŒçš„åœ°æ–¹æ‰§è¡Œ this æ‰§è¡Œä¼šæŒ‡å‘ä¸åŒå—ï¼Ÿ</li><li>const å’Œ let å¸¦æ¥äº†ä»€å¥½å¤„ï¼Ÿ</li><li>é™¤äº†å—çº§ä½œç”¨åŸŸè¿˜æœ‰ä»€ä¹ˆä½œç”¨åŸŸï¼Ÿ</li><li>è¿‡æ¸¡ä½¿ç”¨é—­åŒ…ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Ÿ</li><li>promise å‡ºç°ä»¥å‰æ˜¯æ€ä¹ˆå¤„ç†å¼‚æ­¥ç¼–ç¨‹çš„ï¼Ÿpromise æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿç¼–ç¨‹æ€è·¯å‘ç”Ÿäº†ä»€ä¹ˆè½¬å˜ï¼Ÿä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Ÿ</li><li>ä»å“ªé‡Œçœ‹åˆ°çš„å¤§ç–†æ‹›è˜ä¿¡æ¯ï¼Ÿäº†è§£å¤§ç–†æ˜¯æ€ä¹ˆæ ·çš„ä¸€ä¸ªä¼ä¸šï¼Ÿ</li><li>ä½ è§‰å¾—æ¥å¤§ç–†åšå‰ç«¯ä½ ä¼šåšå“ªäº›å·¥ä½œï¼Ÿ</li><li>â†‘ ä½ è§‰å¾—ä½ çš„æè¿°èƒ½å¤Ÿå¸å¼•äººå—ï¼Ÿ</li><li>ä¸šåŠ¡ä»‹ç»ã€åé—®ç¯èŠ‚</li></ol><h2 id="8-26-äºŒé¢-30min-é€šè¿‡">8.26 äºŒé¢ 30min é€šè¿‡</h2><ol><li>è®²ä¸€è®²ä½ è§‰å¾—æœ€èƒ½ä½“ç°ä½ æŠ€æœ¯æ°´å¹³çš„é¡¹ç›®</li><li>èŠå­—èŠ‚å®ä¹ å·¥ä½œã€é¡¹ç›®ã€è´Ÿè½½å‡è¡¡å™¨é¡¹ç›®</li><li>é€šè¿‡è¿™äº›é¡¹ç›® / å­—èŠ‚å®ä¹ ï¼Œä½ å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ</li><li>ä¸ªäººçš„èŒä¸šè§„åˆ’æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</li><li>åœºæ™¯è®¾è®¡ï¼Œå•äºº / å¤šäººäº†è§£ï¼Œå¦‚ä½•åšåŠ è§£å¯†å¯ä»¥åšåˆ°æœåŠ¡å™¨è¢«æ”»é™·ä¹Ÿä¸ä¼šæ³„æ¼èŠå¤©è®°å½•ï¼ŒåŠ è§£å¯†çš„æµç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</li><li>ä¸ºä»€ä¹ˆæƒ³æ¥å¤§ç–†ï¼Ÿæœ‰ç”¨è¿‡å¤§ç–†çš„äº§å“å—ï¼Ÿ</li><li>ä½ èƒ½æ€»ç»“ä¸€ä¸‹ä½ ä¸ªäººçš„ä¼˜ç¼ºç‚¹å—ï¼Ÿ</li><li>ä½ çš„ç¼ºç‚¹æœ‰ç»™ä½ å¸¦æ¥å›°æ‰°å’Œå½±å“å—ï¼Ÿ</li><li>ä½ å®ä¹ çš„åŒäº‹å¯¹ä½ è¯„ä»·æ€ä¹ˆæ ·ï¼Ÿ</li><li>ä¸è€ƒè™‘åœ¨å­—èŠ‚ç•™ç”¨å—ï¼Ÿ</li><li>ä½ çš„äº§å“æ€ç»´æ€ä¹ˆæ ·ï¼Ÿé€šè¿‡ä»€ä¹ˆäº‹æƒ…èƒ½å¤Ÿä½“ç°ï¼Ÿ</li><li>ä½ å¹³æ—¶æœ‰ä»€ä¹ˆçˆ±å¥½ï¼Ÿæ°´å¹³å¦‚ä½•ï¼Ÿ</li><li>åé—®ç¯èŠ‚ã€ä¸šåŠ¡ä»‹ç»</li></ol><h2 id="8-29-ä¸‰é¢-50min-é€šè¿‡">8.29 ä¸‰é¢ 50min é€šè¿‡</h2><ol><li>äº†è§£ä¼ä¸šå®ä¹ å·¥ä½œå’Œä¸šåŠ¡</li><li>æœ€è¿‘å›½å®¶çº¦è°ˆäº’è”ç½‘å¤§å‚å’Œåšå‡ºæ•´æ”¹ä½ æ€ä¹ˆçœ‹ï¼ŸåŠ¨æœºæ˜¯ä»€ä¹ˆï¼Ÿé¢å¯¹æ•´æ”¹ä½ ä»¬åšäº†ä»€ä¹ˆå·¥ä½œ?</li><li>ä¸ºä»€ä¹ˆæ˜¯å›½å®¶æ•´æ”¹è€Œä¸æ˜¯ä¼ä¸šä¸»åŠ¨å»åšï¼Ÿ</li><li>ä½ å¯¹æœªæ¥çš„èŒä¸šè§„åˆ’åŒ…æ‹¬é€‰æ‹©æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</li><li>ä½ ä¼šå› ä¸ºä»€ä¹ˆå»é€‰æ‹©ä¸€å®¶å…¬å¸ï¼Ÿä¸ºä»€ä¹ˆé€‰æ‹©å¤§ç–†ï¼Ÿ</li><li>ä½ è‡ªå·±åšçš„æœ€æ»¡æ„çš„ä¸€ä¸ªé¡¹ç›®æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹å’Œéš¾ç‚¹ï¼Ÿ</li><li>è‡ªå·±åšçš„é¡¹ç›®å’Œä¼ä¸šé¡¹ç›®çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿå®ä¹ æœ‰ä»€ä¹ˆæ”¶è·ï¼Ÿ</li><li>ä½ æ€ä¹ˆçœ‹å¾…å¤§ç–†ï¼Ÿå’Œäº’è”ç½‘ä¼ä¸šä¸å¤ªä¸€æ ·ï¼Œæœ‰ä»€ä¹ˆç‰¹åˆ«çš„æƒ³æ³•å—ï¼Ÿ</li><li>ä½ ä¹Ÿæœ‰æåˆ°æœ‰ç”¨è¿‡å¤§ç–†çš„äº§å“ï¼Œæ„Ÿè§‰ä½“éªŒæ€ä¹ˆæ ·ï¼Ÿæœ‰ä»€ä¹ˆåŠŸèƒ½å»ºè®®ç‚¹ï¼Ÿâ€¦è®¨è®ºå¤§ç–†äº§å“å’Œçˆ±å¥½</li><li>å¦‚æœå‘äº† offer è®©ä½ æ¥ï¼Ÿä½ è§‰å¾—ä½ éœ€è¦æå‰åšä»€ä¹ˆå‡†å¤‡ï¼Ÿ</li><li>ä½ æœ‰é‡åˆ°è¿‡æ¯”è¾ƒå¤§çš„æŒ«æŠ˜å’Œå›°éš¾å—ï¼Œæ˜¯æ€ä¹ˆé¢å¯¹çš„ï¼Ÿ</li><li>ä½ çš„äººç”Ÿç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿæœ€å¤§çš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆ?</li><li>æœ‰è¿‡è®©è‡ªå·±åæ‚”çš„å†³ç­–å—?</li><li>å­—èŠ‚å’Œå¤§ç–†éƒ½ç»™ä½  offer äº†ä½ ä¼šæ€ä¹ˆé€‰æ‹©å‘¢ï¼Ÿ</li><li>åé—®ç¯èŠ‚ã€ä¼ä¸šæ–‡åŒ–ä»·å€¼è§‚äº¤æµ</li></ol><h1>Shopee</h1><h2 id="7-19-æå‰æ‰¹ç¬”è¯•-120min-é€šè¿‡">7.19 æå‰æ‰¹ç¬”è¯• 120min é€šè¿‡</h2><ol start="0"><li><p>Symbol ç›¸å…³</p></li><li><p>Proxy ç›¸å…³</p></li><li><p>instance of ç›¸å…³</p></li><li><p>%ã€remã€vhã€px ç›¸å…³</p></li><li><p>liunx å»ºç«‹æ–°è¿›ç¨‹çš„å‘½ä»¤</p></li><li><p>çŠ¶æ€ç  504 çš„å«ä¹‰</p></li><li><p>å‰ç«¯å®‰å…¨ï¼ŒSQL æ³¨å…¥ã€XSS æ”»å‡»ã€CSRF æ”»å‡»ã€HTTPSã€CA ç›¸å…³</p></li><li><p>IPã€å­ç½‘æ©ç ç®—å¹¿æ’­åœ°å€</p></li><li><p>æ­£åˆ™ç›¸å…³ï¼Œé€‰ä¸€ä¸ªæ­£åˆ™ä¸èƒ½è¿›è¡Œçš„æ“ä½œ</p></li><li><p>é€‰ä¸€ä¸ªä¼šè§¦å‘é‡ç»˜ã€å›æµçš„æƒ…æ™¯</p></li><li><p>ä¸ç»™ cookie è®¾ç½®æœ‰æ•ˆæ—¶é—´ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸæ˜¯ï¼Ÿ</p></li><li><p>visualbilityï¼šhiddenã€displayï¼šnone æ˜¯å¦è§¦å‘é‡ç»˜å›æµ</p></li><li><p>ä½¿ç”¨è™šæ‹Ÿ DOM çš„å¥½å¤„</p></li><li><p>CSRF é˜²å¾¡æ–¹æ¡ˆ</p></li><li><p>å¯èƒ½è¢« XSS æ³¨å…¥çš„æ ‡ç­¾</p></li><li><p>position å®šä½ç±»å‹</p></li><li><p>CORS è§£å†³è·¨åŸŸè¯·æ±‚å¤´è®¾ç½® å¸¦ cookie</p></li><li><p>ç®—æ³•ï¼š</p><ol start="0"><li>æ‰¾å‡ºæœ€åä¸€ä¸ªåªå‡ºç°ä¸€ä¸ªçš„å­—ç¬¦</li><li>ACM çš„ä¸€é“é¢˜ ä»“åº“æ‹£è´§ï¼ŒäºŒç»´æ•°ç»„æ ‡è®°å‡ ä¸ªç‚¹ä¸ºè´§ç‰©ï¼Œç»è¿‡è´§ç‰©å››å‘¨å³ä¸ºæ‹£è´§æˆåŠŸã€‚ä»å…¥å£å¼€å§‹ï¼Œéœ€è¦è½¬å‘å‡ æ¬¡æ‰èƒ½æ‹£å®Œæ‰€æœ‰çš„è´§ã€‚</li><li>ç›¸äº¤æ•°ç»„ï¼Œæ‰¾å‡ºä¸¤ä¸ªæ•°ç»„é‡å¤çš„é¡¹</li></ol></li></ol><h2 id="7-25-æå‰æ‰¹ä¸€é¢-50min-é€šè¿‡">7.25 æå‰æ‰¹ä¸€é¢ 50min é€šè¿‡</h2><ol start="0"><li>é‡ç»˜é‡æ’åŠä¼˜åŒ–ç‚¹</li><li>CSS å®šä½æ–¹å¼æœ‰å“ªå‡ ç§ åˆ†åˆ«æœ‰ä»€ä¹ˆåŒºåˆ«</li><li>è™šæ‹Ÿ DOM çš„ä¼˜ç¼ºç‚¹</li><li>TCP è¿æ¥å¯é æ€§</li><li>TCP æ˜¯å¦æœ‰æ•°æ®æ ¡éªŒ</li><li>TCP æµé‡æ§åˆ¶ã€æ‹¥å¡æ§åˆ¶</li><li>Vue data ä¸ºä»€ä¹ˆæ˜¯ä¸ªå‡½æ•°</li><li>æ·±æ‹·è´ã€æµ…æ‹·è´ ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§æ¦‚å¿µ</li><li>JS åŸºæœ¬ç±»å‹ã€å¼•ç”¨ç±»å‹</li><li>V8 åƒåœ¾å›æ”¶æè¿°</li><li>äº‹ä»¶å§”æ‰˜ã€äº‹ä»¶ä»£ç†</li><li>ç®—æ³•ï¼šæ‹¬å·åŒ¹é…ã€äºŒå‰æ ‘åç»­éå†</li><li>åé—®ç¯èŠ‚</li></ol><h2 id="8-1-æå‰æ‰¹äºŒé¢-54min-é€šè¿‡">8.1 æå‰æ‰¹äºŒé¢ 54min é€šè¿‡</h2><ol start="0"><li>EventLoopï¼Œå†™è¾“å‡ºå’Œæ€è·¯</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line"> Â console.log(&quot;start&quot;);</span><br><span class="line">â€‹</span><br><span class="line"> Â Promise.resolve().then(() &#x3D;&gt; &#123;</span><br><span class="line"> Â  Â console.log(&quot;Promise1&quot;);</span><br><span class="line"> Â  Â setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line"> Â  Â  Â console.log(&quot;setTimeout2&quot;);</span><br><span class="line"> Â   &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">â€‹</span><br><span class="line"> Â setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line"> Â  Â console.log(&quot;setTimeout1&quot;);</span><br><span class="line"> Â  Â Promise.resolve().then(() &#x3D;&gt; &#123;</span><br><span class="line"> Â  Â  Â console.log(&quot;promise2&quot;);</span><br><span class="line"> Â   &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;, 0);</span><br><span class="line">â€‹</span><br><span class="line">console.log(&quot;end&quot;);</span><br></pre></td></tr></table></figure><ol start="2"><li>é—­åŒ…ã€å—çº§ä½œç”¨åŸŸï¼Œå†™è¾“å‡ºå’Œæ€è·¯</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var result &#x3D; [],</span><br><span class="line"> Â a &#x3D; 3;</span><br><span class="line">var total &#x3D; 0;</span><br><span class="line">function foo(a) &#123;</span><br><span class="line"> Â var i &#x3D; 0;</span><br><span class="line"> Â for (; i &lt; 3; i++) &#123;</span><br><span class="line"> Â  Â result[i] &#x3D; function () &#123;</span><br><span class="line"> Â  Â  Â total +&#x3D; i * a;</span><br><span class="line"> Â  Â  Â console.log(total);</span><br><span class="line"> Â   &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">foo(1);</span><br><span class="line">result[0]();</span><br><span class="line">result[1]();</span><br><span class="line">result[2]();</span><br></pre></td></tr></table></figure><ol start="3"><li>æ‰‹æ’•é˜²æŠ–ï¼Œæ”¯æŒç«‹å³æ‰§è¡Œ</li><li>å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼ŒèŠäº†é™æ€èµ„æºä¸Š cdnï¼ŒHTTP ç¼“å­˜ï¼Œæ¥å£èšåˆï¼Œéª¨æ¶å±/loadingï¼ŒDNS é¢„è§£æï¼Œpreloadï¼Œprefetchï¼Œwebpack ä¼˜åŒ–ï¼šCompressã€Tenserã€HMRã€å¤šçº¿ç¨‹æ‰“åŒ…ã€å¼€å¯ç¼“å­˜ã€DLL</li><li>å®ç°ä¸€ä¸ªç»„ä»¶ï¼Œæ— é™æ»šåŠ¨ï¼Œè¦æ±‚åˆ·æ–°æ€§èƒ½å°½å¯èƒ½åœ°å¥½ï¼ŒèŠäº†è™šæ‹Ÿåˆ—è¡¨å›ºå®šå¤§å°å’Œä¸å›ºå®šå¤§å°åˆ†åˆ«æ€ä¹ˆå®ç°</li><li>èŠå®ä¹ é¡¹ç›®ã€äº®ç‚¹ã€é‡åˆ°é—®é¢˜ã€æ€ä¹ˆè§£å†³</li><li>ES6 - æœ€æ–°ç‰ˆæœ¬æœ‰ä»€ä¹ˆæ–°ç‰¹æ€§</li><li>Vite äº†è§£å—ï¼ŒèŠä¸€èŠï¼Œå’Œ webpack æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¸ºä»€ä¹ˆæ¯” webpack å¿«</li><li>åé—®ç¯èŠ‚</li></ol><h2 id="8-4-æå‰æ‰¹-HR-é¢-20min-é€šè¿‡">8.4 æå‰æ‰¹ HR é¢ 20min é€šè¿‡</h2><ol start="0"><li>è‡ªæˆ‘ä»‹ç»</li><li>å­—èŠ‚å®ä¹ å·¥ä½œå†…å®¹</li><li>åšé¡¹ç›®é‡åˆ°ä»€ä¹ˆé—®é¢˜ï¼Œæ€ä¹ˆè§£å†³çš„ï¼Ÿ</li><li>ä¼šå› ä¸ºä»€ä¹ˆé€‰æ‹©ä¸€ä¸ªå…¬å¸ï¼Ÿä¸šåŠ¡ï¼Ÿè–ªé…¬ï¼Ÿå¤§å‚èƒŒæ™¯ï¼Ÿ</li><li>å¯¹ä»€ä¹ˆä¸šåŠ¡æ¯”è¾ƒæ„Ÿå…´è¶£å‘¢ï¼Ÿ</li><li>ç”¨ä¸‰ä¸ªè¯å½¢å®¹è‡ªå·±</li><li>èŒä¸šè§„åˆ’ï¼Œæœ‰è€ƒè™‘è€ƒç ”å—ï¼Ÿ</li><li>è‡ªèº«æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</li><li>æ‰‹å¤´è¿˜æœ‰ä»€ä¹ˆ offerï¼Ÿ</li><li>æœ‰ä»€ä¹ˆå…´è¶£ã€çˆ±å¥½ï¼Ÿ</li></ol><h1>ç™¾åº¦</h1><h2 id="8-19-æå‰æ‰¹ä¸€é¢-80min-é€šè¿‡">8.19 æå‰æ‰¹ä¸€é¢ 80min é€šè¿‡</h2><ol><li><p>ä»‹ç»ä¼ä¸šå®ä¹ é¡¹ç›®</p></li><li><p>é¡¹ç›®å¹¶å‘é‡çº§è¿™ä¹ˆå¤§ï¼Œæ˜¯æ€ä¹ˆæ‰¿å—é«˜å¹¶å‘çš„ï¼Ÿæ€ä¹ˆæ›´æ–°ç‰ˆæœ¬ï¼Ÿ</p></li><li><p>å‰ç«¯å±‚é¢æ€ä¹ˆè®¾è®¡å¯ä»¥å‡è½»æœåŠ¡ç«¯å‹åŠ›ï¼Œæ‰¿å—é«˜å¹¶å‘ï¼Ÿ</p></li><li><p>ä»‹ç»ä¸€ä¸‹ HTTP ç¼“å­˜</p></li><li><p>CDN æœ‰ä»€ä¹ˆå¥½å¤„ï¼ŸåŸç†å‘¢ï¼Ÿ</p></li><li><p>ç¦»çº¿åŒ…æœ‰äº†è§£è¿‡å—ï¼Ÿ</p></li><li><p>ä½ çš„ safeRouter æ˜¯æ€ä¹ˆå°è£…çš„ï¼Ÿæ€ä¹ˆåšçš„ï¼Ÿ</p></li><li><p>VueRouter çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p></li><li><p>ä¸ªäººé¡¹ç›®çš„æƒé™ç³»ç»Ÿæ˜¯æ€ä¹ˆè®¾è®¡çš„ï¼Ÿå¦‚æœæ›´å¤æ‚çš„æƒé™ç³»ç»Ÿä½ ä¼šæ€ä¹ˆè®¾è®¡ï¼Ÿ</p></li><li><p>å°è£…ä¸€ä¸ªé€šç”¨çš„æ ¹æ®æƒé™æ¸²æŸ“ä¸åŒå†…å®¹çš„ç»„ä»¶ä½ ä¼šæ€ä¹ˆè®¾è®¡ï¼Ÿ</p></li><li><p>æµè§ˆå™¨çš„æ—¶é—´å¾ªç¯æœºåˆ¶æè¿°ä¸€ä¸‹ï¼Ÿ</p></li><li><p>Node äº‹ä»¶å¾ªç¯å’Œæµè§ˆå™¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p></li><li><p>éå†ä¸€ä¸ªå¯¹è±¡æœ‰ä»€ä¹ˆå½¢å¼ï¼Ÿ</p></li><li><p>for in æœ‰ä»€ä¹ˆç¼ºé™·ï¼Ÿæ€ä¹ˆé¿å…ï¼Ÿ</p></li><li><p>for of å¯ä»¥éå†å¯¹è±¡å—ï¼Ÿæ€ä¹ˆè®©å®ƒèƒ½éå†</p></li><li><p>v-model çš„åŸç†</p></li><li><p>æ€ä¹ˆå®ç°å¤šä¸ªä½ç½®ç»‘å®šåŒä¸€ä¸ª v-modelï¼Ÿ</p></li><li><p>vue ç»„ä»¶ä¼ å€¼æœ‰å“ªäº›æ–¹å¼ï¼Ÿå°½å¯èƒ½å¤šåœ°è¯´</p></li><li><p>å·¥ç¨‹åŒ–äº†è§£è¿‡å—ï¼ŸWebpack çš„ Loader å’Œ Plugin æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p></li><li><p>Plugin å¯ä»¥å®ç° Loader çš„åŠŸèƒ½å—ï¼Ÿ</p></li><li><p>æ‹†åŒ…æœ‰äº†è§£è¿‡å—ï¼Ÿè·¯ç”±æ‡’åŠ è½½æœ‰äº†è§£è¿‡å—ï¼Ÿè®²ä¸€è®²</p></li><li><p>è®²ä¸€è®²ä½ äº†è§£çš„æ•°æ®ç»“æ„</p></li><li><p>é“¾è¡¨çš„å¤´æ’æ³•ã€æŸ¥è¯¢ã€æœ‰åºæ’å…¥æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ</p></li><li><p>äºŒå‰æ ‘çš„æŸ¥è¯¢å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ</p></li><li><p>å¿«æ’çš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ</p></li><li><p>ç®—æ³•</p><ol><li><p>æ•°ç»„å»é‡</p><ol><li>set</li><li>æ‰‹åŠ¨</li></ol></li><li><p>çˆ¬æ¥¼æ¢¯</p><ol><li>è¿­ä»£</li><li>é€’å½’</li><li>ç¼“å­˜ + é€’å½’</li></ol></li></ol></li><li><p>åé—®ç¯èŠ‚ã€ä¸šåŠ¡ä»‹ç»</p></li></ol><h2 id="8-21-æå‰æ‰¹äºŒé¢-80min-é€šè¿‡">8.21 æå‰æ‰¹äºŒé¢ 80min é€šè¿‡</h2><ol><li><p>èŠå¼€æºé¡¹ç›®</p></li><li><p>èŠä¼ä¸šå®ä¹ é¡¹ç›®</p></li><li><p>é¡¹ç›®æœ‰ä»€ä¹ˆéš¾ç‚¹ï¼Ÿäº®ç‚¹ï¼Ÿ</p></li><li><p>å®ä¹ æœ‰ä»€ä¹ˆæ”¶è·ï¼Ÿ</p></li><li><p>å®ç°ä¸€ä¸ª repeat å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²é‡å¤å¤šå°‘æ¬¡åè¿”å›ï¼Œä¾‹å¦‚ repeat(â€˜strâ€™,2)è¿”å› strstr</p><ol><li>å®ç°è¿™ä¸ªå‡½æ•°ä½ è¦è€ƒè™‘ä»€ä¹ˆé—®é¢˜ï¼Ÿ</li><li>ä¸€ä¸ªå­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦æ˜¯å¤šå°‘ï¼Ÿ</li><li>é™¤äº†é—®äººï¼Œå¯ä»¥æŸ¥æ–‡æ¡£ç­‰å„ç§æ–¹å¼å»æŸ¥ã€å†™ä»£ç å»éªŒè¯ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿï¼ˆç¬¬äºŒä¸ªé—®é¢˜ï¼‰</li><li>MDN æ–‡æ¡£ä¸­æ–‡ç‰ˆå’Œè‹±æ–‡ç‰ˆæœ‰ä»€ä¹ˆä¸ä¸€æ ·å—ï¼Ÿå¯ä»¥çœ‹ä¸€çœ‹</li><li>ä½ ç°åœ¨å†™çš„æ˜¯è¿­ä»£çš„æ–¹å¼ï¼Œä½ å¯ä»¥æ”¹æˆé€’å½’çš„æ–¹å¼å—ï¼Ÿ</li><li>ä½ ä¸€èˆ¬æ€ä¹ˆå¯¹ä»£ç è¿›è¡Œ debugï¼Ÿ</li><li>ä½ ç°åœ¨çš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿå¯ä»¥ä¼˜åŒ–å—ï¼Ÿ</li><li>okï¼Œä¼˜åŒ–åˆ° logn äº†ï¼Œlogn çš„è¿­ä»£å½¢å¼è¦æ€ä¹ˆæ”¹å‘¢ï¼Ÿ</li></ol></li><li><p>åé—®ç¯èŠ‚ã€ä¸šåŠ¡äº†è§£</p></li></ol><h2 id="8-24-æå‰æ‰¹ä¸‰é¢-30min-é€šè¿‡">8.24 æå‰æ‰¹ä¸‰é¢ 30min é€šè¿‡</h2><ol><li><p>åœ¨å­—èŠ‚è½¬æ­£äº†å—ï¼Ÿ</p></li><li><p>åç»­èŒä¸šè§„åˆ’æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿè€ƒè™‘è€ƒç ”å—ï¼Ÿ</p></li><li><p>èŠå­—èŠ‚å®ä¹ é¡¹ç›®</p></li><li><p>å®ä¹ æœ‰å“ªäº›æˆé•¿ï¼Ÿ</p></li><li><p>æˆ‘çœ‹ä½ å­¦çš„æ˜¯ç‰©è”ç½‘ï¼Œè¿˜è·å¾—äº†ä¸å°‘å¥–é¡¹å’ŒçŸ¥è¯†äº§æƒï¼Œä¸ºä»€ä¹ˆé€‰æ‹©åšå‰ç«¯å‘¢ï¼Ÿ</p></li><li><p>ä½ ä¼šå› ä¸ºå“ªäº›å› ç´ é€‰æ‹©ä¸€å®¶å…¬å¸ï¼Ÿ</p></li><li><p>åç»­è€ƒè™‘åœ¨æ·±åœ³å‘å±•å—ï¼Ÿ</p></li><li><p>ç®—æ³•è®¾è®¡</p><p>1000 æ”¯ç–«è‹—ï¼Œæœ‰ä¸€æ”¯å˜è´¨äº†ï¼Œå¯ä»¥é€šè¿‡è¯•çº¸æ£€æµ‹ï¼Œååº”æ—¶é—´éœ€è¦ä¸€å°æ—¶ï¼Œå¦‚ä½•åœ¨ä¸€å°æ—¶ç”¨å°½å¯èƒ½å°‘çš„è¯•çº¸æ‰¾åˆ°å˜è´¨çš„ç–«è‹—ã€‚ä¸€å¼ è¯•çº¸å¯ä»¥æ»´å¤šæ”¯ç–«è‹—ï¼Œä¸€æ”¯ç–«è‹—ä¹Ÿå¯ä»¥æ»´åœ¨å¤šå¼ è¯•çº¸ã€‚</p><ol><li>å°†ç–«è‹—å˜æˆ m _ n çŸ©é˜µï¼Œm _ n = 1000ï¼Œ m + n å°½é‡å°ï¼Œéœ€ m + n å¼ ï¼ˆmn å¯¹åº”è¡Œåˆ—ï¼‰</li><li>å°†ç–«è‹—è¿›è¡ŒäºŒè¿›åˆ¶ç¼–å·ï¼Œä½¿ç”¨ 10 å¼ è¯•çº¸ï¼Œå¯¹åº”ä½ä¸º 1 åˆ™æ»´ï¼Œä¸ä¸º 1 åˆ™ä¸æ»´ï¼Œé€šè¿‡å˜çº¢çš„è¯•çº¸åæ¨ç¼–å·ã€‚</li></ol></li><li><p>åé—®ç¯èŠ‚</p></li></ol><h1>æ»´æ»´</h1><h2 id="7-31-æå‰æ‰¹ä¸€é¢-70min-é€šè¿‡">7.31 æå‰æ‰¹ä¸€é¢ 70min é€šè¿‡</h2><ol><li>èŠè´Ÿè½½å‡è¡¡å™¨ å®ç°ã€ç®—æ³•ï¼ˆä¸ªäººé¡¹ç›®ï¼‰</li><li>Node è¿›ç¨‹é—´é€šä¿¡å®ç°ï¼Œå…¶ä»–è¿›ç¨‹é—´é€šä¿¡æ–¹å¼</li><li>å®ä¹ é¡¹ç›®ä»‹ç»ï¼Œä¸šåŠ¡ç†è§£ï¼Œäº®ç‚¹</li><li>Express å’Œ Koa çš„åŒºåˆ«ï¼Œä¸­é—´ä»¶çš„å®ç°æ–¹å¼ compose</li><li>å®ç°ä¸€ä¸ª compose</li><li>compose å‡½æ•°çœ‹ä»£ç å†™è¾“å‡º å¸¦ try catch å’ŒæŠ›é”™</li><li>è®²è®²å¯¹ webpack çš„ç†è§£</li><li>vue2 å’Œ vue3 çš„åŒºåˆ«</li><li>vue ç»„ä»¶ä¼ å€¼$attr</li><li>Vue çš„æ’æ§½æœ‰å“ªå‡ ç§ç±»å‹ï¼Œåˆ†åˆ«æœ‰ä»€ä¹ˆåŒºåˆ«</li><li>æ‰‹æ’•æœ€é•¿å…¬å…±å­ä¸² LeetCode 1143 middle</li><li>æ‰‹æ’•æ·±æ‹·è´</li><li>åˆ¤æ–­æ•°æ®ç±»å‹çš„æ–¹æ³•</li><li>æ‰‹æ’•å‘å¸ƒè®¢é˜…æ¨¡å¼</li><li>åé—®ç¯èŠ‚</li></ol><h2 id="7-31-æå‰æ‰¹äºŒé¢-70min-é€šè¿‡">7.31 æå‰æ‰¹äºŒé¢ 70min é€šè¿‡</h2><ol><li>å°½å¯èƒ½å¤šçš„å†™å‡º div ä¸­ img å‚ç›´æ°´å¹³å±…ä¸­çš„æ–¹æ³•ã€‚è¦æ±‚è‡³å°‘æœ‰ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ flex å¸ƒå±€ã€‚å…¶ä¸­ div å®½é«˜ 300pxï¼Œimg å®½é«˜ 100px</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line"> Â &lt;img &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>ç”»ä¸€æ¡ 0.5px çš„çº¿</li><li>å®ä»»åŠ¡ã€å¾®ä»»åŠ¡ã€EventLoop</li><li>çœ‹ä»£ç å†™è¾“å‡º</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line"> Â console.log(100)</span><br><span class="line">&#125;)</span><br><span class="line">console.log(200)</span><br><span class="line">Promise.resolve().then(() &#x3D;&gt; &#123;</span><br><span class="line"> Â console.log(300)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="4"><li>å°½å¯èƒ½å¤šçš„å†™å‡ºæ•°ç»„å»é‡çš„æ–¹æ³•</li><li>å†™ä¸€ä¸ªæ¯éš”ä¸€ç§’è¾“å‡º 0ã€1ã€2ã€3ã€4ã€5 çš„æ–¹æ³•</li><li><strong>var const let</strong> å—çº§ä½œç”¨åŸŸ</li><li>å†™å‡º console çš„ç»“æœ</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var f &#x3D; (function() &#123;</span><br><span class="line"> Â var c &#x3D; &quot;c&quot;;</span><br><span class="line"> Â return &#123;</span><br><span class="line"> Â  Â a: function() &#123;</span><br><span class="line"> Â  Â  Â return c;</span><br><span class="line"> Â   &#125;,</span><br><span class="line"> Â  Â b: function(d) &#123;</span><br><span class="line"> Â  Â  Â c &#x3D; d;</span><br><span class="line"> Â   &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)()</span><br><span class="line">console.warn(f.a())</span><br><span class="line">console.warn(f.c)</span><br><span class="line">console.warn(f.b(&quot;d&quot;))</span><br><span class="line">console.warn(f.a())</span><br></pre></td></tr></table></figure><ol start="7"><li>é—­åŒ…</li><li>ä»»é€‰ä¸€ç§æ’åºæ–¹æ³•è¿›è¡Œå®ç°</li><li>æµè§ˆå™¨ url ä»è¾“å…¥åˆ°æ˜¾ç¤ºå‡ºé¡µé¢çš„æµç¨‹ï¼ˆå¸¦ç¼“å­˜ï¼‰</li><li>å¼ºç¼“å­˜ã€åå•†ç¼“å­˜</li><li>link æ ‡ç­¾å¼•å…¥ css ä¼šé˜»å¡ dom æ¸²æŸ“å˜›</li><li>async å’Œ defer çš„åŒºåˆ«</li><li>node EventLoop å’Œæµè§ˆå™¨æœ‰ä»€ä¹ˆåŒºåˆ«</li><li>è¿›ç¨‹é—´é€šä¿¡ domain socket å…·ä½“å®ç°æµç¨‹</li><li>ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°æœ‰ä»€ä¹ˆåŒºåˆ«</li><li>å°ç¨‹åºçš„è¿è¡Œæœºåˆ¶ï¼ˆåŒçº¿ç¨‹ã€JSB ç›¸å…³ï¼‰</li><li>redis æ€ä¹ˆå®ç°åˆ†å¸ƒå¼é”</li><li>ä½ è®¤ä¸ºè‡ªå·±çš„å®šä½æ˜¯æ€ä¹ˆæ ·çš„ æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹</li><li>ä½ è®¤ä¸ºåˆ«äººçœ¼ä¸­çš„ä½ æ˜¯æ€ä¹ˆæ ·çš„</li><li>åé—®ç¯èŠ‚</li></ol><h2 id="7-31-æå‰æ‰¹ä¸‰é¢-70min-é€šè¿‡">7.31 æå‰æ‰¹ä¸‰é¢ 70min é€šè¿‡</h2><ol><li>è‡ªæˆ‘ä»‹ç»çˆ±å¥½ã€ç‰¹é•¿ã€ç‰¹ç‚¹ã€äº®ç‚¹ã€ä¸ªäººå®šä½</li><li>å¤§å­¦ä¸­çš„æˆé•¿å†ç¨‹ã€æ€ä¹ˆæ¥è§¦æŠ€æœ¯ã€å­¦ä¹ å’Œå‘å±•å†ç¨‹</li><li>å®ä¹ é¡¹ç›®å’Œåšçš„äº‹æƒ…</li><li>æœªæ¥ä¸ªäººèŒä¸šè§„åˆ’</li><li>èŠè´Ÿè½½å‡è¡¡å™¨é¡¹ç›®ï¼ˆä¸ªäººé¡¹ç›®ï¼‰</li><li>ä¸ºä»€ä¹ˆä¼šå»åšæŠ€æœ¯åˆ†äº«ã€ç›®çš„ã€æ€ä¹ˆé€‰é¢˜ï¼ˆå­—èŠ‚éƒ¨é—¨æŠ€æœ¯åˆ†äº«ï¼‰</li><li>å†è®©ä½ åšæŠ€æœ¯åˆ†äº«ä½ ä¼šé€‰ä»€ä¹ˆé¢˜ç›®</li><li>å¤§å­¦é‡Œæœ€æœ‰æˆå°±æ„Ÿçš„äº‹æƒ…ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</li><li>ç®€å†ä¸Šå…­ä¸ªé¡¹ç›®æŒ¨ä¸ªèŠ</li><li>ç‰©è”ç½‘å·¥ç¨‹ä¸“ä¸šå’Œè®¡ç®—æœºçš„å…³ç³»å’ŒåŒºåˆ«</li><li>é™¤äº†å‰ç«¯è¿˜æœ‰æ²¡æœ‰å­¦è¿‡åˆ«çš„æ–¹å‘çš„æŠ€æœ¯</li><li>æœ€æ“…é•¿çš„ä¸“ä¸šè¯¾æ˜¯ä»€ä¹ˆ</li><li>ä½ æ€ä¹ˆç»™ä¸€ä¸ªéä¸“ä¸šçš„äººä»‹ç»è®¡ç®—æœºç½‘ç»œ</li><li>è®¡ç®—æœºç½‘ç»œä¸ºä»€ä¹ˆè¦åˆ†å±‚</li><li>ä½ çš„æ•°æ®ç»“æ„å’Œç®—æ³•æ€ä¹ˆæ · æœ‰æ²¡æœ‰åˆ·é¢˜</li><li>dp äº†è§£å— è®²ä¸€è®²</li><li>å†™é“é¢˜å§ å¯¹è±¡çš„ key å…¨éƒ¨é©¼å³°è½¬ä¸‹åˆ’çº¿ è¦æ±‚é€’å½’ å¯é™åˆ¶æ·±åº¦ dfs å’Œ bfs åˆ†åˆ«æ€ä¹ˆå®ç°</li><li>åé—®ç¯èŠ‚</li></ol><h1>ç¾å›¢</h1><h2 id="8-16-ä¸€é¢-70min-é€šè¿‡">8.16 ä¸€é¢ 70min é€šè¿‡</h2><ol><li>çœ‹ä»£ç å†™è¾“å‡º</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var name &#x3D; &quot;windowsName&quot;;</span><br><span class="line">var a &#x3D; &#123;</span><br><span class="line"> Â name:&quot;Cherry&quot;,</span><br><span class="line"> Â </span><br><span class="line"> Â func1:function()&#123;</span><br><span class="line"> Â  Â console.log(this.name);</span><br><span class="line">  &#125;</span><br><span class="line"> Â </span><br><span class="line"> Â func2:function()&#123;</span><br><span class="line"> Â  Â setTimeout(function()&#123;</span><br><span class="line"> Â  Â  Â this.func1();</span><br><span class="line"> Â   &#125;, 100)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">a.func2();</span><br></pre></td></tr></table></figure><ol start="2"><li>è¯´è¯´å¯¹é—­åŒ…çš„ç†è§£ï¼Œæœ‰å“ªäº›åº”ç”¨åœºæ™¯</li><li>å®ç°ä¸€ä¸ªæ–¹æ³•</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">f(a) -&gt; [a]</span><br><span class="line">f(b) -&gt; [a, b]</span><br><span class="line">f(c) -&gt; [a, b, c]</span><br></pre></td></tr></table></figure><ol start="4"><li>çœ‹ä»£ç å†™è¾“å‡º</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const list &#x3D; [1, 2, 3];</span><br><span class="line">const square &#x3D; num &#x3D;&gt; &#123;</span><br><span class="line"> Â return new Promise((resolve, reject) &#x3D;&gt; &#123;</span><br><span class="line"> Â  Â setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line"> Â  Â  Â resolve(num * num);</span><br><span class="line"> Â   &#125;, 3000)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">function test()&#123;</span><br><span class="line"> Â list.forEach(async x&#x3D;&gt;&#123;</span><br><span class="line"> Â  Â const res &#x3D; await square(x);</span><br><span class="line"> Â  Â console.log(res);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">test();</span><br></pre></td></tr></table></figure><ol start="5"><li>new çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆ</li><li>è¯´ä¸€ä¸‹ Promise çš„åº”ç”¨</li><li>async await æ˜¯ä»€ä¹ˆçš„è¯­æ³•ç³–</li><li>Promise æœ‰å“ªäº›çŠ¶æ€ï¼Œå¯é€†å—ï¼Ÿ</li><li>è®²è®² Vue çš„åŒå‘ç»‘å®šåŸç†</li><li>æ•°ç»„çš„åŒå‘ç»‘å®šç›¸å…³ï¼ŒVue2 ç›´æ¥æ›´æ–°æ•°ç»„æŸé¡¹ä¼šè¿›è¡Œè§†å›¾æ›´æ–°å—ï¼Ÿ</li><li>äº†è§£è·¨åŸŸå—ï¼Ÿè®²ä¸€è®²æœ‰å“ªå‡ ç§æ–¹å¼</li><li>TCP ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹ï¼Œä¸ºä»€ä¹ˆä¸‰æ¬¡å’Œå››æ¬¡ï¼Œå¦‚ä½•ä¿éšœå¯é æ€§</li><li>æ‰‹å†™å¿«æ’</li><li>è·¨ç«¯æ–¹å¼äº¤æµ</li><li>åé—®ç¯èŠ‚</li></ol><h2 id="8-24-äºŒé¢-45min-é€šè¿‡">8.24 äºŒé¢ 45min é€šè¿‡</h2><ol><li><p>å¯ä»¥æå‰è¿‡æ¥å®ä¹ å—ï¼Ÿ</p></li><li><p>å­—èŠ‚ç•™ç”¨æƒ…å†µï¼Ÿ</p></li><li><p>æ›´çœ‹é‡å…¬å¸çš„å“ªäº›å› ç´ ï¼Ÿ</p></li><li><p>æœ‰è€ƒè™‘è€ƒç ”å—ï¼Ÿ</p></li><li><p>èŠå­—èŠ‚å®ä¹ é¡¹ç›®</p></li><li><p>ä»‹ç»ä¸€ä¸‹ä½ çš„ HTTP ç¼“å­˜æ–‡ç« å†™äº†å“ªäº›å†…å®¹</p></li><li><p>ETag æ˜¯ä»€ä¹ˆï¼Ÿå¸¸è§çš„ç®—æ³•æœ‰å“ªäº›ï¼Ÿ</p></li><li><p>è´Ÿè½½å‡è¡¡å™¨é¡¹ç›®æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</p></li><li><p>ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•åŸç†æ˜¯ï¼Ÿ</p></li><li><p>æœ€æœ‰æˆå°±æ„Ÿçš„é¡¹ç›®æ˜¯å“ªä¸€ä¸ªï¼Ÿ</p></li><li><p>ä»‹ç»ä¸€ä¸‹è™šæ‹Ÿ DOMï¼Œæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</p></li><li><p>è™šæ‹Ÿ DOM çš„åº•å±‚ patchã€diff æœ‰äº†è§£è¿‡å—ï¼Ÿ</p></li><li><p>Vue çš„ diff ç®—æ³•ï¼ŒVue2 å’Œ Vue3 åˆ†åˆ«æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p></li><li><p>Vue çš„åŒå‘ç»‘å®šåŸç†æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</p></li><li><p>ç®—æ³•</p><ol><li>è®¡ç®—ä¸€ä¸ªæ•°ç»„æœ€é•¿è¿ç»­è‡ªç„¶æ•°ä¸ªæ•°ï¼Œè¦æ±‚å€¼è¿ç»­ï¼Œä½ç½®æ²¡æœ‰è¦æ±‚</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ &#123;100,4,200,1,3,2&#125;</span><br><span class="line">è¾“å‡º 4</span><br><span class="line">ç¤ºä¾‹2 è¾“å…¥ &#123;200,201,202,100,4,200,1,3,2,204,203&#125;</span><br><span class="line">è¾“å‡º 5</span><br></pre></td></tr></table></figure><ol start="2"><li>çœ‹ä»£ç è¯´è¾“å‡ºï¼Œä¼šæŠ¥é”™å—</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">let A &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line"> Â this.a &#x3D; 100;</span><br><span class="line"> Â return &#123;a: 200&#125;</span><br><span class="line">&#125;</span><br><span class="line">A.a &#x3D; 300</span><br><span class="line">A.__proto__.a &#x3D; 500</span><br><span class="line">A.prototype &#x3D; &#123; a: 600 &#125;</span><br><span class="line">a &#x3D; new A()</span><br><span class="line">console.log(a.a)</span><br></pre></td></tr></table></figure></li><li><p>ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p></li><li><p>prototype å’Œ*<strong>*proto**</strong> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p></li><li><p>èƒ½è¯´ä¸€ä¸‹ HTTPS æ¡æ‰‹ã€åŠ è§£å¯†æµç¨‹å—ï¼Ÿ</p></li><li><p>è®©ä½ æœ€æœ‰æ”¶è·çš„ä¸“ä¸šè¯¾æ˜¯ä»€ä¹ˆï¼Ÿ</p></li><li><p>ä½ è§‰å¾—è‡ªå·±æœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ</p></li><li><p>é™¤äº†å‰ç«¯è¿˜å­¦ä¹ è¿‡ä»€ä¹ˆåˆ«çš„æŠ€æœ¯å—ï¼Ÿ</p></li><li><p>ä½ çš„çŸ¥è¯†äº§æƒï¼ˆå‘æ˜ä¸“åˆ©ã€å®ç”¨æ–°å‹ä¸“åˆ©ã€è½¯ä»¶è‘—ä½œæƒï¼‰æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼Ÿ</p></li><li><p>åé—®ç¯èŠ‚</p></li></ol><h2 id="9-1-HR-é¢-20min-é€šè¿‡">9.1 HR é¢ 20min é€šè¿‡</h2><ol><li>ä½ çš„ä¸“åˆ©å’Œè½¯ä»¶è‘—ä½œæƒæ˜¯é€šè¿‡ä»€ä¹ˆæœºä¼šå»äº§å‡ºçš„ï¼Ÿç¬¬å‡ ä½œè€…å‘¢ï¼Ÿ</li><li>çœ‹ä½ é¡¹ç›®ç»éªŒå¾ˆä¸°å¯Œ</li><li>ä½ åœ¨å­—èŠ‚çš„å·¥ä½œæ„Ÿå—å¦‚ä½•ï¼Ÿå‹åŠ›å¤§å—ï¼Ÿ</li><li>å­—èŠ‚æ˜¯å¦ä¼šç»™ä½ ç•™ç”¨ offerï¼Ÿ</li><li>ä½ è¿˜æœ‰æŠ•é€’å…¶ä»–é‚£äº›å…¬å¸ï¼Ÿ</li><li>ä½ ä¼šå› ä¸ºä»€ä¹ˆé€‰æ‹©ä¸€å®¶å…¬å¸ï¼Ÿ</li><li>ä½ è§‰å¾—ä½ åšçš„æœ€æœ‰æˆå°±æ„Ÿçš„é¡¹ç›®æ˜¯å“ªä¸ªï¼Ÿ</li><li>ä½ è§‰å¾—ä½ åšçš„æœ€éš¾çš„é¡¹ç›®æ˜¯å“ªä¸€ä¸ªï¼Ÿéš¾ç‚¹åœ¨å“ªé‡Œï¼Ÿ</li><li>ä½ çš„èŒä¸šè§„åˆ’æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</li><li>ä½ æœ‰å“ªäº›ä¼˜ç‚¹å’Œä¼˜åŠ¿ï¼Ÿ</li><li>åé—®ç¯èŠ‚</li></ol><h1>æ‹¼å¤šå¤š</h1><h2 id="7-25-æå‰æ‰¹ç¬”è¯•-90minï¼ˆ30min-å®Œæˆï¼‰-é€šè¿‡">7.25 æå‰æ‰¹ç¬”è¯• 90minï¼ˆ30min å®Œæˆï¼‰ é€šè¿‡</h2><ol start="0"><li>é€’å½’å®ç°å’Œéé€’å½’å®ç°å“ªä¸ªæ›´å¿«</li><li>TCP å’Œ UDP çš„åŒºåˆ«æ˜¯</li><li>å®æ“ HTML CSS</li><li>å®ç°ä¸€ä¸ªå¼‚æ­¥åŠ è½½ js å‡½æ•°è¿”å›ä¸€ä¸ª promiseï¼ŒæˆåŠŸ resolveï¼Œå¤±è´¥/5s è¶…æ—¶ reject</li><li>æ‰‹å†™ Promise.resolve å’Œ Promise.reject</li></ol><h2 id="8-3-æå‰æ‰¹ä¸€é¢-55min-é€šè¿‡">8.3 æå‰æ‰¹ä¸€é¢ 55min é€šè¿‡</h2><ol start="0"><li><p>æ‰‹æ’•æ‹¬å·åŒ¹é…</p></li><li><p>å®ç°ä¸€ä¸ª promiseTimeout æ–¹æ³•ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸º promiseï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸º number ç±»å‹ï¼›è¯¥æ–¹æ³•çš„ä½œç”¨ä¸º</p><ol start="0"><li>è‹¥ promise åœ¨ç¬¬äºŒä¸ªå‚æ•°ç»™å®šçš„æ—¶é—´å†…å¤„äº pending çŠ¶æ€ï¼Œåˆ™è¿”å›ä¸€ä¸ª rejected çš„ promiseï¼Œå…¶ reason ä¸º new Errorï¼ˆâ€˜promise timeoutâ€™ï¼‰</li><li>è‹¥ promise åœ¨ç¬¬äºŒä¸ªå‚æ•°ç»™å®šçš„æ—¶é—´å†…å¤„äºé pending çŠ¶æ€ï¼Œåˆ™è¿”å›è¯¥ promise</li></ol></li><li><p>æµè§ˆå™¨ä»»åŠ¡å¾ªç¯ï¼Œçœ‹ä»£ç å†™è¾“å‡º</p></li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">async function async1() &#123;</span><br><span class="line"> Â console.log(&quot;async1 start&quot;);</span><br><span class="line"> Â await async2();</span><br><span class="line"> Â console.log(&quot;async1 end&quot;);</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">async function async2() &#123;</span><br><span class="line"> Â console.log(&quot;async2&quot;);</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line">setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line"> Â console.log(&quot;setTimeout&quot;);</span><br><span class="line">&#125;, 0);</span><br><span class="line">â€‹</span><br><span class="line">async1();</span><br><span class="line">â€‹</span><br><span class="line">new Promise((resolve) &#x3D;&gt; &#123;</span><br><span class="line"> Â console.log(&quot;promise1&quot;);</span><br><span class="line"> Â resolve();</span><br><span class="line">&#125;)</span><br><span class="line">  .then(() &#x3D;&gt; &#123;</span><br><span class="line"> Â  Â console.log(&quot;promise2&quot;);</span><br><span class="line"> Â  Â return new Promise((resolve) &#x3D;&gt; &#123;</span><br><span class="line"> Â  Â  Â resolve();</span><br><span class="line"> Â   &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then((result) &#x3D;&gt; &#123;</span><br><span class="line"> Â  Â console.log(&quot;promise3&quot;);</span><br><span class="line">  &#125;);</span><br><span class="line">â€‹</span><br><span class="line">console.log(&quot;script end&quot;);</span><br></pre></td></tr></table></figure><ol start="4"><li>çœ‹ä»£ç å†™è¾“å‡º</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; a.js</span><br><span class="line">console.log(&#39;a finish&#39;);</span><br><span class="line">&#x2F;&#x2F; b.js</span><br><span class="line">console.log(&#39;b finish&#39;);</span><br><span class="line">â€‹</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang&#x3D;&quot;en&quot;&gt;</span><br><span class="line"> Â &lt;head&gt;</span><br><span class="line"> Â  Â &lt;meta charset&#x3D;&quot;UTF-8&quot; &#x2F;&gt;</span><br><span class="line"> Â  Â &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge&quot; &#x2F;&gt;</span><br><span class="line"> Â  Â &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0&quot; &#x2F;&gt;</span><br><span class="line"> Â  Â &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;.&#x2F;a.js&quot; defer&#x3D;&quot;defer&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line"> Â  Â &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;.&#x2F;b.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line"> Â  Â &lt;script&gt;</span><br><span class="line"> Â  Â  Â console.log(&quot;event begin&quot;);</span><br><span class="line"> Â  Â  Â document.addEventListener(&quot;DOMContentLoaded&quot;, () &#x3D;&gt; &#123;</span><br><span class="line"> Â  Â  Â  Â console.log(&quot;DOMContentLoaded finish&quot;);</span><br><span class="line"> Â  Â   &#125;);</span><br><span class="line"> Â  Â  Â window.addEventListener(&quot;load&quot;, () &#x3D;&gt; &#123;</span><br><span class="line"> Â  Â  Â  Â console.log(&quot;load finish&quot;);</span><br><span class="line"> Â  Â   &#125;);</span><br><span class="line"> Â  Â &lt;&#x2F;script&gt;</span><br><span class="line"> Â  Â &lt;title&gt;Document&lt;&#x2F;title&gt;</span><br><span class="line"> Â &lt;&#x2F;head&gt;</span><br><span class="line"> Â &lt;body&gt;</span><br><span class="line"> Â  Â &lt;div id&#x3D;&quot;main&quot; class&#x3D;&quot;bg&quot;&gt;</span><br><span class="line"> Â  Â  Â &lt;script&gt;</span><br><span class="line"> Â  Â  Â  Â let i &#x3D; 0;</span><br><span class="line"> Â  Â  Â  Â while (i &lt; 1000000) &#123;</span><br><span class="line"> Â  Â  Â  Â  Â i++;</span><br><span class="line"> Â  Â  Â   &#125;</span><br><span class="line"> Â  Â  Â  Â console.log(&quot;compute finished&quot;);</span><br><span class="line"> Â  Â  Â &lt;&#x2F;script&gt;</span><br><span class="line"> Â  Â &lt;&#x2F;div&gt;</span><br><span class="line"> Â &lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line">â€‹</span><br></pre></td></tr></table></figure><ol start="5"><li>Vue åŒå‘ç»‘å®šå®ç°åŸç†</li><li>Vue.$nextTick å®ç°åŸç†ï¼Œæ˜¯å®ä»»åŠ¡è¿˜æ˜¯å¾®ä»»åŠ¡</li><li>Vue scoped å®ç°åŸç†</li><li>è·¨åŸŸçš„å®ç°æ–¹å¼</li><li>ç®€å•è¯·æ±‚å¤æ‚è¯·æ±‚ Option é¢„è¯·æ±‚</li><li>ä» url åˆ°é¡µé¢æ¸²æŸ“é—´å‘ç”Ÿäº†ä»€ä¹ˆ</li><li>é‡ç»˜ã€å›æµï¼Œä¼˜åŒ–æ–¹å¼</li><li>HTTP ç¼“å­˜ å¼ºç¼“å­˜ã€åå•†ç¼“å­˜</li><li>æ‰‹å†™ Reac Hookst è®¡æ•°å™¨ï¼ˆè‡ªå¢ï¼‰ï¼Œé—­åŒ…é™·é˜±</li><li>æ— é™æ»šåŠ¨åœºæ™¯ï¼Œè™šæ‹Ÿåˆ—è¡¨è®¾è®¡</li><li>å•ç‚¹ç™»å½•</li><li>å‰ç«¯å®‰å…¨ CSRF</li></ol><h2 id="8-7-æå‰æ‰¹äºŒé¢-50min-é€šè¿‡">8.7 æå‰æ‰¹äºŒé¢ 50min é€šè¿‡</h2><ol start="0"><li>ä½ è§‰å¾— Vue æ˜¯ä¸ªæ€ä¹ˆæ ·çš„æ¡†æ¶</li><li>Vue DSL æ˜¯ä¸ªä»€ä¹ˆæ ·çš„æ¨¡å¼</li><li>ä»€ä¹ˆæ˜¯ MVVMï¼Ÿ</li><li>MVVM ä¸‰å±‚åˆ†åˆ«åšäº†ä»€ä¹ˆäº‹æƒ…</li><li>Vue ä¸­ç»„ä»¶æ˜¯ä»€ä¹ˆæ¦‚å¿µï¼Ÿä»€ä¹ˆåœºæ™¯ä½ ä¼šå»å°è£…ä¸€ä¸ªç»„ä»¶</li><li>Vue ç»„ä»¶æ•°æ®é€šä¿¡æœ‰ä»€ä¹ˆæ–¹å¼ï¼Ÿåˆ†åˆ«æœ‰ä»€ä¹ˆåŒºåˆ«</li><li>Vuex å¼‚æ­¥å’ŒåŒæ­¥æ“ä½œåˆ†åˆ«ç”¨ä»€ä¹ˆï¼ŒåŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ</li><li>ç®—æ³•é¢˜ï¼šç»™å‡ºä¸€ä¸ªæ•°ç»„ä¸­æœ‰å¤šä¸ªå¯¹è±¡ï¼Œå¯¹è±¡çš„å±æ€§æœ‰ç”¨æˆ·çš„ id å’Œæ“ä½œçš„æ—¶é—´ï¼Œç»™å‡ºäº†æ—¶é—´çš„èµ·æ­¢ï¼Œè¾“å‡ºä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„å¯¹è±¡ä¸ºæ“ä½œæ¬¡æ•°å’Œç›¸åŒæ“ä½œæ¬¡æ•°çš„ç”¨æˆ·æ•°ï¼ŒæŒ‰æ“ä½œæ¬¡æ•°ä»å¤§åˆ°å°æ’åˆ—</li><li>for in å’Œ for of çš„åŒºåˆ«</li><li>constã€let å’Œ var çš„åŒºåˆ«</li><li>ä»€ä¹ˆæ˜¯å—çº§ä½œç”¨åŸŸ</li><li>åƒåœ¾å›æ”¶åšäº†ä»€ä¹ˆäº‹æƒ…</li><li>å¦‚ä½•è®©å‡½æ•°ä½œç”¨åŸŸå¤–çš„è®¿é—®å‡½æ•°å†…çš„å˜é‡</li><li>ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Œæ‰‹å†™ä¸ªé—­åŒ…</li><li>this åœ¨ JS ä¸­æ˜¯ä»€ä¹ˆ</li><li>ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°æœ‰ä»€ä¹ˆåŒºåˆ«</li><li>æ€ä¹ˆæ”¹å˜å‡½æ•°çš„ this æŒ‡å‘</li><li>è¯´ä¸€ä¸‹ flex å¸ƒå±€ï¼Œæœ‰å“ªäº›å¸¸è§å±æ€§ï¼Œåˆ†åˆ«ç”¨æ¥å¹²å—</li><li>ç®€å•å†™ä¸ª flex å¸ƒå±€</li><li>CSS æœ‰å“ªäº›å•ä½ æœ‰ä»€ä¹ˆåŒºåˆ«</li><li>rem æœ‰ä»€ä¹ˆä½¿ç”¨åœºæ™¯</li><li>æµè§ˆå™¨æ‹¿åˆ° document åæµè§ˆå™¨çš„æ¸²æŸ“æµç¨‹</li><li>ä»€ä¹ˆæƒ…å†µä¼šé˜»å¡æ¸²æŸ“ï¼Œæ€ä¹ˆä¼˜åŒ–</li><li>async å’Œ defer æœ‰ä»€ä¹ˆåŒºåˆ«</li><li>æ€ä¹ˆæ‰‹åŠ¨æµ‹é‡æ¸²æŸ“æ—¶é—´</li></ol><h2 id="8-16-æå‰æ‰¹ä¸‰é¢-70min-é€šè¿‡">8.16 æå‰æ‰¹ä¸‰é¢ 70min é€šè¿‡</h2><ol start="0"><li>ç®—æ³•</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">è¯·å°†ç¬¬äºŒæ’å¤©ä¸Šæ•°ç»„ï¼Œä½¿å¾—ç¬¬äºŒæ’æ¯ä¸€ä½æ•°å­—æ˜¯å¯¹åº”çš„ç¬¬ä¸€æ’æ•°å­—çš„æ¬¡æ•°</span><br><span class="line">0 1 2 3 4 5 6 7 8 9</span><br><span class="line">- - - - - - - - - -</span><br><span class="line">â€‹</span><br><span class="line">ä¾‹å¦‚</span><br><span class="line">0 1 2 3</span><br><span class="line">1 2 1 0</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure><ol start="2"><li>å®ç°ä¸€ä¸ª HardMan</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">HardMan(&quot;jack&quot;)è¾“å‡º</span><br><span class="line">i am jack</span><br><span class="line">HardMan(&quot;jack&quot;).learn(&quot;computer&quot;)è¾“å‡ºï¼š</span><br><span class="line">i am jack</span><br><span class="line">Learning computer</span><br><span class="line">HardMan(&quot;jack&quot;).rest(10).learn(&quot;computer&quot;)è¾“å‡º</span><br><span class="line">i am jack ç­‰å¾…10s</span><br><span class="line">Start learning after 10 seconds</span><br><span class="line">Learning computer</span><br><span class="line">HardMan(&quot;jack&quot;).restFirst(5).learn(&quot;computer&quot;)è¾“å‡º</span><br><span class="line">ç­‰å¾…5s</span><br><span class="line">Start learning after 5 seconds</span><br><span class="line">i am jack</span><br><span class="line">Learning chinese</span><br></pre></td></tr></table></figure><ol start="3"><li>ä»‹ç»é¡¹ç›®ï¼Œéš¾ç‚¹ã€äº®ç‚¹ã€é—®é¢˜ã€æ€ä¹ˆè§£å†³</li><li>HTTP å¼ºç¼“å­˜ã€åå•†ç¼“å­˜</li><li>localstorge å’Œ HTTP ç¼“å­˜æœ‰å•¥åŒºåˆ«ï¼Œä½ ä¼šæ€ä¹ˆé€‰æ‹©ç¼“å­˜æ–¹æ¡ˆ</li><li>ç¼“å­˜ä½ç½®åœ¨å“ªå„¿ï¼Ÿç­–ç•¥ï¼Ÿ</li><li>åé—®ç¯èŠ‚</li></ol><h2 id="8-23-HR-é¢-20min-é€šè¿‡">8.23 HR é¢ 20min é€šè¿‡</h2><ol start="0"><li>è‡ªæˆ‘ä»‹ç»</li><li>èŒä¸šè§„åˆ’</li><li>åç»­åœ¨å“ªä¸ªåŸå¸‚å‘å±•</li><li>çˆ¸å¦ˆåŒæ„å—ï¼Ÿæœ‰æ²¡æœ‰å¥³æœ‹å‹</li><li>ä¼šå› ä¸ºä»€ä¹ˆå› ç´ é€‰æ‹©ä¸€å®¶å…¬å¸</li><li>æœ‰ä»€ä¹ˆæ„Ÿå…´è¶£çš„ä¸šåŠ¡æ–¹å‘</li><li>æœŸæœ›è–ªèµ„æ˜¯ä»€ä¹ˆæ°´å¹³ï¼Ÿ</li><li>ä¸ºä»€ä¹ˆé€‰æ‹©åšå‰ç«¯å¼€å‘ï¼Ÿ</li><li>å¯ä»¥è¿‡æ¥å®ä¹ å˜›ï¼Ÿ</li><li>å·¥ä½œå¼ºåº¦æ˜¯å¦äº†è§£è¿‡ï¼Ÿæ˜¯å¦èƒ½æ¥å—ï¼Ÿ</li></ol><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;å¥½ä¹…ä¸è§ï¼Œæˆ‘æ˜¯ LeBronï¼Œæœ‰æ®µæ—¶é—´æ²¡å†™åšå®¢äº†ã€‚æœ€è¿‘å‡ ä¸ªæœˆçš„å¤§éƒ¨åˆ†ç²¾åŠ›éƒ½æ”¾åœ¨ç§‹æ‹›ä¸Šäº†ï¼Œè¾¹å®ä¹ è¾¹ç§‹æ‹›è¿˜æ˜¯æŒºåƒåŠ›çš„ï¼Œæ€»ç®—ç»“æœè¿˜æ˜¯ä¸é”™ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆä»‹ç»ä¸€ä¸‹ä¸ªäººæƒ…å†µï¼š2022 å±ŠåŒéæœ¬ç§‘åº”å±Šç”Ÿï¼Œé¡¹ç›®ç»éªŒå’Œç»å†è¿˜ç®—ä¸°å¯Œï¼Œåœ¨å­—èŠ‚å®ä¹ è‡³ä»Šä¹Ÿå¿« 8 ä¸ªæœˆäº†</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="é¢ç»" scheme="https://lebronchao.com/tags/%E9%9D%A2%E7%BB%8F/"/>
    
    <category term="ç§‹æ‹›" scheme="https://lebronchao.com/tags/%E7%A7%8B%E6%8B%9B/"/>
    
    <category term="åº”å±Šç”Ÿ" scheme="https://lebronchao.com/tags/%E5%BA%94%E5%B1%8A%E7%94%9F/"/>
    
    <category term="é¢è¯•" scheme="https://lebronchao.com/tags/%E9%9D%A2%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>[æºç è§£è¯»]ä¸€æ–‡è¯»æ‡‚Vuex4æºç </title>
    <link href="https://lebronchao.com/2021/09/05/Vuex4%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <id>https://lebronchao.com/2021/09/05/Vuex4%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</id>
    <published>2021-09-05T02:25:04.000Z</published>
    <updated>2021-09-05T02:25:04.000Z</updated>
    
    <content type="html"><![CDATA[<p>Vuex4 æºç è§£æ</p><blockquote><p>Vuex æ˜¯åœ¨ Vue ä¸­å¸¸ç”¨çš„çŠ¶æ€ç®¡ç†åº“ï¼Œåœ¨ Vue3 å‘å¸ƒåï¼Œè¿™ä¸ªçŠ¶æ€ç®¡ç†åº“ä¹Ÿéšä¹‹å‘å‡ºäº†é€‚é… Vue3 çš„ Vuex4</p></blockquote><h1>å¿«é€Ÿè¿‡ Vuex3.x åŸç†</h1><ul><li>ä¸ºä»€ä¹ˆæ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥é€šè¿‡<code>this.$store</code>è®¿é—®åˆ° store æ•°æ®ï¼Ÿ<ul><li>åœ¨ beforeCreate æ—¶ï¼Œé€šè¿‡ mixin çš„æ–¹å¼æ³¨å…¥äº† store</li></ul></li><li>ä¸ºä»€ä¹ˆ Vuex ä¸­çš„æ•°æ®éƒ½æ˜¯å“åº”å¼çš„<ul><li>åˆ›å»º store çš„æ—¶å€™è°ƒç”¨çš„æ˜¯<code>new Vue</code>,åˆ›å»ºäº†ä¸€ä¸ª Vue å®ä¾‹ï¼Œç›¸å½“äºå€Ÿç”¨äº† Vue çš„å“åº”å¼ã€‚</li></ul></li><li>mapXxxx æ˜¯æ€ä¹ˆè·å–åˆ° store ä¸­çš„æ•°æ®å’Œæ–¹æ³•çš„<ul><li>mapXxxx åªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œåº•å±‚å®ç°ä¹Ÿæ˜¯ä»$store ä¸­è·å–ç„¶åè¿”å›åˆ° computed / methods ä¸­ã€‚</li></ul></li></ul><h1>Vuex4 ä½¿ç”¨</h1><h2 id="Vue-useStore">Vue.useStore</h2><ul><li>åœ¨ Vue3 Composition API ä¸­ä½¿ç”¨ Vuex</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useStore &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> store = useStore();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1>Vuex4 åŸç†æ¢ç©¶</h1><blockquote><p>å»é™¤å†—ä½™ä»£ç çœ‹æœ¬è´¨</p></blockquote><h2 id="Vuex4-æ˜¯æ€ä¹ˆæ³¨å…¥-Vue-çš„">Vuex4 æ˜¯æ€ä¹ˆæ³¨å…¥ Vue çš„</h2><h3 id="install">install</h3><ul><li>Vuex æ˜¯ä»¥æ’ä»¶çš„å½¢å¼åœ¨ Vue ä¸­ä½¿ç”¨çš„ï¼Œåœ¨ createApp æ—¶è°ƒç”¨ install å®‰è£…<ul><li>ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ Vue.use å‡½æ•°<ul><li>æ’ä»¶åˆ—è¡¨ä¸­åŠ å…¥ plugin</li><li>æ‰§è¡Œ plugin çš„å®‰è£…å‡½æ•°</li></ul></li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vue3æºç  app.use</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">createAppAPI</span>&lt;<span class="title">HostElement</span>&gt;(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  render: RootRenderFunction,</span></span></span><br><span class="line"><span class="function"><span class="params">  hydrate?: RootHydrateFunction</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">CreateAppFunction</span>&lt;<span class="title">HostElement</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">createApp</span>(<span class="params">rootComponent, rootProps = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çœç•¥éƒ¨åˆ†ä»£ç ....</span></span><br><span class="line">    <span class="keyword">const</span> app: App = (context.app = &#123;</span><br><span class="line">      _uid: uid++,</span><br><span class="line">      _component: rootComponent <span class="keyword">as</span> ConcreteComponent,</span><br><span class="line">      _props: rootProps,</span><br><span class="line">      _container: <span class="literal">null</span>,</span><br><span class="line">      _context: context,</span><br><span class="line"></span><br><span class="line">      version,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// çœç•¥éƒ¨åˆ†ä»£ç ....</span></span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="title">use</span>(<span class="params">plugin: Plugin, ...options: <span class="built_in">any</span>[]</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (installedPlugins.has(plugin)) &#123;</span><br><span class="line">          __DEV__ &amp;&amp; warn(<span class="string">`Plugin has already been applied to target app.`</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (plugin &amp;&amp; isFunction(plugin.install)) &#123;</span><br><span class="line">          installedPlugins.add(plugin)</span><br><span class="line">          plugin.install(app, ...options)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isFunction(plugin)) &#123;</span><br><span class="line">          installedPlugins.add(plugin)</span><br><span class="line">          plugin(app, ...options)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">          warn(</span><br><span class="line">            <span class="string">`A plugin must either be a function or an object with an &quot;install&quot; `</span> +</span><br><span class="line">              <span class="string">`function.`</span></span><br><span class="line">          )</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> app</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// çœç•¥éƒ¨åˆ†ä»£ç  ....</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Store ç±»çš„ installï¼Œä¸¤ç§å®ç°åˆ†åˆ«ä¸ºæŒ‚è½½åˆ°å…¨å±€å’Œç»„ä»¶å†…è®¿é—®<ul><li>å®ç°é€šè¿‡ inject è·å–<ul><li>è¯¦æƒ…è§ä¸‹æ–‡ app.provide è®²è§£</li></ul></li><li>å®ç° this.$store è·å–<ul><li>å°† store æŒ‚è½½åˆ°å…¨å±€ properties</li></ul></li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vuex4å®ç°æ’ä»¶install</span></span><br><span class="line">install (app, injectKey) &#123;</span><br><span class="line">  <span class="comment">// å®ç°é€šè¿‡injectè·å–</span></span><br><span class="line">  app.provide(injectKey || storeKey, <span class="built_in">this</span>)</span><br><span class="line">  <span class="comment">// å®ç°this.$storeè·å–</span></span><br><span class="line">  app.config.globalProperties.$store = <span class="built_in">this</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>Provide / Inject æ¶æ„ç¤ºæ„å›¾</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)" alt="img"></p><blockquote><p>ä¸‹é¢æ¥ç€çœ‹ provide å®ç°</p></blockquote><h3 id="app-provide-å®ç°">app.provide å®ç°</h3><ul><li>æ¯ä¸ª Vue ç»„ä»¶éƒ½æœ‰ä¸€ä¸ª context ä¸Šä¸‹æ–‡å¯¹è±¡</li><li>å¯¹ context ä¸Šä¸‹æ–‡ä¸­çš„ provides å¯¹è±¡è¿›è¡Œèµ‹å€¼</li><li>createAppContext æ˜¯ä¸€ä¸ªåˆ›å»º App ä¸Šä¸‹æ–‡å‡½æ•°<ul><li>è¿”å›ä½“ä¸­æ˜¯ä¸€ä¸ªå…·æœ‰ä¸€äº›å¸¸è§çš„ Optionï¼ˆmixinsã€components ç­‰ï¼‰</li><li>Vue çš„æ’ä»¶å®ç°æœ€ä¸»è¦çš„ä¸ºå…¶ä¸­ä¸€é¡¹ providesï¼Œå…·ä½“å®ç°æ–¹å¼ä¸ºï¼š<ul><li>å°†æ’ä»¶é€šè¿‡ key / value çš„å½¢å¼æŒ‚è½½åˆ° app ä¸Šä¸‹æ–‡çš„ provides å¯¹è±¡ä¸Š</li><li>inject æ—¶ï¼Œé€šè¿‡å­˜å…¥çš„ key è¿›è¡Œå–å‡º</li></ul></li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vue3 app.provideå®ç°</span></span><br><span class="line"><span class="function"><span class="title">provide</span>(<span class="params">key, value</span>)</span> &#123;</span><br><span class="line">  <span class="comment">// å·²å­˜åœ¨åˆ™è­¦å‘Š</span></span><br><span class="line">  <span class="keyword">if</span> (__DEV__ &amp;&amp; (key <span class="keyword">as</span> <span class="built_in">string</span> | symbol) <span class="keyword">in</span> context.provides) &#123;</span><br><span class="line">    warn(</span><br><span class="line">      <span class="string">`App already provides property with key &quot;<span class="subst">$&#123;<span class="built_in">String</span>(key)&#125;</span>&quot;. `</span> +</span><br><span class="line">        <span class="string">`It will be overwritten with the new value.`</span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å°†storeæ”¾å…¥contextçš„provideä¸­</span></span><br><span class="line">  context.provides[key <span class="keyword">as</span> <span class="built_in">string</span>] = value</span><br><span class="line">  <span class="keyword">return</span> app</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// contextç›¸å…³   contextä¸ºä¸Šä¸‹æ–‡å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> context = createAppContext()</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">createAppContext</span>(<span class="params"></span>): <span class="title">AppContext</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    app: <span class="literal">null</span> <span class="keyword">as</span> <span class="built_in">any</span>,</span><br><span class="line">    config: &#123;</span><br><span class="line">      isNativeTag: NO,</span><br><span class="line">      performance: <span class="literal">false</span>,</span><br><span class="line">      globalProperties: &#123;&#125;,</span><br><span class="line">      optionMergeStrategies: &#123;&#125;,</span><br><span class="line">      errorHandler: <span class="literal">undefined</span>,</span><br><span class="line">      warnHandler: <span class="literal">undefined</span>,</span><br><span class="line">      compilerOptions: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    mixins: [],</span><br><span class="line">    components: &#123;&#125;,</span><br><span class="line">    directives: &#123;&#125;,</span><br><span class="line">    provides: <span class="built_in">Object</span>.create(<span class="literal">null</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="useStore-çš„å®ç°">useStore çš„å®ç°</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useStore</span>(<span class="params">key = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> inject(key !== <span class="literal">null</span> ? key : storeKey);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Vue-provide">Vue.provide</h3><ul><li>Vue çš„ provide API ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œç›¸å½“äºç›´æ¥é€šè¿‡ key/value èµ‹å€¼</li><li>å½“å‰å®ä¾‹ provides å’Œçˆ¶çº§å®ä¾‹ provides ç›¸åŒæ—¶ï¼Œé€šè¿‡åŸå‹é“¾å»ºç«‹è¿æ¥</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vue3 provideå®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">provide</span>&lt;<span class="title">T</span>&gt;(<span class="params">key: InjectionKey&lt;T&gt; | <span class="built_in">string</span> | <span class="built_in">number</span>, value: T</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!currentInstance) &#123;</span><br><span class="line">    <span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">      warn(<span class="string">`provide() can only be used inside setup().`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> provides = currentInstance.provides;</span><br><span class="line">    <span class="keyword">const</span> parentProvides =</span><br><span class="line">      currentInstance.parent &amp;&amp; currentInstance.parent.provides;</span><br><span class="line">    <span class="keyword">if</span> (parentProvides === provides) &#123;</span><br><span class="line">      provides = currentInstance.provides = <span class="built_in">Object</span>.create(parentProvides);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// TS doesn&#x27;t allow symbol as index type</span></span><br><span class="line">    provides[key <span class="keyword">as</span> <span class="built_in">string</span>] = value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Vue-inject">Vue.inject</h3><ul><li>é€šè¿‡ provide æ—¶å­˜å…¥çš„ key å–å‡º store</li><li>æœ‰çˆ¶çº§å®ä¾‹åˆ™å–çˆ¶çº§å®ä¾‹çš„ providesï¼Œæ²¡æœ‰åˆ™å–æ ¹å®ä¾‹çš„ provides</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vue3 injectå®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inject</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  key: InjectionKey&lt;<span class="built_in">any</span>&gt; | <span class="built_in">string</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  defaultValue?: unknown,</span></span></span><br><span class="line"><span class="function"><span class="params">  treatDefaultAsFactory = <span class="literal">false</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> instance = currentInstance || currentRenderingInstance;</span><br><span class="line">  <span class="keyword">if</span> (instance) &#123;</span><br><span class="line">    <span class="comment">// æœ‰çˆ¶çº§å®ä¾‹åˆ™å–çˆ¶çº§å®ä¾‹çš„providesï¼Œæ²¡æœ‰åˆ™å–æ ¹å®ä¾‹çš„provides</span></span><br><span class="line">    <span class="keyword">const</span> provides =</span><br><span class="line">      instance.parent == <span class="literal">null</span></span><br><span class="line">        ? instance.vnode.appContext &amp;&amp; instance.vnode.appContext.provides</span><br><span class="line">        : instance.parent.provides;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡provideæ—¶å­˜å…¥çš„keyå–å‡ºstore</span></span><br><span class="line">    <span class="keyword">if</span> (provides &amp;&amp; (key <span class="keyword">as</span> <span class="built_in">string</span> | symbol) <span class="keyword">in</span> provides) &#123;</span><br><span class="line">      <span class="keyword">return</span> provides[key <span class="keyword">as</span> <span class="built_in">string</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// çœç•¥ä¸€éƒ¨åˆ†ä»£ç ......</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ³¨å…¥">æ³¨å…¥</h3><ul><li>ä¸ºä»€ä¹ˆæ¯ä¸ªç»„ä»¶å®ä¾‹éƒ½æœ‰ Store å¯¹è±¡äº†?<ul><li>åœ¨åˆ›å»ºç»„ä»¶å®ä¾‹çš„æ—¶å€™æ³¨å…¥äº† provides<ul><li>ä¼˜å…ˆæ³¨å…¥çˆ¶çº§ provides</li><li>å…œåº•ä¸ºæ³¨å…¥ app ä¸Šä¸‹æ–‡çš„ provides</li></ul></li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createComponentInstance</span>(<span class="params">vnode, parent, suspense</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">type</span> = vnode.type;</span><br><span class="line">  <span class="keyword">const</span> appContext =</span><br><span class="line">    (parent ? parent.appContext : vnode.appContext) || emptyAppContext;</span><br><span class="line">  <span class="keyword">const</span> instance = &#123;</span><br><span class="line">    parent,</span><br><span class="line">    appContext,</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    provides: parent ? parent.provides : <span class="built_in">Object</span>.create(appContext.provides),</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¯ä» vue ä¸­å¼•å…¥ provideã€injectã€getCurrentInstance ç­‰ API è¿›è¡Œåº“å¼€å‘ / é«˜é˜¶ç”¨æ³•ï¼Œè¿™é‡Œä¸è¿‡å¤šèµ˜è¿°ã€‚</p></blockquote><h2 id="Vuex4-æ‰§è¡Œæœºåˆ¶">Vuex4 æ‰§è¡Œæœºåˆ¶</h2><h3 id="createStore">createStore</h3><ul><li>ä» createStore å¼€å§‹çœ‹èµ·<ul><li>å¯ä»¥å‘ç° Vuex4 ä¸­çš„ state æ˜¯é€šè¿‡ reactive API å»åˆ›å»ºçš„å“åº”å¼æ•°æ®ï¼ŒVuex3 ä¸­æ˜¯é€šè¿‡ new Vue å®ä¾‹</li><li>dispatchã€commit çš„å®ç°åŸºæœ¬æ˜¯å°è£…äº†ä¸€å±‚æ‰§è¡Œï¼Œåº•å±‚ä¹Ÿæ˜¯é€šè¿‡ store å»æ‰§è¡Œï¼Œä¸ç”¨è¿‡äºå…³å¿ƒ</li><li>è€Œ Vuex4 çš„å“åº”å¼å®ç°ï¼ŒåŒæ ·æ˜¯å€Ÿç”¨äº† Vue3 çš„å“åº”å¼ API reactive</li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vuex4æºç </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">createStore</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Store(options);</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">options = &#123;&#125;</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// çœç•¥è‹¥å¹²ä»£ç ...</span></span><br><span class="line">    <span class="built_in">this</span>._committing = <span class="literal">false</span>;</span><br><span class="line">    <span class="built_in">this</span>._actions = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">    <span class="built_in">this</span>._actionSubscribers = [];</span><br><span class="line">    <span class="built_in">this</span>._mutations = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">    <span class="built_in">this</span>._wrappedGetters = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">    <span class="built_in">this</span>._modules = <span class="keyword">new</span> ModuleCollection(options);</span><br><span class="line">    <span class="built_in">this</span>._modulesNamespaceMap = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">    <span class="built_in">this</span>._subscribers = [];</span><br><span class="line">    <span class="built_in">this</span>._makeLocalGettersCache = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// bind commit and dispatch to self</span></span><br><span class="line">    <span class="keyword">const</span> store = <span class="built_in">this</span>;</span><br><span class="line">    <span class="keyword">const</span> &#123; dispatch, commit &#125; = <span class="built_in">this</span>;</span><br><span class="line">    <span class="built_in">this</span>.dispatch = <span class="function"><span class="keyword">function</span> <span class="title">boundDispatch</span>(<span class="params"><span class="keyword">type</span>, payload</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> dispatch.call(store, <span class="keyword">type</span>, payload);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">this</span>.commit = <span class="function"><span class="keyword">function</span> <span class="title">boundCommit</span>(<span class="params"><span class="keyword">type</span>, payload, options</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> commit.call(store, <span class="keyword">type</span>, payload, options);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> state = <span class="built_in">this</span>._modules.root.state;</span><br><span class="line">    installModule(<span class="built_in">this</span>, state, [], <span class="built_in">this</span>._modules.root);</span><br><span class="line">    resetStoreState(<span class="built_in">this</span>, state);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çœç•¥è‹¥å¹²ä»£ç ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resetStoreState</span>(<span class="params">store, state, hot</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// çœç•¥è‹¥å¹²ä»£ç ...</span></span><br><span class="line">  store._state = reactive(&#123;</span><br><span class="line">    data: state,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// çœç•¥è‹¥å¹²ä»£ç ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="installModule">installModule</h3><blockquote><p>installModule ä¸»è¦ä¸ºæŒ‰åºåˆå§‹åŒ–å„æ¨¡å—ï¼Œä¸»è¦åŠŸèƒ½ä»£ç å·²é«˜äº®</p></blockquote><ol><li><blockquote><p>Mutation</p></blockquote></li><li><blockquote><p>Action</p></blockquote></li><li><blockquote><p>Getter</p></blockquote></li><li><blockquote><p>Childï¼ˆinstallï¼‰</p></blockquote></li></ol><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vuex4</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">installModule</span>(<span class="params">store, rootState, path, <span class="built_in">module</span>, hot</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> isRoot = !path.length;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">namespace</span> = store._modules.getNamespace(path);</span><br><span class="line"></span><br><span class="line">  // register in <span class="keyword">namespace</span> map</span><br><span class="line">  if (module.namespaced) &#123;</span><br><span class="line">    <span class="keyword">if</span> (store._modulesNamespaceMap[<span class="keyword">namespace</span>] &amp;&amp; __DEV__) &#123;</span><br><span class="line">      <span class="built_in">console</span>.error(</span><br><span class="line">        <span class="string">`[vuex] duplicate namespace <span class="subst">$&#123;<span class="keyword">namespace</span>&#125;</span> for the namespaced module <span class="subst">$&#123;path.join(</span></span></span><br><span class="line"><span class="string"><span class="subst">          <span class="string">&#x27;/&#x27;</span></span></span></span><br><span class="line"><span class="string"><span class="subst">        )&#125;</span>`</span></span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">    store._modulesNamespaceMap[<span class="keyword">namespace</span>] = module;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // set state</span><br><span class="line">  if (!isRoot &amp;&amp; !hot) &#123;</span><br><span class="line">    <span class="keyword">const</span> parentState = getNestedState(rootState, path.slice(<span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">    <span class="keyword">const</span> moduleName = path[path.length - <span class="number">1</span>];</span><br><span class="line">    store._withCommit(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">        <span class="keyword">if</span> (moduleName <span class="keyword">in</span> parentState) &#123;</span><br><span class="line">          <span class="built_in">console</span>.warn(</span><br><span class="line">            <span class="string">`[vuex] state field &quot;<span class="subst">$&#123;moduleName&#125;</span>&quot; was overridden by a module with the same name at &quot;<span class="subst">$&#123;path.join(</span></span></span><br><span class="line"><span class="string"><span class="subst">              <span class="string">&#x27;.&#x27;</span></span></span></span><br><span class="line"><span class="string"><span class="subst">            )&#125;</span>&quot;`</span></span><br><span class="line">          );</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      parentState[moduleName] = <span class="built_in">module</span>.state;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> local = (<span class="built_in">module</span>.context = makeLocalContext(store, <span class="keyword">namespace</span>, path));</span><br><span class="line"></span><br><span class="line">  module.forEachMutation((mutation, key) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> namespacedType = <span class="keyword">namespace</span> + key;</span><br><span class="line">    registerMutation(store, namespacedType, mutation, local);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  module.forEachAction((action, key) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">type</span> = action.root ? key : <span class="keyword">namespace</span> + key;</span><br><span class="line">    const handler = action.handler || action;</span><br><span class="line">    registerAction(store, type, handler, local);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  module.forEachGetter((getter, key) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> namespacedType = <span class="keyword">namespace</span> + key;</span><br><span class="line">    registerGetter(store, namespacedType, getter, local);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  module.forEachChild((child, key) =&gt; &#123;</span><br><span class="line">    installModule(store, rootState, path.concat(key), child, hot);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è®¢é˜…æœºåˆ¶">è®¢é˜…æœºåˆ¶</h3><blockquote><p>çœ‹å®Œäº† Vuex4 æ˜¯å¦‚ä½•å®‰è£…å’Œæ³¨å…¥çš„ï¼Œæœ€åæ¥çœ‹çœ‹ Vuex çš„è®¢é˜…æœºåˆ¶æ˜¯å¦‚ä½•å®ç°çš„</p></blockquote><ul><li>å’Œè®¢é˜…æœºåˆ¶æœ‰å…³çš„æ–¹æ³•ä¸»è¦æœ‰<ul><li>è®¢é˜…ï¼šsubscribeã€subscribeActionï¼Œåˆ†åˆ«ç”¨äºè®¢é˜… Mutation å’Œ Action</li><li>æ‰§è¡Œï¼šcommitã€dispatchï¼Œåˆ†åˆ«ç”¨äºæ‰§è¡Œ</li></ul></li><li>æ•°æ®é¡¹æœ‰ï¼š_actionSubscribersã€_subscribers</li></ul><h4 id="subscribe">subscribe</h4><blockquote><p>è®¢é˜… store çš„ mutationã€‚<code>handler</code> ä¼šåœ¨æ¯ä¸ª mutation å®Œæˆåè°ƒç”¨ï¼Œæ¥æ”¶ mutation å’Œç»è¿‡ mutation åçš„çŠ¶æ€ä½œä¸ºå‚æ•°</p></blockquote><blockquote><p>æ‰€æœ‰çš„è®¢é˜… callback éƒ½ä¼šè¢«æ”¾å…¥<code>this._subscribers</code>ï¼Œå¯é€šè¿‡ prepend é€‰é¡¹é€‰æ‹©æ”¾å…¥é˜Ÿå¤´ / é˜Ÿå°¾ã€‚</p></blockquote><ol><li>å°† callback æ¨å…¥è®¢é˜…æ•°ç»„</li><li>è¿”å›ä¸€ä¸ªå–æ¶ˆè®¢é˜…çš„å‡½æ•°</li></ol><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç”¨æ³•   è¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå–æ¶ˆè®¢é˜…çš„å‡½æ•°</span></span><br><span class="line">store.subscribe(<span class="function">(<span class="params">action, state</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(action.type)</span><br><span class="line">    <span class="built_in">console</span>.log(action.payload)</span><br><span class="line">&#125;, &#123; <span class="attr">prepend</span>: <span class="literal">true</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// subscribe  Vuex4æºç å®ç°</span></span><br><span class="line">subscribe (fn, options) &#123;</span><br><span class="line">    <span class="keyword">return</span> genericSubscribe(fn, <span class="built_in">this</span>._subscribers, options)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">genericSubscribe</span> (<span class="params">fn, subs, options</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (subs.indexOf(fn) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        options &amp;&amp; options.prepend</span><br><span class="line">            ? subs.unshift(fn)</span><br><span class="line">            : subs.push(fn)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> i = subs.indexOf(fn)</span><br><span class="line">        <span class="keyword">if</span> (i &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">            subs.splice(i, <span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ¥ç€çœ‹çœ‹ commit æ‰§è¡Œæ—¶å¦‚ä½•è§¦å‘è¿™äº›è®¢é˜…çš„ callback</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/image-20210905101036157.png" alt="image-20210905101036157"></p><ol><li>æ‰§è¡Œéœ€ commit çš„å‡½æ•°</li><li>ä¾æ¬¡æ‰§è¡Œ<code>this._subscribers</code>ä¸­çš„è®¢é˜… callback</li></ol><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// commitå®ç°</span></span><br><span class="line">commit (_type, _payload, _options) &#123;</span><br><span class="line">    <span class="comment">// check object-style commit</span></span><br><span class="line">    <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">type</span>,</span><br><span class="line">        payload,</span><br><span class="line">        options</span><br><span class="line">    &#125; = unifyObjectStyle(_type, _payload, _options)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> mutation = &#123; <span class="keyword">type</span>, payload &#125;</span><br><span class="line">    <span class="keyword">const</span> entry = <span class="built_in">this</span>._mutations[<span class="keyword">type</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰§è¡Œéœ€commitçš„å‡½æ•°</span></span><br><span class="line">    <span class="built_in">this</span>._withCommit(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        entry.forEach(<span class="function"><span class="keyword">function</span> <span class="title">commitIterator</span> (<span class="params">handler</span>) </span>&#123;</span><br><span class="line">            handler(payload)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)x</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰§è¡Œè®¢é˜…å‡½æ•°</span></span><br><span class="line">    <span class="built_in">this</span>._subscribers</span><br><span class="line">        .slice() <span class="comment">// shallow copy to prevent iterator invalidation if subscriber synchronously calls unsubscribe</span></span><br><span class="line">        .forEach(<span class="function"><span class="params">sub</span> =&gt;</span> sub(mutation, <span class="built_in">this</span>.state))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çœç•¥è‹¥å¹²ä»£ç ....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="subscribeAction">subscribeAction</h4><blockquote><p>è®¢é˜… store çš„ actionã€‚<code>handler</code> ä¼šåœ¨æ¯ä¸ª action åˆ†å‘çš„æ—¶å€™è°ƒç”¨å¹¶æ¥æ”¶ action æè¿°å’Œå½“å‰çš„ store çš„ state è¿™ä¸¤ä¸ªå‚æ•°</p></blockquote><blockquote><p>å¯è®¢é˜…ï¼šæ‰§è¡Œå‰ã€æ‰§è¡Œåå’Œé”™è¯¯</p></blockquote><ol><li>å°†è®¢é˜…å¯¹è±¡æ¨å…¥<code>this._actionSubscribers</code></li><li>è¿”å›ä¸€ä¸ªå–æ¶ˆè®¢é˜…å‡½æ•°</li></ol><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç”¨æ³•</span></span><br><span class="line">store.subscribeAction(&#123;</span><br><span class="line">    before: <span class="function">(<span class="params">action, state</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`before action <span class="subst">$&#123;action.<span class="keyword">type</span>&#125;</span>`</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    after: <span class="function">(<span class="params">action, state</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`after action <span class="subst">$&#123;action.<span class="keyword">type</span>&#125;</span>`</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    error: <span class="function">(<span class="params">action, state, error</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`error action <span class="subst">$&#123;action.<span class="keyword">type</span>&#125;</span>`</span>)</span><br><span class="line">        <span class="built_in">console</span>.error(error)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, &#123; <span class="attr">prepend</span>: <span class="literal">true</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Vuex4æºç å®ç°</span></span><br><span class="line">subscribeAction (fn, options) &#123;</span><br><span class="line">    <span class="keyword">const</span> subs = <span class="keyword">typeof</span> fn === <span class="string">&#x27;function&#x27;</span> ? &#123; <span class="attr">before</span>: fn &#125; : fn</span><br><span class="line">    <span class="keyword">return</span> genericSubscribe(subs, <span class="built_in">this</span>._actionSubscribers, options)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">genericSubscribe</span> (<span class="params">fn, subs, options</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (subs.indexOf(fn) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        options &amp;&amp; options.prepend</span><br><span class="line">            ? subs.unshift(fn)</span><br><span class="line">            : subs.push(fn)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> i = subs.indexOf(fn)</span><br><span class="line">        <span class="keyword">if</span> (i &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">            subs.splice(i, <span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>dispatch æ‰§è¡Œæ—¶å¦‚ä½•è§¦å‘è¿™äº›è®¢é˜…å‡½æ•°ï¼Ÿ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/image-20210905101145134.png" alt="image-20210905101145134"></p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vuex4æºç å®ç°</span></span><br><span class="line">dispatch (_type, _payload) &#123;</span><br><span class="line">  <span class="comment">// check object-style dispatch</span></span><br><span class="line">  <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="keyword">type</span>,</span><br><span class="line">    payload</span><br><span class="line">  &#125; = unifyObjectStyle(_type, _payload)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> action = &#123; <span class="keyword">type</span>, payload &#125;</span><br><span class="line">  <span class="keyword">const</span> entry = <span class="built_in">this</span>._actions[<span class="keyword">type</span>]</span><br><span class="line">  <span class="keyword">if</span> (!entry) &#123;</span><br><span class="line">    <span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">      <span class="built_in">console</span>.error(<span class="string">`[vuex] unknown action type: <span class="subst">$&#123;<span class="keyword">type</span>&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// beforeè®¢é˜…æ‰§è¡Œ</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>._actionSubscribers</span><br><span class="line">      .slice() <span class="comment">// shallow copy to prevent iterator invalidation if subscriber synchronously calls unsubscribe</span></span><br><span class="line">      .filter(<span class="function"><span class="params">sub</span> =&gt;</span> sub.before)</span><br><span class="line">      .forEach(<span class="function"><span class="params">sub</span> =&gt;</span> sub.before(action, <span class="built_in">this</span>.state))</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">      <span class="built_in">console</span>.warn(<span class="string">`[vuex] error in before action subscribers: `</span>)</span><br><span class="line">      <span class="built_in">console</span>.error(e)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// actionæ‰§è¡Œ</span></span><br><span class="line">  <span class="keyword">const</span> result = entry.length &gt; <span class="number">1</span></span><br><span class="line">    ? <span class="built_in">Promise</span>.all(entry.map(<span class="function"><span class="params">handler</span> =&gt;</span> handler(payload)))</span><br><span class="line">    : entry[<span class="number">0</span>](payload)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    result.then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// afterè®¢é˜…æ‰§è¡Œ</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>._actionSubscribers</span><br><span class="line">          .filter(<span class="function"><span class="params">sub</span> =&gt;</span> sub.after)</span><br><span class="line">          .forEach(<span class="function"><span class="params">sub</span> =&gt;</span> sub.after(action, <span class="built_in">this</span>.state))</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">          <span class="built_in">console</span>.warn(<span class="string">`[vuex] error in after action subscribers: `</span>)</span><br><span class="line">          <span class="built_in">console</span>.error(e)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      resolve(res)</span><br><span class="line">    &#125;, <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// errorè®¢é˜…æ‰§è¡Œ</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>._actionSubscribers</span><br><span class="line">          .filter(<span class="function"><span class="params">sub</span> =&gt;</span> sub.error)</span><br><span class="line">          .forEach(<span class="function"><span class="params">sub</span> =&gt;</span> sub.error(action, <span class="built_in">this</span>.state, error))</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">          <span class="built_in">console</span>.warn(<span class="string">`[vuex] error in error action subscribers: `</span>)</span><br><span class="line">          <span class="built_in">console</span>.error(e)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      reject(error)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>ä¸€å¥è¯æ€»ç»“</h1><blockquote><p>Vuex3 -&gt; Vuex4ï¼Œä¸»è¦å®ç°æ–¹å¼å°† mixin æ³¨å…¥æ”¹ä¸ºäº† provides / inject çš„æ–¹å¼æ³¨å…¥ã€‚</p></blockquote><blockquote><p>Provide / Inject ä¸ä»…ç”¨äº Vuex å®ç°ï¼ŒåŒæ ·å¯ä»¥ç”¨äºæ·±å±‚ç»„ä»¶çš„æ•°æ®ä¼ é€’</p></blockquote><blockquote><p>æç¤ºï¼š<code>provide</code> å’Œ <code>inject</code> ç»‘å®šå¹¶ä¸æ˜¯å¯å“åº”çš„ã€‚è¿™æ˜¯åˆ»æ„ä¸ºä¹‹çš„ã€‚ç„¶è€Œï¼Œå¦‚æœä½ ä¼ å…¥äº†ä¸€ä¸ªå¯ç›‘å¬çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå…¶å¯¹è±¡çš„ property è¿˜æ˜¯å¯å“åº”çš„ã€‚</p></blockquote><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Vuex4 æºç è§£æ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Vuex æ˜¯åœ¨ Vue ä¸­å¸¸ç”¨çš„çŠ¶æ€ç®¡ç†åº“ï¼Œåœ¨ Vue3 å‘å¸ƒåï¼Œè¿™ä¸ªçŠ¶æ€ç®¡ç†åº“ä¹Ÿéšä¹‹å‘å‡ºäº†é€‚é… Vue3 çš„ Vuex4&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1&gt;å¿«é€Ÿè¿‡ Vuex3.x åŸç†&lt;/h1&gt;
&lt;u</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://lebronchao.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="Front End" scheme="https://lebronchao.com/tags/Front-End/"/>
    
    <category term="Vue" scheme="https://lebronchao.com/tags/Vue/"/>
    
    <category term="SPA" scheme="https://lebronchao.com/tags/SPA/"/>
    
    <category term="æºç åˆ†æ" scheme="https://lebronchao.com/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•ä¼˜é›…åœ°æ“ä½œæ•°æ®åº“ï¼ŸORMäº†è§£ä¸€ä¸‹</title>
    <link href="https://lebronchao.com/2021/09/05/ORM/"/>
    <id>https://lebronchao.com/2021/09/05/ORM/</id>
    <published>2021-09-05T02:24:50.000Z</published>
    <updated>2021-09-05T02:24:50.000Z</updated>
    
    <content type="html"><![CDATA[<h1>ä»€ä¹ˆæ˜¯ ORM</h1><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/orm.jpg" alt="img"></p><p>å¯¹è±¡å…³ç³»æ˜ å°„ï¼ˆObject Relational Mappingï¼Œç®€ç§° ORMï¼‰ï¼Œæ˜¯ä¸€ç§ç¨‹åºæŠ€æœ¯ï¼Œå®ç°é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ä¸­çš„å†…å­˜å¯¹è±¡ä¸å…³ç³»å‹æ•°æ®åº“ä¸­çš„ä¸šåŠ¡å®ä½“ä¹‹é—´çš„å…³ç³»æ˜ å°„ã€‚è¿™æ ·åœ¨æˆ‘ä»¬æ“ä½œæ•°æ®åº“çš„æ—¶å€™ï¼Œä¸å†éœ€è¦å’Œå¤æ‚çš„ SQL è¯­å¥æ‰“äº¤é“ï¼Œåªéœ€è¦ç®€å•åœ°æ“ä½œå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•å°±å¯ä»¥ç›´æ¥å®ç°å¯¹æ•°æ®åº“ä¸­å¯¹åº”å®ä½“è¡¨çš„ CRUDï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰çš„æ“ä½œã€‚å¸¸è§çš„ ORM æ¡†æ¶æœ‰ Node.js çš„ TypeOrmã€Sequlizeï¼ŒJava çš„ Hibernateã€Mybatis å’Œ Go çš„ Gormã€GoRose ç­‰ã€‚</p><ul><li>ORM çš„æ–¹æ³•è®ºåŸºäºä¸‰ä¸ªæ ¸å¿ƒåŸåˆ™<ul><li>ç®€å•ï¼šä»¥æœ€åŸºæœ¬çš„å½¢å¼å»ºæ¨¡æ•°æ®</li><li>ä¼ è¾¾æ€§ï¼šæ•°æ®åº“ç»“æ„è¢«ä»»ä½•äººéƒ½èƒ½ç†è§£çš„è¯­è¨€æ–‡æ¡£åŒ–</li><li>ç²¾ç¡®æ€§ï¼šåŸºäºæ•°æ®æ¨¡å‹åˆ›å»ºæ­£ç¡®ã€æ ‡å‡†åŒ–çš„ç»“æ„</li></ul></li></ul><h1>ä¸ºä»€ä¹ˆä¼šå‡ºç° ORM</h1><blockquote><p>é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€å’Œå…³ç³»å‹æ•°æ®åº“éƒ½æ˜¯ç›®å‰æœ€æµè¡Œçš„æŠ€æœ¯ï¼Œä½†ä»–ä»¬çš„æ¨¡å‹æ˜¯ä¸ä¸€æ ·çš„ã€‚</p></blockquote><ul><li>å‡ ä¹æ‰€æœ‰çš„ç¨‹åºé‡Œé¢ï¼Œéƒ½å­˜åœ¨å¯¹è±¡å’Œå…³ç³»æ•°æ®åº“ã€‚åœ¨ä¸šåŠ¡é€»è¾‘å±‚å’Œç”¨æˆ·ç•Œé¢å±‚ä¸­ï¼Œæˆ‘ä»¬æ˜¯é¢å‘å¯¹è±¡çš„ã€‚å½“å¯¹è±¡ä¿¡æ¯å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå¯¹è±¡çš„ä¿¡æ¯ä¿å­˜åœ¨å…³ç³»æ•°æ®åº“ä¸­ã€‚</li><li>ä»¥ MVC åˆ†å±‚æ¨¡å¼ä¸ºä¾‹ã€‚Model ä½œä¸ºæ•°æ®æ‰¿è½½å®ä½“ï¼Œåœ¨ç”¨æˆ·ç•Œé¢å’Œä¸šåŠ¡é€»è¾‘å±‚ä¹‹é—´ï¼Œæ•°æ®ä»¥é¢å‘å¯¹è±¡çš„å½¢å¼ä¼ é€’ï¼›è€Œå½“æˆ‘ä»¬éœ€è¦é€šè¿‡ Controller åˆ†å‘è¯·æ±‚æŠŠæ•°æ®æŒä¹…åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±é‡åˆ°äº†å†…å­˜ä¸­çš„å¯¹è±¡å¦‚ä½•æŒä¹…åŒ–æˆå…³ç³»æ•°æ®åº“ä¸­å­˜å‚¨çš„ä¸€æ¡å®é™…æ•°æ®è®°å½•çš„é—®é¢˜ã€‚</li><li>é¢å‘å¯¹è±¡æ˜¯ä»è½¯ä»¶å·¥ç¨‹çš„åŸºæœ¬åŸåˆ™ï¼Œå³å°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€çš„åŸºç¡€ä¸Šå‘å±•èµ·æ¥çš„ï¼›è€Œå…³ç³»å‹æ•°æ®åº“åˆ™æ˜¯ä»æ•°å­¦ç†è®ºçš„åŸºç¡€ä¸Šå‘å±•èµ·æ¥çš„ï¼Œä¸¤è€…ä¹‹é—´æ˜¯ä¸åŒ¹é…çš„ã€‚æ‰€æœ‰å°±å‡ºç°äº† ORM ä»¥é¡¹ç›®ä¸­é—´ä»¶çš„å½¢å¼å®ç°æ•°æ®åœ¨ä¸åŒåœºæ™¯ä¸‹çš„æ•°æ®å…³ç³»æ˜ å°„ã€‚ã€‚è€Œå¯¹è±¡å…³ç³»æ˜ å°„å°±æ˜¯è¿™æ ·ä¸€ç§ä¸ºäº†è§£å†³é¢å‘å¯¹è±¡ä¸å…³ç³»æ•°æ®åº“å­˜åœ¨çš„äº’ä¸åŒ¹é…çš„ç°è±¡çš„æŠ€æœ¯ã€‚åœ¨å…¶åŸºç¡€ä¸Šè¯ç”Ÿå¾ˆå¤šå¯¹è±¡å’Œå…³ç³»ä¹‹é—´çš„æ˜ å°„æ¡†æ¶ï¼Œä¹Ÿå³ ORM æŠ€æœ¯ã€‚</li></ul><h1>ORM çš„ä½¿ç”¨ ä»¥ Sequelize ä¸ºä¾‹</h1><blockquote><p>ä»…ç¤ºä¾‹ï¼Œæ›´å¤šæ“ä½œå¯å‚è€ƒ</p></blockquote><ul><li><a href="https://www.sequelize.com.cn/">Sequelize ä¸­æ–‡æ–‡æ¡£</a></li><li><a href="https://github.com/RobinBuschmann/sequelize-typescript">RobinBuschmann/sequelize-typescript</a></li></ul><p>Sequelize æ˜¯ä¸€ä¸ªåŸºäº Promise çš„ Node.js <a href="https://en.wikipedia.org/wiki/Object-relational_mapping">ORM</a>, ç›®å‰æ”¯æŒ <a href="https://en.wikipedia.org/wiki/PostgreSQL">Postgres</a>, <a href="https://en.wikipedia.org/wiki/MySQL">MySQL</a>, <a href="https://en.wikipedia.org/wiki/MariaDB">MariaDB</a>, <a href="https://en.wikipedia.org/wiki/SQLite">SQLite</a> ä»¥åŠ <a href="https://en.wikipedia.org/wiki/Microsoft_SQL_Server">Microsoft SQL Server</a>. å®ƒå…·æœ‰å¼ºå¤§çš„äº‹åŠ¡æ”¯æŒ, å…³è”å…³ç³», é¢„è¯»å’Œå»¶è¿ŸåŠ è½½,è¯»å–å¤åˆ¶ç­‰åŠŸèƒ½ã€‚</p><p>Sequelize éµä» <a href="http://semver.org/">è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶</a>ã€‚ æ”¯æŒ Node v10 åŠæ›´é«˜ç‰ˆæœ¬ä»¥ä¾¿ä½¿ç”¨ ES6 åŠŸèƒ½ã€‚</p><h2 id="è¿æ¥æ•°æ®åº“">è¿æ¥æ•°æ®åº“</h2><ul><li>è®¾ç½®ä½¿ç”¨ sequlize æ’ä»¶ï¼Œå¹¶é…ç½®è¦è¿æ¥çš„æ•°æ®åº“</li></ul><h2 id="å®šä¹‰-Model">å®šä¹‰ Model</h2><blockquote><p>é€šè¿‡é¢å‘å¯¹è±¡ Class å’Œ å…³ç³»å‹æ•°æ®åº“çš„è¡¨å»ºç«‹è¿æ¥</p><p>@Column è¡¨ç¤ºæ•°æ®åº“çš„ä¸€åˆ—</p><p>@PrimaryKey è¡¨ç¤ºä¸»é”®</p></blockquote><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">tsimport &#123;</span><br><span class="line">  Column,</span><br><span class="line">  Model,</span><br><span class="line">  PrimaryKey,</span><br><span class="line">  Table,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@gulu/sequelize/typescript&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">enum</span> GameType &#123;</span><br><span class="line">  micro_game = <span class="string">&#x27;micro_game&#x27;</span>,</span><br><span class="line">  mobile_game = <span class="string">&#x27;mobile_game&#x27;</span>,</span><br><span class="line">  micro_app = <span class="string">&#x27;micro_app&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Table</span>(&#123; <span class="attr">modelName</span>: <span class="string">&#x27;game&#x27;</span>, <span class="attr">timestamps</span>: <span class="literal">false</span> &#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">GameModel</span> <span class="keyword">extends</span> <span class="title">Model</span> </span>&#123;</span><br><span class="line">  <span class="meta">@PrimaryKey</span></span><br><span class="line">  <span class="meta">@Column</span></span><br><span class="line">  gameId!: <span class="built_in">string</span>;</span><br><span class="line">  <span class="meta">@Column</span></span><br><span class="line">  name!: <span class="built_in">string</span>;</span><br><span class="line">  <span class="meta">@Column</span></span><br><span class="line">  description?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="meta">@Column</span></span><br><span class="line">  <span class="keyword">type</span>!: GameType;</span><br><span class="line">  <span class="meta">@Column</span></span><br><span class="line">  icon?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="meta">@Column</span></span><br><span class="line">  isDelete!: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ“ä½œæ•°æ®åº“">æ“ä½œæ•°æ®åº“</h2><blockquote><p>é€šè¿‡ Model çš„æ–¹æ³•æ“ä½œæ•°æ®åº“</p></blockquote><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> GameModel <span class="keyword">from</span> <span class="string">&#x27;../model/game&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¸¸æˆåˆ—è¡¨æŸ¥è¯¢æœåŠ¡</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="title">query</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> GameModel.findAll(&#123;</span><br><span class="line">    <span class="comment">// å»é™¤è½¯åˆ é™¤å­—æ®µ</span></span><br><span class="line">    attributes: &#123;</span><br><span class="line">      exclude: [<span class="string">&#x27;isDelete&#x27;</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// æŸ¥è¯¢æœªè¢«è½¯åˆ é™¤çš„æ¸¸æˆ</span></span><br><span class="line">    where: &#123;</span><br><span class="line">      isDelete: <span class="number">0</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç›¸å½“äºä»¥ä¸‹ SQL è¯­å¥</p></blockquote><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> gameId, name, description, type, icon <span class="keyword">from</span> game <span class="keyword">where</span> isDelete <span class="operator">=</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><blockquote><p>å½“ç„¶ Sequlize ä¹Ÿæ”¯æŒ SQL è¯­å¥æŸ¥è¯¢</p></blockquote><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> GameModel <span class="keyword">from</span> <span class="string">&#x27;../model/game&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¸¸æˆåˆ—è¡¨æŸ¥è¯¢æœåŠ¡</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="title">query</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> GameModel.sequelize.query(</span><br><span class="line">      <span class="string">&#x27;select gameId, name, description, type, icon from game where isDelete = 0&#x27;</span>,</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>ORM çš„ä¼˜ç¼ºç‚¹</h1><blockquote><p>ä¼˜ç‚¹</p></blockquote><ol><li>éšè—äº†æ•°æ®è®¿é—®çš„ç»†èŠ‚ï¼Œâ€œå°é—­â€çš„é€šç”¨æ•°æ®åº“äº¤äº’æ˜¯ ORM çš„æ ¸å¿ƒã€‚ä»–ä½¿å¾—æˆ‘ä»¬çš„é€šç”¨æ•°æ®åº“äº¤äº’å˜å¾—ç®€å•æ˜“è¡Œï¼Œå¹¶ä¸”å®Œå…¨ä¸ç”¨è€ƒè™‘ SQL è¯­å¥ã€‚</li><li>å¼€å‘æ•ˆç‡æ›´é«˜ï¼ŒORM ä½¿æˆ‘ä»¬æ„é€ å›ºåŒ–æ•°æ®å˜å¾—ç®€å•æ˜“è¡Œï¼Œåœ¨ ORM è¯ç”Ÿå‰ï¼Œæˆ‘ä»¬éœ€è¦è§è¿‡æˆ‘ä»¬çš„å¯¹è±¡æ¨¡å‹è½¬åŒ–ä¸ºä¸€æ¡ä¸€æ¡çš„ SQL è¯­å¥ï¼Œé€šè¿‡ç›´è¿æˆ–è€…æ˜¯ DB helper åœ¨å…³ç³»æ•°æ®åº“æ„é€ æˆ‘ä»¬çš„æ•°æ®åº“ä½“ç³»ã€‚è€Œç°åœ¨ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„ ORM æ¡†æ¶éƒ½æä¾›äº†é€šè¿‡å¯¹è±¡æ¨¡å‹æ„é€ å…³ç³»æ•°æ®åº“ç»“æ„çš„åŠŸèƒ½ã€‚</li><li>æ•°æ®è®¿é—®æ›´æŠ½è±¡ã€è½»ä¾¿ï¼Œæ”¯æŒé¢å‘å¯¹è±¡å°è£…ã€‚æ•°æ®æ¨¡å‹éƒ½åœ¨ä¸€ä¸ªåœ°æ–¹å®šä¹‰ï¼Œæ›´å®¹æ˜“æ›´æ–°å’Œç»´æŠ¤ï¼Œä¹Ÿåˆ©äºé‡ç”¨ä»£ç </li><li>ORM æœ‰ç°æˆçš„å·¥å…·ï¼Œå¾ˆå¤šåŠŸèƒ½éƒ½å¯ä»¥è‡ªåŠ¨å®Œæˆï¼Œæ¯”å¦‚æ•°æ®æ¶ˆæ¯’ã€é¢„å¤„ç†ã€äº‹åŠ¡ç­‰ç­‰ã€‚</li><li>å®ƒè¿«ä½¿ä½ ä½¿ç”¨ MVC æ¶æ„ï¼ŒORM å°±æ˜¯å¤©ç„¶çš„ Modelï¼Œæœ€ç»ˆä½¿ä»£ç æ›´æ¸…æ™°ã€‚</li><li>åŸºäº ORM çš„ä¸šåŠ¡ä»£ç æ¯”è¾ƒç®€å•ï¼Œä»£ç é‡å°‘ï¼Œè¯­ä¹‰æ€§å¥½ï¼Œå®¹æ˜“ç†è§£ã€‚</li><li>é˜²èŒƒ SQL æ³¨å…¥æ”»å‡»</li><li>ä¸å¿…ç¼–å†™æ€§èƒ½ä¸ä½³çš„ SQLã€‚</li></ol><blockquote><p>ç¼ºç‚¹</p></blockquote><ol><li>æ— å¯é¿å…çš„ï¼Œè‡ªåŠ¨åŒ–æ„å‘³ç€æ˜ å°„å’Œå…³è”ç®¡ç†ï¼Œä»£ä»·æ˜¯ç‰ºç‰²æ€§èƒ½ã€‚ç°åœ¨çš„å„ç§ ORM æ¡†æ¶éƒ½åœ¨å°è¯•ä½¿ç”¨å„ç§æ–¹æ³•æ¥å‡è½»æ€§èƒ½ä¸Šçš„æŸå¤±ï¼Œå¦‚æ‡’åŠ è½½æŠ€æœ¯ã€ç¼“å­˜æŠ€æœ¯ç­‰ã€‚</li><li>é¢å‘å¯¹è±¡çš„æŸ¥è¯¢è¯­è¨€ä½œä¸ºä¸€ç§æ•°æ®åº“ä¸å¯¹è±¡ä¹‹é—´çš„è¿‡æ¸¡ï¼Œè™½ç„¶éšè—äº†æ•°æ®å±‚é¢çš„ä¸šåŠ¡æŠ½è±¡ï¼Œä½†å¹¶ä¸èƒ½å®Œå…¨å±è”½æ•°æ®åº“å±‚çš„è®¾è®¡ã€‚ORM åº“ä¹Ÿä¸æ˜¯è½»é‡çº§çš„å·¥å…·ï¼Œéœ€è¦èŠ±å¾ˆå¤šç²¾åŠ›å­¦ä¹ å’Œè®¾ç½®ï¼Œæ— ç–‘å°†å¢åŠ å­¦ä¹ æˆæœ¬ã€‚</li><li>ORM éš¾ä»¥å®ç°è¿‡äºå¤æ‚çš„æŸ¥è¯¢ã€‚è™½ç„¶å¯ä»¥å®ç°ï¼Œä½†æ˜¯éœ€è¦èŠ±è´¹å¾ˆå¤§çš„ä»£ä»·ï¼ˆæ€§èƒ½ä¸å¦‚åŸç”Ÿ SQLï¼‰ã€‚</li><li>æŒä¹…åŒ–å±‚ç¼ºä¹å¼¹æ€§ï¼Œä¸€æ—¦å‡ºç°ä¸šåŠ¡éœ€æ±‚å˜æ›´ï¼Œå°±å¿…é¡»ä¿®æ”¹æŒä¹…åŒ–å±‚çš„æ¥å£</li><li>æŒä¹…åŒ–å±‚åŒæ—¶ä¸åŸŸæ¨¡å‹ä¸å…³ç³»æ•°æ®åº“æ¨¡å‹ç»‘å®šï¼Œä¸ç®¡åŸŸæ¨¡å‹è¿˜æ˜¯å…³ç³»æ•°æ®åº“æ¨¡å‹å‘ç”Ÿå˜åŒ–ï¼Œéƒ½è¦ä¿®æ”¹æŒä¹…åŒ–å±‚ç›¸å…³ç¨‹åºä»£ç ï¼Œå¢åŠ äº†è½¯ä»¶çš„ç»´æŠ¤éš¾åº¦ã€‚</li></ol><blockquote><p>ä»€ä¹ˆæ˜¯â€œæŒä¹…åŒ–â€ å±‚</p></blockquote><ul><li><p>æŒä¹…ï¼ˆPersistenceï¼‰ï¼Œå³æŠŠæ•°æ®ï¼ˆå¦‚å†…å­˜ä¸­çš„å¯¹è±¡ï¼‰ä¿å­˜åˆ°å¯æ°¸ä¹…ä¿å­˜çš„å­˜å‚¨è®¾å¤‡ä¸­ï¼ˆå¦‚ç£ç›˜ï¼‰ã€‚æŒä¹…åŒ–çš„ä¸»è¦åº”ç”¨æ˜¯å°†å†…å­˜ä¸­çš„æ•°æ®å­˜å‚¨åœ¨å…³ç³»å‹çš„æ•°æ®åº“ä¸­ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å­˜å‚¨åœ¨ç£ç›˜æ–‡ä»¶ä¸­ã€XML æ•°æ®æ–‡ä»¶ä¸­ç­‰ç­‰ã€‚</p></li><li><p>æ€»ç»“ï¼šå½“ä¸‹ ORM çš„å¼€å‘æ¨¡å¼æ˜¯ä¸»æµï¼Œæé«˜äº†ä»£ç çš„å°è£…æ€§å’Œå¯è¯»æ€§ï¼ŒåŒæ—¶é˜²èŒƒäº† SQL æ³¨å…¥æ”»å‡»ã€‚ä»¥è¾ƒå°é‡çº§çš„æ€§èƒ½æŸå¤±æ¢æ¥äº†æ˜æ˜¾çš„å¼€å‘æ•ˆç‡æå‡ï¼Œæ˜æ˜¾çš„æ€§èƒ½æŸå¤±å¾€å¾€å­˜åœ¨äºå¤æ‚çš„æŸ¥è¯¢ï¼Œè¿™ç§æƒ…å†µå¯ä»¥é€‰æ‹©ä½¿ç”¨ ORM æä¾›çš„ SQL è¯­å¥æ¥å£è¿›è¡ŒæŸ¥è¯¢ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚</p></li></ul><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;ä»€ä¹ˆæ˜¯ ORM&lt;/h1&gt;
&lt;p&gt;&lt;img src= &quot;/img/loading.gif&quot; data-lazy-src=&quot;https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/orm.jp</summary>
      
    
    
    
    <category term="Back End" scheme="https://lebronchao.com/categories/Back-End/"/>
    
    
    <category term="æ•°æ®åº“" scheme="https://lebronchao.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="TypeScript" scheme="https://lebronchao.com/tags/TypeScript/"/>
    
    <category term="Node" scheme="https://lebronchao.com/tags/Node/"/>
    
    <category term="ORM" scheme="https://lebronchao.com/tags/ORM/"/>
    
  </entry>
  
  <entry>
    <title>[æ·±å…¥æµ…å‡ºLB]æ‰‹æŠŠæ‰‹å¸¦ä½ å®ç°ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨</title>
    <link href="https://lebronchao.com/2021/08/02/LoadBalance%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
    <id>https://lebronchao.com/2021/08/02/LoadBalance%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/</id>
    <published>2021-08-01T16:11:46.000Z</published>
    <updated>2021-08-01T16:11:46.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Load Balance è´Ÿè½½å‡è¡¡ ğŸŒ¡</h1><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20210622002849831.(null)" alt="img"></p><blockquote><p>ç®€ä»‹</p></blockquote><p>è´Ÿè½½å‡è¡¡ï¼Œå«ä¹‰å°±æ˜¯æ ¹æ®ä¸€å®šç®—æ³•å°†è´Ÿè½½ï¼ˆå·¥ä½œä»»åŠ¡ï¼‰è¿›è¡Œå¹³è¡¡ï¼Œåˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šè¿è¡Œã€æ‰§è¡Œï¼Œå¸¸è§çš„ä¸º Web æœåŠ¡å™¨ã€ä¼ä¸šæ ¸å¿ƒåº”ç”¨æœåŠ¡å™¨å’Œå…¶ä»–ä¸»è¦ä»»åŠ¡æœåŠ¡å™¨ç­‰ï¼Œä»è€ŒååŒå®Œæˆå·¥ä½œä»»åŠ¡ã€‚è´Ÿè½½å‡è¡¡åœ¨åŸæœ‰çš„ç½‘ç»œç»“æ„ä¸Šæä¾›äº†ä¸€ç§é€æ˜ä¸”æœ‰æ•ˆçš„çš„æ–¹æ³•æ‰©å±•æœåŠ¡å™¨å’Œç½‘ç»œè®¾å¤‡çš„å¸¦å®½ã€åŠ å¼ºç½‘ç»œæ•°æ®å¤„ç†èƒ½åŠ›ã€å¢åŠ ååé‡ã€æé«˜ç½‘ç»œçš„å¯ç”¨æ€§å’Œçµæ´»æ€§ï¼ŒåŒæ—¶æ‰¿å—ä½æ›´å¤§çš„å¹¶å‘é‡çº§ã€‚</p><blockquote><p>ç®€å•æ¥è¯´å°±æ˜¯å°†å¤§é‡çš„å¹¶å‘è¯·æ±‚å¤„ç†è½¬å‘ç»™å¤šä¸ªåç«¯èŠ‚ç‚¹å¤„ç†ï¼Œå‡å°‘å·¥ä½œå“åº”æ—¶é—´ã€‚</p></blockquote><ul><li><p>é¿å…èµ„æºæµªè´¹</p></li><li><p>é¿å…æœåŠ¡ä¸å¯ç”¨</p></li></ul><h1>ä¸€ã€åˆ†ç±»</h1><h2 id="å››å±‚ï¼ˆä¼ è¾“å±‚ï¼‰">å››å±‚ï¼ˆä¼ è¾“å±‚ï¼‰</h2><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/image-20210622002908874.png" alt="image-20210622002908874"></p><p>å››å±‚å³ OSI ä¸ƒå±‚æ¨¡å‹ä¸­çš„ä¼ è¾“å±‚ï¼Œæœ‰ TCPã€UDP åè®®ï¼Œè¿™ä¸¤ç§åè®®ä¸­åŒ…å«æº IPã€ç›®æ ‡ IP ä»¥å¤–ï¼Œè¿˜åŒ…å«æºç«¯å£å·åŠç›®æ ‡ç«¯å£å·ã€‚å››å±‚è´Ÿè½½å‡è¡¡åœ¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚åï¼Œé€šè¿‡ä¿®æ”¹æŠ¥æ–‡çš„åœ°å€ä¿¡æ¯ï¼ˆIP + PORTï¼‰å°†æµé‡è½¬å‘åˆ°åº”ç”¨æœåŠ¡å™¨ã€‚</p><h2 id="ä¸ƒå±‚ï¼ˆåº”ç”¨å±‚ï¼‰">ä¸ƒå±‚ï¼ˆåº”ç”¨å±‚ï¼‰</h2><blockquote><p>ä»£ç†è´Ÿè½½å‡è¡¡</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/image-20210622002927473.png" alt="image-20210622002927473"></p><p>ä¸ƒå±‚å³ OSI ä¸ƒå±‚æ¨¡å‹ä¸­çš„åº”ç”¨å±‚ï¼Œåº”ç”¨å±‚åè®®è¾ƒå¤šï¼Œå¸¸ç”¨çš„ä¸º HTTP/HTTPSã€‚ä¸ƒå±‚è´Ÿè½½å‡è¡¡å¯ä»¥ç»™äºˆè¿™äº›åè®®æ¥è´Ÿè½½ã€‚è¿™äº›åº”ç”¨å±‚åè®®ä¸­ä¼šåŒ…å«å¾ˆå¤šæœ‰æ„ä¹‰çš„å†…å®¹ã€‚æ¯”å¦‚åŒä¸€ä¸ª Web æœåŠ¡å™¨çš„è´Ÿè½½å‡è¡¡ï¼Œé™¤äº†æ ¹æ® IP + PORT è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œè¿˜å¯ä»¥æ ¹æ®ä¸ƒå±‚çš„ URLã€Cookieã€æµè§ˆå™¨ç±»åˆ«ã€è¯­è¨€ã€è¯·æ±‚ç±»å‹æ¥å†³å®šã€‚</p><blockquote><p>å››å±‚è´Ÿè½½å‡è¡¡çš„æœ¬è´¨æ˜¯è½¬å‘ï¼Œä¸ƒå±‚è´Ÿè½½å‡è¡¡çš„æœ¬è´¨æ˜¯å†…å®¹äº¤æ¢å’Œä»£ç†ã€‚</p></blockquote><table><thead><tr><th></th><th><strong>å››å±‚è´Ÿè½½å‡è¡¡</strong></th><th><strong>ä¸ƒå±‚è´Ÿè½½å‡è¡¡</strong></th></tr></thead><tbody><tr><td><strong>åŸºäº</strong></td><td>IP + PORT</td><td>URL æˆ– ä¸»æœº IP</td></tr><tr><td><strong>ç±»ä¼¼</strong></td><td>è·¯ç”±å™¨</td><td>ä»£ç†æœåŠ¡å™¨</td></tr><tr><td><strong>å¤æ‚åº¦</strong></td><td>ä½</td><td>é«˜</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>é«˜ï¼Œæ— éœ€è§£æå†…å®¹</td><td>ä¸­ï¼Œéœ€ç®—æ³•è¯†åˆ« URL Headerã€Cookie ç­‰</td></tr><tr><td><strong>å®‰å…¨æ€§</strong></td><td>ä½ï¼Œæ— æ³•è¯†åˆ« DDoS æ”»å‡»</td><td>é«˜ï¼Œå¯é˜²å¾¡ SYN Flood æ”»å‡»</td></tr><tr><td><strong>æ‰©å±•åŠŸèƒ½</strong></td><td>æ— </td><td>å†…å®¹ç¼“å­˜ã€å›¾ç‰‡é˜²ç›—é“¾ç­‰</td></tr></tbody></table><h1>äºŒã€å¸¸è§ç®—æ³•</h1><blockquote><p>å‰ç½®æ•°æ®ç»“æ„</p></blockquote><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> urlObj&#123;</span><br><span class="line">  url:<span class="built_in">string</span>,</span><br><span class="line">  weight:<span class="built_in">number</span> <span class="comment">// ä»…åœ¨æƒé‡è½®è¯¢æ—¶ç”Ÿæ•ˆ</span></span><br><span class="line">&#125;</span><br><span class="line">urlDesc: urlObj[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> urlCollectObj&#123;</span><br><span class="line">  count: <span class="built_in">number</span>, <span class="comment">// è¿æ¥æ•°</span></span><br><span class="line">  costTime: <span class="built_in">number</span>, <span class="comment">// å“åº”æ—¶é—´</span></span><br><span class="line">  connection: <span class="built_in">number</span>, <span class="comment">// å®æ—¶è¿æ¥æ•°</span></span><br><span class="line">&#125;</span><br><span class="line">urlCollect: urlCollectObj[]</span><br></pre></td></tr></table></figure><h2 id="Random">Random</h2><blockquote><p>éšæœº</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/image-20210622002949591.png" alt="image-20210622002949591"></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Random = <span class="function">(<span class="params">urlDesc</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> urlCollect = [];</span><br><span class="line"></span><br><span class="line">  <span class="comment">//  æ”¶é›†url</span></span><br><span class="line">  urlDesc.forEach(<span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">    urlCollect.push(val.url);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//  ç”Ÿæˆéšæœºæ•°ä¸‹æ ‡è¿”å›ç›¸åº”URL</span></span><br><span class="line">    <span class="keyword">const</span> pos = <span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random() * urlCollect.length);</span><br><span class="line">    <span class="keyword">return</span> urlCollect[pos];</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = Random;</span><br></pre></td></tr></table></figure><h2 id="Weighted-Round-Robin">Weighted Round Robin</h2><blockquote><p>æƒé‡è½®è¯¢ç®—æ³•</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/image-20210622003000250.png" alt="image-20210622003000250"></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> WeiRoundRobin = <span class="function">(<span class="params">urlDesc</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> pos = <span class="number">0</span>,</span><br><span class="line">    urlCollect = [],</span><br><span class="line">    copyUrlDesc = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(urlDesc));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ ¹æ®æƒé‡æ”¶é›†url</span></span><br><span class="line">  <span class="keyword">while</span> (copyUrlDesc.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; copyUrlDesc.length; i++) &#123;</span><br><span class="line">      urlCollect.push(copyUrlDesc[i].url);</span><br><span class="line">      copyUrlDesc[i].weight--;</span><br><span class="line">      <span class="keyword">if</span> (copyUrlDesc[i].weight === <span class="number">0</span>) &#123;</span><br><span class="line">        copyUrlDesc.splice(i, <span class="number">1</span>);</span><br><span class="line">        i--;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è½®è¯¢è·å–URLå‡½æ•°</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> res = urlCollect[pos++];</span><br><span class="line">    <span class="keyword">if</span> (pos === urlCollect.length) &#123;</span><br><span class="line">      pos = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = WeiRoundRobin;</span><br></pre></td></tr></table></figure><h2 id="IP-Hash-URL-Hash">IP Hash &amp; URL Hash</h2><blockquote><p>æº IP / URL Hash</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/image-20210622003030857.png" alt="image-20210622003030857"></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; Hash &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../util&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> IpHash = <span class="function">(<span class="params">urlDesc</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> urlCollect = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> urlDesc) &#123;</span><br><span class="line">    <span class="comment">// æ”¶é›†url</span></span><br><span class="line">    urlCollect.push(urlDesc[key].url);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">sourceInfo</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ç”ŸæˆHashåè¿›åˆ¶æ•°å€¼</span></span><br><span class="line">    <span class="keyword">const</span> hashInfo = Hash(sourceInfo);</span><br><span class="line">    <span class="comment">// å–ä½™ä¸ºä¸‹æ ‡</span></span><br><span class="line">    <span class="keyword">const</span> urlPos = <span class="built_in">Math</span>.abs(hashInfo) % urlCollect.length;</span><br><span class="line">    <span class="comment">// è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> urlCollect[urlPos];</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = IpHash;</span><br></pre></td></tr></table></figure><h2 id="Consistent-Hash">Consistent Hash</h2><blockquote><p>ä¸€è‡´æ€§ Hash</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/image-20210622003051914.png" alt="image-20210622003051914"></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; Hash &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../util&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ConsistentHash = <span class="function">(<span class="params">urlDesc</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> urlHashMap = &#123;&#125;,</span><br><span class="line">    hashCollect = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> urlDesc) &#123;</span><br><span class="line">    <span class="comment">// æ”¶é›†urlHashè¿›æ•°ç»„å’Œç”ŸæˆHashMap</span></span><br><span class="line">    <span class="keyword">const</span> &#123; url &#125; = urlDesc[key];</span><br><span class="line">    <span class="keyword">const</span> hash = Hash(url);</span><br><span class="line">    urlHashMap[hash] = url;</span><br><span class="line">    hashCollect.push(hash);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å°†hashæ•°ç»„ä»å°åˆ°å¤§æ’åº</span></span><br><span class="line">  hashCollect = hashCollect.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">sourceInfo</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ç”ŸæˆHashåè¿›åˆ¶æ•°å€¼</span></span><br><span class="line">    <span class="keyword">const</span> hashInfo = Hash(sourceInfo);</span><br><span class="line">    <span class="comment">// éå†hashæ•°ç»„æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ¯”æºä¿¡æ¯hashå€¼å¤§çš„ï¼Œå¹¶é€šè¿‡hashMapè¿”å›url</span></span><br><span class="line">    hashCollect.forEach(<span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (val &gt;= hashInfo) &#123;</span><br><span class="line">        <span class="keyword">return</span> urlHashMap[val];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// æ²¡æ‰¾å¤§åˆ™è¿”å›æœ€å¤§çš„</span></span><br><span class="line">    <span class="keyword">return</span> urlHashMap[hashCollect[hashCollect.length - <span class="number">1</span>]];</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = ConsistentHash;</span><br></pre></td></tr></table></figure><h2 id="Least-Connections">Least Connections</h2><blockquote><p>æœ€å°è¿æ¥æ•°</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/image-20210622003136462.png" alt="image-20210622003136462"></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> leastConnections = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">urlCollect</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> min = <span class="built_in">Number</span>.POSITIVE_INFINITY,</span><br><span class="line">      url = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éå†å¯¹è±¡æ‰¾åˆ°æœ€å°‘è¿æ¥æ•°çš„åœ°å€</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> urlCollect) &#123;</span><br><span class="line">      <span class="keyword">const</span> val = urlCollect[key].connection;</span><br><span class="line">      <span class="keyword">if</span> (val &lt; min) &#123;</span><br><span class="line">        min = val;</span><br><span class="line">        url = key;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = leastConnections;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼šurlCollect ä¸ºè´Ÿè½½å‡å±æ•°æ®ç»Ÿè®¡å¯¹è±¡ï¼Œæœ‰ä»¥ä¸‹å±æ€§</p></blockquote><ul><li><p>connection å®æ—¶è¿æ¥æ•°</p></li><li><p>count å¤„ç†è¯·æ±‚æ¬¡æ•°</p></li><li><p>costTime å“åº”æ—¶é—´ã€‚</p></li></ul><h2 id="FAIR">FAIR</h2><blockquote><p>æœ€å°å“åº”æ—¶é—´</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/image-20210622003155965.png" alt="image-20210622003155965"></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Fair = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">urlCollect</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> min = <span class="built_in">Number</span>.POSITIVE_INFINITY,</span><br><span class="line">      url = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰¾åˆ°è€—æ—¶æœ€å°‘çš„url</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> urlCollect) &#123;</span><br><span class="line">      <span class="keyword">const</span> urlObj = urlCollect[key];</span><br><span class="line">      <span class="keyword">if</span> (urlObj.costTime &lt; min) &#123;</span><br><span class="line">        min = urlObj.costTime;</span><br><span class="line">        url = key;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = Fair;</span><br></pre></td></tr></table></figure><blockquote><p>çœ‹åˆ°è¿™é‡Œæ˜¯ä¸æ˜¯æ„Ÿè§‰ç®—æ³•éƒ½æŒºç®€å•çš„ ğŸ¥±</p></blockquote><blockquote><p>æœŸå¾…ä¸€ä¸‹æ¨¡å—å››çš„å®ç°å§ ğŸ˜</p></blockquote><h1>ä¸‰ã€å¥åº·ç›‘æµ‹</h1><blockquote><p>å¥åº·ç›‘æµ‹å³å¯¹åº”ç”¨æœåŠ¡å™¨çš„å¥åº·ç›‘æµ‹ï¼Œä¸ºé˜²æ­¢æŠŠè¯·æ±‚è½¬å‘åˆ°å¼‚å¸¸çš„åº”ç”¨æœåŠ¡å™¨ä¸Šï¼Œåº”ä½¿ç”¨å¥åº·ç›‘æµ‹ç­–ç•¥ã€‚åº”å¯¹ä¸åŒçš„ä¸šåŠ¡æ•æ„Ÿç¨‹åº¦ï¼Œå¯ç›¸åº”è°ƒæ•´ç­–ç•¥å’Œé¢‘ç‡ã€‚</p></blockquote><h2 id="HTTP-HTTPS-å¥åº·ç›‘æµ‹æ­¥éª¤ï¼ˆä¸ƒå±‚ï¼‰">HTTP / HTTPS å¥åº·ç›‘æµ‹æ­¥éª¤ï¼ˆä¸ƒå±‚ï¼‰</h2><ol><li>è´Ÿè½½å‡è¡¡èŠ‚ç‚¹å‘åº”ç”¨æœåŠ¡å™¨å‘é€ HEAD è¯·æ±‚ã€‚</li><li>åº”ç”¨æœåŠ¡å™¨æ¥æ”¶åˆ° HEAD è¯·æ±‚åæ ¹æ®æƒ…å†µè¿”å›ç›¸åº”çŠ¶æ€ç ã€‚</li><li>è‹¥åœ¨è¶…æ—¶æ—¶é—´å†…æœªæ”¶åˆ°è¿”å›çš„çŠ¶æ€ç ï¼Œåˆ™åˆ¤æ–­ä¸ºè¶…æ—¶ï¼Œå¥åº·æ£€æŸ¥å¤±è´¥ã€‚</li><li>è‹¥åœ¨è¶…æ—¶æ—¶é—´å†…æ”¶åˆ°è¿”å›çš„çŠ¶æ€ç ï¼Œè´Ÿè½½å‡è¡¡èŠ‚ç‚¹è¿›è¡Œæ¯”å¯¹ï¼Œåˆ¤æ–­å¥åº·æ£€æŸ¥æ˜¯å¦æˆåŠŸã€‚</li></ol><h2 id="TCP-å¥åº·æ£€æŸ¥æ­¥éª¤ï¼ˆå››å±‚ï¼‰">TCP å¥åº·æ£€æŸ¥æ­¥éª¤ï¼ˆå››å±‚ï¼‰</h2><ol><li>è´Ÿè½½å‡è¡¡èŠ‚ç‚¹å‘å†…ç½‘åº”ç”¨æœåŠ¡å™¨ IP + PORT å‘ TCP SYN è¯·æ±‚æ•°æ®åŒ…ã€‚</li><li>å†…ç½‘åº”ç”¨æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œè‹¥åœ¨æ­£å¸¸ç›‘å¬ï¼Œåˆ™è¿”å› SYN + ACK æ•°æ®åŒ…ã€‚</li><li>è‹¥åœ¨è¶…æ—¶æ—¶é—´å†…æœªæ”¶åˆ°è¿”å›çš„æ•°æ®åŒ…ï¼Œåˆ™åˆ¤æ–­æœåŠ¡æ— å“åº”ã€å¥åº·æ£€æŸ¥å¤±è´¥ï¼Œå¹¶å‘å†…ç½‘åº”ç”¨æœåŠ¡å™¨å‘é€ RST æ•°æ®åŒ…ä¸­æ–­ TCP è¿æ¥ã€‚</li><li>è‹¥åœ¨è¶…æ—¶æ—¶é—´å†…æ”¶åˆ°è¿”å›çš„æ•°æ®åŒ…ï¼Œåˆ™åˆ¤å®šæœåŠ¡å¥åº·è¿è¡Œï¼Œå‘èµ· RST æ•°æ®åŒ…ä¸­æ–­ TCP è¿æ¥ã€‚</li></ol><h2 id="UDP-å¥åº·æ£€æŸ¥æ­¥éª¤ï¼ˆå››å±‚ï¼‰">UDP å¥åº·æ£€æŸ¥æ­¥éª¤ï¼ˆå››å±‚ï¼‰</h2><ol><li>è´Ÿè½½å‡è¡¡èŠ‚ç‚¹å‘å†…ç½‘åº”ç”¨æœåŠ¡å™¨ IP + PORT å‘é€ UDP æŠ¥æ–‡ã€‚</li><li>è‹¥å†…ç½‘åº”ç”¨æœåŠ¡å™¨æœªæ­£å¸¸ç›‘å¬ï¼Œåˆ™è¿”å›<code>PORT XX unreachable</code>çš„ ICMP æŠ¥é”™ä¿¡æ¯ï¼Œåä¹‹ä¸ºæ­£å¸¸ã€‚</li><li>è‹¥åœ¨è¶…æ—¶æ—¶é—´å†…æ”¶åˆ°äº†æŠ¥é”™ä¿¡æ¯ï¼Œåˆ™åˆ¤æ–­æœåŠ¡å¼‚å¸¸ï¼Œå¥åº·æ£€æŸ¥å¤±è´¥ã€‚</li><li>è‹¥åœ¨è¶…æ—¶æ—¶é—´å†…æœªæ”¶åˆ°æŠ¥é”™ä¿¡æ¯ï¼Œåˆ™åˆ¤æ–­æœåŠ¡å¥åº·è¿è¡Œã€‚</li></ol><h1>å››ã€VIP æŠ€æœ¯</h1><blockquote><p>Vrtual IP</p></blockquote><h2 id="è™šæ‹Ÿ-IP">è™šæ‹Ÿ IP</h2><ul><li>åœ¨ TCP / IP æ¶æ„ä¸‹ï¼Œæ‰€æœ‰æƒ³ä¸Šç½‘çš„ç”µè„‘ï¼Œä¸è®ºä»¥ä½•ç§å½¢å¼è¿ä¸Šç½‘ç»œï¼Œéƒ½ä¸éœ€è¦æœ‰ä¸€ä¸ªå”¯ä¸€çš„ IP åœ°å€ã€‚äº‹å®ä¸Š IP åœ°å€æ˜¯ä¸»æœºç¡¬ä»¶ç‰©ç†åœ°å€çš„ä¸€ç§æŠ½è±¡ã€‚</li><li>ç®€å•æ¥è¯´åœ°å€åˆ†ä¸ºä¸¤ç§<ul><li>MAC ç‰©ç†åœ°å€</li><li>IP é€»è¾‘åœ°å€</li></ul></li><li>è™šæ‹Ÿ IP æ˜¯ä¸€ä¸ªæœªåˆ†é…ç»™çœŸå®ä¸»æœºçš„ IPï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹å¤–æä¾›çš„æœåŠ¡å™¨çš„ä¸»æœºé™¤äº†æœ‰ä¸€ä¸ªçœŸå® IP è¿˜æœ‰ä¸€ä¸ªè™š IPï¼Œè¿™ä¸¤ä¸ª IP ä¸­çš„ä»»æ„ä¸€ä¸ªéƒ½å¯ä»¥è¿æ¥åˆ°è¿™å°ä¸»æœºã€‚<ul><li>é€šè¿‡è™šæ‹Ÿ IP å¯¹åº”çœŸå®ä¸»æœºçš„ MAC åœ°å€å®ç°</li></ul></li><li>è™šæ‹Ÿ IP ä¸€èˆ¬ç”¨ä½œè¾¾åˆ°é«˜å¯ç”¨çš„ç›®çš„ï¼Œæ¯”å¦‚è®©æ‰€æœ‰é¡¹ç›®ä¸­çš„æ•°æ®åº“é“¾æ¥é…ç½®éƒ½æ˜¯è¿™ä¸ªè™šæ‹Ÿ IPï¼Œå½“ä¸»æœåŠ¡å™¨å‘ç”Ÿæ•…éšœæ— æ³•å¯¹å¤–æä¾›æœåŠ¡æ—¶ï¼ŒåŠ¨æ€å°†è¿™ä¸ªè™š IP åˆ‡æ¢åˆ°å¤‡ç”¨æœåŠ¡å™¨ã€‚</li></ul><h2 id="è™šæ‹Ÿ-IP-åŸç†">è™šæ‹Ÿ IP åŸç†</h2><ol><li>ARP æ˜¯åœ°å€è§£æåè®®ï¼Œä½œç”¨ä¸ºå°†ä¸€ä¸ª IP åœ°å€è½¬æ¢ä¸º MAC åœ°å€ã€‚</li><li>æ¯å°ä¸»æœºéƒ½æœ‰ ARP é«˜é€Ÿç¼“å­˜ï¼Œå­˜å‚¨åŒä¸€ä¸ªç½‘ç»œå†… IP åœ°å€ä¸ MAC åœ°å€çš„æ˜ å°„å…³ç³»ï¼Œä¸»æœºå‘é€æ•°æ®ä¼šå…ˆä»è¿™ä¸ªç¼“å­˜ä¸­æŸ¥è¯¢ç›®æ ‡ IP å¯¹åº” MAC åœ°å€ï¼Œå‘è¿™ä¸ª MAC åœ°å€å‘é€æ•°æ®ã€‚æ“ä½œç³»ç»Ÿè‡ªåŠ¨ç»´æŠ¤è¿™ä¸ªç¼“å­˜ã€‚</li><li>Linux ä¸‹å¯ç”¨ ARP å‘½ä»¤æ“ä½œ ARP é«˜é€Ÿç¼“å­˜</li></ol><ul><li><p>æ¯”å¦‚å­˜åœ¨ä¸»æœº Aï¼ˆ192.168.1.6ï¼‰å’Œä¸»æœº Bï¼ˆ192.168.1.8ï¼‰ã€‚A ä½œä¸ºå¯¹å¤–æœåŠ¡çš„ä¸»æœåŠ¡å™¨ï¼ŒB ä½œä¸ºå¤‡ä»½æœºå™¨ï¼Œä¸¤å°æœåŠ¡å™¨ä¹‹é—´é€šè¿‡ HeartBeat é€šä¿¡ã€‚</p></li><li><p>å³ä¸»æœåŠ¡å™¨ä¼šå®šæ—¶ç»™å¤‡ä»½æœåŠ¡å™¨å‘é€æ•°æ®åŒ…ï¼Œå‘ŠçŸ¥ä¸»æœåŠ¡å™¨æ­£å¸¸ï¼Œå½“å¤‡ä»½æœåŠ¡å™¨åœ¨è§„å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°ä¸»æœåŠ¡å™¨çš„ HeartBeatï¼Œä¼šè®¤ä¸ºä¸»æœåŠ¡å™¨å®•æœºã€‚</p></li><li><p>æ­¤æ—¶å¤‡ä»½æœåŠ¡å™¨å°±å‡çº§ä¸ºä¸»æœåŠ¡å™¨ã€‚</p><ul><li>æœåŠ¡å™¨ B å°†è‡ªå·±çš„ ARP ç¼“å­˜å‘é€å‡ºå»ï¼Œå‘ŠçŸ¥è·¯ç”±å™¨ä¿®æ”¹è·¯ç”±è¡¨ï¼Œå‘ŠçŸ¥è™šæ‹Ÿ IP åœ°å€åº”è¯¥æŒ‡å‘ 192.168.1.8.</li><li>è¿™æ—¶å¤–æ¥å†æ¬¡è®¿é—®è™šæ‹Ÿ IP çš„æ—¶å€™ï¼Œæœºå™¨ B å°±ä¼šå˜æˆä¸»æœåŠ¡å™¨ï¼Œè€Œ A é™çº§ä¸ºå¤‡ä»½æœåŠ¡å™¨ã€‚</li><li>è¿™æ ·å°±å®Œæˆäº†ä¸»ä»æœºå™¨çš„åˆ‡æ¢ï¼Œè¿™ä¸€åˆ‡å¯¹å¤–éƒ½æ˜¯æ— æ„ŸçŸ¥ã€é€æ˜çš„ã€‚</li></ul></li></ul><h1>äº”ã€åŸºäº nodejs å®ç°ä¸€ä¸ªç®€å•çš„è´Ÿè½½å‡è¡¡</h1><h2 id="é¢„æœŸæ•ˆæœ">é¢„æœŸæ•ˆæœ</h2><blockquote><p>ç¼–è¾‘ config.js å<code>npm run start</code>å³å¯å¯åŠ¨å‡è¡¡å™¨å’Œåç«¯æœåŠ¡èŠ‚ç‚¹</p></blockquote><ul><li><p>urlDescï¼šåç«¯æœåŠ¡èŠ‚ç‚¹é…ç½®å¯¹è±¡ï¼Œweight ä»…åœ¨ WeightRoundRobin ç®—æ³•æ—¶èµ·ä½œç”¨</p></li><li><p>portï¼šå‡è¡¡å™¨ç›‘å¬ç«¯å£</p></li><li><p>algorithmï¼šç®—æ³•åç§°ï¼ˆæ¨¡å—äºŒä¸­çš„ç®—æ³•å‡å·²å®ç°ï¼‰</p></li><li><p>workerNumï¼šåç«¯æœåŠ¡ç«¯å£å¼€å¯è¿›ç¨‹æ•°ï¼Œæä¾›å¹¶å‘èƒ½åŠ›ã€‚</p></li><li><p>balancerNumï¼šå‡è¡¡å™¨ç«¯å£å¼€å¯è¿›ç¨‹æ•°ï¼Œæä¾›å¹¶å‘èƒ½åŠ›ã€‚</p></li><li><p>workerFilePathï¼šåç«¯æœåŠ¡èŠ‚ç‚¹æ‰§è¡Œæ–‡ä»¶ï¼Œæ¨èä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;ALGORITHM, BASE_URL&#125; = <span class="built_in">require</span>(<span class="string">&quot;./constant&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    urlDesc: [</span><br><span class="line">        &#123;</span><br><span class="line">            url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;<span class="number">16666</span>&#125;</span>`</span>,</span><br><span class="line">            weight: <span class="number">6</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;<span class="number">16667</span>&#125;</span>`</span>,</span><br><span class="line">            weight: <span class="number">1</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;<span class="number">16668</span>&#125;</span>`</span>,</span><br><span class="line">            weight: <span class="number">1</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;<span class="number">16669</span>&#125;</span>`</span>,</span><br><span class="line">            weight: <span class="number">1</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;<span class="number">16670</span>&#125;</span>`</span>,</span><br><span class="line">            weight: <span class="number">2</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;<span class="number">16671</span>&#125;</span>`</span>,</span><br><span class="line">            weight: <span class="number">1</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;<span class="number">16672</span>&#125;</span>`</span>,</span><br><span class="line">            weight: <span class="number">4</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    ],</span><br><span class="line">    port: <span class="number">8080</span>,</span><br><span class="line">    algorithm: ALGORITHM.RANDOM,</span><br><span class="line">    workerNum: <span class="number">5</span>ï¼Œ</span><br><span class="line">    balancerNum: <span class="number">5</span>ï¼Œ</span><br><span class="line">    workerFilePath:path.resolve(__dirname, <span class="string">&quot;./worker.js&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¶æ„è®¾è®¡å›¾">æ¶æ„è®¾è®¡å›¾</h2><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/image-20210622003323078.png" alt="image-20210622003323078"></p><h2 id="å…ˆæ¥çœ‹çœ‹ä¸»æµç¨‹-main-js">å…ˆæ¥çœ‹çœ‹ä¸»æµç¨‹ main.js</h2><ol><li><p>åˆå§‹åŒ–è´Ÿè½½å‡è¡¡ç»Ÿè®¡å¯¹è±¡ balanceDataBase</p><ul><li>balanceDataBase æ˜¯ä¸€ä¸ª DataBase ç±»å®ä¾‹ï¼Œç”¨äºç»Ÿè®¡è´Ÿè½½å‡è¡¡æ•°æ®ï¼ˆåç»­ä¼šè®²åˆ°ï¼‰.</li></ul></li><li><p>è¿è¡Œå‡è¡¡å™¨</p><ul><li>å¤šè¿›ç¨‹æ¨¡å‹ï¼Œæä¾›å¹¶å‘èƒ½åŠ›ã€‚</li></ul></li><li><p>è¿è¡Œåç«¯æœåŠ¡èŠ‚ç‚¹</p><ul><li>å¤šçº¿ç¨‹+å¤šè¿›ç¨‹æ¨¡å‹ï¼Œè¿è¡Œå¤šä¸ªæœåŠ¡èŠ‚ç‚¹å¹¶æä¾›å¹¶å‘èƒ½åŠ›ã€‚</li></ul></li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; urlDesc, balancerNum &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./config&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> cluster = <span class="built_in">require</span>(<span class="string">&#x27;cluster&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> cpusLen = <span class="built_in">require</span>(<span class="string">&#x27;os&#x27;</span>).cpus().length;</span><br><span class="line"><span class="keyword">const</span> &#123; DataBase &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./util&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; Worker &#125; = <span class="built_in">require</span>(<span class="string">&#x27;worker_threads&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> runWorker = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// é˜²æ­¢ç›‘å¬ç«¯å£æ•° &gt; CPUæ ¸æ•°</span></span><br><span class="line">  <span class="keyword">const</span> urlObjArr = urlDesc.slice(<span class="number">0</span>, cpusLen);</span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–åˆ›å»ºå­çº¿ç¨‹</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; urlObjArr.length; i++) &#123;</span><br><span class="line">    createWorkerThread(urlObjArr[i].url);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> runBalancer = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è®¾ç½®å­è¿›ç¨‹æ‰§è¡Œæ–‡ä»¶</span></span><br><span class="line">  cluster.setupMaster(&#123; <span class="attr">exec</span>: path.resolve(__dirname, <span class="string">&#x27;./balancer.js&#x27;</span>) &#125;);</span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–åˆ›å»ºå­è¿›ç¨‹</span></span><br><span class="line">  <span class="keyword">let</span> max;</span><br><span class="line">  <span class="keyword">if</span> (balancerNum) &#123;</span><br><span class="line">    max = balancerNum &gt; cpusLen ? cpusLen : balancerNum;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    max = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; max; i++) &#123;</span><br><span class="line">    createBalancer();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–è´Ÿè½½å‡è¡¡æ•°æ®ç»Ÿè®¡å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> balanceDataBase = <span class="keyword">new</span> DataBase(urlDesc);</span><br><span class="line"><span class="comment">// è¿è¡Œå‡è¡¡å™¨</span></span><br><span class="line">runBalancer();</span><br><span class="line"><span class="comment">// è¿è¡Œåç«¯æœåŠ¡èŠ‚ç‚¹</span></span><br><span class="line">runWorker();</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºå‡è¡¡å™¨ï¼ˆcreateBalancer-å‡½æ•°ï¼‰">åˆ›å»ºå‡è¡¡å™¨ï¼ˆcreateBalancer å‡½æ•°ï¼‰</h3><ol><li>åˆ›å»ºè¿›ç¨‹</li><li>ç›‘å¬è¿›ç¨‹é€šä¿¡æ¶ˆæ¯<ul><li>ç›‘å¬æ›´æ–°å“åº”æ—¶é—´äº‹ä»¶å¹¶æ‰§è¡Œæ›´æ–°å‡½æ•°<ul><li>ç”¨äº FAIR ç®—æ³•ï¼ˆæœ€å°å“åº”æ—¶é—´ï¼‰ã€‚</li></ul></li><li>ç›‘å¬è·å–ç»Ÿè®¡å¯¹è±¡äº‹ä»¶å¹¶è¿”å›</li></ul></li><li>ç›‘å¬å¼‚å¸¸é€€å‡ºå¹¶é‡æ–°åˆ›å»ºï¼Œè¿›ç¨‹å®ˆæŠ¤ã€‚</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> createBalancer = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºè¿›ç¨‹</span></span><br><span class="line">  <span class="keyword">const</span> worker = cluster.fork();</span><br><span class="line">  worker.on(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ç›‘å¬æ›´æ–°å“åº”æ—¶é—´äº‹ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (msg.type === <span class="string">&#x27;updateCostTime&#x27;</span>) &#123;</span><br><span class="line">      balanceDataBase.updateCostTime(msg.URL, msg.costTime);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç›‘å¬è·å–urlç»Ÿè®¡å¯¹è±¡äº‹ä»¶å¹¶è¿”å›</span></span><br><span class="line">    <span class="keyword">if</span> (msg.type === <span class="string">&#x27;getUrlCollect&#x27;</span>) &#123;</span><br><span class="line">      worker.send(&#123;</span><br><span class="line">        type: <span class="string">&#x27;getUrlCollect&#x27;</span>,</span><br><span class="line">        urlCollect: balanceDataBase.urlCollect,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// ç›‘å¬å¼‚å¸¸é€€å‡ºäº‹ä»¶å¹¶é‡æ–°åˆ›å»ºè¿›ç¨‹</span></span><br><span class="line">  worker.on(<span class="string">&#x27;exit&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    createBalancer();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºåç«¯æœåŠ¡èŠ‚ç‚¹ï¼ˆcreateWorkerThread-å‡½æ•°ï¼‰">åˆ›å»ºåç«¯æœåŠ¡èŠ‚ç‚¹ï¼ˆcreateWorkerThread å‡½æ•°ï¼‰</h3><ol><li><p>åˆ›å»ºçº¿ç¨‹</p></li><li><p>è§£æéœ€è¦ç›‘å¬çš„ç«¯å£</p></li><li><p>å‘å­çº¿ç¨‹é€šä¿¡ï¼Œå‘é€éœ€è¦ç›‘å¬çš„ç«¯å£</p></li><li><p>é€šè¿‡çº¿ç¨‹é€šä¿¡ï¼Œç›‘å¬å­çº¿ç¨‹äº‹ä»¶</p><ul><li><p>ç›‘å¬è¿æ¥äº‹ä»¶ï¼Œå¹¶è§¦å‘å¤„ç†å‡½æ•°ã€‚</p></li><li><p>ç›‘å¬æ–­å¼€è¿æ¥äº‹ä»¶å¹¶è§¦å‘å¤„ç†å‡½æ•°ã€‚</p></li><li><p>ç”¨äºç»Ÿè®¡è´Ÿè½½å‡è¡¡åˆ†å¸ƒå’Œå®æ—¶è¿æ¥æ•°ã€‚</p></li></ul></li><li><p>ç›‘å¬å¼‚å¸¸é€€å‡ºå¹¶é‡æ–°åˆ›å»ºï¼Œçº¿ç¨‹å®ˆæŠ¤ã€‚</p></li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> createWorkerThread = <span class="function">(<span class="params">listenUrl</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºçº¿ç¨‹</span></span><br><span class="line">  <span class="keyword">const</span> worker = <span class="keyword">new</span> Worker(path.resolve(__dirname, <span class="string">&#x27;./workerThread.js&#x27;</span>));</span><br><span class="line">  <span class="comment">// è·å–ç›‘å¬ç«¯å£</span></span><br><span class="line">  <span class="keyword">const</span> listenPort = listenUrl.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">2</span>];</span><br><span class="line">  <span class="comment">// å‘å­çº¿ç¨‹å‘é€è¦ç›‘å¬çš„ç«¯å£å·</span></span><br><span class="line">  worker.postMessage(&#123; <span class="attr">type</span>: <span class="string">&#x27;port&#x27;</span>, <span class="attr">port</span>: listenPort &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¥æ”¶å­çº¿ç¨‹æ¶ˆæ¯ç»Ÿè®¡è¿›ç¨‹è¢«è®¿é—®æ¬¡æ•°</span></span><br><span class="line">  worker.on(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ç›‘å¬è¿æ¥äº‹ä»¶å¹¶è§¦å‘è®¡æ•°äº‹ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (msg.type === <span class="string">&#x27;connect&#x27;</span>) &#123;</span><br><span class="line">      balanceDataBase.add(msg.port);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç›‘å¬æ–­å¼€è¿æ¥äº‹ä»¶å¹¶è§¦å‘è®¡æ•°äº‹ä»¶</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (msg.type === <span class="string">&#x27;disconnect&#x27;</span>) &#123;</span><br><span class="line">      balanceDataBase.sub(msg.port);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// ç›‘å¬å¼‚å¸¸é€€å‡ºäº‹ä»¶å¹¶é‡æ–°åˆ›å»ºè¿›ç¨‹</span></span><br><span class="line">  worker.on(<span class="string">&#x27;exit&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    createWorkerThread(listenUrl);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="å†æ¥çœ‹çœ‹å‡è¡¡å™¨å·¥ä½œæµç¨‹-balancer-js">å†æ¥çœ‹çœ‹å‡è¡¡å™¨å·¥ä½œæµç¨‹ balancer.js</h2><ol><li>è·å– getURL å·¥å…·å‡½æ•°</li><li>ç›‘å¬è¯·æ±‚å¹¶ä»£ç†<ol><li>è·å–éœ€è¦ä¼ å…¥ getURL å·¥å…·å‡½æ•°çš„å‚æ•°ã€‚</li><li>é€šè¿‡ getURL å·¥å…·å‡½æ•°è·å–å‡è¡¡ä»£ç†ç›®çš„åœ°å€ URL</li><li>è®°å½•è¯·æ±‚å¼€å§‹æ—¶é—´</li><li>å¤„ç†è·¨åŸŸ</li><li>è¿”å›å“åº”</li><li>é€šè¿‡è¿›ç¨‹é€šä¿¡ï¼Œè§¦å‘å“åº”æ—¶é—´æ›´æ–°äº‹ä»¶ã€‚</li></ol></li></ol><blockquote><p>æ³¨ 1ï¼šLoadBalance å‡½æ•°å³é€šè¿‡ç®—æ³•åç§°è¿”å›ä¸åŒçš„ getURL å·¥å…·å‡½æ•°ï¼Œå„ç®—æ³•å®ç°è§æ¨¡å—äºŒï¼šå¸¸è§ç®—æ³•</p></blockquote><blockquote><p>æ³¨ 2ï¼šgetSource å‡½æ•°å³å¤„ç†å‚æ•°å¹¶è¿”å›ï¼ŒgetURL ä¸ºä¸Šé¢è®²åˆ°çš„è·å– URL å·¥å…·å‡½æ•°ã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> cpusLen = <span class="built_in">require</span>(<span class="string">&#x27;os&#x27;</span>).cpus().length;</span><br><span class="line"><span class="keyword">const</span> LoadBalance = <span class="built_in">require</span>(<span class="string">&#x27;./algorithm&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&#x27;axios&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"><span class="keyword">const</span> &#123; urlFormat, ipFormat &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./util&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; ALGORITHM, BASE_URL &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./constant&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; urlDesc, algorithm, port &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./config&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> run = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è·å–è½¬å‘URLå·¥å…·å‡½æ•°</span></span><br><span class="line">  <span class="keyword">const</span> getURL = LoadBalance(urlDesc.slice(<span class="number">0</span>, cpusLen), algorithm);</span><br><span class="line">  <span class="comment">// ç›‘å¬è¯·æ±‚å¹¶å‡è¡¡ä»£ç†</span></span><br><span class="line">  app.get(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">    <span class="comment">// è·å–éœ€è¦ä¼ å…¥çš„å‚æ•°</span></span><br><span class="line">    <span class="keyword">const</span> source = <span class="keyword">await</span> getSource(req);</span><br><span class="line">    <span class="comment">// è·å–URL</span></span><br><span class="line">    <span class="keyword">const</span> URL = getURL(source);</span><br><span class="line">    <span class="comment">// res.redirect(301, URL) é‡å®šå‘è´Ÿè½½å‡è¡¡</span></span><br><span class="line">    <span class="comment">// è®°å½•è¯·æ±‚å¼€å§‹æ—¶é—´</span></span><br><span class="line">    <span class="keyword">const</span> start = <span class="built_in">Date</span>.now();</span><br><span class="line">    <span class="comment">// ä»£ç†è¯·æ±‚</span></span><br><span class="line">    axios.get(URL).then(<span class="keyword">async</span> (response) =&gt; &#123;</span><br><span class="line">      <span class="comment">// è·å–è´Ÿè½½å‡è¡¡ç»Ÿè®¡å¯¹è±¡å¹¶è¿”å›</span></span><br><span class="line">      <span class="keyword">const</span> urlCollect = <span class="keyword">await</span> getUrlCollect();</span><br><span class="line">      <span class="comment">// å¤„ç†è·¨åŸŸ</span></span><br><span class="line">      res.setHeader(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">      response.data.urlCollect = urlCollect;</span><br><span class="line">      <span class="comment">// è¿”å›æ•°æ®</span></span><br><span class="line">      res.send(response.data);</span><br><span class="line">      <span class="comment">// è®°å½•ç›¸åº”æ—¶é—´å¹¶æ›´æ–°</span></span><br><span class="line">      <span class="keyword">const</span> costTime = <span class="built_in">Date</span>.now() - start;</span><br><span class="line">      process.send(&#123; <span class="attr">type</span>: <span class="string">&#x27;updateCostTime&#x27;</span>, costTime, URL &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// è´Ÿè½½å‡è¡¡æœåŠ¡å™¨å¼€å§‹ç›‘å¬è¯·æ±‚</span></span><br><span class="line">  app.listen(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Load Balance Server Running at <span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">run();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getSource = <span class="keyword">async</span> (req) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (algorithm) &#123;</span><br><span class="line">    <span class="keyword">case</span> ALGORITHM.IP_HASH:</span><br><span class="line">      <span class="keyword">return</span> ipFormat(req);</span><br><span class="line">    <span class="keyword">case</span> ALGORITHM.URL_HASH:</span><br><span class="line">      <span class="keyword">return</span> urlFormat(req);</span><br><span class="line">    <span class="keyword">case</span> ALGORITHM.CONSISTENT_HASH:</span><br><span class="line">      <span class="keyword">return</span> urlFormat(req);</span><br><span class="line">    <span class="keyword">case</span> ALGORITHM.LEAST_CONNECTIONS:</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">await</span> getUrlCollect();</span><br><span class="line">    <span class="keyword">case</span> ALGORITHM.FAIR:</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">await</span> getUrlCollect();</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="å¦‚ä½•åœ¨å‡è¡¡å™¨ä¸­è·å–è´Ÿè½½å‡è¡¡ç»Ÿè®¡å¯¹è±¡-getUrlCollect">å¦‚ä½•åœ¨å‡è¡¡å™¨ä¸­è·å–è´Ÿè½½å‡è¡¡ç»Ÿè®¡å¯¹è±¡ getUrlCollect</h3><ol><li>é€šè¿‡è¿›ç¨‹é€šä¿¡ï¼Œå‘çˆ¶è¿›ç¨‹å‘é€è·å–æ¶ˆæ¯ã€‚</li><li>åŒæ—¶å¼€å§‹ç›‘å¬çˆ¶è¿›ç¨‹é€šä¿¡æ¶ˆæ¯ï¼Œæ¥æ”¶åä½¿ç”¨ Promise resovle è¿”å›ã€‚</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è·å–è´Ÿè½½å‡è¡¡ç»Ÿè®¡å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> getUrlCollect = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      process.send(&#123; <span class="attr">type</span>: <span class="string">&#x27;getUrlCollect&#x27;</span> &#125;);</span><br><span class="line">      process.on(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (msg.type === <span class="string">&#x27;getUrlCollect&#x27;</span>) &#123;</span><br><span class="line">          resolve(msg.urlCollect);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      reject(e);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="å¦‚ä½•å®ç°æœåŠ¡èŠ‚ç‚¹å¹¶å‘-workerThread-js">å¦‚ä½•å®ç°æœåŠ¡èŠ‚ç‚¹å¹¶å‘ workerThread.js</h2><blockquote><p>ä½¿ç”¨å¤šçº¿ç¨‹+å¤šè¿›ç¨‹æ¨¡å‹ï¼Œä¸ºæ¯ä¸ªæœåŠ¡èŠ‚ç‚¹æä¾›å¹¶å‘èƒ½åŠ›ã€‚</p></blockquote><h3 id="ä¸»è¿›ç¨‹æµç¨‹">ä¸»è¿›ç¨‹æµç¨‹</h3><ol><li>æ ¹æ®é…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºç›¸åº”æ•°é‡æœåŠ¡èŠ‚ç‚¹ã€‚<ol><li>åˆ›å»ºè¿›ç¨‹</li><li>ç›‘å¬çˆ¶çº¿ç¨‹æ¶ˆæ¯ï¼ˆæœåŠ¡èŠ‚ç‚¹ç›‘å¬ç«¯å£ï¼‰ï¼Œå¹¶è½¬å‘ç»™å­è¿›ç¨‹ã€‚</li><li>ç›‘å¬å­è¿›ç¨‹æ¶ˆæ¯ï¼Œå¹¶è½¬å‘ç»™çˆ¶çº¿ç¨‹ï¼ˆå»ºç«‹è¿æ¥ã€æ–­å¼€è¿æ¥äº‹ä»¶ï¼‰ã€‚</li><li>ç›‘å¬å¼‚å¸¸é€€å‡ºå¹¶é‡æ–°å»ºç«‹ã€‚</li></ol></li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> cluster = <span class="built_in">require</span>(<span class="string">&#x27;cluster&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> cpusLen = <span class="built_in">require</span>(<span class="string">&#x27;os&#x27;</span>).cpus().length;</span><br><span class="line"><span class="keyword">const</span> &#123; parentPort &#125; = <span class="built_in">require</span>(<span class="string">&#x27;worker_threads&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; workerNum, workerFilePath &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./config&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (cluster.isMaster) &#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºå·¥ä½œè¿›ç¨‹å‡½æ•°</span></span><br><span class="line">  <span class="keyword">const</span> createWorker = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºè¿›ç¨‹</span></span><br><span class="line">    <span class="keyword">const</span> worker = cluster.fork();</span><br><span class="line">    <span class="comment">// ç›‘å¬çˆ¶çº¿ç¨‹æ¶ˆæ¯ï¼Œå¹¶è½¬å‘ç»™å­è¿›ç¨‹ã€‚</span></span><br><span class="line">    parentPort.on(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (msg.type === <span class="string">&#x27;port&#x27;</span>) &#123;</span><br><span class="line">        worker.send(&#123; <span class="attr">type</span>: <span class="string">&#x27;port&#x27;</span>, <span class="attr">port</span>: msg.port &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// ç›‘å¬å­è¿›ç¨‹æ¶ˆæ¯å¹¶è½¬å‘ç»™çˆ¶çº¿ç¨‹</span></span><br><span class="line">    worker.on(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">      parentPort.postMessage(msg);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// ç›‘å¬è¿›ç¨‹å¼‚å¸¸é€€å‡ºå¹¶é‡æ–°åˆ›å»º</span></span><br><span class="line">    worker.on(<span class="string">&#x27;exit&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      createWorker();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// æŒ‰é…ç½®åˆ›å»ºè¿›ç¨‹ï¼Œä½†ä¸å¯å¤§äºCPUæ ¸æ•°</span></span><br><span class="line">  <span class="keyword">let</span> max;</span><br><span class="line">  <span class="keyword">if</span> (workerNum) &#123;</span><br><span class="line">    max = workerNum &gt; cpusLen ? cpusLen : workerNum;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    max = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; max; i++) &#123;</span><br><span class="line">    createWorker();</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// åç«¯æœåŠ¡æ‰§è¡Œæ–‡ä»¶</span></span><br><span class="line">  <span class="built_in">require</span>(workerFilePath);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å­è¿›ç¨‹æµç¨‹-worker-jsï¼ˆconfig-workerFilePathï¼‰">å­è¿›ç¨‹æµç¨‹ worker.jsï¼ˆconfig.workerFilePathï¼‰</h3><ol><li>é€šè¿‡è¿›ç¨‹é—´é€šä¿¡ï¼Œå‘çˆ¶è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼Œè§¦å‘å»ºç«‹è¿æ¥äº‹ä»¶ã€‚</li><li>è¿”å›ç›¸åº”ã€‚</li><li>é€šè¿‡è¿›ç¨‹é—´é€šä¿¡ï¼Œå‘çˆ¶è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼Œè§¦å‘æ–­å¼€è¿æ¥äº‹ä»¶ã€‚</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"><span class="keyword">let</span> port = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è§¦å‘è¿æ¥äº‹ä»¶</span></span><br><span class="line">  process.send(&#123; <span class="attr">type</span>: <span class="string">&#x27;connect&#x27;</span>, port &#125;);</span><br><span class="line">  <span class="comment">// æ‰“å°ä¿¡æ¯</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;HTTP Version: &#x27;</span> + req.httpVersion);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;Connection PORT Is &#x27;</span> + port);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> msg = <span class="string">&#x27;Hello My PORT is &#x27;</span> + port;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿”å›å“åº”</span></span><br><span class="line">  res.send(&#123; msg &#125;);</span><br><span class="line">  <span class="comment">// è§¦å‘æ–­å¼€è¿æ¥äº‹ä»¶</span></span><br><span class="line">  process.send(&#123; <span class="attr">type</span>: <span class="string">&#x27;disconnect&#x27;</span>, port &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¥æ”¶ä¸»è¿›é€šä¿¡æ¶ˆæ¯ä¸­çš„ç«¯å£å£å¹¶ç›‘å¬</span></span><br><span class="line">process.on(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (msg.type === <span class="string">&#x27;port&#x27;</span>) &#123;</span><br><span class="line">    port = msg.port;</span><br><span class="line">    app.listen(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;Worker Listening &#x27;</span> + port);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="æœ€åæ¥çœ‹çœ‹-DataBase-ç±»">æœ€åæ¥çœ‹çœ‹ DataBase ç±»</h2><ul><li>æˆå‘˜ï¼š</li></ul><ol><li>statusï¼šä»»åŠ¡é˜Ÿåˆ—çŠ¶æ€</li><li>urlCollectï¼šæ•°æ®ç»Ÿè®¡å¯¹è±¡ï¼ˆæä¾›ç»™å„ç®—æ³•ä½¿ç”¨ / å±•ç¤ºæ•°æ®ï¼‰<ol><li>countï¼šå¤„ç†è¯·æ±‚æ•°</li><li>costTimeï¼šå“åº”æ—¶é—´</li><li>connectionï¼šå®æ—¶è¿æ¥æ•°</li></ol></li><li>add æ–¹æ³•<ol><li>å¢åŠ è¿æ¥æ•°å’Œå®æ—¶è¿æ¥æ•°</li></ol></li><li>sub æ–¹æ³•<ol><li>å‡å°‘å®æ—¶è¿æ¥æ•°</li></ol></li><li>updateCostTime æ–¹æ³•<ol><li>æ›´æ–°å“åº”æ—¶é—´</li></ol></li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DataBase</span> </span>&#123;</span><br><span class="line">  urlCollect = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">urlObj</span>)</span> &#123;</span><br><span class="line">    urlObj.forEach(<span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.urlCollect[val.url] = &#123;</span><br><span class="line">        count: <span class="number">0</span>,</span><br><span class="line">        costTime: <span class="number">0</span>,</span><br><span class="line">        connection: <span class="number">0</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//å¢åŠ è¿æ¥æ•°å’Œå®æ—¶è¿æ¥æ•°</span></span><br><span class="line">  <span class="function"><span class="title">add</span>(<span class="params">port</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> url = <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;port&#125;</span>`</span>;</span><br><span class="line">    <span class="built_in">this</span>.urlCollect[url].count++;</span><br><span class="line">    <span class="built_in">this</span>.urlCollect[url].connection++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å‡å°‘å®æ—¶è¿æ¥æ•°</span></span><br><span class="line">  <span class="function"><span class="title">sub</span>(<span class="params">port</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> url = <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;port&#125;</span>`</span>;</span><br><span class="line">    <span class="built_in">this</span>.urlCollect[url].connection--;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ›´æ–°å“åº”æ—¶é—´</span></span><br><span class="line">  <span class="function"><span class="title">updateCostTime</span>(<span class="params">url, time</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.urlCollect[url].costTime = time;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æœ€ç»ˆæ•ˆæœ">æœ€ç»ˆæ•ˆæœ</h2><blockquote><p>åšäº†ä¸ªå¯è§†åŒ–å›¾è¡¨æ¥çœ‹å‡è¡¡æ•ˆæœ(Random)âœ”ï¸</p></blockquote><blockquote><p>çœ‹èµ·æ¥å‡è¡¡æ•ˆæœè¿˜ä¸é”™ ğŸ§</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20210622003557369.(null)" alt="img"></p><h1>å°ä½œä¸š</h1><blockquote><p>æƒ³æ‰‹åŠ¨å®ç°ä¸€ä¸‹è´Ÿè½½å‡è¡¡å™¨ / çœ‹çœ‹æºç çš„åŒå­¦éƒ½å¯ä»¥çœ‹çœ‹ ğŸ‘‰ğŸ» <a href="https://github.com/LeBronChao/LoadBalancer">ä»£ç ä»“åº“</a></p></blockquote><h1>å…­ã€çŸ¥è¯†æ‰©å±•</h1><h2 id="cluster-å¤šè¿›ç¨‹ä¸ºä»€ä¹ˆå¯ä»¥ç›‘å¬ä¸€ä¸ªç«¯å£">cluster å¤šè¿›ç¨‹ä¸ºä»€ä¹ˆå¯ä»¥ç›‘å¬ä¸€ä¸ªç«¯å£?</h2><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/image-20210622003752283.png" alt="image-20210622003752283"></p><ol><li>é€šè¿‡ cluster.isMaster åˆ¤æ–­æ˜¯å¦ä¸ºä¸»è¿›ç¨‹ï¼Œä¸»è¿›ç¨‹ä¸è´Ÿè´£ä»»åŠ¡å¤„ç†ï¼Œåªè´Ÿè´£ç®¡ç†å’Œè°ƒåº¦å·¥ä½œå­è¿›ç¨‹ã€‚</li><li>master ä¸»è¿›ç¨‹å¯åŠ¨äº†ä¸€ä¸ª TCP æœåŠ¡å™¨ï¼ŒçœŸæ­£ç›‘å¬ç«¯å£çš„åªæœ‰è¿™ä¸ª TCP æœåŠ¡å™¨ã€‚è¯·æ±‚è§¦å‘äº†è¿™ä¸ª TCP æœåŠ¡å™¨çš„<code>connection</code>äº‹ä»¶åï¼Œé€šè¿‡å¥æŸ„è½¬å‘ï¼ˆIPCï¼‰ç»™å·¥ä½œè¿›ç¨‹å¤„ç†ã€‚<ol><li>å¥æŸ„è½¬å‘å¯è½¬å‘ TCP æœåŠ¡å™¨ã€TCP å¥—æ¥å­—ã€UDP å¥—æ¥å­—ã€IPC ç®¡é“</li><li>IPC åªæ”¯æŒä¼ è¾“å­—ç¬¦ä¸²ï¼Œä¸æ”¯æŒä¼ è¾“å¯¹è±¡ï¼ˆå¯åºåˆ—åŒ–ï¼‰ã€‚</li><li>è½¬å‘æµç¨‹ï¼šçˆ¶è¿›ç¨‹å‘é€ -&gt; stringfy &amp;&amp; send(fd) -&gt; IPC -&gt; get(fd) &amp;&amp; parse -&gt; å­è¿›ç¨‹æ¥æ”¶</li><li>fd ä¸ºå¥æŸ„æ–‡ä»¶æè¿°ç¬¦ã€‚</li></ol></li><li>å¦‚ä½•é€‰æ‹©å·¥ä½œè¿›ç¨‹?<ol><li>cluster æ¨¡å—å†…ç½®äº† RoundRobin ç®—æ³•ï¼Œè½®è¯¢é€‰æ‹©å·¥ä½œè¿›ç¨‹ã€‚</li></ol></li><li>ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨ cluster è¿›è¡Œè´Ÿè½½å‡è¡¡?<ol><li>æ‰‹åŠ¨å®ç°å¯æ ¹æ®ä¸åŒåœºæ™¯é€‰æ‹©ä¸åŒçš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚</li></ol></li></ol><h2 id="Node-æ€ä¹ˆå®ç°è¿›ç¨‹é—´é€šä¿¡çš„ï¼Ÿ">Node æ€ä¹ˆå®ç°è¿›ç¨‹é—´é€šä¿¡çš„ï¼Ÿ</h2><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20210622003758932.(null)" alt="img"></p><ol><li>å¸¸è§çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼<ol><li>ç®¡é“é€šä¿¡<ol><li>åŒ¿åç®¡é“</li><li>å‘½åç®¡é“</li></ol></li><li>ä¿¡å·é‡</li><li>å…±äº«å†…å­˜</li><li>Socket</li><li>æ¶ˆæ¯é˜Ÿåˆ—</li></ol></li><li>Node ä¸­å®ç° IPC é€šé“æ˜¯ä¾èµ–äº libuvã€‚Windows ä¸‹ç”±å‘½åç®¡é“å®ç°ï¼Œ*nix ç³»ç»Ÿåˆ™é‡‡ç”¨ Domain Socket å®ç°ã€‚</li><li>è¡¨ç°åœ¨åº”ç”¨å±‚ä¸Šçš„è¿›ç¨‹é—´é€šä¿¡åªæœ‰ç®€å•çš„ message äº‹ä»¶å’Œ send()æ–¹æ³•ï¼Œæ¥å£ååˆ†ç®€æ´å’Œæ¶ˆæ¯åŒ–ã€‚</li><li>IPC ç®¡é“æ˜¯å¦‚ä½•å»ºç«‹çš„ï¼Ÿ<ol><li>çˆ¶è¿›ç¨‹å…ˆé€šè¿‡ç¯å¢ƒå˜é‡å‘ŠçŸ¥å­è¿›ç¨‹ç®¡é“çš„æ–‡ä»¶æè¿°ç¬¦</li><li>çˆ¶è¿›ç¨‹åˆ›å»ºå­è¿›ç¨‹</li><li>å­è¿›ç¨‹å¯åŠ¨ï¼Œé€šè¿‡æ–‡ä»¶æè¿°ç¬¦è¿æ¥å·²å­˜åœ¨çš„ IPC ç®¡é“ï¼Œä¸çˆ¶è¿›ç¨‹å»ºç«‹è¿æ¥ã€‚</li></ol></li></ol><h2 id="å¤šè¿›ç¨‹-VS-å¤šçº¿ç¨‹">å¤šè¿›ç¨‹ VS å¤šçº¿ç¨‹</h2><h3 id="å¤šè¿›ç¨‹">å¤šè¿›ç¨‹</h3><ol><li>æ•°æ®å…±äº«å¤æ‚ï¼Œéœ€è¦ IPCã€‚æ•°æ®æ˜¯åˆ†å¼€çš„ï¼ŒåŒæ­¥ç®€å•ã€‚</li><li>å ç”¨å†…å­˜å¤šï¼ŒCPU åˆ©ç”¨ç‡ä½ã€‚</li><li>åˆ›å»ºé”€æ¯å¤æ‚ï¼Œé€Ÿåº¦æ…¢</li><li>è¿›ç¨‹ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¼šç›¸äº’å½±å“</li><li>å¯ç”¨äºå¤šæœºå¤šæ ¸åˆ†å¸ƒå¼ï¼Œæ˜“äºæ‰©å±•</li></ol><h3 id="å¤šçº¿ç¨‹">å¤šçº¿ç¨‹</h3><ol><li>å…±äº«è¿›ç¨‹æ•°æ®ï¼Œæ•°æ®å…±äº«ç®€å•ï¼ŒåŒæ­¥å¤æ‚ã€‚</li><li>å ç”¨å†…å­˜å°‘ï¼ŒCPU åˆ©ç”¨ç‡é«˜ã€‚</li><li>åˆ›å»ºé”€æ¯ç®€å•ï¼Œé€Ÿåº¦å¿«ã€‚</li><li>çº¿ç¨‹åŒå‘¼å¸å…±å‘½è¿ã€‚</li><li>åªèƒ½ç”¨äºå¤šæ ¸åˆ†å¸ƒå¼ã€‚</li></ol><h1>ä¸ƒã€ç”±æœ¬æ¬¡åˆ†äº«äº§ç”Ÿçš„ä¸€äº›æƒ³æ³•</h1><blockquote><p>æ¬¢è¿ç•™è¨€è®¨è®º</p></blockquote><ol><li>Node.js éé˜»å¡å¼‚æ­¥ I/O é€Ÿåº¦å¿«ï¼Œå‰ç«¯æ‰©å±•æœåŠ¡ç«¯ä¸šåŠ¡ï¼Ÿ</li><li>ä¼ä¸šå®è·µï¼Œè¯´æ˜ Node è¿˜æ˜¯å¯é çš„ï¼Ÿ<ol><li>é˜¿é‡Œ Node ä¸­å°æ¶æ„</li><li>è…¾è®¯ CloudBase äº‘å¼€å‘ Node</li><li>å¤§é‡ Node.js å…¨æ ˆå·¥ç¨‹å¸ˆå²—ä½</li></ol></li><li>Node è®¡ç®—å¯†é›†å‹ä¸å‹å¥½ï¼Ÿ<ol><li>Serverless ç››è¡Œï¼Œè®¡ç®—å¯†é›†å‹ç”¨ C++/Go/Java ç¼–å†™ï¼Œä»¥ Faas çš„æ–¹å¼è°ƒç”¨ã€‚</li></ol></li><li>Node ç”Ÿæ€ä¸å¦‚å…¶ä»–æˆç†Ÿçš„è¯­è¨€<ol><li>é˜¿é‡Œè¾“å‡ºäº† Java ç”Ÿæ€</li><li>æ˜¯ä¸æ˜¯å¯ä»¥çœ‹å‡†è¶‹åŠ¿ï¼Œæ‰“é€  Node ç”Ÿæ€ä»¥å¢å¼ºå›¢é˜Ÿå½±å“åŠ›ã€‚</li></ol></li><li>æœªé›¨ç»¸ç¼ªï¼Œå°† Node &amp; æœåŠ¡ç«¯ä¸šåŠ¡çŸ¥è¯†åŠ å…¥å­¦ä¹ è®¡åˆ’ / è§„åˆ’ä¸“é¢˜åˆ†äº«ï¼Ÿ</li><li>è®¨è®º</li></ol><ul><li><a href="https://www.zhihu.com/question/357717742/answer/926367671"> Node.js åš Web åç«¯ä¼˜åŠ¿ä¸ºä»€ä¹ˆè¿™ä¹ˆå¤§ï¼Ÿ - çŸ¥ä¹ (zhihu.com)</a></li></ul><h1>å…«ã€å‚è€ƒèµ„æ–™</h1><ol><li><a href="https://help.aliyun.com/document_detail/85958.html">å¥åº·æ£€æŸ¥æ¦‚è¿° - è´Ÿè½½å‡è¡¡</a></li><li>ã€Šæ·±å…¥æµ…å‡º Node.jsã€‹</li><li><a href="http://nodejs.cn/">Node.js (nodejs.cn)</a></li><li><a href="https://juejin.cn/post/6844903908385488903#heading-17">æ·±å…¥ç†è§£ Node.js ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹ </a></li></ol><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Load Balance è´Ÿè½½å‡è¡¡ ğŸŒ¡&lt;/h1&gt;
&lt;p&gt;&lt;img src= &quot;/img/loading.gif&quot; data-lazy-src=&quot;https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc</summary>
      
    
    
    
    <category term="è®¡ç®—æœºç½‘ç»œ" scheme="https://lebronchao.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"/>
    
    
    <category term="è®¡ç®—æœºç½‘ç»œ" scheme="https://lebronchao.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"/>
    
    <category term="è´Ÿè½½å‡è¡¡" scheme="https://lebronchao.com/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
    
    <category term="Node" scheme="https://lebronchao.com/tags/Node/"/>
    
    <category term="è¿›ç¨‹" scheme="https://lebronchao.com/tags/%E8%BF%9B%E7%A8%8B/"/>
    
    <category term="çº¿ç¨‹" scheme="https://lebronchao.com/tags/%E7%BA%BF%E7%A8%8B/"/>
    
    <category term="è¿›ç¨‹é—´é€šä¿¡" scheme="https://lebronchao.com/tags/%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/"/>
    
  </entry>
  
  <entry>
    <title>[å»ºè®®æ”¶è—]ä½ æƒ³çŸ¥é“çš„Vue3æ ¸å¿ƒæºç è¿™é‡Œéƒ½æœ‰</title>
    <link href="https://lebronchao.com/2021/07/07/Vue3%E6%A0%B8%E5%BF%83%E6%BA%90%E7%A0%81/"/>
    <id>https://lebronchao.com/2021/07/07/Vue3%E6%A0%B8%E5%BF%83%E6%BA%90%E7%A0%81/</id>
    <published>2021-07-06T17:09:08.000Z</published>
    <updated>2021-07-06T17:09:08.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Effect å’Œ Reactive</h1><blockquote><p>effect ä½œä¸º Vue å“åº”å¼åŸç†ä¸­çš„æ ¸å¿ƒï¼Œåœ¨ Computedã€Watchã€Reactive ä¸­éƒ½æœ‰å‡ºç°</p><p>ä¸»è¦å’Œ Reactive(Proxy)ã€trackã€trigger ç­‰å‡½æ•°é…åˆå®ç°æ”¶é›†ä¾èµ–ï¼Œè§¦å‘ä¾èµ–æ›´æ–°</p></blockquote><ul><li>Effect<ul><li>å‰¯ä½œç”¨ä¾èµ–å‡½æ•°</li></ul></li><li>Track<ul><li>ä¾èµ–æ”¶é›†</li></ul></li><li>Trigger<ul><li>ä¾èµ–è§¦å‘</li></ul></li></ul><h2 id="Effect">Effect</h2><blockquote><p>effect å¯ä»¥è¢«ç†è§£ä¸ºä¸€ä¸ªå‰¯ä½œç”¨å‡½æ•°ï¼Œè¢«å½“åšä¾èµ–æ”¶é›†ï¼Œåœ¨å“åº”å¼æ•°æ®æ›´æ–°åè¢«è§¦å‘ã€‚</p><p>Vue çš„å“åº”å¼ API ä¾‹å¦‚ Computedã€Watch éƒ½æœ‰ç”¨åˆ° effect æ¥å®ç°</p></blockquote><ul><li>å…ˆæ¥çœ‹çœ‹å…¥å£å‡½æ•°<ul><li>å…¥å£å‡½æ•°ä¸»è¦æ˜¯ä¸€äº›é€»è¾‘å¤„ç†ï¼Œæ ¸å¿ƒé€»è¾‘ä½äº createReactiveEffect</li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">effect</span>&lt;<span class="title">T</span> = <span class="title">any</span>&gt;(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  fn: () =&gt; T,</span></span></span><br><span class="line"><span class="function"><span class="params">  options: ReactiveEffectOptions = EMPTY_OBJ</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">ReactiveEffect</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// å¦‚æœå·²ç»æ˜¯effectï¼Œåˆ™é‡ç½®</span></span><br><span class="line">  <span class="keyword">if</span> (isEffect(fn)) &#123;</span><br><span class="line">    fn = fn.raw;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// åˆ›å»ºeffect</span></span><br><span class="line">  <span class="keyword">const</span> effect = createReactiveEffect(fn, options);</span><br><span class="line">  <span class="comment">// å¦‚æœä¸æ˜¯æƒ°æ€§æ‰§è¡Œï¼Œå…ˆæ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">  <span class="keyword">if</span> (!options.lazy) &#123;</span><br><span class="line">    effect();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> effect;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>createReactiveEffect</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> effectStack: ReactiveEffect[] = [];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createReactiveEffect</span>&lt;<span class="title">T</span> = <span class="title">any</span>&gt;(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  fn: () =&gt; T,</span></span></span><br><span class="line"><span class="function"><span class="params">  options: ReactiveEffectOptions</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">ReactiveEffect</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> effect = <span class="function"><span class="keyword">function</span> <span class="title">reactiveEffect</span>(<span class="params"></span>): <span class="title">unknown</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ²¡æœ‰æ¿€æ´»ï¼Œè¯´æ˜è°ƒç”¨äº†effect stopå‡½æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (!effect.active) &#123;</span><br><span class="line">      <span class="comment">// æ— è°ƒåº¦è€…åˆ™ç›´æ¥è¿”å›ï¼Œå¦åˆ™æ‰§è¡Œfn</span></span><br><span class="line">      <span class="keyword">return</span> options.scheduler ? <span class="literal">undefined</span> : fn();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­EffectStackä¸­æœ‰æ²¡æœ‰effectï¼Œæœ‰åˆ™ä¸å¤„ç†</span></span><br><span class="line">    <span class="keyword">if</span> (!effectStack.includes(effect)) &#123;</span><br><span class="line">      <span class="comment">// æ¸…é™¤effect</span></span><br><span class="line">      cleanup(effect);</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * å¼€å§‹é‡æ–°æ”¶é›†ä¾èµ–</span></span><br><span class="line"><span class="comment">         * å‹å…¥stack</span></span><br><span class="line"><span class="comment">         * å°†effectè®¾ç½®ä¸ºactiveEffect</span></span><br><span class="line"><span class="comment">         * */</span></span><br><span class="line">        enableTracking();</span><br><span class="line">        effectStack.push(effect);</span><br><span class="line">        activeEffect = effect;</span><br><span class="line">        <span class="keyword">return</span> fn();</span><br><span class="line">      &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * å®Œæˆåå°†effectå¼¹å‡º</span></span><br><span class="line"><span class="comment">         * é‡ç½®ä¾èµ–</span></span><br><span class="line"><span class="comment">         * é‡ç½®activeEffect</span></span><br><span class="line"><span class="comment">         * */</span></span><br><span class="line">        effectStack.pop();</span><br><span class="line">        resetTracking();</span><br><span class="line">        activeEffect = effectStack[effectStack.length - <span class="number">1</span>];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">as</span> ReactiveEffect;</span><br><span class="line">  effect.id = uid++; <span class="comment">// è‡ªå¢idï¼Œeffectå”¯ä¸€æ ‡è¯†</span></span><br><span class="line">  effect.allowRecurse = !!options.allowRecurse;</span><br><span class="line">  effect._isEffect = <span class="literal">true</span>; <span class="comment">// æ˜¯å¦æ˜¯effect</span></span><br><span class="line">  effect.active = <span class="literal">true</span>; <span class="comment">// æ˜¯å¦æ¿€æ´»</span></span><br><span class="line">  effect.raw = fn; <span class="comment">// æŒ‚è½½åŸå§‹å¯¹è±¡</span></span><br><span class="line">  effect.deps = []; <span class="comment">// å½“å‰effectçš„depæ•°ç»„</span></span><br><span class="line">  effect.options = options; <span class="comment">// ä¼ å…¥çš„options</span></span><br><span class="line">  <span class="keyword">return</span> effect;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¯æ¬¡effectè¿è¡Œéƒ½ä¼šé‡æ–°æ”¶é›†ä¾èµ–ï¼Œdepsæ˜¯effectçš„ä¾èµ–æ•°ç»„ï¼Œéœ€è¦å…¨éƒ¨æ¸…ç©º</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cleanup</span>(<span class="params">effect: ReactiveEffect</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; deps &#125; = effect;</span><br><span class="line">  <span class="keyword">if</span> (deps.length) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; deps.length; i++) &#123;</span><br><span class="line">      deps[i].delete(effect);</span><br><span class="line">    &#125;</span><br><span class="line">    deps.length = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Track">Track</h2><blockquote><p>Track è¿™ä¸ªå‡½æ•°å¸¸å‡ºç°åœ¨ reactive çš„ getter å‡½æ•°ä¸­ï¼Œç”¨äºä¾èµ–æ”¶é›†</p><p>æºç è¯¦è§£è§æ³¨é‡Š</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">track</span>(<span class="params">target: <span class="built_in">object</span>, <span class="keyword">type</span>: TrackOpTypes, key: unknown</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// activeEffectä¸ºç©ºè¡¨ç¤ºæ²¡æœ‰ä¾èµ–</span></span><br><span class="line">  <span class="keyword">if</span> (!shouldTrack || activeEffect === <span class="literal">undefined</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// targetMapä¾èµ–ç®¡ç†Mapï¼Œç”¨äºæ”¶é›†ä¾èµ–</span></span><br><span class="line">  <span class="comment">// æ£€æŸ¥targetMapä¸­æœ‰æ²¡æœ‰targetï¼Œæ²¡æœ‰åˆ™æ–°å»º</span></span><br><span class="line">  <span class="keyword">let</span> depsMap = targetMap.get(target);</span><br><span class="line">  <span class="keyword">if</span> (!depsMap) &#123;</span><br><span class="line">    targetMap.set(target, (depsMap = <span class="keyword">new</span> <span class="built_in">Map</span>()));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// depç”¨æ¥æ”¶é›†ä¾èµ–å‡½æ•°ï¼Œå½“ç›‘å¬çš„keyå€¼å‘ç”Ÿå˜åŒ–ï¼Œè§¦å‘depä¸­çš„ä¾èµ–å‡½æ•°æ›´æ–°</span></span><br><span class="line">  <span class="keyword">let</span> dep = depsMap.get(key);</span><br><span class="line">  <span class="keyword">if</span> (!dep) &#123;</span><br><span class="line">    depsMap.set(key, (dep = <span class="keyword">new</span> <span class="built_in">Set</span>()));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!dep.has(activeEffect)) &#123;</span><br><span class="line">    dep.add(activeEffect);</span><br><span class="line">    activeEffect.deps.push(dep);</span><br><span class="line">    <span class="comment">// å¼€å‘ç¯å¢ƒä¼šè§¦å‘onTrackï¼Œä»…ç”¨äºè°ƒè¯•</span></span><br><span class="line">    <span class="keyword">if</span> (__DEV__ &amp;&amp; activeEffect.options.onTrack) &#123;</span><br><span class="line">      activeEffect.options.onTrack(&#123;</span><br><span class="line">        effect: activeEffect,</span><br><span class="line">        target,</span><br><span class="line">        <span class="keyword">type</span>,</span><br><span class="line">        key,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Trigger">Trigger</h2><blockquote><p>Trigger å¸¸å‡ºç°åœ¨ reactive ä¸­çš„ setter å‡½æ•°ä¸­ï¼Œç”¨äºè§¦å‘ä¾èµ–æ›´æ–°</p><p>æºç è¯¦è§£è§æ³¨é‡Š</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trigger</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  target: <span class="built_in">object</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  <span class="keyword">type</span>: TriggerOpTypes,</span></span></span><br><span class="line"><span class="function"><span class="params">  key?: unknown,</span></span></span><br><span class="line"><span class="function"><span class="params">  newValue?: unknown,</span></span></span><br><span class="line"><span class="function"><span class="params">  oldValue?: unknown,</span></span></span><br><span class="line"><span class="function"><span class="params">  oldTarget?: <span class="built_in">Map</span>&lt;unknown, unknown&gt; | <span class="built_in">Set</span>&lt;unknown&gt;</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// è·å–ä¾èµ–Mapï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸éœ€è¦è§¦å‘</span></span><br><span class="line">  <span class="keyword">const</span> depsMap = targetMap.get(target);</span><br><span class="line">  <span class="keyword">if</span> (!depsMap) &#123;</span><br><span class="line">    <span class="comment">// never been tracked</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä½¿ç”¨Setä¿å­˜éœ€è¦è§¦å‘çš„effectï¼Œé¿å…é‡å¤</span></span><br><span class="line">  <span class="keyword">const</span> effects = <span class="keyword">new</span> <span class="built_in">Set</span>&lt;ReactiveEffect&gt;();</span><br><span class="line">  <span class="comment">// å®šä¹‰ä¾èµ–æ·»åŠ å‡½æ•°</span></span><br><span class="line">  <span class="keyword">const</span> add = <span class="function">(<span class="params">effectsToAdd: <span class="built_in">Set</span>&lt;ReactiveEffect&gt; | <span class="literal">undefined</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (effectsToAdd) &#123;</span><br><span class="line">      effectsToAdd.forEach(<span class="function">(<span class="params">effect</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (effect !== activeEffect || effect.allowRecurse) &#123;</span><br><span class="line">          effects.add(effect);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å°†depsMapä¸­çš„ä¾èµ–æ·»åŠ åˆ°effectsä¸­</span></span><br><span class="line">  <span class="comment">// åªä¸ºäº†ç†è§£å’ŒåŸç†çš„è¯   å„ä¸ªåˆ†æ”¯ä¸ç”¨ç»†çœ‹</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">type</span> === TriggerOpTypes.CLEAR) &#123;</span><br><span class="line">    <span class="comment">// collection being cleared</span></span><br><span class="line">    <span class="comment">// trigger all effects for target</span></span><br><span class="line">    depsMap.forEach(add);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key === <span class="string">&#x27;length&#x27;</span> &amp;&amp; isArray(target)) &#123;</span><br><span class="line">    depsMap.forEach(<span class="function">(<span class="params">dep, key</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (key === <span class="string">&#x27;length&#x27;</span> || key &gt;= (newValue <span class="keyword">as</span> <span class="built_in">number</span>)) &#123;</span><br><span class="line">        add(dep);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// schedule runs for SET | ADD | DELETE</span></span><br><span class="line">    <span class="keyword">if</span> (key !== <span class="built_in">void</span> <span class="number">0</span>) &#123;</span><br><span class="line">      add(depsMap.get(key));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// also run for iteration key on ADD | DELETE | Map.SET</span></span><br><span class="line">    <span class="keyword">switch</span> (<span class="keyword">type</span>) &#123;</span><br><span class="line">      <span class="keyword">case</span> TriggerOpTypes.ADD:</span><br><span class="line">        <span class="keyword">if</span> (!isArray(target)) &#123;</span><br><span class="line">          add(depsMap.get(ITERATE_KEY));</span><br><span class="line">          <span class="keyword">if</span> (isMap(target)) &#123;</span><br><span class="line">            add(depsMap.get(MAP_KEY_ITERATE_KEY));</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isIntegerKey(key)) &#123;</span><br><span class="line">          <span class="comment">// new index added to array -&gt; length changes</span></span><br><span class="line">          add(depsMap.get(<span class="string">&#x27;length&#x27;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> TriggerOpTypes.DELETE:</span><br><span class="line">        <span class="keyword">if</span> (!isArray(target)) &#123;</span><br><span class="line">          add(depsMap.get(ITERATE_KEY));</span><br><span class="line">          <span class="keyword">if</span> (isMap(target)) &#123;</span><br><span class="line">            add(depsMap.get(MAP_KEY_ITERATE_KEY));</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> TriggerOpTypes.SET:</span><br><span class="line">        <span class="keyword">if</span> (isMap(target)) &#123;</span><br><span class="line">          add(depsMap.get(ITERATE_KEY));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å°è£…effectsæ‰§è¡Œå‡½æ•°</span></span><br><span class="line">  <span class="keyword">const</span> run = <span class="function">(<span class="params">effect: ReactiveEffect</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (__DEV__ &amp;&amp; effect.options.onTrigger) &#123;</span><br><span class="line">      effect.options.onTrigger(&#123;</span><br><span class="line">        effect,</span><br><span class="line">        target,</span><br><span class="line">        key,</span><br><span class="line">        <span class="keyword">type</span>,</span><br><span class="line">        newValue,</span><br><span class="line">        oldValue,</span><br><span class="line">        oldTarget,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦‚æœå­˜åœ¨scheduleråˆ™è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">if</span> (effect.options.scheduler) &#123;</span><br><span class="line">      effect.options.scheduler(effect);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      effect();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è§¦å‘effectsä¸­çš„æ‰€æœ‰ä¾èµ–å‡½æ•°</span></span><br><span class="line">  effects.forEach(run);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Reactive">Reactive</h2><blockquote><p>äº†è§£äº† Track ç”¨äºä¾èµ–æ”¶é›†ï¼ŒTrigger ç”¨äºä¾èµ–è§¦å‘ï¼Œé‚£ä¹ˆä»–ä»¬çš„è°ƒç”¨æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™å‘¢?æ¥çœ‹çœ‹ Reactive çš„æºç å°±æ¸…æ¥šäº†ï¼Œæºç è¯¦è§£è§æ³¨é‡Šã€‚</p><p>æ³¨ï¼šæºç ç»“æ„è¾ƒä¸ºå¤æ‚ï¼ˆå°è£…ï¼‰ï¼Œä¸ºä¾¿äºç†è§£åŸç†ï¼Œä»¥ä¸‹ä¸ºç®€åŒ–æºç ã€‚</p></blockquote><ul><li>æ€»ç»“æ¥è¯´<ul><li>åœ¨ getter æ—¶è¿›è¡Œä¾èµ–æ”¶é›†</li><li>åœ¨ setter æ—¶è§¦å‘ä¾èµ–æ›´æ–°</li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reactive</span>(<span class="params">target:<span class="built_in">object</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(target,&#123;</span><br><span class="line">        <span class="function"><span class="title">get</span>(<span class="params">target: Target, key: <span class="built_in">string</span> | symbol, receiver: <span class="built_in">object</span></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="built_in">Reflect</span>.get(target, key, receiver)</span><br><span class="line">            track(target, TrackOpTypes.GET, key)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="title">set</span>(<span class="params">target: <span class="built_in">object</span>, key: <span class="built_in">string</span> | symbol, value: unknown, receiver: <span class="built_in">object</span></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">let</span> oldValue = (target <span class="keyword">as</span> <span class="built_in">any</span>)[key]</span><br><span class="line">            <span class="keyword">const</span> result = <span class="built_in">Reflect</span>.set(target, key, value, receiver)</span><br><span class="line">            <span class="comment">// trigger(target, TriggerOpTypes.ADD, key, value)</span></span><br><span class="line">            trigger(target, TriggerOpTypes.SET, key, value, oldValue)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>Computed</h1><blockquote><p>Computed æ˜¯ Vue ä¸­å¸¸ç”¨ä¸”å¥½ç”¨çš„ä¸€ä¸ªå±æ€§ï¼Œè¿™ä¸ªå±æ€§çš„å€¼åœ¨ä¾èµ–æ”¹å˜ååŒæ­¥è¿›è¡Œæ”¹å˜ï¼Œåœ¨ä¾èµ–æœªæ”¹å˜æ—¶ä½¿ç”¨ç¼“å­˜çš„å€¼ã€‚</p></blockquote><ul><li>Vue2<ul><li>åœ¨ Vue2 ä¸­ Computed çš„å®ç°é€šè¿‡åµŒå¥— watcherï¼Œå®ç°å“åº”å¼æ•°æ®çš„ä¾èµ–æ”¶é›†ï¼Œé—´æ¥é“¾å¼è§¦å‘ä¾èµ–æ›´æ–°ã€‚</li></ul></li><li>Vue3 ä¸­å‡ºç°äº† effectï¼Œé‡æ–°å®ç°äº† Computed å±æ€§<ul><li>effect å¯ä»¥è¢«ç†è§£ä¸ºå‰¯ä½œç”¨å‡½æ•°ï¼Œè¢«å½“åšä¾èµ–æ”¶é›†ï¼Œåœ¨å“åº”å¼æ•°æ®æ›´æ–°åè¢«è§¦å‘ã€‚</li></ul></li></ul><blockquote><p>Show me the Code</p></blockquote><ul><li>è¯»å®Œè¿™æ®µ computed å‡½æ•°ä¼šå‘ç°ï¼Œè¿™é‡Œåªæ˜¯åšäº†ç®€è¦çš„ getter å’Œ setter çš„èµ‹å€¼å¤„ç†<ul><li>computed æ”¯æŒä¸¤ç§å†™æ³•<ul><li>å‡½æ•°</li><li>getterã€setter</li></ul></li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">computed</span>&lt;<span class="title">T</span>&gt;(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  getterOrOptions: ComputedGetter&lt;T&gt; | WritableComputedOptions&lt;T&gt;</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> getter: ComputedGetter&lt;T&gt;;</span><br><span class="line">  <span class="keyword">let</span> setter: ComputedSetter&lt;T&gt;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (isFunction(getterOrOptions)) &#123;</span><br><span class="line">    getter = getterOrOptions;</span><br><span class="line">    setter = __DEV__</span><br><span class="line">      ? <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.warn(<span class="string">&#x27;Write operation failed: computed value is readonly&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      : NOOP;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    getter = getterOrOptions.get;</span><br><span class="line">    setter = getterOrOptions.set;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> ComputedRefImpl(</span><br><span class="line">    getter,</span><br><span class="line">    setter,</span><br><span class="line">    isFunction(getterOrOptions) || !getterOrOptions.set</span><br><span class="line">  ) <span class="keyword">as</span> <span class="built_in">any</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ ¸å¿ƒé€»è¾‘éƒ½åœ¨ ComputedRefImpl ä¸­ï¼Œæˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹<ul><li>é€šè¿‡ dirty å˜é‡æ ‡è®°æ•°æ®æ˜¯å¦ä¸ºæ—§æ•°æ®</li><li>åœ¨å“åº”å¼æ•°æ®æ›´æ–°åå°† dirty èµ‹å€¼ä¸º true</li><li>åœ¨ä¸‹ä¸€æ¬¡ get æ—¶ï¼Œdirty ä¸º true æ—¶è¿›è¡Œé‡æ–°è®¡ç®—ï¼Œå¹¶å°† dirty èµ‹å€¼ä¸º false</li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComputedRefImpl</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> _value!: T;</span><br><span class="line">  <span class="keyword">private</span> _dirty = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">readonly</span> effect: ReactiveEffect&lt;T&gt;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">readonly</span> __v_isRef = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">readonly</span> [ReactiveFlags.IS_READONLY]: <span class="built_in">boolean</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    getter: ComputedGetter&lt;T&gt;,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> <span class="keyword">readonly</span> _setter: ComputedSetter&lt;T&gt;,</span></span><br><span class="line"><span class="params">    isReadonly: <span class="built_in">boolean</span></span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>.effect = effect(getter, &#123;</span><br><span class="line">      lazy: <span class="literal">true</span>,</span><br><span class="line">      <span class="comment">// å“åº”å¼æ•°æ®æ›´æ–°åå°†dirtyèµ‹å€¼ä¸ºtrue</span></span><br><span class="line">      <span class="comment">// ä¸‹æ¬¡æ‰§è¡Œgetteråˆ¤æ–­dirtyä¸ºtrueå³é‡æ–°è®¡ç®—computedå€¼</span></span><br><span class="line">      scheduler: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">this</span>._dirty) &#123;</span><br><span class="line">          <span class="built_in">this</span>._dirty = <span class="literal">true</span>;</span><br><span class="line">          <span class="comment">// æ´¾å‘æ‰€æœ‰å¼•ç”¨å½“å‰è®¡ç®—å±æ€§çš„å‰¯ä½œç”¨å‡½æ•°effect</span></span><br><span class="line">          trigger(toRaw(<span class="built_in">this</span>), TriggerOpTypes.SET, <span class="string">&#x27;value&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>[ReactiveFlags.IS_READONLY] = isReadonly;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">value</span>() &#123;</span><br><span class="line">    <span class="comment">// the computed ref may get wrapped by other proxies e.g. readonly() #3376</span></span><br><span class="line">    <span class="keyword">const</span> self = toRaw(<span class="built_in">this</span>);</span><br><span class="line">    <span class="comment">// å½“å“åº”å¼æ•°æ®æ›´æ–°ådirtyä¸ºtrue</span></span><br><span class="line">    <span class="comment">// é‡æ–°è®¡ç®—æ•°æ®åï¼Œå°†dirtyèµ‹å€¼ä¸ºfalse</span></span><br><span class="line">    <span class="keyword">if</span> (self._dirty) &#123;</span><br><span class="line">      self._value = <span class="built_in">this</span>.effect();</span><br><span class="line">      self._dirty = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä¾èµ–æ”¶é›†</span></span><br><span class="line">    track(self, TrackOpTypes.GET, <span class="string">&#x27;value&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å›è®¡ç®—åçš„å€¼</span></span><br><span class="line">    <span class="keyword">return</span> self._value;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">set</span> <span class="title">value</span>(<span class="params">newValue: T</span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>._setter(newValue);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>Watch</h1><blockquote><p>Watch ä¸»è¦ç”¨äºå¯¹æŸä¸ªå˜é‡çš„ç›‘å¬ï¼Œå¹¶åšç›¸åº”çš„å¤„ç†</p><p>Vue3 ä¸­ä¸ä»…é‡æ„äº† watchï¼Œè¿˜å¤šäº†ä¸€ä¸ª WatchEffect API</p></blockquote><ul><li>Watch</li></ul><blockquote><p>ç”¨äºå¯¹æŸä¸ªå˜é‡çš„ç›‘å¬ï¼ŒåŒæ—¶å¯ä»¥é€šè¿‡ callBack æ‹¿åˆ°æ–°å€¼å’Œæ—§å€¼</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">watch(state, <span class="function">(<span class="params">state, prevState</span>) =&gt;</span> &#123;&#125;);</span><br></pre></td></tr></table></figure><ul><li>WatchEffect</li></ul><blockquote><p>æ¯æ¬¡æ›´æ–°éƒ½ä¼šæ‰§è¡Œï¼Œè‡ªåŠ¨æ”¶é›†ä½¿ç”¨åˆ°çš„ä¾èµ–</p></blockquote><blockquote><p>æ— æ³•è·å–åˆ°æ–°å€¼å’Œæ—§å€¼ï¼Œå¯æ‰‹åŠ¨åœæ­¢ç›‘å¬</p></blockquote><blockquote><p><code>onInvalidate(fn)</code>ä¼ å…¥çš„å›è°ƒä¼šåœ¨ <code>watchEffect</code> é‡æ–°è¿è¡Œæˆ–è€… <code>watchEffect</code> åœæ­¢çš„æ—¶å€™æ‰§è¡Œ</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> stop = watchEffect(<span class="function">(<span class="params">onInvalidate</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  onInvalidate(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// æ‰‹åŠ¨åœæ­¢ç›‘å¬</span></span><br><span class="line">stop();</span><br></pre></td></tr></table></figure><h2 id="watch-å’Œ-watchEffect-çš„ä¸åŒç‚¹">watch å’Œ watchEffect çš„ä¸åŒç‚¹</h2><ul><li>watch æƒ°æ€§æ‰§è¡Œï¼ŒwatchEffect æ¯æ¬¡ä»£ç åŠ è½½éƒ½ä¼šæ‰§è¡Œ</li><li>watch å¯æŒ‡å®šç›‘å¬å˜é‡ï¼ŒwatchEffect è‡ªåŠ¨ä¾èµ–æ”¶é›†</li><li>watch å¯è·å–æ–°æ—§å€¼ï¼ŒwatchEffect ä¸è¡Œ</li><li>watchEffect æœ‰ onInvalidate åŠŸèƒ½ï¼Œwatch æ²¡æœ‰</li><li>watch åªå¯ç›‘å¬ refã€reactive ç­‰å¯¹è±¡ï¼ŒwatchEffect åªå¯ç›‘å¬å…·ä½“å±æ€§</li></ul><h2 id="Source-Code">Source Code</h2><blockquote><p>Show me the Code</p></blockquote><ul><li>è¿™é‡Œå¯ä»¥çœ‹åˆ° watch å’Œ watchEffet çš„æ ¸å¿ƒé€»è¾‘éƒ½å°è£…åˆ°äº† doWatch ä¸­</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// watch</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">watch</span>&lt;<span class="title">T</span> = <span class="title">any</span>, <span class="title">Immediate</span> <span class="title">extends</span> <span class="title">Readonly</span>&lt;<span class="title">boolean</span>&gt; = <span class="title">false</span>&gt;(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  source: T | WatchSource&lt;T&gt;,</span></span></span><br><span class="line"><span class="function"><span class="params">  cb: <span class="built_in">any</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  options?: WatchOptions&lt;Immediate&gt;</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">WatchStopHandle</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (__DEV__ &amp;&amp; !isFunction(cb)) &#123;</span><br><span class="line">    warn(</span><br><span class="line">      <span class="string">`\`watch(fn, options?)\` signature has been moved to a separate API. `</span> +</span><br><span class="line">        <span class="string">`Use \`watchEffect(fn, options?)\` instead. \`watch\` now only `</span> +</span><br><span class="line">        <span class="string">`supports \`watch(source, cb, options?) signature.`</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> doWatch(source <span class="keyword">as</span> <span class="built_in">any</span>, cb, options);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">watchEffect</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  effect: WatchEffect,</span></span></span><br><span class="line"><span class="function"><span class="params">  options?: WatchOptionsBase</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">WatchStopHandle</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> doWatch(effect, <span class="literal">null</span>, options);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>doWatch</li></ul><blockquote><p>ä»¥ä¸‹ä¸ºåˆ å‡ç‰ˆæºç ï¼Œç†è§£æ ¸å¿ƒåŸç†å³å¯</p><p>è¯¦æƒ…è§æ³¨é‡Š</p></blockquote><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doWatch</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  source: WatchSource | WatchSource[] | WatchEffect | object,</span></span></span><br><span class="line"><span class="function"><span class="params">  cb: WatchCallback | <span class="literal">null</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  &#123; immediate, deep, flush, onTrack, onTrigger &#125;: WatchOptions = EMPTY_OBJ,</span></span></span><br><span class="line"><span class="function"><span class="params">  instance = currentInstance</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">WatchStopHandle</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> getter: <span class="function">() =&gt;</span> any</span><br><span class="line">  <span class="keyword">let</span> forceTrigger = <span class="literal">false</span></span><br><span class="line">  <span class="keyword">let</span> isMultiSource = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¯¹ä¸åŒçš„æƒ…å†µåšgetterèµ‹å€¼</span></span><br><span class="line">  <span class="keyword">if</span> (isRef(source)) &#123;</span><br><span class="line">    <span class="comment">// refé€šè¿‡.valueè·å–</span></span><br><span class="line">    getter = <span class="function">() =&gt;</span> (source <span class="keyword">as</span> Ref).value</span><br><span class="line">    forceTrigger = !!(source <span class="keyword">as</span> Ref)._shallow</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isReactive(source)) &#123;</span><br><span class="line">    <span class="comment">// reactiveç›´æ¥è·å–</span></span><br><span class="line">    getter = <span class="function">() =&gt;</span> source</span><br><span class="line">    deep = <span class="literal">true</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isArray(source)) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯æ•°ç»„ï¼Œåšéå†å¤„ç†</span></span><br><span class="line">    isMultiSource = <span class="literal">true</span></span><br><span class="line">    forceTrigger = source.some(isReactive)</span><br><span class="line">    getter = <span class="function">() =&gt;</span></span><br><span class="line">      source.map(<span class="function"><span class="params">s</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isRef(s)) &#123;</span><br><span class="line">          <span class="keyword">return</span> s.value</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isReactive(s)) &#123;</span><br><span class="line">          <span class="keyword">return</span> traverse(s)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isFunction(s)) &#123;</span><br><span class="line">          <span class="keyword">return</span> callWithErrorHandling(s, instance, ErrorCodes.WATCH_GETTER, [</span><br><span class="line">            instance &amp;&amp; (instance.proxy <span class="keyword">as</span> any)</span><br><span class="line">          ])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          __DEV__ &amp;&amp; warnInvalidSource(s)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isFunction(source)) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯å‡½æ•°çš„æƒ…å†µ</span></span><br><span class="line">    <span class="comment">// æœ‰cbåˆ™ä¸ºwatchï¼Œæ²¡æœ‰åˆ™ä¸ºwatchEffect</span></span><br><span class="line">    <span class="keyword">if</span> (cb) &#123;</span><br><span class="line">      <span class="comment">// getter with cb</span></span><br><span class="line">      getter = <span class="function">() =&gt;</span></span><br><span class="line">        callWithErrorHandling(source, instance, ErrorCodes.WATCH_GETTER, [</span><br><span class="line">          instance &amp;&amp; (instance.proxy <span class="keyword">as</span> any)</span><br><span class="line">        ])</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// no cb -&gt; simple effect</span></span><br><span class="line">      getter = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance &amp;&amp; instance.isUnmounted) &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cleanup) &#123;</span><br><span class="line">          cleanup()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> callWithAsyncErrorHandling(</span><br><span class="line">          source,</span><br><span class="line">          instance,</span><br><span class="line">          ErrorCodes.WATCH_CALLBACK,</span><br><span class="line">          [onInvalidate]</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// å¼‚å¸¸æƒ…å†µ</span></span><br><span class="line">    getter = NOOP</span><br><span class="line">    <span class="comment">// æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    __DEV__ &amp;&amp; warnInvalidSource(source)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ·±åº¦ç›‘å¬é€»è¾‘å¤„ç†</span></span><br><span class="line">  <span class="keyword">if</span> (cb &amp;&amp; deep) &#123;</span><br><span class="line">    <span class="keyword">const</span> baseGetter = getter</span><br><span class="line">    getter = <span class="function">() =&gt;</span> traverse(baseGetter())</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> cleanup: <span class="function">() =&gt;</span> <span class="keyword">void</span></span><br><span class="line">  <span class="keyword">let</span> onInvalidate: InvalidateCbRegistrator = <span class="function">(<span class="params">fn: () =&gt; <span class="keyword">void</span></span>) =&gt;</span> &#123;</span><br><span class="line">    cleanup = runner.options.onStop = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      callWithErrorHandling(fn, instance, ErrorCodes.WATCH_CLEANUP)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è®°å½•oldValueï¼Œå¹¶é€šè¿‡runnerè·å–newValue</span></span><br><span class="line">  <span class="comment">// callbackçš„å°è£…å¤„ç†ä¸ºjob</span></span><br><span class="line">  <span class="keyword">let</span> oldValue = isMultiSource ? [] : INITIAL_WATCHER_VALUE</span><br><span class="line">  <span class="keyword">const</span> job: SchedulerJob = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!runner.active) &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (cb) &#123;</span><br><span class="line">      <span class="comment">// watch(source, cb)</span></span><br><span class="line">      <span class="keyword">const</span> newValue = runner()</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        deep ||</span><br><span class="line">        forceTrigger ||</span><br><span class="line">        (isMultiSource</span><br><span class="line">          ? (newValue <span class="keyword">as</span> any[]).some(<span class="function">(<span class="params">v, i</span>) =&gt;</span></span><br><span class="line">              hasChanged(v, (oldValue <span class="keyword">as</span> any[])[i])</span><br><span class="line">            )</span><br><span class="line">          : hasChanged(newValue, oldValue)) ||</span><br><span class="line">        (__COMPAT__ &amp;&amp;</span><br><span class="line">          isArray(newValue) &amp;&amp;</span><br><span class="line">          isCompatEnabled(DeprecationTypes.WATCH_ARRAY, instance))</span><br><span class="line">      ) &#123;</span><br><span class="line">        <span class="comment">// cleanup before running cb again</span></span><br><span class="line">        <span class="keyword">if</span> (cleanup) &#123;</span><br><span class="line">          cleanup()</span><br><span class="line">        &#125;</span><br><span class="line">        callWithAsyncErrorHandling(cb, instance, ErrorCodes.WATCH_CALLBACK, [</span><br><span class="line">          newValue,</span><br><span class="line">          <span class="comment">// pass undefined as the old value when it&#x27;s changed for the first time</span></span><br><span class="line">          oldValue === INITIAL_WATCHER_VALUE ? <span class="literal">undefined</span> : oldValue,</span><br><span class="line">          onInvalidate</span><br><span class="line">        ])</span><br><span class="line">        oldValue = newValue</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// watchEffect</span></span><br><span class="line">      runner()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// important: mark the job as a watcher callback so that scheduler knows</span></span><br><span class="line">  <span class="comment">// it is allowed to self-trigger (#1727)</span></span><br><span class="line">  job.allowRecurse = !!cb</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// é€šè¿‡è¯»å–é…ç½®ï¼Œå¤„ç†jobçš„è§¦å‘æ—¶æœº</span></span><br><span class="line">  <span class="comment">// å¹¶å†æ¬¡å°†jobçš„æ‰§è¡Œå°è£…åˆ°schedulerä¸­</span></span><br><span class="line">  <span class="keyword">let</span> scheduler: ReactiveEffectOptions[<span class="string">&#x27;scheduler&#x27;</span>]</span><br><span class="line">  <span class="keyword">if</span> (flush === <span class="string">&#x27;sync&#x27;</span>) &#123; <span class="comment">// åŒæ­¥æ‰§è¡Œ</span></span><br><span class="line">    scheduler = job</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (flush === <span class="string">&#x27;post&#x27;</span>) &#123; <span class="comment">// æ›´æ–°åæ‰§è¡Œ</span></span><br><span class="line">    scheduler = <span class="function">() =&gt;</span> queuePostRenderEffect(job, instance &amp;&amp; instance.suspense)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// default: &#x27;pre&#x27;</span></span><br><span class="line">    <span class="comment">// æ›´æ–°å‰æ‰§è¡Œ</span></span><br><span class="line">    scheduler = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!instance || instance.isMounted) &#123;</span><br><span class="line">        queuePreFlushCb(job)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// with &#x27;pre&#x27; option, the first call must happen before</span></span><br><span class="line">        <span class="comment">// the component is mounted so it is called synchronously.</span></span><br><span class="line">        job()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä½¿ç”¨effectå‰¯ä½œç”¨å¤„ç†ä¾èµ–æ”¶é›†ï¼Œåœ¨ä¾èµ–æ›´æ–°åè°ƒç”¨schedulerï¼ˆå…¶ä¸­å°è£…äº†callbackçš„æ‰§è¡Œï¼‰</span></span><br><span class="line">  <span class="keyword">const</span> runner = effect(getter, &#123;</span><br><span class="line">    lazy: <span class="literal">true</span>,</span><br><span class="line">    onTrack,</span><br><span class="line">    onTrigger,</span><br><span class="line">    scheduler</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ”¶é›†ä¾èµ–</span></span><br><span class="line">  recordInstanceBoundEffect(runner, instance)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¯»å–é…ç½®ï¼Œè¿›è¡Œwatchåˆå§‹åŒ–</span></span><br><span class="line">  <span class="comment">// æ˜¯å¦æœ‰cb</span></span><br><span class="line">  <span class="keyword">if</span> (cb) &#123;</span><br><span class="line">    <span class="comment">// æ˜¯å¦ç«‹åˆ»æ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">if</span> (immediate) &#123;</span><br><span class="line">      job()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      oldValue = runner()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (flush === <span class="string">&#x27;post&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// æ˜¯å¦æ›´æ–°åæ‰§è¡Œ</span></span><br><span class="line">    queuePostRenderEffect(runner, instance &amp;&amp; instance.suspense)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    runner()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿”å›æ‰‹åŠ¨åœæ­¢å‡½æ•°</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    stop(runner)</span><br><span class="line">    <span class="keyword">if</span> (instance) &#123;</span><br><span class="line">      remove(instance.effects!, runner)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>Mixin</h1><blockquote><p>Mixin æ„ä¸ºæ··åˆï¼Œæ˜¯å…¬å…±é€»è¾‘å°è£…åˆ©å™¨ã€‚</p><p>åŸç†æ¯”è¾ƒç®€å•ï¼Œé‚£å°±æ˜¯åˆå¹¶ã€‚</p></blockquote><ul><li>åˆå¹¶åˆ†ä¸ºå¯¹è±¡çš„åˆå¹¶å’Œç”Ÿå‘½å‘¨æœŸçš„åˆå¹¶<ul><li>å¯¹è±¡ï¼ŒmergeOption<ul><li>ç±»å‹ Object.assign çš„åˆå¹¶ï¼Œä¼šå‡ºç°è¦†ç›–ç°è±¡</li></ul></li><li>ç”Ÿå‘½å‘¨æœŸï¼ŒmergeHook<ul><li>åˆå¹¶ä¼šå°†ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸæ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¾æ¬¡è°ƒç”¨</li></ul></li></ul></li><li>mergeOptions</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeOptions</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  to: <span class="built_in">any</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  <span class="keyword">from</span>: <span class="built_in">any</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  instance?: ComponentInternalInstance | <span class="literal">null</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  strats = instance &amp;&amp; instance.appContext.config.optionMergeStrategies</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (__COMPAT__ &amp;&amp; isFunction(<span class="keyword">from</span>)) &#123;</span><br><span class="line">    <span class="keyword">from</span> = <span class="keyword">from</span>.options;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; mixins, <span class="attr">extends</span>: extendsOptions &#125; = <span class="keyword">from</span>;</span><br><span class="line"></span><br><span class="line">  extendsOptions &amp;&amp; mergeOptions(to, extendsOptions, instance, strats);</span><br><span class="line">  mixins &amp;&amp;</span><br><span class="line">    mixins.forEach(<span class="function">(<span class="params">m: ComponentOptionsMixin</span>) =&gt;</span></span><br><span class="line">      mergeOptions(to, m, instance, strats)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¯¹mixinä¸­çš„å¯¹è±¡è¿›è¡Œéå†</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> <span class="keyword">from</span>) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœå­˜åœ¨åˆ™è¿›è¡Œè¦†ç›–å¤„ç†</span></span><br><span class="line">    <span class="keyword">if</span> (strats &amp;&amp; hasOwn(strats, key)) &#123;</span><br><span class="line">      to[key] = strats[key](</span><br><span class="line">        to[key],</span><br><span class="line">        <span class="keyword">from</span>[key],</span><br><span class="line">        instance &amp;&amp; instance.proxy,</span><br><span class="line">        key</span><br><span class="line">      );</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// å¦‚æœä¸å­˜åœ¨åˆ™ç›´æ¥èµ‹å€¼</span></span><br><span class="line">      to[key] = <span class="keyword">from</span>[key];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> to;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>mergeHook</li></ul><blockquote><p>ç®€å•ç²—æš´æ”¾è¿› Setï¼Œè°ƒç”¨æ—¶ä¾æ¬¡è°ƒç”¨</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeHook</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  to: <span class="built_in">Function</span>[] | <span class="built_in">Function</span> | <span class="literal">undefined</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  <span class="keyword">from</span>: <span class="built_in">Function</span> | <span class="built_in">Function</span>[]</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>([...toArray(to), ...toArray(<span class="keyword">from</span>)]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>Diff ç®—æ³•ä¼˜åŒ–</h1><blockquote><p>äº†è§£ Vue3 çš„ Diff ç®—æ³•ä¼˜åŒ–å‰ï¼Œå¯ä»¥å…ˆäº†è§£ä¸€ä¸‹<a href="https://juejin.cn/post/6944887985531781133">Vue2 çš„ Diff ç®—æ³•</a></p><p>æœ¬éƒ¨åˆ†æ³¨é‡æŠŠç®—æ³•è®²æ¸…æ¥šï¼Œå°†ä¸è¿›è¡Œé€è¡Œæºç åˆ†æ</p></blockquote><ul><li>Vue3 ä¸­çš„ä¸»è¦ä¼˜åŒ–ç‚¹ä¸º<ul><li>åœ¨ updateChildren æ—¶åŒç«¯æ¯”è¾ƒ -&gt; æœ€é•¿é€’å¢å­åºåˆ—</li><li>å…¨é‡ Diff -&gt; é™æ€æ ‡è®° + éå…¨é‡ Diff</li><li>é™æ€æå‡</li></ul></li></ul><h2 id="updateChildren">updateChildren</h2><ul><li>Vue2<ul><li>å¤´ - å¤´æ¯”è¾ƒ</li><li>å°¾ - å°¾æ¯”è¾ƒ</li><li>å¤´ - å°¾æ¯”è¾ƒ</li><li>å°¾ - å¤´æ¯”è¾ƒ</li></ul></li><li>Vue3<ul><li>å¤´ - å¤´æ¯”è¾ƒ</li><li>å°¾ - å°¾æ¯”è¾ƒ</li><li>åŸºäºæœ€é•¿é€’å¢å­åºåˆ—è¿›è¡Œç§»åŠ¨ / åˆ é™¤ / æ–°å¢</li></ul></li></ul><h3 id="ä¸¾ä¸ª-ğŸŒ°">ä¸¾ä¸ª ğŸŒ°</h3><ul><li>oldChild [a,b,c,d,e,f,g]</li><li>newChild [a,b,f,c,d,e,h,g]</li></ul><ol><li>é¦–å…ˆè¿›è¡Œå¤´ - å¤´æ¯”è¾ƒ,æ¯”è¾ƒåˆ°ä¸ä¸€æ ·çš„èŠ‚ç‚¹æ—¶è·³å‡ºå¾ªç¯<ul><li>å¾—åˆ°[a,b]</li></ul></li><li>ç„¶åè¿›è¡Œå°¾ - å°¾æ¯”è¾ƒï¼Œæ¯”è¾ƒåˆ°ä¸ä¸€æ ·çš„èŠ‚ç‚¹æ—¶è·³å‡ºå¾ªç¯<ul><li>å¾—åˆ°[g]</li></ul></li><li>å‰©ä½™[f,c,d,e,h]<ul><li>é€šè¿‡ newIndexToOldIndexMap ç”Ÿæˆæ•°ç»„[5, 2, 3, 4, -1]</li><li>å¾—å‡ºæœ€é•¿é€’å¢å­åºåˆ—[2, 3, 4]å¯¹åº”èŠ‚ç‚¹ä¸º[c, d, e]</li><li>å‰©ä½™çš„èŠ‚ç‚¹åŸºäº[c, d, e]è¿›è¡Œç§»åŠ¨ / æ–°å¢ / åˆ é™¤</li></ul></li></ol><blockquote><p><strong>æœ€é•¿é€’å¢å­åºåˆ—</strong> å‡å°‘ Dom å…ƒç´ çš„ç§»åŠ¨ï¼Œè¾¾åˆ°æœ€å°‘çš„ dom æ“ä½œä»¥å‡å°å¼€é”€ã€‚</p><p>å…³äºæœ€é•¿é€’å¢å­åºåˆ—ç®—æ³•å¯ä»¥çœ‹çœ‹<a href="https://github.com/labuladong/fucking-algorithm/blob/master/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E7%B3%BB%E5%88%97/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E8%AE%BE%E8%AE%A1%EF%BC%9A%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97.md">æœ€é•¿é€’å¢å­åºåˆ—</a></p></blockquote><h2 id="é™æ€æ ‡è®°">é™æ€æ ‡è®°</h2><blockquote><p>Vue2 ä¸­å¯¹ vdom è¿›è¡Œå…¨é‡ Diffï¼ŒVue3 ä¸­å¢åŠ äº†é™æ€æ ‡è®°è¿›è¡Œéå…¨é‡ Diff</p><p>å¯¹ vnode æ‰“äº†åƒä»¥ä¸‹æšä¸¾å†…çš„é™æ€æ ‡è®°</p></blockquote><ul><li>patchFlag</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="built_in">enum</span> PatchFlags &#123;</span><br><span class="line">  TEXT = <span class="number">1</span>, <span class="comment">//åŠ¨æ€æ–‡æœ¬èŠ‚ç‚¹</span></span><br><span class="line">  CLASS = <span class="number">1</span> &lt;&lt; <span class="number">1</span>, <span class="comment">//2   åŠ¨æ€class</span></span><br><span class="line">  STYLE = <span class="number">1</span> &lt;&lt; <span class="number">2</span>, <span class="comment">//4   åŠ¨æ€style</span></span><br><span class="line">  PROPS = <span class="number">1</span> &lt;&lt; <span class="number">3</span>, <span class="comment">//8                åŠ¨æ€å±æ€§ï¼Œä½†ä¸åŒ…å«ç±»åå’Œæ ·å¼</span></span><br><span class="line">  FULL_PROPS = <span class="number">1</span> &lt;&lt; <span class="number">4</span>, <span class="comment">//16   å…·æœ‰åŠ¨æ€keyå±æ€§ï¼Œå½“keyæ”¹å˜æ—¶ï¼Œéœ€è¿›è¡Œå®Œæ•´çš„diffæ¯”è¾ƒ</span></span><br><span class="line">  HYDRATE_EVENTS = <span class="number">1</span> &lt;&lt; <span class="number">5</span>, <span class="comment">//32  å¸¦æœ‰ç›‘å¬äº‹ä»¶çš„èŠ‚ç‚¹</span></span><br><span class="line">  STABLE_FRAGMENT = <span class="number">1</span> &lt;&lt; <span class="number">6</span>, <span class="comment">//64  ä¸€ä¸ªä¸ä¼šæ”¹å˜å­èŠ‚ç‚¹é¡ºåºçš„fragment</span></span><br><span class="line">  KEYED_FRAGMENT = <span class="number">1</span> &lt;&lt; <span class="number">7</span>, <span class="comment">//128 å¸¦æœ‰keyå±æ€§çš„fragmentæˆ–éƒ¨åˆ†å­èŠ‚ç‚¹æœ‰key</span></span><br><span class="line">  UNKEYEN_FRAGMENT = <span class="number">1</span> &lt;&lt; <span class="number">8</span>, <span class="comment">//256  å­èŠ‚ç‚¹æ²¡æœ‰keyçš„fragment</span></span><br><span class="line">  NEED_PATCH = <span class="number">1</span> &lt;&lt; <span class="number">9</span>, <span class="comment">//512   ä¸€ä¸ªèŠ‚ç‚¹åªä¼šè¿›è¡Œépropsæ¯”è¾ƒ</span></span><br><span class="line">  DYNAMIC_SLOTS = <span class="number">1</span> &lt;&lt; <span class="number">10</span>, <span class="comment">//1024   åŠ¨æ€slot</span></span><br><span class="line">  HOISTED = -<span class="number">1</span>, <span class="comment">//é™æ€èŠ‚ç‚¹</span></span><br><span class="line">  <span class="comment">//æŒ‡ç¤ºåœ¨diffè¿‡ç¨‹ä¸­è¦é€€å‡ºä¼˜åŒ–æ¨¡å¼</span></span><br><span class="line">  BAIL = -<span class="number">2</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¸ª-ğŸŒ°-2">ä¸¾ä¸ª ğŸŒ°</h3><ul><li>æ¨¡æ¿é•¿è¿™æ ·</li></ul><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ç”Ÿæˆ vdom æºç </li></ul><blockquote><p>å¯¹ msg å˜é‡è¿›è¡Œäº†æ ‡è®°</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  createVNode <span class="keyword">as</span> _createVNode,</span><br><span class="line">  toDisplayString <span class="keyword">as</span> _toDisplayString,</span><br><span class="line">  openBlock <span class="keyword">as</span> _openBlock,</span><br><span class="line">  createBlock <span class="keyword">as</span> _createBlock,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    _openBlock(),</span><br><span class="line">    _createBlock(<span class="string">&#x27;div&#x27;</span>, <span class="literal">null</span>, [</span><br><span class="line">      _createVNode(<span class="string">&#x27;p&#x27;</span>, <span class="literal">null</span>, <span class="string">&#x27;Hello World&#x27;</span>),</span><br><span class="line">      _createVNode(<span class="string">&#x27;p&#x27;</span>, <span class="literal">null</span>, _toDisplayString(_ctx.msg), <span class="number">1</span> <span class="comment">/* TEXT */</span>),</span><br><span class="line">    ])</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check the console for the AST</span></span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“">æ€»ç»“</h3><ul><li>å¯¹ vnode è¿›è¡Œæ ‡è®°ï¼Œå°†éœ€è¦åŠ¨æ€æ›´æ–°å’Œä¸éœ€è¦åŠ¨æ€æ›´æ–°çš„èŠ‚ç‚¹è¿›è¡Œåˆ†ç±»</li><li>é™æ€èŠ‚ç‚¹ä»…éœ€åˆ›å»ºä¸€æ¬¡ï¼Œæ¸²æŸ“ç›´æ¥å¤ç”¨ï¼Œä¸å‚ä¸ diff ç®—æ³•æµç¨‹ã€‚</li></ul><h2 id="é™æ€æå‡">é™æ€æå‡</h2><ul><li><p>Vue2 ä¸­æ— è®ºæ˜¯å…ƒç´ æ˜¯å¦å‚ä¸æ›´æ–°ï¼Œæ¯æ¬¡éƒ½ä¼šé‡æ–°åˆ›å»º</p></li><li><p>Vue3 ä¸­å¯¹äºä¸å‚ä¸æ›´æ–°çš„å…ƒç´ ï¼Œåªä¼šè¢«åˆ›å»ºä¸€æ¬¡ï¼Œä¹‹åä¼šåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶å€™è¢«ä¸åœåœ°å¤ç”¨</p></li><li><p>ä»¥åæ¯æ¬¡è¿›è¡Œ render çš„æ—¶å€™ï¼Œå°±ä¸ä¼šé‡å¤åˆ›å»ºè¿™äº›é™æ€çš„å†…å®¹ï¼Œè€Œæ˜¯ç›´æ¥ä»ä¸€å¼€å§‹å°±åˆ›å»ºå¥½çš„å¸¸é‡ä¸­å–å°±è¡Œäº†ã€‚</p></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  createVNode <span class="keyword">as</span> _createVNode,</span><br><span class="line">  toDisplayString <span class="keyword">as</span> _toDisplayString,</span><br><span class="line">  openBlock <span class="keyword">as</span> _openBlock,</span><br><span class="line">  createBlock <span class="keyword">as</span> _createBlock,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * é™æ€æå‡å‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    _openBlock(),</span><br><span class="line">    _createBlock(<span class="string">&#x27;div&#x27;</span>, <span class="literal">null</span>, [</span><br><span class="line">      _createVNode(<span class="string">&#x27;p&#x27;</span>, <span class="literal">null</span>, <span class="string">&#x27;Xmo&#x27;</span>),</span><br><span class="line">      _createVNode(<span class="string">&#x27;p&#x27;</span>, <span class="literal">null</span>, <span class="string">&#x27;Xmo&#x27;</span>),</span><br><span class="line">      _createVNode(<span class="string">&#x27;p&#x27;</span>, <span class="literal">null</span>, <span class="string">&#x27;Xmo&#x27;</span>),</span><br><span class="line">      _createVNode(<span class="string">&#x27;p&#x27;</span>, <span class="literal">null</span>, _toDisplayString(_ctx.msg), <span class="number">1</span> <span class="comment">/* TEXT */</span>),</span><br><span class="line">    ])</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * é™æ€æå‡å</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> _hoisted_1 = <span class="comment">/*#__PURE__*/</span> _createVNode(</span><br><span class="line">  <span class="string">&#x27;p&#x27;</span>,</span><br><span class="line">  <span class="literal">null</span>,</span><br><span class="line">  <span class="string">&#x27;Xmo&#x27;</span>,</span><br><span class="line">  -<span class="number">1</span> <span class="comment">/* HOISTED */</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">const</span> _hoisted_2 = <span class="comment">/*#__PURE__*/</span> _createVNode(</span><br><span class="line">  <span class="string">&#x27;p&#x27;</span>,</span><br><span class="line">  <span class="literal">null</span>,</span><br><span class="line">  <span class="string">&#x27;Xmo&#x27;</span>,</span><br><span class="line">  -<span class="number">1</span> <span class="comment">/* HOISTED */</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">const</span> _hoisted_3 = <span class="comment">/*#__PURE__*/</span> _createVNode(</span><br><span class="line">  <span class="string">&#x27;p&#x27;</span>,</span><br><span class="line">  <span class="literal">null</span>,</span><br><span class="line">  <span class="string">&#x27;Xmo&#x27;</span>,</span><br><span class="line">  -<span class="number">1</span> <span class="comment">/* HOISTED */</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    _openBlock(),</span><br><span class="line">    _createBlock(<span class="string">&#x27;div&#x27;</span>, <span class="literal">null</span>, [</span><br><span class="line">      _hoisted_1,</span><br><span class="line">      _hoisted_2,</span><br><span class="line">      _hoisted_3,</span><br><span class="line">      _createVNode(<span class="string">&#x27;p&#x27;</span>, <span class="literal">null</span>, _toDisplayString(_ctx.msg), <span class="number">1</span> <span class="comment">/* TEXT */</span>),</span><br><span class="line">    ])</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check the console for the AST</span></span><br></pre></td></tr></table></figure><h1>cacheHandlers äº‹ä»¶ä¾¦å¬å™¨ç¼“å­˜</h1><ul><li><p>é»˜è®¤æƒ…å†µä¸‹ onClick ä¼šè¢«è§†ä¸ºåŠ¨æ€ç»‘å®šï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½ä¼šå»è¿½è¸ªå®ƒçš„å˜åŒ–</p></li><li><p>ä½†æ˜¯å› ä¸ºæ˜¯åŒä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥æ²¡æœ‰è¿½è¸ªå˜åŒ–ï¼Œç›´æ¥ç¼“å­˜èµ·æ¥å¤ç”¨å³å¯ã€‚</p></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ¨¡æ¿</span></span><br><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;button <span class="meta">@click</span>=<span class="string">&quot;onClick&quot;</span>&gt;btn&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¼“å­˜å‰</span></span><br><span class="line"><span class="comment">// è¿™é‡Œæˆ‘ä»¬è¿˜æ²¡æœ‰å¼€å¯äº‹ä»¶ç›‘å¬ç¼“å­˜ï¼Œç†Ÿæ‚‰çš„é™æ€æ ‡è®° 8 /* PROPS */ å‡ºç°äº†ï¼Œ</span></span><br><span class="line"><span class="comment">// å®ƒå°†æ ‡ç­¾çš„ Props ï¼ˆå±æ€§ï¼‰ æ ‡è®°åŠ¨æ€å±æ€§ã€‚</span></span><br><span class="line"><span class="comment">// å¦‚æœæˆ‘ä»¬å­˜åœ¨å±æ€§ä¸ä¼šæ”¹å˜ï¼Œä¸å¸Œæœ›è¿™ä¸ªå±æ€§è¢«æ ‡è®°ä¸ºåŠ¨æ€ï¼Œé‚£ä¹ˆå°±éœ€è¦ cacheHandler çš„å‡ºåœºäº†ã€‚</span></span><br><span class="line"><span class="keyword">import</span> &#123; createVNode <span class="keyword">as</span> _createVNode, openBlock <span class="keyword">as</span> _openBlock, createBlock <span class="keyword">as</span> _createBlock &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, [</span><br><span class="line">    _createVNode(<span class="string">&quot;button&quot;</span>, &#123; <span class="attr">onClick</span>: _ctx.onClick &#125;, <span class="string">&quot;btn&quot;</span>, <span class="number">8</span> <span class="comment">/* PROPS */</span>, [<span class="string">&quot;onClick&quot;</span>])</span><br><span class="line">  ]))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check the console for the AST</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¼“å­˜å</span></span><br><span class="line"><span class="keyword">import</span> &#123; createVNode <span class="keyword">as</span> _createVNode, openBlock <span class="keyword">as</span> _openBlock, createBlock <span class="keyword">as</span> _createBlock &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, [</span><br><span class="line">    _createVNode(<span class="string">&quot;button&quot;</span>, &#123;</span><br><span class="line">      onClick: _cache[<span class="number">1</span>] || (_cache[<span class="number">1</span>] = <span class="function">(<span class="params">...args</span>) =&gt;</span> (_ctx.onClick(...args)))</span><br><span class="line">    &#125;, <span class="string">&quot;btn&quot;</span>)</span><br><span class="line">  ]))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check the console for the AST</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>å®ƒçš„æ„æ€å¾ˆæ˜æ˜¾ï¼ŒonClick æ–¹æ³•è¢«å­˜å…¥ cacheã€‚</p><p>åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå¦‚æœèƒ½åœ¨ç¼“å­˜ä¸­æ‰¾åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒå°†ç›´æ¥è¢«ä½¿ç”¨ã€‚</p><p>å¦‚æœæ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆå°†è¿™ä¸ªæ–¹æ³•æ³¨å…¥ç¼“å­˜ã€‚</p><p>æ€»ä¹‹ï¼Œå°±æ˜¯æŠŠæ–¹æ³•ç»™ç¼“å­˜äº†ã€‚</p></blockquote><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Effect å’Œ Reactive&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;effect ä½œä¸º Vue å“åº”å¼åŸç†ä¸­çš„æ ¸å¿ƒï¼Œåœ¨ Computedã€Watchã€Reactive ä¸­éƒ½æœ‰å‡ºç°&lt;/p&gt;
&lt;p&gt;ä¸»è¦å’Œ Reactive(Proxy)ã€trackã€trigger </summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://lebronchao.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="Front End" scheme="https://lebronchao.com/tags/Front-End/"/>
    
    <category term="Vue" scheme="https://lebronchao.com/tags/Vue/"/>
    
    <category term="SPA" scheme="https://lebronchao.com/tags/SPA/"/>
    
    <category term="æºç åˆ†æ" scheme="https://lebronchao.com/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>[æ·±å…¥æµ…å‡º]JavaScript GC åƒåœ¾å›æ”¶æœºåˆ¶</title>
    <link href="https://lebronchao.com/2021/06/22/JavaScipt-GC/"/>
    <id>https://lebronchao.com/2021/06/22/JavaScipt-GC/</id>
    <published>2021-06-22T15:32:35.000Z</published>
    <updated>2021-06-22T15:32:35.000Z</updated>
    
    <content type="html"><![CDATA[<h1>[ç§‘æ™®]JavaScript GC</h1><h1>ä¸ºä»€ä¹ˆéœ€è¦åƒåœ¾å›æ”¶</h1><ul><li>åœ¨ C / C++ä¸­ï¼Œè·Ÿè¸ªå†…å­˜çš„ä½¿ç”¨å’Œç®¡ç†å†…å­˜å¯¹å¼€å‘è€…æ¥è¯´æ˜¯å¾ˆå¤§çš„è´Ÿæ‹…<ul><li>JavaScript æ˜¯ä½¿ç”¨åƒåœ¾å›æ”¶æœºåˆ¶çš„è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰§è¡Œç¯å¢ƒè´Ÿè´£åœ¨ä»£ç æ‰§è¡Œæ—¶ç®¡ç†å†…å­˜ï¼Œå¸®å¼€å‘è€…å¸ä¸‹äº†è¿™ä¸ªè´Ÿæ‹…</li><li>é€šè¿‡è‡ªåŠ¨å†…å­˜ç®¡ç†å®ç°å†…å­˜çš„åˆ†é…å’Œèµ„æºçš„å›æ”¶</li><li>åŸºæœ¬æ€è·¯å¾ˆç®€å•ï¼Œç¡®å®šå“ªä¸ªå˜é‡ä¸ä¼šå†è¢«ä½¿ç”¨äº†ï¼ŒæŠŠå®ƒçš„å†…å­˜ç©ºé—´é‡Šæ”¾</li><li>è¿™ä¸ªè¿‡ç¨‹æ˜¯å‘¨æœŸæ€§çš„ï¼Œæ„æ€æ˜¯è¿™ä¸ªåƒåœ¾å›æ”¶ç¨‹åºæ¯éš”ä¸€æ®µæ—¶é—´å°±ä¼šè¿è¡Œä¸€æ¬¡</li></ul></li><li>åƒ JS ä¸­çš„å¯¹è±¡ã€å­—ç¬¦ä¸²ã€å¯¹è±¡çš„å†…å­˜æ˜¯ä¸å›ºå®šçš„ï¼Œåªæœ‰çœŸæ­£ç”¨åˆ°çš„æ—¶å€™æ‰ä¼šåŠ¨æ€åˆ†é…å†…å­˜<ul><li>è¿™äº›å†…å­˜éœ€åœ¨ä¸ä½¿ç”¨åè¿›è¡Œé‡Šæ”¾ä»¥ä¾¿å†æ¬¡ä½¿ç”¨ï¼Œå¦åˆ™åœ¨è®¡ç®—æœºå¯ç”¨å†…å­˜è€—å°½åé€ æˆå´©æºƒ</li></ul></li><li>æµè§ˆå™¨å‘å±•å²ä¸Šçš„åƒåœ¾å›æ”¶æ³•ä¸»è¦æœ‰<ul><li>å¼•ç”¨è®¡æ•°æ³•</li><li>æ ‡è®°æ¸…é™¤æ³•</li></ul></li></ul><h1>å¼•ç”¨è®¡æ•°æ³•</h1><h2 id="æ€è·¯">æ€è·¯</h2><ul><li>å˜é‡åªæ˜¯å¯¹å€¼è¿›è¡Œå¼•ç”¨</li><li>å½“å˜é‡å¼•ç”¨è¯¥å€¼æ—¶ï¼Œå¼•ç”¨æ¬¡æ•°+1</li><li>å½“è¯¥å˜é‡çš„å¼•ç”¨è¢«è¦†ç›–æˆ–è€…æ¸…é™¤æ—¶ï¼Œå¼•ç”¨æ¬¡æ•°-1</li><li>å½“å¼•ç”¨æ¬¡æ•°ä¸º 0 æ—¶ï¼Œå°±å¯ä»¥å®‰å…¨åœ°é‡Šæ”¾è¿™å—å†…å­˜ã€‚</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]; <span class="comment">// [1, 0, 1]è¿™å—å†…å­˜è¢«arrå¼•ç”¨  å¼•ç”¨æ¬¡æ•°ä¸º1</span></span><br><span class="line">arr = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]; <span class="comment">// [1, 0, 1]çš„å†…å­˜å¼•ç”¨æ¬¡æ•°ä¸º0è¢«é‡Šæ”¾</span></span><br><span class="line"><span class="comment">// [0, 1, 0]çš„å†…å­˜è¢«arrå¼•ç”¨   å¼•ç”¨æ¬¡æ•°ä¸º1</span></span><br><span class="line"><span class="keyword">const</span> tmp = arr; <span class="comment">// [0, 1, 0]çš„å†…å­˜è¢«tmpå¼•ç”¨   å¼•ç”¨æ¬¡æ•°ä¸º2</span></span><br></pre></td></tr></table></figure><h2 id=""></h2><h2 id="å¾ªç¯å¼•ç”¨é—®é¢˜">å¾ªç¯å¼•ç”¨é—®é¢˜</h2><blockquote><p>Netscape Navigator 3.0 é‡‡ç”¨</p></blockquote><ul><li>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒObjectA å’Œ ObjectB çš„å±æ€§åˆ†åˆ«ç›¸äº’å¼•ç”¨</li><li>é€ æˆè¿™ä¸ªå‡½æ•°æ‰§è¡Œåï¼ŒObject è¢«å¼•ç”¨çš„æ¬¡æ•°ä¸ä¼šå˜æˆ 0ï¼Œå½±å“äº†æ­£å¸¸çš„ GCã€‚</li><li>å¦‚æœæ‰§è¡Œå¤šæ¬¡ï¼Œå°†é€ æˆä¸¥é‡çš„å†…å­˜æ³„æ¼ã€‚</li><li>è€Œæ ‡è®°æ¸…é™¤æ³•åˆ™ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> ObjectA = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">  <span class="keyword">let</span> ObjectB = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line"></span><br><span class="line">  ObjectA.p = ObjectB;</span><br><span class="line">  ObjectB.p = ObjectA;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Example();</span><br></pre></td></tr></table></figure><ul><li>è§£å†³æ–¹æ³•ï¼šåœ¨å‡½æ•°ç»“æŸæ—¶å°†å…¶æŒ‡å‘ null</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">ObjectA = <span class="literal">null</span>;</span><br><span class="line">ObjectB = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure><h1>æ ‡è®°æ¸…é™¤æ³•</h1><blockquote><p>ä¸ºäº†è§£å†³å¾ªç¯å¼•ç”¨é€ æˆçš„å†…å­˜æ³„æ¼é—®é¢˜ï¼ŒNetscape Navigator 4.0 å¼€å§‹é‡‡ç”¨æ ‡è®°æ¸…é™¤æ³•</p></blockquote><blockquote><p>åˆ°äº† 2008 å¹´ï¼ŒIEã€Firefoxã€Operaã€Chrome å’Œ Safari éƒ½åœ¨è‡ªå·±çš„ JavaScript å®ç°ä¸­é‡‡ç”¨æ ‡è®°æ¸…ç†(æˆ– å…¶å˜ä½“)ï¼Œåªæ˜¯åœ¨è¿è¡Œåƒåœ¾å›æ”¶çš„é¢‘ç‡ä¸Šæœ‰æ‰€å·®å¼‚ã€‚</p></blockquote><h2 id="æ€è·¯-2">æ€è·¯</h2><ul><li>åœ¨å˜é‡è¿›å…¥æ‰§è¡Œä¸Šä¸‹æ–‡æ—¶æ‰“ä¸Šâ€œè¿›å…¥â€æ ‡è®°</li><li>åŒæ—¶åœ¨å˜é‡ç¦»å¼€æ‰§è¡Œä¸Šä¸‹æ–‡æ—¶ä¹Ÿæ‰“ä¸Šâ€œç¦»å¼€â€æ ‡è®°<ul><li>ä»æ­¤ä»¥åï¼Œæ— æ³•è®¿é—®è¿™ä¸ªå˜é‡</li><li>åœ¨ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶è¿›è¡Œå†…å­˜çš„é‡Šæ”¾</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> a = <span class="number">1</span>,</span><br><span class="line">    b = <span class="number">2</span>,</span><br><span class="line">    c = <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">return</span> n * a * b * c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ ‡è®°Exampleè¿›å…¥æ‰§è¡Œä¸Šä¸‹æ–‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> n = <span class="number">1</span>; <span class="comment">// æ ‡è®°nè¿›å…¥æ‰§è¡Œä¸Šä¸‹æ–‡</span></span><br><span class="line">Example(n); <span class="comment">// æ ‡è®°a,b,cè¿›å…¥æ‰§è¡Œä¸Šä¸‹æ–‡</span></span><br><span class="line"><span class="built_in">console</span>.log(n); <span class="comment">// æ ‡è®°a, b, cç¦»å¼€æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œç­‰å¾…åƒåœ¾å›æ”¶</span></span><br></pre></td></tr></table></figure><h2 id="const-å’Œ-let-å£°æ˜æå‡æ€§èƒ½">const å’Œ let å£°æ˜æå‡æ€§èƒ½</h2><ul><li>const å’Œ let ä¸ä»…æœ‰åŠ©äºæ”¹å–„ä»£ç é£æ ¼ï¼ŒåŒæ—¶æœ‰åˆ©äºåƒåœ¾å›æ”¶æ€§èƒ½çš„æå‡</li><li>const å’Œ let ä½¿ JS æœ‰äº†å—çº§ä½œç”¨åŸŸï¼Œå½“å—çº§ä½œç”¨åŸŸæ¯”å‡½æ•°ä½œç”¨åŸŸæ›´æ—©ç»“æŸæ—¶ï¼Œåƒåœ¾å›æ”¶ç¨‹åºæ›´æ—©ä»‹å…¥</li><li>å°½æ—©å›æ”¶è¯¥å›æ”¶çš„å†…å­˜ï¼Œæå‡äº†åƒåœ¾å›æ”¶çš„æ€§èƒ½</li></ul><h1>V8 å¼•æ“çš„åƒåœ¾å›æ”¶</h1><blockquote><p>V8 å¼•æ“çš„åƒåœ¾å›æ”¶é‡‡ç”¨æ ‡è®°æ¸…é™¤æ³•ä¸åˆ†ä»£å›æ”¶æ³•</p></blockquote><blockquote><p>åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€ç”Ÿä»£</p></blockquote><h2 id="æ–°ç”Ÿä»£">æ–°ç”Ÿä»£</h2><blockquote><p>æ–°ç”Ÿä»£åƒåœ¾å›æ”¶é‡‡ç”¨<code>Scavenge</code> ç®—æ³•</p></blockquote><blockquote><p>åˆ†é…ç»™å¸¸ç”¨å†…å­˜å’Œæ–°åˆ†é…çš„å°é‡å†…å­˜</p></blockquote><ul><li><p>å†…å­˜å¤§å°</p><ul><li>32 ä½ç³»ç»Ÿ 16M å†…å­˜</li><li>64 ä½ç³»ç»Ÿ 32M å†…å­˜</li></ul></li><li><p>åˆ†åŒº</p><ul><li>æ–°ç”Ÿä»£å†…å­˜åˆ†ä¸ºä»¥ä¸‹ä¸¤åŒºï¼Œå†…å­˜å„å ä¸€åŠ</li><li>From space</li><li>To space</li></ul></li><li><p>è¿è¡Œ</p><ul><li>å®é™…è¿è¡Œçš„åªæœ‰ From space</li><li>To space å¤„äºç©ºé—²çŠ¶æ€</li></ul></li><li><p><code>Scavenge</code>ç®—æ³•</p><ul><li>å½“ From space å†…å­˜ä½¿ç”¨å°†è¦è¾¾åˆ°ä¸Šé™æ—¶å¼€å§‹åƒåœ¾å›æ”¶ï¼Œå°† From space ä¸­çš„ä¸å¯è¾¾å¯¹è±¡éƒ½æ‰“ä¸Šæ ‡è®°</li><li>å°† From space çš„æœªæ ‡è®°å¯¹è±¡å¤åˆ¶åˆ° To spaceã€‚<ul><li>è§£å†³äº†å†…å­˜æ•£è½åˆ†å—çš„é—®é¢˜ï¼ˆä¸è¿ç»­çš„å†…å­˜ç©ºé—´ï¼‰</li><li>ç›¸å½“äºç”¨ç©ºé—´æ¢æ—¶é—´ã€‚</li></ul></li><li>ç„¶åæ¸…ç©º From spaceã€å°†å…¶é—²ç½®ï¼Œä¹Ÿå°±æ˜¯è½¬å˜ä¸º To spaceï¼Œä¿—ç§°åè½¬ã€‚</li></ul></li><li><p>æ–°ç”Ÿä»£ -&gt; è€ç”Ÿä»£</p><ul><li>æ–°ç”Ÿä»£å­˜æ”¾çš„æ˜¯æ–°åˆ†é…çš„å°é‡å†…å­˜ï¼Œå¦‚æœè¾¾åˆ°ä»¥ä¸‹æ¡ä»¶ä¸­çš„ä¸€ä¸ªï¼Œå°†è¢«åˆ†é…è‡³è€ç”Ÿä»£<ul><li>å†…å­˜å¤§å°è¾¾åˆ° From space çš„ 25%</li><li>ç»å†äº† From space &lt;-&gt; To space çš„ä¸€ä¸ªè½®å›</li></ul></li></ul></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20210607231001850.(null)" alt="img"></p><h2 id="è€ç”Ÿä»£">è€ç”Ÿä»£</h2><blockquote><p>è€ç”Ÿä»£é‡‡ç”¨<code>mark-sweep</code>æ ‡è®°æ¸…é™¤å’Œ<code>mark-compact</code>æ ‡è®°æ•´ç†</p></blockquote><blockquote><p>é€šå¸¸å­˜æ”¾è¾ƒå¤§çš„å†…å­˜å—å’Œä»æ–°ç”Ÿä»£åˆ†é…è¿‡æ¥çš„å†…å­˜å—</p></blockquote><ul><li>å†…å­˜å¤§å°<ul><li>32 ä½ç³»ç»Ÿ 700M å·¦å³</li><li>64 ä½ç³»ç»Ÿ 1.4G å·¦å³</li></ul></li><li>åˆ†åŒº<ul><li>Old Object Space<ul><li>å­—é¢çš„è€ç”Ÿä»£ï¼Œå­˜æ”¾çš„æ˜¯æ–°ç”Ÿä»£åˆ†é…è¿‡æ¥çš„å†…å­˜ã€‚</li></ul></li><li>Large Object Space<ul><li>å­˜æ”¾å…¶ä»–åŒºåŸŸæ”¾ä¸ä¸‹çš„è¾ƒå¤§çš„å†…å­˜ï¼ŒåŸºæœ¬éƒ½è¶…è¿‡ 1M</li></ul></li><li>Map Space<ul><li>å­˜æ”¾å­˜å‚¨å¯¹è±¡çš„æ˜ å°„å…³ç³»</li></ul></li><li>Code Space<ul><li>å­˜å‚¨ç¼–è¯‘åçš„ä»£ç </li></ul></li></ul></li><li>å›æ”¶æµç¨‹<ul><li>æ ‡è®°åˆ†ç±»ï¼ˆä¸‰è‰²æ ‡è®°ï¼‰<ul><li>æœªè¢«æ‰«æï¼Œå¯å›æ”¶ï¼Œä¸‹é¢ç®€ç§°<code>1ç±»</code></li><li>æ‰«æä¸­ï¼Œä¸å¯å›æ”¶ï¼Œä¸‹é¢ç®€ç§°<code>2ç±»</code></li><li>æ‰«æå®Œæˆï¼Œä¸å¯å›æ”¶ï¼Œä¸‹é¢ç®€ç§°<code>3ç±»</code></li></ul></li><li>éå†<ul><li>é‡‡ç”¨æ·±åº¦ä¼˜å…ˆéå†ï¼Œéå†æ¯ä¸ªå¯¹è±¡ã€‚</li><li>é¦–å…ˆå°†éæ ¹éƒ¨å¯¹è±¡å…¨éƒ¨æ ‡è®°ä¸º<code>1ç±»</code>ï¼Œç„¶åè¿›è¡Œæ·±åº¦ä¼˜å…ˆéå†ã€‚</li><li>éå†è¿‡ç¨‹ä¸­å°†å¯¹è±¡å‹å…¥æ ˆï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å¯¹è±¡è¢«æ ‡è®°ä¸º<code>2ç±»</code>ã€‚</li><li>éå†å®Œæˆå¯¹è±¡å‡ºæ ˆï¼Œè¿™ä¸ªå¯¹è±¡è¢«æ ‡è®°ä¸º<code>3ç±»</code>ã€‚</li><li>æ•´ä¸ªè¿‡ç¨‹ç›´è‡³æ ˆç©º</li></ul></li><li>Mark-sweep<ul><li>æ ‡è®°å®Œæˆä¹‹åï¼Œå°†æ ‡è®°ä¸º<code>1ç±»</code>çš„å¯¹è±¡è¿›è¡Œå†…å­˜é‡Šæ”¾<br><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20210607231013225-20210607231556621.(null)" alt="img"></li></ul></li><li>Mark-compact<ul><li>åƒåœ¾å›æ”¶å®Œæˆä¹‹åï¼Œå†…å­˜ç©ºé—´æ˜¯ä¸è¿ç»­çš„ã€‚</li><li>è¿™æ ·å®¹æ˜“é€ æˆæ— æ³•åˆ†é…è¾ƒå¤§çš„å†…å­˜ç©ºé—´çš„é—®é¢˜ï¼Œä»è€Œè§¦å‘åƒåœ¾å›æ”¶ã€‚</li><li>æ‰€ä»¥ï¼Œä¼šæœ‰ Mark-compact æ­¥éª¤å°†æœªè¢«å›æ”¶çš„å†…å­˜å—æ•´ç†ä¸ºè¿ç»­åœ°å†…å­˜ç©ºé—´ã€‚</li><li>é¢‘ç¹è§¦å‘åƒåœ¾å›æ”¶ä¼šå½±å“å¼•æ“çš„æ€§èƒ½ï¼Œå†…å­˜ç©ºé—´ä¸è¶³æ—¶ä¹Ÿä¼šä¼˜å…ˆè§¦å‘ Mark-compact</li></ul></li></ul></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20210607231009280.(null)" alt="img"></p><h2 id="åƒåœ¾å›æ”¶ä¼˜åŒ–">åƒåœ¾å›æ”¶ä¼˜åŒ–</h2><ul><li>å¢é‡æ ‡è®°<ul><li>å¦‚æœç”¨é›†ä¸­çš„ä¸€æ®µæ—¶é—´è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œæ–°ç”Ÿä»£å€’è¿˜å¥½ï¼Œè€ç”Ÿä»£å¦‚æœéå†è¾ƒå¤§çš„å¯¹è±¡ï¼Œå¯èƒ½ä¼šé€ æˆå¡é¡¿ã€‚</li><li>å¢é‡æ ‡è®°ï¼šä½¿åƒåœ¾å›æ”¶ç¨‹åºå’Œåº”ç”¨é€»è¾‘ç¨‹åºäº¤æ›¿è¿è¡Œï¼Œæ€æƒ³ç±»ä¼¼ Time Slicing</li></ul></li><li>å¹¶è¡Œå›æ”¶<ul><li>åœ¨åƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸­ï¼Œå¼€å¯è‹¥å¹²è¾…åŠ©çº¿ç¨‹ï¼Œæé«˜åƒåœ¾å›æ”¶æ•ˆç‡ã€‚</li></ul></li><li>å¹¶å‘å›æ”¶<ul><li>åœ¨é€»è¾‘ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå¼€å¯è‹¥å¹²è¾…åŠ©çº¿ç¨‹è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œæ¸…ç†å’Œä¸»çº¿ç¨‹æ²¡æœ‰ä»»ä½•é€»è¾‘å…³ç³»çš„å†…å­˜ã€‚</li></ul></li></ul><h1>å†…å­˜æ³„éœ²åœºæ™¯</h1><h2 id="å…¨å±€å˜é‡">å…¨å±€å˜é‡</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// exm1</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  exm = <span class="string">&#x27;LeBron&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// exm2</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.exm = <span class="string">&#x27;LeBron&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">Example();</span><br></pre></td></tr></table></figure><h2 id="æœªæ¸…é™¤çš„å®šæ—¶å™¨">æœªæ¸…é™¤çš„å®šæ—¶å™¨</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// clearInterval(timer)</span></span><br></pre></td></tr></table></figure><h2 id="é—­åŒ…">é—­åŒ…</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn, time</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> timeout = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (timeout) &#123;</span><br><span class="line">      <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    timeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;, time);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fn = debounce(handler, <span class="number">1000</span>); <span class="comment">// fnå¼•ç”¨äº†timeout</span></span><br></pre></td></tr></table></figure><h2 id="æœªæ¸…é™¤çš„-DOM-å…ƒç´ å¼•ç”¨">æœªæ¸…é™¤çš„ DOM å…ƒç´ å¼•ç”¨</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> element = &#123;</span><br><span class="line">  <span class="comment">// æ­¤å¤„å¼•ç”¨äº†DOMå…ƒç´ </span></span><br><span class="line">  button: <span class="built_in">document</span>.getElementById(<span class="string">&#x27;LeBron&#x27;</span>),</span><br><span class="line">  select: <span class="built_in">document</span>.getElementById(<span class="string">&#x27;select&#x27;</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.body.removeChild(<span class="built_in">document</span>.getElementById(<span class="string">&#x27;LeBron&#x27;</span>));</span><br></pre></td></tr></table></figure><h1>å¦‚ä½•æ£€æµ‹å†…å­˜æ³„æ¼</h1><blockquote><p>è¿™ä¸ªå…¶å®ä¸éš¾ï¼Œæµè§ˆå™¨åŸå¸¦çš„å¼€å‘è€…å·¥å…· Performance å°±å¯ä»¥</p></blockquote><ul><li>æ­¥éª¤<ul><li>F12 æ‰“å¼€å¼€å‘è€…å·¥å…·</li><li>é€‰æ‹© Performance å·¥å…·æ </li><li>å‹¾é€‰å±å¹•æˆªå›¾å’Œ Memory</li><li>ç‚¹å‡»å¼€å§‹å½•åˆ¶</li><li>ä¸€æ®µæ—¶é—´ä¹‹åç»“æŸå½•åˆ¶</li></ul></li><li>ç»“æœ<ul><li>å †å†…å­˜ä¼šå‘¨æœŸæ€§åœ°åˆ†é…å’Œé‡Šæ”¾</li><li>å¦‚æœå †å†…å­˜çš„ min å€¼åœ¨é€æ¸ä¸Šå‡åˆ™å­˜åœ¨å†…å­˜æ³„æ¼</li></ul></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/(null)-20210622234127287.(null)" alt="img"></p><h1>ä¼˜åŒ–å†…å­˜ä½¿ç”¨</h1><ol><li>å°½é‡ä¸åœ¨ for å¾ªç¯ä¸­å®šä¹‰å‡½æ•°</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// exm</span></span><br><span class="line"><span class="keyword">const</span> fn = <span class="function">(<span class="params">idx</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> idx * <span class="number">2</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">    <span class="comment">//const fn = (idx) =&gt; &#123;</span></span><br><span class="line">    <span class="comment">//    return idx * 2;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="keyword">const</span> res = fn(i);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>å°½é‡ä¸åœ¨ for å¾ªç¯ä¸­å®šä¹‰å¯¹è±¡</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line">  <span class="keyword">let</span> res = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">    <span class="comment">// const obj = &#123;</span></span><br><span class="line">    <span class="comment">//   a: i,</span></span><br><span class="line">    <span class="comment">//   b: i * 2,</span></span><br><span class="line">    <span class="comment">//   c: i * 3,</span></span><br><span class="line">    <span class="comment">// &#125;;</span></span><br><span class="line">    obj.a = i;</span><br><span class="line">    obj.b = i * <span class="number">2</span>;</span><br><span class="line">    obj.c = i * <span class="number">3</span>;</span><br><span class="line">    res += <span class="built_in">JSON</span>.stringify(obj);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>æ¸…ç©ºæ•°ç»„</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">arr = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line">arr.length = <span class="number">0</span>; <span class="comment">// æ¸…ç©ºäº†æ•°ç»„ï¼Œæ•°ç»„ç±»å‹ä¸å˜</span></span><br><span class="line"><span class="comment">// arr = []  // é‡æ–°ç”³è¯·äº†ä¸€å—ç©ºæ•°ç»„å¯¹è±¡å†…å­˜</span></span><br></pre></td></tr></table></figure><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;[ç§‘æ™®]JavaScript GC&lt;/h1&gt;
&lt;h1&gt;ä¸ºä»€ä¹ˆéœ€è¦åƒåœ¾å›æ”¶&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ C / C++ä¸­ï¼Œè·Ÿè¸ªå†…å­˜çš„ä½¿ç”¨å’Œç®¡ç†å†…å­˜å¯¹å¼€å‘è€…æ¥è¯´æ˜¯å¾ˆå¤§çš„è´Ÿæ‹…
&lt;ul&gt;
&lt;li&gt;JavaScript æ˜¯ä½¿ç”¨åƒåœ¾å›æ”¶æœºåˆ¶çš„è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰§è¡Œç¯å¢ƒè´Ÿè´£åœ¨ä»£ç æ‰§è¡Œæ—¶</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Front End" scheme="https://lebronchao.com/tags/Front-End/"/>
    
    <category term="JavaScript" scheme="https://lebronchao.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>[æ‰“åŒ…ä¼˜åŒ–]Webpackä½“ç§¯å‹ç¼©</title>
    <link href="https://lebronchao.com/2021/06/07/Webpack%E4%BD%93%E7%A7%AF%E5%8E%8B%E7%BC%A9/"/>
    <id>https://lebronchao.com/2021/06/07/Webpack%E4%BD%93%E7%A7%AF%E5%8E%8B%E7%BC%A9/</id>
    <published>2021-06-07T15:57:14.000Z</published>
    <updated>2021-06-07T15:57:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼<br/>å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼</p><p>[<a href="https://juejin.cn/post/6969018138591494158">æ‰“åŒ…ä¼˜åŒ–]Webpack ä½“ç§¯å‹ç¼© (juejin.cn)</a></p></blockquote><h1>HTTP å‹ç¼©</h1><ul><li><p>HTTP å‹ç¼©æ˜¯ä¸€ç§å†…ç½®åœ¨ æœåŠ¡å™¨ å’Œ å®¢æˆ·ç«¯ ä¹‹é—´çš„ï¼Œä»¥æ”¹è¿›ä¼ è¾“é€Ÿåº¦å’Œå¸¦å®½åˆ©ç”¨ç‡çš„æ–¹å¼;</p></li><li><p>HTTP å‹ç¼©çš„æµç¨‹ä»€ä¹ˆå‘¢?</p><ul><li>ç¬¬ä¸€æ­¥:HTTP æ•°æ®åœ¨æœåŠ¡å™¨å‘é€å‰å°±å·²ç»è¢«å‹ç¼©äº†;(å¯ä»¥åœ¨ webpack ä¸­å®Œæˆ)</li><li>ç¬¬äºŒæ­¥:å…¼å®¹çš„æµè§ˆå™¨åœ¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œä¼šå‘ŠçŸ¥æœåŠ¡å™¨è‡ªå·±æ”¯æŒå“ªäº›å‹ç¼©æ ¼å¼;</li><li>ç¬¬ä¸‰æ­¥:æœåŠ¡å™¨åœ¨æµè§ˆå™¨æ”¯æŒçš„å‹ç¼©æ ¼å¼ä¸‹ï¼Œç›´æ¥è¿”å›å¯¹åº”çš„å‹ç¼©åçš„æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨å“åº”å¤´ä¸­å‘ŠçŸ¥æµè§ˆå™¨;</li></ul></li></ul><h2 id="å‹ç¼©æ ¼å¼">å‹ç¼©æ ¼å¼</h2><ol><li><p>compress â€“ UNIX çš„â€œcompressâ€ç¨‹åºçš„æ–¹æ³•(å†å²æ€§åŸå› ï¼Œä¸æ¨èå¤§å¤šæ•°åº”ç”¨ä½¿ç”¨ï¼Œåº”è¯¥ä½¿ç”¨ gzip æˆ–</p><p>deflate);</p></li><li><p>deflate â€“ åŸºäº deflate ç®—æ³•(å®šä¹‰äº RFC 1951)çš„å‹ç¼©ï¼Œä½¿ç”¨ zlib æ•°æ®æ ¼å¼å°è£…;</p></li><li><p>gzip â€“ GNU zip æ ¼å¼(å®šä¹‰äº RFC 1952)ï¼Œæ˜¯ç›®å‰ä½¿ç”¨æ¯”è¾ƒå¹¿æ³›çš„å‹ç¼©ç®—æ³•;</p></li><li><p>br â€“ ä¸€ç§æ–°çš„å¼€æºå‹ç¼©ç®—æ³•ï¼Œä¸“ä¸º HTTP å†…å®¹çš„ç¼–ç è€Œè®¾è®¡;</p></li></ol><h2 id="Webpack-å¯¹æ–‡ä»¶å‹ç¼©">Webpack å¯¹æ–‡ä»¶å‹ç¼©</h2><blockquote><p>ä½¿ç”¨ CompressionPlugin å¯¹æ–‡ä»¶è¿›è¡Œå‹ç¼©</p></blockquote><ul><li><p>å®‰è£…</p><ul><li><code>npm install compression-webpack-plugin</code></li></ul></li><li><p>webpack.prod.js</p><ul><li>thresholdï¼šx ä»¥ä¸Šçš„æ–‡ä»¶æ‰è¿›è¡Œå‹ç¼©</li><li>minRatioï¼šæœ€å°å‹ç¼©æ¯”ï¼Œå°äºåˆ™ä¸å‹ç¼©</li><li>testï¼šæ­£åˆ™åŒ¹é…çš„æ–‡ä»¶æ‰å‹ç¼©</li><li>alogorithmï¼šå‹ç¼©ç®—æ³•</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> CompressionPlugin = <span class="built_in">require</span>(<span class="string">&#x27;compression-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line">plugins: [</span><br><span class="line">  <span class="keyword">new</span> CompressionPlugin(&#123;</span><br><span class="line">    threshold: <span class="number">0</span>,</span><br><span class="line">    minRatio: <span class="number">0.6</span>,</span><br><span class="line">    test: <span class="regexp">/\.(css|js)/i</span>,</span><br><span class="line">    algorithm: <span class="string">&#x27;gzip&#x27;</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="HTML-æ–‡ä»¶ä¸­ä»£ç çš„å‹ç¼©">HTML æ–‡ä»¶ä¸­ä»£ç çš„å‹ç¼©</h2><ul><li><p>ä¹‹å‰ä½¿ç”¨äº† HtmlWebpackPlugin æ’ä»¶æ¥ç”Ÿæˆ HTML çš„æ¨¡æ¿ï¼Œäº‹å®ä¸Šå®ƒè¿˜æœ‰ä¸€äº›å…¶ä»–çš„é…ç½®:</p></li><li><p>inject:è®¾ç½®æ‰“åŒ…çš„èµ„æºæ’å…¥çš„ä½ç½®</p><ul><li>trueã€ false ã€bodyã€head</li></ul></li><li><p>cache:è®¾ç½®ä¸º trueï¼Œåªæœ‰å½“æ–‡ä»¶æ”¹å˜æ—¶ï¼Œæ‰ä¼šç”Ÿæˆæ–°çš„æ–‡ä»¶(é»˜è®¤å€¼ä¹Ÿæ˜¯ true)</p></li><li><p>minify:é»˜è®¤ä¼šä½¿ç”¨ä¸€ä¸ªæ’ä»¶ html-minifier-terser</p></li><li><p>webpack.prod.js</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">  <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">    title: <span class="string">&#x27;LeBronChao Webpack&#x27;</span>,</span><br><span class="line">    template: <span class="string">&#x27;./src/index.html&#x27;</span>,</span><br><span class="line">    inject: <span class="string">&#x27;body&#x27;</span>,</span><br><span class="line">    cache: <span class="literal">true</span>,</span><br><span class="line">    minify: isProduction</span><br><span class="line">      ? &#123;</span><br><span class="line">          removeComments: <span class="literal">true</span>, <span class="comment">// æ˜¯å¦åˆ é™¤æ³¨é‡Š</span></span><br><span class="line">          removeRedundantAttributes: <span class="literal">true</span>, <span class="comment">// æ˜¯å¦åˆ é™¤å¤šä½™ï¼ˆé»˜è®¤ï¼‰å±æ€§</span></span><br><span class="line">          removeEmptyAttributes: <span class="literal">true</span>, <span class="comment">// æ˜¯å¦åˆ é™¤ç©ºå±æ€§</span></span><br><span class="line">          collapseWhitespace: <span class="literal">false</span>, <span class="comment">// æŠ˜å ç©ºæ ¼</span></span><br><span class="line">          removeStyleLinkTypeAttributes: <span class="literal">true</span>, <span class="comment">// æ¯”å¦‚linkä¸­çš„type=&quot;text/css&quot;</span></span><br><span class="line">          minifyCSS: <span class="literal">true</span>, <span class="comment">// æ˜¯å¦å‹ç¼©styleæ ‡ç­¾å†…çš„css</span></span><br><span class="line">          minifyJS: &#123;</span><br><span class="line">            <span class="comment">// å‹ç¼©JSé€‰é¡¹ï¼Œå¯å‚è€ƒTerseré…ç½®</span></span><br><span class="line">            mangle: &#123;</span><br><span class="line">              toplevel: <span class="literal">true</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;</span><br><span class="line">      : <span class="literal">false</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="InlineChunkHtmlPlugin">InlineChunkHtmlPlugin</h2><ul><li><p>å¦å¤–æœ‰ä¸€ä¸ªæ’ä»¶ï¼Œå¯ä»¥è¾…åŠ©å°†ä¸€äº› chunk å‡ºæ¥çš„æ¨¡å—ï¼Œå†…è”åˆ° html ä¸­:</p><ul><li>æ¯”å¦‚ runtime çš„ä»£ç ï¼Œä»£ç é‡ä¸å¤§ï¼Œä½†æ˜¯æ˜¯å¿…é¡»åŠ è½½çš„;</li><li>é‚£ä¹ˆå¯ä»¥ç›´æ¥å†…è”åˆ° html ä¸­;</li></ul></li><li><p>è¿™ä¸ªæ’ä»¶æ˜¯åœ¨ react-dev-utils ä¸­å®ç°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å®‰è£…ä¸€ä¸‹:</p><ul><li><code>npm i react-dev-utils </code></li></ul></li><li><p>åœ¨ production çš„ plugins ä¸­è¿›è¡Œé…ç½®ï¼ˆå†…è” runtime æ–‡ä»¶ï¼‰:</p><ul><li>webpack.prod.js</li><li>å‚æ•°ä¸€ä¸º HtmlWebpackPlugin</li><li>å‚æ•°äºŒä¸ºæ­£åˆ™åŒ¹é…è¡¨è¾¾å¼</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> InlieChunkHtmlPlugin = <span class="built_in">require</span>(<span class="string">&#x27;react-dev-utils/InlineChunkHtmlPlugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line">plugins: [<span class="keyword">new</span> InlieChunkHtmlPlugin(HtmlWebpackPlugin, [<span class="regexp">/runtime.+\.js/</span>])];</span><br></pre></td></tr></table></figure><h2 id="Terser">Terser</h2><ul><li><p>ä»€ä¹ˆæ˜¯ Terser å‘¢?</p><ul><li>Terser æ˜¯ä¸€ä¸ª JavaScript çš„è§£é‡Š(Parser)ã€Mangler(ç»è‚‰æœº)/Compressor(å‹ç¼©æœº)çš„å·¥å…·é›†;</li><li>æ—©æœŸä¼šä½¿ç”¨ uglify-js æ¥å‹ç¼©ã€ä¸‘åŒ– JavaScript ä»£ç ï¼Œä½†æ˜¯ç›®å‰å·²ç»ä¸å†ç»´æŠ¤ï¼Œå¹¶ä¸”ä¸æ”¯æŒ ES6+çš„ è¯­æ³•;</li><li>Terser æ˜¯ä» uglify-es fork è¿‡æ¥çš„ï¼Œå¹¶ä¸”ä¿ç•™å®ƒåŸæ¥çš„å¤§éƒ¨åˆ† API ä»¥åŠé€‚é… uglify-es å’Œ uglify-js@3 ç­‰; ä¹Ÿå°±æ˜¯è¯´ï¼ŒTerser å¯ä»¥å¸®åŠ©å‹ç¼©ã€ä¸‘åŒ–ä»£ç ï¼Œè®©æˆ‘ä»¬çš„ bundle å˜å¾—æ›´å°ã€‚</li></ul></li><li><p>å› ä¸º Terser æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å·¥å…·ï¼Œæ‰€ä»¥å®ƒå¯ä»¥å•ç‹¬å®‰è£…:</p><ul><li><code>npm i terser -g</code></li></ul></li><li><p>å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨ Terser</p><ul><li>å› ä¸ºä»–ä»¬çš„é…ç½®éå¸¸å¤š Compress option å’Œ Mangle option</li><li>è¯¦æƒ…æŸ¥çœ‹æ–‡æ¡£<ul><li><a href="https://github.com/terser/terser#compress-options">https://github.com/terser/terser#compress-options</a></li><li><a href="https://github.com/terser/terser#mangle-options">https://github.com/terser/terser#mangle-options</a></li></ul></li></ul></li></ul><h3 id="Webpack-ä¸­é…ç½®-Terser">Webpack ä¸­é…ç½® Terser</h3><ul><li><p>é¦–å…ˆï¼Œéœ€è¦æ‰“å¼€ minimizeï¼Œè®©å…¶å¯¹ä»£ç è¿›è¡Œå‹ç¼©(é»˜è®¤ production æ¨¡å¼ä¸‹å·²ç»æ‰“å¼€äº†)</p></li><li><p>å…¶æ¬¡ï¼Œå¯ä»¥åœ¨ minimizer åˆ›å»ºä¸€ä¸ª TerserPlugin:</p><ul><li>extractComments:é»˜è®¤å€¼ä¸º trueï¼Œè¡¨ç¤ºä¼šå°†æ³¨é‡ŠæŠ½å–åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­;<ul><li>åœ¨å¼€å‘ä¸­ï¼Œä¸å¸Œæœ›ä¿ç•™è¿™ä¸ªæ³¨é‡Šæ—¶ï¼Œå¯ä»¥è®¾ç½®ä¸º false;</li></ul></li><li>parallel:ä½¿ç”¨å¤šè¿›ç¨‹å¹¶å‘è¿è¡Œæé«˜æ„å»ºçš„é€Ÿåº¦ï¼Œé»˜è®¤å€¼æ˜¯ trueï¼Œå¹¶å‘è¿è¡Œçš„é»˜è®¤æ•°é‡: os.cpus().length - 1;<ul><li>ä¹Ÿå¯ä»¥è®¾ç½®è‡ªå·±çš„ä¸ªæ•°ï¼Œä½†æ˜¯ä½¿ç”¨é»˜è®¤å€¼å³å¯;</li></ul></li><li>terserOptions:è®¾ç½® terser ç›¸å…³çš„é…ç½®<ul><li>compress:è®¾ç½®å‹ç¼©ç›¸å…³çš„é€‰é¡¹;</li><li>mangle:è®¾ç½®ä¸‘åŒ–ç›¸å…³çš„é€‰é¡¹ï¼Œå¯ä»¥ç›´æ¥è®¾ç½®ä¸º true;</li><li>toplevel:åº•å±‚å˜é‡æ˜¯å¦è¿›è¡Œè½¬æ¢;</li><li>keep_classnames:ä¿ç•™ç±»çš„åç§°;</li></ul></li></ul></li></ul><h2 id="CSS-å‹ç¼©">CSS å‹ç¼©</h2><ul><li><p>å¦ä¸€ä¸ªä»£ç çš„å‹ç¼©æ˜¯ CSS:</p><ul><li>CSS å‹ç¼©é€šå¸¸æ˜¯å»é™¤æ— ç”¨çš„ç©ºæ ¼ç­‰ï¼Œå› ä¸ºå¾ˆéš¾å»ä¿®æ”¹é€‰æ‹©å™¨ã€å±æ€§çš„åç§°ã€å€¼ç­‰;</li><li>CSS çš„å‹ç¼©æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ä¸ªæ’ä»¶:css-minimizer-webpack-plugin;</li><li>css-minimizer-webpack-plugin æ˜¯ä½¿ç”¨ cssnano å·¥å…·æ¥ä¼˜åŒ–ã€å‹ç¼© CSS(ä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨);</li></ul></li><li><p>å®‰è£… css-minimizer-webpack-plugin:</p><ul><li><code>npm i css-minimizer-webpack-plugin</code></li></ul></li><li><p>åœ¨ optimization.minimizer ä¸­é…ç½®</p></li></ul><h2 id="é…ç½®ç¤ºä¾‹">é…ç½®ç¤ºä¾‹</h2><ul><li>webpack.prod.js</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="built_in">require</span>(<span class="string">&#x27;clean-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;copy-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> isProduction = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">const</span> TerserPlugin = <span class="built_in">require</span>(<span class="string">&#x27;terser-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> CssMiniMizerPlugin = <span class="built_in">require</span>(<span class="string">&#x27;css-minimizer-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">&#x27;production&#x27;</span>,</span><br><span class="line">  optimization: &#123;</span><br><span class="line">    chunkIds: <span class="string">&#x27;deterministic&#x27;</span>,</span><br><span class="line">    minimize: <span class="literal">true</span>,</span><br><span class="line">    minimizer: [</span><br><span class="line">      <span class="keyword">new</span> TerserPlugin(&#123;</span><br><span class="line">        extractComments: <span class="literal">true</span>,</span><br><span class="line">        parallel: <span class="literal">true</span>,</span><br><span class="line">        terserOptions: &#123;</span><br><span class="line">          compress: <span class="literal">true</span>,</span><br><span class="line">          mangle: <span class="literal">true</span>,</span><br><span class="line">          toplevel: <span class="literal">false</span>,</span><br><span class="line">          keep_classnames: <span class="literal">false</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="keyword">new</span> CssMiniMizerPlugin(&#123;</span><br><span class="line">        parallel: <span class="literal">true</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> CleanWebpackPlugin(),</span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin(&#123;</span><br><span class="line">      patterns: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">from</span>: <span class="string">&#x27;public&#x27;</span>,</span><br><span class="line">          <span class="comment">// å¯ä¸å†™ï¼Œé»˜è®¤åˆ°output</span></span><br><span class="line">          to: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">          globOptions: &#123;</span><br><span class="line">            ignore: [<span class="string">&#x27;**/index.html&#x27;</span>, <span class="string">&#x27;**/.DS_Store&#x27;</span>, <span class="string">&#x27;**/abc.txt&#x27;</span>],</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>[<a href="https://juejin.cn/post/6969018138591494158">æ‰“åŒ…ä¼˜åŒ–]Webpack ä½“ç§¯å‹ç¼© (juejin.cn)</a></p><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼&lt;br/&gt;å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;https://juejin.cn/post/6969018138591494158&quot;&gt;æ‰“åŒ…ä¼˜åŒ–]Webpack ä½“ç§¯å‹</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Webpack" scheme="https://lebronchao.com/tags/Webpack/"/>
    
    <category term="æ‰“åŒ…æ„å»º" scheme="https://lebronchao.com/tags/%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA/"/>
    
    <category term="å‰ç«¯" scheme="https://lebronchao.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://lebronchao.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="Loader" scheme="https://lebronchao.com/tags/Loader/"/>
    
  </entry>
  
  <entry>
    <title>[åˆ†äº«]Webpackæ‰“åŒ…åˆ†æå·¥å…·</title>
    <link href="https://lebronchao.com/2021/06/07/Webpack%E6%89%93%E5%8C%85%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/"/>
    <id>https://lebronchao.com/2021/06/07/Webpack%E6%89%93%E5%8C%85%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/</id>
    <published>2021-06-07T15:54:31.000Z</published>
    <updated>2021-06-07T15:54:31.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼<br/>å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼</p><p>[<a href="https://juejin.cn/post/6968275465572188191">åˆ†äº«]Webpack æ‰“åŒ…åˆ†æå·¥å…· (juejin.cn)</a></p></blockquote><h1>Webpack æ‰“åŒ…åˆ†æ</h1><blockquote><p>åˆ†äº«æ—¶é—´å’Œæ–‡ä»¶çš„åˆ†æå·¥å…·ï¼Œä¾¿äºè¿›è¡Œæ‰“åŒ…ä¼˜åŒ–ã€‚</p></blockquote><h2 id="æ‰“åŒ…çš„æ—¶é—´åˆ†æ">æ‰“åŒ…çš„æ—¶é—´åˆ†æ</h2><ul><li><p>å¦‚æœå¸Œæœ›çœ‹åˆ°æ¯ä¸€ä¸ª Loaderã€æ¯ä¸€ä¸ª Plugin æ¶ˆè€—çš„æ‰“åŒ…æ—¶é—´ï¼Œå¯ä»¥å€ŸåŠ©äºä¸€ä¸ªæ’ä»¶:speed-measure-webpack-plugin</p><ul><li>æ³¨æ„:è¯¥æ’ä»¶åœ¨æœ€æ–°çš„ webpack ç‰ˆæœ¬ä¸­å­˜åœ¨ä¸€äº›å…¼å®¹æ€§çš„é—®é¢˜(å’Œéƒ¨åˆ† Plugin ä¸å…¼å®¹)</li><li>æˆªæ­¢ 2021-3-10 æ—¥ï¼Œä½†æ˜¯ç›®å‰è¯¥æ’ä»¶è¿˜åœ¨ç»´æŠ¤ï¼Œæ‰€ä»¥å¯ä»¥ç­‰å¾…åç»­æ˜¯å¦æ›´æ–°;</li></ul></li><li><p>å®‰è£…</p><ul><li><code>npm i speed-measure-webpack-plugin</code></li></ul></li><li><p>ä½¿ç”¨</p><ul><li>åˆ›å»ºæ’ä»¶å¯¼å‡ºçš„å¯¹è±¡ SpeedMeasurePlugin;</li><li>ä½¿ç”¨ smp.wrap åŒ…è£¹æˆ‘ä»¬å¯¼å‡ºçš„ webpack é…ç½®;</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> SpeedMeasurePlugin = <span class="built_in">require</span>(<span class="string">&#x27;speed-measure-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> smp = <span class="keyword">new</span> SpeedMeasurePlugin();</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">env</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> isProduction = env.production;</span><br><span class="line">  process.env.NODE_ENV = isProduction ? <span class="string">&#x27;production&#x27;</span> : <span class="string">&#x27;development&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> config = isProduction ? prodConfig : devConfig;</span><br><span class="line">  <span class="keyword">const</span> webpackConfig = merge(commonConfig(isProduction), config);</span><br><span class="line">  <span class="keyword">return</span> smp.wrap(webpackConfig);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>æ•ˆæœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/33dce190bd2344059ba35f5923d08985~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210502234038719"></p><h2 id="æ‰“åŒ…åçš„æ–‡ä»¶åˆ†æ">æ‰“åŒ…åçš„æ–‡ä»¶åˆ†æ</h2><h3 id="æ–¹æ¡ˆä¸€ï¼šç”Ÿæˆ-stats-json-æ–‡ä»¶">æ–¹æ¡ˆä¸€ï¼šç”Ÿæˆ stats.json æ–‡ä»¶</h3><ul><li>ç¼–è¾‘ npm script</li></ul><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&quot;stats&quot;: &quot;webpack --config ./config/webpack.common.js --env production --profile --json=stats.json&quot;,</span><br></pre></td></tr></table></figure><ul><li><p>è¿è¡Œ npm run stats</p><ul><li>æ ¹ç›®å½•ä¸‹ç”Ÿæˆäº†ä¸€ä¸ª stats.json</li></ul></li><li><p>json æ–‡ä»¶å†…å®¹è¾ƒå¤æ‚ï¼Œå¯ä»¥å°†æ–‡ä»¶ä¸Šä¼ è‡³https://webpack.github.io/analyse/ è¿›è¡Œåˆ†æ</p></li><li><p>æ•ˆæœ</p></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9e4274bbeb174029a66c2476e471d03e~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p><h3 id="æ–¹æ¡ˆäºŒï¼šä½¿ç”¨-webpack-bundle-analyzer">æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ webpack-bundle-analyzer</h3><ul><li><p>å®‰è£…</p><ul><li><code>npm install webpack-bundle-analyzer</code></li></ul></li><li><p>webpack.common.js</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; BundleAnalyzerPlugin &#125; = <span class="built_in">require</span>(<span class="string">&#x27;webpack-bundle-analyzer&#x27;</span>);</span><br><span class="line"></span><br><span class="line">plugins: [<span class="keyword">new</span> BundleAnalyzerPlugin()];</span><br></pre></td></tr></table></figure><ul><li><p>åœ¨æ‰“åŒ… webpack çš„æ—¶å€™ï¼Œè¿™ä¸ªå·¥å…·æ‰“å¼€ä¸€ä¸ª 8888 ç«¯å£ä¸Šçš„æœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥ç›´è§‚çš„çœ‹åˆ°æ¯ä¸ªåŒ…çš„å¤§å°ã€‚</p><ul><li>æ¯”å¦‚æœ‰ä¸€ä¸ªåŒ…æ˜¯é€šè¿‡ä¸€ä¸ª Vue ç»„ä»¶æ‰“åŒ…çš„ï¼Œä½†æ˜¯éå¸¸çš„å¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘æ˜¯å¦å¯ä»¥æ‹†åˆ†å‡ºå¤šä¸ªç»„ä»¶ï¼Œå¹¶ä¸”å¯¹å…¶è¿›è¡Œæ‡’åŠ è½½;</li><li>æ¯”å¦‚ä¸€ä¸ªå›¾ç‰‡æˆ–è€…å­—ä½“æ–‡ä»¶ç‰¹åˆ«å¤§ï¼Œæ˜¯å¦å¯ä»¥å¯¹å…¶è¿›è¡Œå‹ç¼©æˆ–è€…å…¶ä»–çš„ä¼˜åŒ–å¤„ç†;</li></ul></li><li><p>æ•ˆæœ</p></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/7736de9810554f7fb63fcc2dce63b65f~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210502234139506"></p><p>[<a href="https://juejin.cn/post/6968275465572188191">åˆ†äº«]Webpack æ‰“åŒ…åˆ†æå·¥å…· (juejin.cn)</a></p><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼&lt;br/&gt;å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;https://juejin.cn/post/6968275465572188191&quot;&gt;åˆ†äº«]Webpack æ‰“åŒ…åˆ†æå·¥</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Webpack" scheme="https://lebronchao.com/tags/Webpack/"/>
    
    <category term="æ‰“åŒ…æ„å»º" scheme="https://lebronchao.com/tags/%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA/"/>
    
    <category term="å‰ç«¯" scheme="https://lebronchao.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://lebronchao.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="Loader" scheme="https://lebronchao.com/tags/Loader/"/>
    
  </entry>
  
  <entry>
    <title>[æ‰“åŒ…ä¼˜åŒ–]Webpack DLL</title>
    <link href="https://lebronchao.com/2021/06/07/WebpackDLL/"/>
    <id>https://lebronchao.com/2021/06/07/WebpackDLL/</id>
    <published>2021-06-07T15:53:03.000Z</published>
    <updated>2021-06-07T15:53:03.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼<br/>å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼</p><p>[<a href="https://juejin.cn/post/6967164397127270436">æ‰“åŒ…ä¼˜åŒ–]Webpack DLL (juejin.cn)</a></p></blockquote><h1>è®¤è¯† DLL åº“</h1><ul><li><p>ä»€ä¹ˆæ˜¯ DLL</p><ul><li>DLL å…¨ç§°æ˜¯åŠ¨æ€é“¾æ¥åº“(Dynamic Link Library)ï¼Œæ˜¯ä¸ºè½¯ä»¶åœ¨ Windows ä¸­å®ç°å…±äº«å‡½æ•°åº“çš„ä¸€ç§å®ç°æ–¹å¼;</li><li>é‚£ä¹ˆ webpack ä¸­ä¹Ÿæœ‰å†…ç½® DLL çš„åŠŸèƒ½ï¼Œå®ƒæŒ‡çš„æ˜¯å¯ä»¥å°†å¯ä»¥å…±äº«ï¼Œå¹¶ä¸”ä¸ç»å¸¸æ”¹å˜çš„ä»£ç ï¼ŒæŠ½å–æˆä¸€ä¸ªå…±äº«çš„åº“;</li><li>è¿™ä¸ªåº“åœ¨ä¹‹åç¼–è¯‘çš„è¿‡ç¨‹ä¸­ï¼Œä¼šè¢«å¼•å…¥åˆ°å…¶ä»–é¡¹ç›®çš„ä»£ç ä¸­ï¼Œå‡å°‘çš„æ‰“åŒ…çš„æ—¶é—´;</li></ul></li><li><p>DDL åº“çš„ä½¿ç”¨åˆ†ä¸ºä¸¤æ­¥:</p><ul><li>ç¬¬ä¸€æ­¥:æ‰“åŒ…ä¸€ä¸ª DLL åº“;</li><li>ç¬¬äºŒæ­¥:é¡¹ç›®ä¸­å¼•å…¥ DLL åº“</li></ul></li></ul><h2 id="DLL-æ‰“åŒ…">DLL æ‰“åŒ…</h2><blockquote><p>webpack å†…ç½® DllPlugin å¸®åŠ©ç”Ÿæˆ DLL æ–‡ä»¶</p></blockquote><ul><li>webpack.common.js<ul><li>contextï¼šæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œ</li><li>entryï¼š<ul><li>keyï¼šnameï¼ˆplaceholderï¼‰</li><li>valueï¼šè¦æ‰“åŒ…çš„åŒ…å</li></ul></li><li>outputï¼ˆå¸¸è§„ï¼‰</li><li>plugins<ul><li>DllPlugin<ul><li>nameï¼šå®šä¹‰ç”Ÿæˆ dll æ–‡ä»¶çš„åç§°</li><li>pathï¼šç”Ÿæˆ dll æ–‡ä»¶çš„æ–‡ä»¶è·¯å¾„</li></ul></li></ul></li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; DllPlugin &#125; = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; merge &#125; = <span class="built_in">require</span>(<span class="string">&#x27;webpack-merge&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig = <span class="function">(<span class="params">isProduction</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    context: path.resolve(__dirname, <span class="string">&#x27;../&#x27;</span>),</span><br><span class="line">    entry: &#123;</span><br><span class="line">      react: [<span class="string">&#x27;react&#x27;</span>, <span class="string">&#x27;react-dom&#x27;</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">      path: path.resolve(__dirname, <span class="string">&#x27;../dll&#x27;</span>),</span><br><span class="line">      filename: <span class="string">&#x27;dll_[name].js&#x27;</span>,</span><br><span class="line">      library: <span class="string">&#x27;dll_[name]&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">      <span class="keyword">new</span> DllPlugin(&#123;</span><br><span class="line">        name: <span class="string">&#x27;[name].manifest.json&#x27;</span>,</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">&#x27;../dll/[name].manifest.json&#x27;</span>),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> devConfig = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.dev&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> prodConfig = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.prod&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">env</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> isProduction = env.production;</span><br><span class="line">  process.env.NODE_ENV = isProduction ? <span class="string">&#x27;production&#x27;</span> : <span class="string">&#x27;development&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> config = isProduction ? prodConfig : devConfig;</span><br><span class="line">  <span class="keyword">return</span> merge(commonConfig(isProduction), config);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>æ‰“åŒ…å®Œæˆåï¼Œåœ¨æ ¹ç›®å½•ä¸‹ä¼šæœ‰ä¸€ä¸ª dll æ–‡ä»¶å¤¹ï¼Œå†…æœ‰ Dll æ–‡ä»¶å’Œç›¸åº” manifest.json æ–‡ä»¶ã€‚</p></blockquote><h2 id="DLL-ä½¿ç”¨">DLL ä½¿ç”¨</h2><ul><li>å¦‚æœæˆ‘ä»¬çš„ä»£ç ä¸­ä½¿ç”¨äº† reactã€react-domï¼Œæœ‰é…ç½® splitChunks çš„æƒ…å†µä¸‹ï¼Œä»–ä»¬ä¼šè¿›è¡Œåˆ†åŒ…ï¼Œæ‰“åŒ…åˆ° ä¸€ä¸ªç‹¬ç«‹çš„ chunk ä¸­ã€‚<ul><li>ä½†æ˜¯ç°åœ¨æœ‰äº† dll_reactï¼Œä¸å†éœ€è¦å•ç‹¬å»æ‰“åŒ…å®ƒä»¬ï¼Œå¯ä»¥ç›´æ¥å»å¼•ç”¨ dll_react å³å¯:</li><li>ç¬¬ä¸€æ­¥:é€šè¿‡ DllReferencePlugin æ’ä»¶å‘ŠçŸ¥è¦ä½¿ç”¨çš„ DLL åº“;</li><li>ç¬¬äºŒæ­¥:é€šè¿‡ AddAssetHtmlPlugin æ’ä»¶ï¼Œå°†æ‰“åŒ…çš„ DLL åº“å¼•å…¥åˆ° Html æ¨¡å—ä¸­;</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> DllReferencePlugin(&#123;</span><br><span class="line">  context: path.resolve(__dirname, <span class="string">&#x27;../&#x27;</span>),</span><br><span class="line">  manifest: path.resolve(__dirname, <span class="string">&#x27;../dll/react.manifest.json&#x27;</span>),</span><br><span class="line">&#125;),</span><br><span class="line">  <span class="keyword">new</span> AddAssetHtmlWebpackPlugin(&#123;</span><br><span class="line">    outputPath: <span class="string">&#x27;../build/js&#x27;</span>,</span><br><span class="line">    filepath: path.resolve(__dirname, <span class="string">&#x27;../dll/dll_react.js&#x27;</span>),</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure> <hr/><p>[<a href="https://juejin.cn/post/6967164397127270436">æ‰“åŒ…ä¼˜åŒ–]Webpack DLL (juejin.cn)</a></p><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼&lt;br/&gt;å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;https://juejin.cn/post/6967164397127270436&quot;&gt;æ‰“åŒ…ä¼˜åŒ–]Webpack DLL</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Webpack" scheme="https://lebronchao.com/tags/Webpack/"/>
    
    <category term="æ‰“åŒ…æ„å»º" scheme="https://lebronchao.com/tags/%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA/"/>
    
    <category term="å‰ç«¯" scheme="https://lebronchao.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://lebronchao.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="Loader" scheme="https://lebronchao.com/tags/Loader/"/>
    
  </entry>
  
  <entry>
    <title>[æ¢ç´¢]Webpack DevServerå’ŒHMRåŸç†</title>
    <link href="https://lebronchao.com/2021/06/07/WebpackDevServer%E5%92%8CHMR%E5%8E%9F%E7%90%86/"/>
    <id>https://lebronchao.com/2021/06/07/WebpackDevServer%E5%92%8CHMR%E5%8E%9F%E7%90%86/</id>
    <published>2021-06-07T15:49:57.000Z</published>
    <updated>2021-06-07T15:49:57.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼<br/>å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼</p><p>[<a href="https://juejin.cn/post/6966422095274180639">æ¢ç´¢]Webpack DevServer å’Œ HMR åŸç† (juejin.cn)</a></p></blockquote><h1>Webpack-Dev-Server</h1><blockquote><p>ä¸ºä»€ä¹ˆè¦æ­å»ºæœ¬åœ°æœåŠ¡å™¨</p></blockquote><ul><li><p>ç›®å‰å¼€å‘çš„ä»£ç ï¼Œä¸ºäº†è¿è¡Œéœ€è¦æœ‰ä¸¤ä¸ªæ“ä½œ</p><ul><li><code>npm run build</code>ç¼–è¯‘</li><li>é€šè¿‡ live-server æˆ–è€…ç›´æ¥é€šè¿‡æµè§ˆå™¨æ‰“å¼€ html æ–‡ä»¶ï¼ŒæŸ¥çœ‹æ•ˆæœ</li></ul></li><li><p>ä¸ºäº†å®Œæˆè‡ªåŠ¨ç¼–è¯‘ï¼Œwebpack æä¾›äº†å‡ ç§å¯é€‰çš„æ–¹å¼</p><ul><li>Webpack watch mode</li><li>Webpack-dev-server</li><li>Webpack-dev-middleware</li></ul></li></ul><h2 id="Webpack-Watch-Mode">Webpack Watch Mode</h2><ul><li><p>webpack æä¾›äº† watch æ¨¡å¼</p><ul><li>åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œwebpack ä¾èµ–å›¾ä¸­æ‰€æœ‰æ–‡ä»¶ï¼Œåªè¦æœ‰ä¸€ä¸ªå‘ç”Ÿäº†æ›´æ–°ï¼Œé‚£ä¹ˆä»£ç å°†è¢«é‡æ–°ç¼–è¯‘ã€‚</li><li>ä¸éœ€è¦æ‰‹åŠ¨<code>npm run build</code></li></ul></li><li><p>å¦‚ä½•å¼€å¯ï¼Ÿ</p><ul><li>æ–¹å¼ä¸€ï¼šåœ¨å¯¼å‡ºçš„é…ç½®ä¸­ï¼Œæ·»åŠ  watch:true</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&#x27;js/bundle.js&#x27;</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">&#x27;build&#x27;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  watch: <span class="literal">true</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>æ–¹å¼äºŒï¼šåœ¨å¯åŠ¨ webapck çš„å‘½ä»¤ä¸­ï¼Œæ·»åŠ â€“watch æ ‡è¯†</li></ul><figure class="highlight"><table><tr><td class="code"><pre><span class="line">npm script:&#123;</span><br><span class="line"> &quot;watch&quot;: &quot;webpack --watch&quot;</span><br><span class="line">&#125;</span><br><span class="line"># npm run watch</span><br></pre></td></tr></table></figure><h2 id="Webpack-Dev-Server">Webpack Dev Server</h2><ul><li><p>ä¸Šé¢çš„æ–¹å¼å¯ä»¥ç›‘å¬åˆ°æ–‡ä»¶çš„å˜åŒ–ï¼Œä½†æ˜¯æ²¡æœ‰è‡ªåŠ¨åˆ·æ–°æµè§ˆå™¨çš„åŠŸèƒ½</p><ul><li>webpack-dev-server å¯ä»¥å®ç°</li></ul></li><li><p>å®‰è£…</p><ul><li><code>npm install --save webpack-dev-server</code></li></ul></li><li><p>ä¿®æ”¹ npm scriptï¼ŒåŒæ—¶å¯åœ¨é…ç½®æ–‡ä»¶ä¸­ devServer å±æ€§ä¸‹é…ç½® devServer</p></li></ul><figure class="highlight"><table><tr><td class="code"><pre><span class="line">script:&#123;</span><br><span class="line">    &quot;serve&quot;:&quot;webpack serve&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>webpack-dev-server åœ¨ç¼–è¯‘ä¹‹åä¸ä¼šå†™å…¥åˆ°ä»»ä½•è¾“å‡ºæ–‡ä»¶ã€‚è€Œæ˜¯å°† bundle æ–‡ä»¶ä¿ç•™åœ¨å†…å­˜ä¸­<ul><li>äº‹å®ä¸Š webpck-dev-server ä½¿ç”¨äº†ä¸€ä¸ªå« memfs çš„åº“ã€‚</li></ul></li></ul><h2 id="Webpack-Dev-Middleware">Webpack Dev Middleware</h2><ul><li><p>webpack-dev-middleware æ˜¯ä¸€ä¸ªå°è£…å™¨ï¼Œå®ƒå¯ä»¥æŠŠ webpack å¤„ç†è¿‡çš„æ–‡ä»¶å‘é€åˆ°ä¸€ä¸ª server</p><ul><li>webpack-dev-server åœ¨å†…éƒ¨ä½¿ç”¨äº†å®ƒï¼Œç„¶è€Œå®ƒä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„ package æ¥ä½¿ç”¨ï¼Œä»¥ä¾¿æ ¹æ®éœ€æ±‚è¿›è¡Œæ›´å¤šè‡ªå®šä¹‰é…ç½®</li><li>æ­é…ä¸€ä¸ªæœåŠ¡å™¨æ¥ä½¿ç”¨å®ƒï¼Œæ¯”å¦‚ express.</li><li><code>npm install --save express webpack-dev-middleware</code></li></ul></li><li><p>ç¼–å†™ Server.js</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> webpackDevMiddleware = <span class="built_in">require</span>(<span class="string">&#x27;webpack-dev-middleware&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.config&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> compiler = webpack(config);</span><br><span class="line"></span><br><span class="line">app.use(</span><br><span class="line">  webpackDevMiddleware(compiler, &#123;</span><br><span class="line">    publicPath: config.output.publicPath,</span><br><span class="line">  &#125;),</span><br><span class="line">  () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;è¿™é‡Œæ˜¯å›è°ƒå‡½æ•°&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;Server running&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>Node Server.js å³å¯è¿è¡Œèµ·ä¸€ä¸ªæœåŠ¡ï¼Œå¹¶ç›‘å¬æ–‡ä»¶æ›´æ”¹å’Œåˆ·æ–°æµè§ˆå™¨ã€‚</li></ul><h2 id="PublicPath">PublicPath</h2><ul><li><p>Output ä¸­æœ‰ä¸¤ä¸ªå¾ˆé‡è¦çš„å±æ€§ï¼špath å’Œ publicPath</p><ul><li>pathï¼šç”¨äºæŒ‡å®šæ–‡ä»¶çš„è¾“å‡ºè·¯å¾„ï¼Œæ˜¯ä¸€ä¸ªèšå †è·¯å¾„</li><li>publicPathï¼šé»˜è®¤æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œå®ƒä¸ºæˆ‘ä»¬é¡¹ç›®ä¸­çš„èµ„æºåˆ¶å®šä¸€ä¸ªå…¬å…±çš„è·¯å¾„ publicPath</li></ul></li><li><p>è¿™ä¸ª publicPath å¾ˆä¸å®¹æ˜“ç†è§£ï¼Œå…¶å®å°±æ˜¯ç»™æˆ‘ä»¬æ‰“åŒ…çš„èµ„æºï¼Œç»™å®ƒä¸€ä¸ªè·¯å¾„</p><ul><li>èµ„æºçš„è·¯å¾„ = output.publicePath + æ‰“åŒ…èµ„æºçš„è·¯å¾„(æ¯”å¦‚&quot;js/[name].bundle.js&quot;)</li></ul></li><li><p>å¸¸ç”¨çš„å€¼</p><ul><li>./ :æœ¬åœ°ç¯å¢ƒä¸‹å¯ä»¥ä½¿ç”¨è¿™ä¸ªç›¸å¯¹è·¯å¾„</li><li>/ :æœåŠ¡å™¨éƒ¨ç½²æ—¶ä½¿ç”¨ï¼ŒæœåŠ¡å™¨åœ°å€ + /js/[name].bundle.js</li></ul></li><li><p>devServer çš„ publicPathã€output çš„ publicPath å’Œ[webpackDevMiddleware çš„ publicPath]éœ€ä¸€è‡´</p></li></ul><h2 id="ContentBase">ContentBase</h2><ul><li><p>devServer ä¸­ contentBase å¯¹äºæˆ‘ä»¬ç›´æ¥è®¿é—®æ‰“åŒ…åçš„èµ„æºå…¶å®å¹¶æ²¡æœ‰å¤ªå¤§çš„ä½œç”¨ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å¦‚æœæˆ‘ä»¬æ‰“åŒ…åçš„èµ„æºï¼Œåˆä¾èµ–äºå…¶ä»–çš„ä¸€äº›èµ„æºï¼Œé‚£ä¹ˆå°±éœ€è¦æŒ‡å®šä»å“ªé‡Œæ¥æŸ¥æ‰¾è¿™ä¸ªå†…å®¹:</p><ul><li>æ¯”å¦‚åœ¨ index.html ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¾èµ–ä¸€ä¸ª abc.js æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æˆ‘ä»¬å­˜æ”¾åœ¨ public æ–‡ä»¶ä¸­;</li><li>åœ¨ index.html ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•å»å¼•å…¥è¿™ä¸ªæ–‡ä»¶?<ul><li>æ¯”å¦‚ä»£ç æ˜¯è¿™æ ·çš„:<script src="./public/abc.js"></script>;</li><li>è¿™æ ·æ‰“åŒ…åæµè§ˆå™¨æ— æ³•é€šè¿‡ç›¸å¯¹è·¯å¾„å»æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹;</li><li>æ‰€ä»¥ä»£ç æ˜¯è¿™æ ·:<script src="/abc.js"></script>;</li><li>å¦‚ä½•è®©å®ƒå»æŸ¥æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶çš„å­˜åœ¨? è®¾ç½® contentBase å³å¯;</li></ul></li></ul></li><li><p>å½“ç„¶åœ¨ devServer ä¸­è¿˜æœ‰ä¸€ä¸ªå¯ä»¥ç›‘å¬ contentBase å‘ç”Ÿå˜åŒ–åé‡æ–°ç¼–è¯‘çš„ä¸€ä¸ªå±æ€§ï¼šwatchContentBaseã€‚</p></li></ul><h2 id="Proxy-ä»£ç†">Proxy ä»£ç†</h2><blockquote><p>proxy æ˜¯æˆ‘ä»¬å¼€å‘ä¸­å¸¸ç”¨çš„ä¸€ä¸ªé…ç½®é€‰é¡¹ï¼Œå®ƒçš„ç›®çš„è®¾ç½®ä»£ç†æ¥è§£å†³è·¨åŸŸè®¿é—®çš„é—®é¢˜</p></blockquote><ul><li>è®¾ç½®<ul><li>targetï¼šæ ‡è¯†çš„æ˜¯ä»£ç†åˆ°çš„ç›®æ ‡åœ°å€ï¼Œæ¯”å¦‚/api/moment ä¼šè¢«ä»£ç†åˆ° <a href="http://localhost:8888/api/moment">http://localhost:8888/api/moment</a></li><li>pathRewriteï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„/api ä¹Ÿä¼šè¢«å†™å…¥åˆ° URL ä¸­ï¼Œå¦‚æœå¸Œæœ›åˆ é™¤ï¼Œå¯ä»¥ä½¿ç”¨</li><li>secureï¼šé»˜è®¤æƒ…å†µä¸‹ä¸æ¥å—è½¬å‘åˆ° https çš„æœåŠ¡å™¨ï¼Œå¦‚æœå¸Œæœ›æ”¯æŒï¼Œè®¾ç½®ä¸º false</li><li>changeOriginï¼šè¡¨ç¤ºæ˜¯å¦æ›´æ–°ä»£ç†åè¯·æ±‚ headers ä¸­çš„ host åœ°å€</li><li>historyApiFallbackï¼šè§£å†³ SPA é¡µé¢åœ¨è·¯ç”±è·³è½¬åï¼Œè¿›è¡Œé¡µé¢åˆ·æ–°è¿”å› 404 çš„é”™è¯¯<ul><li>boolean å€¼ï¼šé»˜è®¤æ˜¯ falseï¼Œå¦‚æœè®¾ç½®ä¸º trueï¼Œåˆ·æ–°çš„æ—¶å€™ï¼Œè¿”å› 404 é”™è¯¯æ—¶ï¼Œä¼šè‡ªåŠ¨è¿”å› index.html çš„å†…å®¹</li><li>object å€¼ï¼šå¯ä»¥é…ç½® rewrites å±æ€§<ul><li>å¯ä»¥é…ç½® from æ¥åŒ¹é…è·¯å¾„ï¼Œå†³å®šè¦è·³åˆ°å“ªä¸ªé¡µé¢ï¼Œè¯¦æƒ…æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ã€‚</li></ul></li></ul></li></ul></li></ul><h2 id="Other-Config">Other Config</h2><ul><li><p>hotOnly</p><ul><li>é»˜è®¤æƒ…å†µä¸‹å½“ä»£ç ç¼–è¯‘å¤±è´¥ä¿®å¤åä¼šåˆ·æ–°é¡µé¢ï¼Œä¸å¸Œæœ›åˆ·æ–°è®¾ç½® hotOnly:true</li></ul></li><li><p>host ä¸»æœºåœ°å€</p><ul><li>é»˜è®¤å€¼æ˜¯ localhost</li><li>å¦‚æœå…¶ä»– PC ä¹Ÿå¯ä»¥è®¿é—®å¯è®¾ç½® 0.0.0.0</li></ul></li><li><p>localhost å’Œ 0.0.0.0 çš„åŒºåˆ«</p><ul><li>localhost æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŸŸåä¼šè¢«è§£æä¸º 127.0.0.1</li><li>127.0.0.1 æ˜¯ä¸€ä¸ªä¼šæ¢åœ°å€ï¼Œè¡¨è¾¾å¾—æ„æ€æ˜¯ä¸»æœºè‡ªå·±å‘å‡ºå»çš„åŒ…ï¼Œç›´æ¥è¢«è‡ªå·±æ¥å—<ul><li>æ­£å¸¸çš„æ•°æ®åº“åŒ…ç»å¸¸ åº”ç”¨å±‚ -&gt; ä¼ è¾“å±‚ -&gt; ç½‘ç»œå±‚ -&gt; æ•°æ®é“¾è·¯å±‚ -&gt; ç‰©ç†å±‚</li><li>è€Œå›ç¯åœ°å€ï¼Œåœ¨ç½‘è”ç»œå±‚ç›´æ¥å°±è¢«è·å–</li><li>ç›‘å¬ 127.0.0.1 æ—¶ï¼ŒåŒä¸ªç½‘æ®µä¸‹çš„ä¸»æœºä¸­ï¼Œé€šè¿‡ ip åœ°å€æ˜¯ä¸èƒ½è®¿é—®çš„ã€‚</li></ul></li><li>0.0.0.0ï¼šç›‘å¬ IPV4 ä¸Šæ‰€æœ‰çš„åœ°å€ï¼Œå†æ ¹æ®ç«¯å£æ‰¾åˆ°ä¸åŒçš„åº”ç”¨ç¨‹åºã€‚<ul><li>ç›‘å¬ 0.0.0.0 æ—¶ï¼Œåœ¨åŒä¸€ä¸ªç½‘æ®µä¸‹çš„ä¸»æœºä¸­ï¼Œé€šè¿‡ IP åœ°å€æ˜¯å¯ä»¥è®¿é—®çš„ã€‚</li></ul></li></ul></li><li><p>Port</p><ul><li>è®¾ç½®ç›‘å¬çš„ç«¯å£ï¼Œé»˜è®¤ä¸º 8080</li></ul></li><li><p>open æ˜¯å¦æ‰“å¼€æµè§ˆå™¨</p><ul><li>é»˜è®¤ä¸º falseï¼Œtrue ä¼šæ‰“å¼€æµè§ˆå™¨</li><li>ä¹Ÿå¯ä»¥è®¾ç½®ç±»ä¼¼äº Google Chrome ç­‰å€¼</li></ul></li><li><p>compress æ˜¯å¦ä¸ºé™æ€æ–‡ä»¶å¼€å¯ gzip compression</p><ul><li>é»˜è®¤æ˜¯æ˜¯ falseï¼Œå¯ä»¥è®¾ç½®ä¸º true</li></ul></li></ul><h2 id="é…ç½®ç¤ºä¾‹">é…ç½®ç¤ºä¾‹</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">    hot: <span class="literal">true</span>,</span><br><span class="line">    hostOnly:<span class="literal">true</span>,</span><br><span class="line">    host:<span class="string">&quot;0.0.0.0&quot;</span>,</span><br><span class="line">    port:<span class="number">8080</span>,</span><br><span class="line">    open:<span class="literal">true</span>,</span><br><span class="line">    compress:<span class="literal">true</span>,</span><br><span class="line">    proxy:&#123;</span><br><span class="line">        <span class="string">&quot;/api&quot;</span>:&#123;</span><br><span class="line">            target:<span class="string">&quot;http://localhost:8888&quot;</span>,</span><br><span class="line">            pathRewrite:&#123;</span><br><span class="line">                <span class="string">&quot;^/api&quot;</span>:<span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            secure:<span class="literal">false</span>,</span><br><span class="line">            changeOrigin:<span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>Hot Module Replacement</h1><ul><li><p>ä»€ä¹ˆæ˜¯ HMR?</p><ul><li>HMR å…¨ç§° Hot Module Replacementï¼Œç¿»è¯‘ä¸ºæ¨¡å—çƒ­æ›¿æ¢</li><li>æ¨¡å—çƒ­æ›¿æ¢æ˜¯æŒ‡åœ¨åº”ç”¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ›¿æ¢ã€æ·»åŠ ã€åˆ é™¤æ¨¡å—ï¼Œè€Œæ— éœ€é‡æ–°åˆ·æ–°æ•´ä¸ªé¡µé¢ã€‚</li></ul></li><li><p>HMR é€šè¿‡å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼Œæ¥æé«˜å¼€å‘çš„é€Ÿåº¦ã€‚</p><ul><li>ä¸é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ï¼Œè¿™æ ·å¯ä»¥ä¿ç•™æŸäº›åº”ç”¨ç¨‹åºçš„çŠ¶æ€ä¸ä¸¢å¤±ï¼›</li><li>åªéœ€æ›´æ–°éœ€è¦å˜åŒ–çš„å†…å®¹ï¼ŒèŠ‚çœå¼€å‘æ—¶é—´</li><li>ä¿®æ”¹äº† cssã€js æºä»£ç ï¼Œä¼šç«‹å³åœ¨æµè§ˆå™¨æ›´æ–°ï¼Œç›¸å½“äºç›´æ¥åœ¨æµè§ˆå™¨çš„ devtools ä¸­ç›´æ¥ä¿®æ”¹æ ·å¼ã€‚</li></ul></li><li><p>å¦‚ä½•ä½¿ç”¨ HMRï¼Ÿ</p><ul><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œwebpack-dev-server å·²ç»æ”¯æŒ HMRï¼Œåªéœ€è¦å¼€å¯å³å¯ã€‚</li><li>åœ¨ä¸å¼€å¯ HMR çš„æƒ…å†µä¸‹ï¼Œä¿®æ”¹äº†æºä»£ç åï¼Œæ•´ä¸ªé¡µé¢ä¼šè‡ªåŠ¨åˆ·æ–°ï¼Œä½¿ç”¨çš„æ˜¯ live reloadingã€‚</li></ul></li><li><p>å¦‚ä½•å¼€å¯</p><ul><li>ä¿®æ”¹ webpack.config.js</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&#x27;js/bundle.js&#x27;</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">&#x27;build&#x27;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  watch: <span class="literal">true</span>,</span><br><span class="line">  mode: <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    hot: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>æ›´æ–°åè¿˜æ˜¯åˆ·æ–°æ•´ä¸ªæµè§ˆå™¨ï¼Œå› ä¸ºéœ€è¦å®šä¹‰ä½¿ç”¨ HMR çš„æ¨¡å—ã€‚</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">module</span>.hot) &#123;</span><br><span class="line">  <span class="built_in">module</span>.hot.accept(<span class="string">&#x27;./App.vue&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;vueæ›´æ–°äº†&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¡†æ¶çš„-HMR">æ¡†æ¶çš„ HMR</h2><blockquote><p>æœ‰ä¸€ä¸ªé—®é¢˜:åœ¨å¼€å‘å…¶ä»–é¡¹ç›®æ—¶ï¼Œæˆ‘ä»¬æ˜¯å¦éœ€è¦ç»å¸¸æ‰‹åŠ¨å»å†™å…¥ module.hot.accpet ç›¸å…³çš„ API å‘¢?</p></blockquote><ul><li><p>æ¯”å¦‚å¼€å‘ Vueã€React é¡¹ç›®ï¼Œæˆ‘ä»¬ä¿®æ”¹äº†ç»„ä»¶ï¼Œå¸Œæœ›è¿›è¡Œçƒ­æ›´æ–°ï¼Œè¿™ä¸ªæ—¶å€™åº”è¯¥å¦‚ä½•å»æ“ä½œ?</p></li><li><p>ç¤¾åŒºå·²ç»é’ˆå¯¹è¿™äº›æœ‰å¾ˆæˆç†Ÿçš„è§£å†³æ–¹æ¡ˆäº†:</p><ul><li>æ¯”å¦‚ vue å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ vue-loaderï¼Œæ­¤ loader æ”¯æŒ vue ç»„ä»¶çš„ HMRï¼Œæä¾›å¼€ç®±å³ç”¨çš„ä½“éªŒ;</li><li>æ¯”å¦‚ react å¼€å‘ä¸­ï¼Œæœ‰ React Hot Loaderï¼Œå®æ—¶è°ƒæ•´ react ç»„ä»¶(ç›®å‰ React å®˜æ–¹å·²ç»å¼ƒç”¨äº†ï¼Œæ”¹æˆä½¿ç”¨ react- refresh);</li></ul></li></ul><h2 id="Vue-çš„-HMR">Vue çš„ HMR</h2><ul><li><p>Vue çš„åŠ è½½éœ€è¦ vue-loaderï¼Œè€Œ vue-loader åŠ è½½çš„é»˜è®¤ä¼šè¿›è¡Œ HMR å¤„ç†</p></li><li><p>å®‰è£…åŠ è½½ Vue æ‰€éœ€ä¾èµ–</p><ul><li><code>npm install vue-loader vue-template-compiler</code></li></ul></li><li><p>é…ç½® Webpack.config.js</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> VueLoaderPlugin = <span class="built_in">require</span>(<span class="string">&quot;vue-loader/lib/plugin&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">        &#123;</span><br><span class="line">            test: <span class="regexp">/\.vue$/</span>,</span><br><span class="line">            use: [<span class="string">&quot;vue-loader&quot;</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">   ]</span><br><span class="line">&#125;,</span><br><span class="line">plugins:[<span class="keyword">new</span> VueLoaderPlugin()]</span><br></pre></td></tr></table></figure><h2 id="React-çš„-HMR">React çš„ HMR</h2><ul><li><p>åœ¨ä¹‹å‰ï¼ŒReact æ˜¯å€ŸåŠ© React Hot Loader æ¥å®ç° HMRï¼Œç›®å‰å·²ç»æ”¹æˆä½¿ç”¨ react-refesh æ¥å®ç°äº†</p></li><li><p>å®‰è£…ç›¸å…³ä¾èµ–</p><ul><li><code>npm install @pmmmwh/react-refresh-webpack-plugin react-refresh</code></li></ul></li><li><p>webpack.config.js</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> ReactRefreshWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;@pmmmwh/react-refresh-webpack-plugin&quot;</span>)</span><br><span class="line"></span><br><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> ReactRefreshWebpackPlugin(),</span><br><span class="line">],</span><br></pre></td></tr></table></figure><ul><li>babel.config.js</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  presets: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">&#x27;@babel/preset-env&#x27;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        useBuiltIns: <span class="string">&#x27;usage&#x27;</span>,</span><br><span class="line">        corejs: <span class="number">3.8</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    [<span class="string">&#x27;@babel/preset-react&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;@babel/preset-typescript&#x27;</span>],</span><br><span class="line">  ],</span><br><span class="line">  plugins: [[<span class="string">&#x27;react-refresh/babel&#x27;</span>]],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="HMR-çš„åŸç†">HMR çš„åŸç†</h2><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/98219680ad66478c89385a4e0fbaacd8~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210502184548214"></p><ul><li><p>é‚£ä¹ˆ HMR çš„åŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¦‚ä½•å¯ä»¥åšåˆ°åªæ›´æ–°ä¸€ä¸ªæ¨¡å—ä¸­çš„å†…å®¹ï¼Ÿ</p><ul><li>webpack-dev-server ä¼šåˆ›å»ºä¸¤ä¸ªæœåŠ¡ï¼šæä¾›é™æ€èµ„æºçš„æœåŠ¡ï¼ˆexpressï¼‰å’Œ Socketï¼ˆnet.Socketï¼‰</li><li>Express Server è´Ÿè´£ç›´æ¥æä¾›é™æ€èµ„æºæœåŠ¡ï¼ˆæ‰“åŒ…åçš„èµ„æºç›´æ¥è¢«æµè§ˆå™¨è¯·æ±‚å’Œè§£æï¼‰</li></ul></li><li><p>HMR Socket Server æ˜¯ä¸€ä¸ª socket é•¿è¿æ¥</p><ul><li>é•¿è¿æ¥æœ‰ä¸€ä¸ªæœ€å¥½çš„å¥½å¤„æ˜¯å»ºç«‹è¿æ¥ååŒæ–¹å¯ä»¥é€šä¿¡ï¼ˆæœåŠ¡å™¨å¯ä»¥ç›´æ¥å‘é€æ–‡ä»¶åˆ°å®¢æˆ·ç«¯ï¼‰</li><li>å½“æœåŠ¡æœŸé—´å¬åˆ°å¯¹åº”æ¨¡å—å‘ä¸Šå˜åŒ–æ—¶ï¼Œä¼šç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶.jsonï¼ˆmanifest æ–‡ä»¶ï¼‰å’Œ.js æ–‡ä»¶ï¼ˆupdate chunkï¼‰</li><li>é€šè¿‡é•¿è¿æ¥ï¼Œå¯ä»¥ç›´æ¥å°†è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸»åŠ¨å‘é€ç»™å®¢æˆ·ç«¯ã€‚</li><li>æµè§ˆå™¨æ‹¿åˆ°ä¸¤ä¸ªæ–°çš„æ–‡ä»¶åï¼Œé€šè¿‡ HMR runtime æœºåˆ¶ï¼ŒåŠ è½½è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”é’ˆå¯¹ä¿®æ”¹çš„æ¨¡å—è¿›è¡Œæ›´æ–°ã€‚</li></ul><hr/></li></ul><p>[<a href="https://juejin.cn/post/6966422095274180639">æ¢ç´¢]Webpack DevServer å’Œ HMR åŸç† (juejin.cn)</a></p><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼&lt;br/&gt;å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;https://juejin.cn/post/6966422095274180639&quot;&gt;æ¢ç´¢]Webpack DevSe</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Webpack" scheme="https://lebronchao.com/tags/Webpack/"/>
    
    <category term="æ‰“åŒ…æ„å»º" scheme="https://lebronchao.com/tags/%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA/"/>
    
    <category term="å‰ç«¯" scheme="https://lebronchao.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://lebronchao.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="Loader" scheme="https://lebronchao.com/tags/Loader/"/>
    
  </entry>
  
  <entry>
    <title>Webpackæ¨¡å—åŒ–åŸç†å’ŒSourceMap</title>
    <link href="https://lebronchao.com/2021/05/25/Webpack%E6%A8%A1%E5%9D%97%E5%8C%96%E5%8E%9F%E7%90%86%E5%92%8CSourceMap/"/>
    <id>https://lebronchao.com/2021/05/25/Webpack%E6%A8%A1%E5%9D%97%E5%8C%96%E5%8E%9F%E7%90%86%E5%92%8CSourceMap/</id>
    <published>2021-05-25T15:31:43.000Z</published>
    <updated>2021-05-25T15:31:43.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼<br/>å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼<br/><a href="https://juejin.cn/post/6965677810862161950">æ˜é‡‘åŸæ–‡é“¾æ¥</a></p></blockquote><h1>Webpack æ¨¡å—åŒ–</h1><ul><li><p>Webpack æ‰“åŒ…çš„ä»£ç ï¼Œå…è®¸æˆ‘ä»¬ä½¿ç”¨å„ç§å„æ ·çš„æ¨¡å—åŒ–ï¼Œä½†æ˜¯æœ€å¸¸ç”¨çš„æ˜¯ CommonJSã€ES Moduleã€‚</p></li><li><p>åŒ…æ‹¬å¦‚ä¸‹åŸç†:</p><ul><li>CommonJS æ¨¡å—åŒ–å®ç°åŸç†;</li><li>ES Module å®ç°åŸç†;</li><li>CommonJS åŠ è½½ ES Module çš„åŸç†;</li><li>ES Module åŠ è½½ CommonJS çš„åŸç†;</li></ul></li></ul><h2 id="CommonJSï¼š">CommonJSï¼š</h2><h3 id="æ‰“åŒ…å‰">æ‰“åŒ…å‰</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; dateFormat, priceFormat &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./js/format&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(dateFormat(<span class="string">&#x27;abc&#x27;</span>));</span><br><span class="line"><span class="built_in">console</span>.log(priceFormat(<span class="string">&#x27;abc&#x27;</span>));</span><br></pre></td></tr></table></figure><h3 id="æ‰“åŒ…å">æ‰“åŒ…å</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="comment">// æ¨¡å—çš„è·¯å¾„(key): å‡½æ•°(value)</span></span><br><span class="line"><span class="keyword">var</span> __webpack_modules__ = &#123;</span><br><span class="line">  <span class="string">&#x27;./src/js/format.js&#x27;</span>: <span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">module</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> dateFormat = <span class="function">(<span class="params">date</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;2020-12-12&#x27;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> priceFormat = <span class="function">(<span class="params">price</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;100.00&#x27;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†æˆ‘ä»¬è¦å¯¼å‡ºçš„å˜é‡, æ”¾å…¥åˆ°moduleå¯¹è±¡ä¸­çš„exportså¯¹è±¡</span></span><br><span class="line">    <span class="built_in">module</span>.exports = &#123;</span><br><span class="line">      dateFormat,</span><br><span class="line">      priceFormat,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªå¯¹è±¡, ä½œä¸ºåŠ è½½æ¨¡å—çš„ç¼“å­˜</span></span><br><span class="line"><span class="keyword">var</span> __webpack_module_cache__ = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜¯ä¸€ä¸ªå‡½æ•°, å½“æˆ‘ä»¬åŠ è½½ä¸€ä¸ªæ¨¡å—æ—¶, éƒ½ä¼šé€šè¿‡è¿™ä¸ªå‡½æ•°æ¥åŠ è½½</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 1.åˆ¤æ–­ç¼“å­˜ä¸­æ˜¯å¦å·²ç»åŠ è½½è¿‡</span></span><br><span class="line">  <span class="keyword">if</span> (__webpack_module_cache__[moduleId]) &#123;</span><br><span class="line">    <span class="keyword">return</span> __webpack_module_cache__[moduleId].exports;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2.ç»™moduleå˜é‡å’Œ__webpack_module_cache__[moduleId]èµ‹å€¼äº†åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">module</span> = (__webpack_module_cache__[moduleId] = &#123; <span class="attr">exports</span>: &#123;&#125; &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3.åŠ è½½æ‰§è¡Œæ¨¡å—</span></span><br><span class="line">  __webpack_modules__[moduleId](<span class="built_in">module</span>, <span class="built_in">module</span>.exports, __webpack_require__);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4.å¯¼å‡ºmodule.exports &#123;dateFormat: function, priceForamt: function&#125;</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…·ä½“å¼€å§‹æ‰§è¡Œä»£ç é€»è¾‘</span></span><br><span class="line">!(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 1.åŠ è½½./src/js/format.js</span></span><br><span class="line">  <span class="keyword">const</span> &#123; dateFormat, priceFormat &#125; = __webpack_require__(<span class="string">&#x27;./src/js/format.js&#x27;</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(dateFormat(<span class="string">&#x27;abc&#x27;</span>));</span><br><span class="line">  <span class="built_in">console</span>.log(priceFormat(<span class="string">&#x27;abc&#x27;</span>));</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h2 id="ES-Module">ES Module</h2><h3 id="æ‰“åŒ…å‰-2">æ‰“åŒ…å‰</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; sum, mul &#125; <span class="keyword">from</span> <span class="string">&#x27;./js/math&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(mul(<span class="number">20</span>, <span class="number">30</span>));</span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">20</span>, <span class="number">30</span>));</span><br></pre></td></tr></table></figure><h3 id="æ‰“åŒ…å-2">æ‰“åŒ…å</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡, å¯¹è±¡é‡Œé¢æ”¾çš„æ˜¯æˆ‘ä»¬çš„æ¨¡å—æ˜ å°„</span></span><br><span class="line"><span class="keyword">var</span> __webpack_modules__ = &#123;</span><br><span class="line">  <span class="string">&#x27;./src/es_index.js&#x27;</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    __unused_webpack_module,</span></span></span><br><span class="line"><span class="function"><span class="params">    __webpack_exports__,</span></span></span><br><span class="line"><span class="function"><span class="params">    __webpack_require__</span></span></span><br><span class="line"><span class="function"><span class="params">  </span>) </span>&#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨rçš„ç›®çš„æ˜¯è®°å½•æ—¶ä¸€ä¸ª__esModule -&gt; true</span></span><br><span class="line">    __webpack_require__.r(__webpack_exports__);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// _js_math__WEBPACK_IMPORTED_MODULE_0__ == exports</span></span><br><span class="line">    <span class="keyword">var</span> _js_math__WEBPACK_IMPORTED_MODULE_0__ =</span><br><span class="line">      __webpack_require__(<span class="string">&#x27;./src/js/math.js&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(_js_math__WEBPACK_IMPORTED_MODULE_0__.mul(<span class="number">20</span>, <span class="number">30</span>));</span><br><span class="line">    <span class="built_in">console</span>.log(_js_math__WEBPACK_IMPORTED_MODULE_0__.sum(<span class="number">20</span>, <span class="number">30</span>));</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&#x27;./src/js/math.js&#x27;</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    __unused_webpack_module,</span></span></span><br><span class="line"><span class="function"><span class="params">    __webpack_exports__,</span></span></span><br><span class="line"><span class="function"><span class="params">    __webpack_require__</span></span></span><br><span class="line"><span class="function"><span class="params">  </span>) </span>&#123;</span><br><span class="line">    __webpack_require__.r(__webpack_exports__);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨äº†då‡½æ•°: ç»™exportsè®¾ç½®äº†ä¸€ä¸ªä»£ç†definition</span></span><br><span class="line">    <span class="comment">// exportså¯¹è±¡ä¸­æœ¬èº«æ˜¯æ²¡æœ‰å¯¹åº”çš„å‡½æ•°</span></span><br><span class="line">    __webpack_require__.d(__webpack_exports__, &#123;</span><br><span class="line">      sum: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">      &#125;,</span><br><span class="line">      mul: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mul;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> sum = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> num1 + num2;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> mul = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> num1 * num2;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.æ¨¡å—çš„ç¼“å­˜</span></span><br><span class="line"><span class="keyword">var</span> __webpack_module_cache__ = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.requireå‡½æ•°çš„å®ç°(åŠ è½½æ¨¡å—)</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (__webpack_module_cache__[moduleId]) &#123;</span><br><span class="line">    <span class="keyword">return</span> __webpack_module_cache__[moduleId].exports;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">module</span> = (__webpack_module_cache__[moduleId] = &#123;</span><br><span class="line">    <span class="built_in">exports</span>: &#123;&#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">  __webpack_modules__[moduleId](<span class="built_in">module</span>, <span class="built_in">module</span>.exports, __webpack_require__);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">!(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// __webpack_require__è¿™ä¸ªå‡½æ•°å¯¹è±¡æ·»åŠ äº†ä¸€ä¸ªå±æ€§: d -&gt; å€¼function</span></span><br><span class="line">  __webpack_require__.d = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">exports</span>, definition</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> definition) &#123;</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        __webpack_require__.o(definition, key) &amp;&amp;</span><br><span class="line">        !__webpack_require__.o(<span class="built_in">exports</span>, key)</span><br><span class="line">      ) &#123;</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(<span class="built_in">exports</span>, key, &#123;</span><br><span class="line">          enumerable: <span class="literal">true</span>,</span><br><span class="line">          get: definition[key],</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">!(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// __webpack_require__è¿™ä¸ªå‡½æ•°å¯¹è±¡æ·»åŠ äº†ä¸€ä¸ªå±æ€§: o -&gt; å€¼function</span></span><br><span class="line">  __webpack_require__.o = <span class="function"><span class="keyword">function</span> (<span class="params">obj, prop</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.hasOwnProperty.call(obj, prop);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">!(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// __webpack_require__è¿™ä¸ªå‡½æ•°å¯¹è±¡æ·»åŠ äº†ä¸€ä¸ªå±æ€§: r -&gt; å€¼function</span></span><br><span class="line">  __webpack_require__.r = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">exports</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Symbol</span> !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag) &#123;</span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(<span class="built_in">exports</span>, <span class="built_in">Symbol</span>.toStringTag, &#123; <span class="attr">value</span>: <span class="string">&#x27;Module&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(<span class="built_in">exports</span>, <span class="string">&#x27;__esModule&#x27;</span>, &#123; <span class="attr">value</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">__webpack_require__(<span class="string">&#x27;./src/es_index.js&#x27;</span>);</span><br></pre></td></tr></table></figure><h2 id="ES-Module-å’Œ-CommonJS-æ··åˆå¯¼å…¥å¯¼å‡º">ES Module å’Œ CommonJS æ··åˆå¯¼å…¥å¯¼å‡º</h2><h3 id="æ‰“åŒ…å‰-3">æ‰“åŒ…å‰</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// es moduleå¯¼å‡ºå†…å®¹, CommonJSå¯¼å…¥å†…å®¹</span></span><br><span class="line"><span class="keyword">const</span> &#123; sum, mul &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./js/math&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// CommonJSå¯¼å‡ºå†…å®¹, es moduleå¯¼å…¥å†…å®¹</span></span><br><span class="line"><span class="keyword">import</span> &#123; dateFormat, priceFormat &#125; <span class="keyword">from</span> <span class="string">&#x27;./js/format&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">20</span>, <span class="number">30</span>));</span><br><span class="line"><span class="built_in">console</span>.log(mul(<span class="number">20</span>, <span class="number">30</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(dateFormat(<span class="string">&#x27;aaa&#x27;</span>));</span><br><span class="line"><span class="built_in">console</span>.log(priceFormat(<span class="string">&#x27;bbb&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(abc);</span><br></pre></td></tr></table></figure><h3 id="æ‰“åŒ…å-3">æ‰“åŒ…å</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> __webpack_modules__ = &#123;</span><br><span class="line">  <span class="string">&#x27;./src/index.js&#x27;</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    __unused_webpack_module,</span></span></span><br><span class="line"><span class="function"><span class="params">    __webpack_exports__,</span></span></span><br><span class="line"><span class="function"><span class="params">    __webpack_require__</span></span></span><br><span class="line"><span class="function"><span class="params">  </span>) </span>&#123;</span><br><span class="line"><span class="meta">    &#x27;use strict&#x27;</span>;</span><br><span class="line">    __webpack_require__.r(__webpack_exports__);</span><br><span class="line">    <span class="keyword">var</span> _js_format__WEBPACK_IMPORTED_MODULE_0__ =</span><br><span class="line">      __webpack_require__(<span class="string">&#x27;./src/js/format.js&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> _js_format__WEBPACK_IMPORTED_MODULE_0___default = __webpack_require__.n(</span><br><span class="line">      _js_format__WEBPACK_IMPORTED_MODULE_0__</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// es moduleå¯¼å‡ºå†…å®¹, CommonJSå¯¼å…¥å†…å®¹</span></span><br><span class="line">    <span class="keyword">const</span> math = __webpack_require__(<span class="string">&#x27;./src/js/math.js&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// CommonJSå¯¼å‡ºå†…å®¹, es moduleå¯¼å…¥å†…å®¹</span></span><br><span class="line">    <span class="built_in">console</span>.log(math.sum(<span class="number">20</span>, <span class="number">30</span>));</span><br><span class="line">    <span class="built_in">console</span>.log(math.mul(<span class="number">20</span>, <span class="number">30</span>));</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      _js_format__WEBPACK_IMPORTED_MODULE_0___default().dateFormat(<span class="string">&#x27;aaa&#x27;</span>)</span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      _js_format__WEBPACK_IMPORTED_MODULE_0___default().priceFormat(<span class="string">&#x27;bbb&#x27;</span>)</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&#x27;./src/js/format.js&#x27;</span>: <span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">module</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> dateFormat = <span class="function">(<span class="params">date</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;2020-12-12&#x27;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> priceFormat = <span class="function">(<span class="params">price</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;100.00&#x27;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">module</span>.exports = &#123;</span><br><span class="line">      dateFormat,</span><br><span class="line">      priceFormat,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="string">&#x27;./src/js/math.js&#x27;</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    __unused_webpack_module,</span></span></span><br><span class="line"><span class="function"><span class="params">    __webpack_exports__,</span></span></span><br><span class="line"><span class="function"><span class="params">    __webpack_require__</span></span></span><br><span class="line"><span class="function"><span class="params">  </span>) </span>&#123;</span><br><span class="line">    __webpack_require__.r(__webpack_exports__);</span><br><span class="line">    __webpack_require__.d(__webpack_exports__, &#123;</span><br><span class="line">      sum: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">      &#125;,</span><br><span class="line">      mul: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mul;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">const</span> sum = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> num1 + num2;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> mul = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> num1 * num2;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> __webpack_module_cache__ = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The require function</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Check if module is in cache</span></span><br><span class="line">  <span class="keyword">if</span> (__webpack_module_cache__[moduleId]) &#123;</span><br><span class="line">    <span class="keyword">return</span> __webpack_module_cache__[moduleId].exports;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Create a new module (and put it into the cache)</span></span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">module</span> = (__webpack_module_cache__[moduleId] = &#123;</span><br><span class="line">    <span class="comment">// no module.id needed</span></span><br><span class="line">    <span class="comment">// no module.loaded needed</span></span><br><span class="line">    <span class="built_in">exports</span>: &#123;&#125;,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Execute the module function</span></span><br><span class="line">  __webpack_modules__[moduleId](<span class="built_in">module</span>, <span class="built_in">module</span>.exports, __webpack_require__);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Return the exports of the module</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">!(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// getDefaultExport function for compatibility with non-harmony modules</span></span><br><span class="line">  __webpack_require__.n = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">module</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> getter =</span><br><span class="line">      <span class="built_in">module</span> &amp;&amp; <span class="built_in">module</span>.__esModule</span><br><span class="line">        ? <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">module</span>[<span class="string">&#x27;default&#x27;</span>];</span><br><span class="line">          &#125;</span><br><span class="line">        : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">module</span>;</span><br><span class="line">          &#125;;</span><br><span class="line">    __webpack_require__.d(getter, &#123; <span class="attr">a</span>: getter &#125;);</span><br><span class="line">    <span class="keyword">return</span> getter;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* webpack/runtime/define property getters */</span></span><br><span class="line">!(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// define getter functions for harmony exports</span></span><br><span class="line">  __webpack_require__.d = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">exports</span>, definition</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> definition) &#123;</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        __webpack_require__.o(definition, key) &amp;&amp;</span><br><span class="line">        !__webpack_require__.o(<span class="built_in">exports</span>, key)</span><br><span class="line">      ) &#123;</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(<span class="built_in">exports</span>, key, &#123;</span><br><span class="line">          enumerable: <span class="literal">true</span>,</span><br><span class="line">          get: definition[key],</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* webpack/runtime/hasOwnProperty shorthand */</span></span><br><span class="line">!(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  __webpack_require__.o = <span class="function"><span class="keyword">function</span> (<span class="params">obj, prop</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.hasOwnProperty.call(obj, prop);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* webpack/runtime/make namespace object */</span></span><br><span class="line">!(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// define __esModule on exports</span></span><br><span class="line">  __webpack_require__.r = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">exports</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Symbol</span> !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag) &#123;</span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(<span class="built_in">exports</span>, <span class="built_in">Symbol</span>.toStringTag, &#123; <span class="attr">value</span>: <span class="string">&#x27;Module&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(<span class="built_in">exports</span>, <span class="string">&#x27;__esModule&#x27;</span>, &#123; <span class="attr">value</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">__webpack_require__(<span class="string">&#x27;./src/index.js&#x27;</span>);</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><blockquote><p>åŸç†éƒ½æ˜¯ç±»ä¼¼çš„</p></blockquote><ol><li>é€šè¿‡ä¸€ä¸ª webpack_module å¯¹è±¡æ¥å­˜å‚¨æ¨¡å—åŒ–ä»£ç <ul><li>key ä¸ºæ–‡ä»¶åç§°</li><li>value ä¸ºæ–‡ä»¶ä»£ç </li></ul></li><li>é€šè¿‡ webpack_module_cache æ¥ç¼“å­˜æ¨¡å—åŒ–ä»£ç </li><li>é€šè¿‡ webpack_require æ¥ä» webpack_module_cache æˆ– webpack_module ä¸­è¯»å–å¹¶ä»å¼•å…¥ä»£ç </li></ol><h2 id="è®¤è¯†-Source-Map">è®¤è¯† Source-Map</h2><blockquote><p><a href="https://developer.mozilla.org/en-US/docs/Mozilla/JavaScript_code_modules/SourceMap.jsm">å‚è€ƒæ–‡æ¡£ </a></p></blockquote><ul><li><p>æˆ‘ä»¬çš„ä»£ç é€šå¸¸è¿è¡Œåœ¨æµè§ˆå™¨ä¸Šæ—¶ï¼Œæ˜¯é€šè¿‡æ‰“åŒ…å‹ç¼©çš„:</p><ul><li>ä¹Ÿå°±æ˜¯çœŸå®è·‘åœ¨æµè§ˆå™¨ä¸Šçš„ä»£ç ï¼Œå’Œæˆ‘ä»¬ç¼–å†™çš„ä»£ç å…¶å®æ˜¯æœ‰å·®å¼‚çš„;</li><li>æ¯”å¦‚ ES6 çš„ä»£ç å¯èƒ½è¢«è½¬æ¢æˆ ES5;</li><li>æ¯”å¦‚å¯¹åº”çš„ä»£ç è¡Œå·ã€åˆ—å·åœ¨ç»è¿‡ç¼–è¯‘åè‚¯å®šä¼šä¸ä¸€è‡´;</li><li>æ¯”å¦‚ä»£ç è¿›è¡Œä¸‘åŒ–å‹ç¼©æ—¶ï¼Œä¼šå°†ç¼–ç åç§°ç­‰ä¿®æ”¹;</li><li>æ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨äº† TypeScript ç­‰æ–¹å¼ç¼–å†™çš„ä»£ç ï¼Œæœ€ç»ˆè½¬æ¢æˆ JavaScript;</li></ul></li><li><p>é€šè¿‡ SourceMap å¯ä»¥è°ƒè¯•è¿™ç§è½¬æ¢åä¸ä¸€è‡´çš„ä»£ç </p><ul><li>source-map æ˜¯ä»å·²è½¬æ¢çš„ä»£ç ï¼Œæ˜ å°„åˆ°åŸå§‹çš„æºæ–‡ä»¶;</li><li>ä½¿æµè§ˆå™¨å¯ä»¥é‡æ„åŸå§‹æºå¹¶åœ¨è°ƒè¯•å™¨ä¸­æ˜¾ç¤ºé‡å»ºçš„åŸå§‹æº;</li><li>æ›´å®¹æ˜“å®šä½åˆ°æºæ–‡ä»¶é”™è¯¯</li></ul></li></ul><h3 id="å¦‚ä½•ä½¿ç”¨-SourceMap">å¦‚ä½•ä½¿ç”¨ SourceMap</h3><ul><li><p>ç¬¬ä¸€æ­¥:æ ¹æ®æºæ–‡ä»¶ï¼Œç”Ÿæˆ source-map æ–‡ä»¶ï¼Œwebpack åœ¨æ‰“åŒ…æ—¶ï¼Œå¯ä»¥é€šè¿‡é…ç½®ç”Ÿæˆ source-map;</p><p><code>devtool:'source-map'</code></p></li><li><p>ç¬¬äºŒæ­¥:åœ¨è½¬æ¢åçš„ä»£ç ï¼Œæœ€åæ·»åŠ ä¸€ä¸ªæ³¨é‡Šï¼Œå®ƒæŒ‡å‘ sourcemap;</p><p><code>//# sourceMappingURL=common.bundle.js.map</code></p></li><li><p>æµè§ˆå™¨ä¼šæ ¹æ®æˆ‘ä»¬çš„æ³¨é‡Šï¼ŒæŸ¥æ‰¾ç›¸åº”çš„ source-mapï¼Œå¹¶ä¸”æ ¹æ® source-map è¿˜åŸæˆ‘ä»¬çš„ä»£ç ï¼Œæ–¹ä¾¿è¿›è¡Œè°ƒè¯•ã€‚</p></li><li><p>åœ¨ Chrome ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§å¦‚ä¸‹çš„æ–¹å¼æ‰“å¼€ source-map:</p><ul><li>âˆšEnable JavaScript source maps</li><li>âˆšEnable CSS source maps</li></ul></li><li><p>æœ€åˆ source-map ç”Ÿæˆçš„æ–‡ä»¶å¸¦ä¸‹æ˜¯åŸå§‹æ–‡ä»¶çš„ 10 å€ï¼Œç¬¬äºŒç‰ˆå‡å°‘äº†çº¦ 50%ï¼Œç¬¬ä¸‰ç‰ˆåˆå‡å°‘äº† 50%ï¼Œæ‰€ä»¥ç›®å‰ä¸€ä¸ª 133kb çš„æ–‡ä»¶ï¼Œæœ€ç»ˆçš„ source-map çš„å¤§å°å¤§æ¦‚åœ¨ 300kbã€‚</p></li><li><p>ç›®å‰çš„ source-map é•¿ä»€ä¹ˆæ ·å­ï¼Ÿ</p><ul><li>version:å½“å‰ä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯æœ€æ–°çš„ç¬¬ä¸‰ç‰ˆ;</li><li>sources:ä»å“ªäº›æ–‡ä»¶è½¬æ¢è¿‡æ¥çš„ source-map å’Œæ‰“åŒ…çš„ä»£ç (æœ€åˆå§‹çš„æ–‡ä»¶);</li><li>names:è½¬æ¢å‰çš„å˜é‡å’Œå±æ€§åç§°(å› ä¸ºç›®å‰ä½¿ç”¨çš„æ˜¯ development æ¨¡å¼ï¼Œæ‰€ä»¥ä¸éœ€è¦ä¿ç•™è½¬æ¢å‰çš„åç§°);</li><li>mappings:source-map ç”¨æ¥å’Œæºæ–‡ä»¶æ˜ å°„çš„ä¿¡æ¯(æ¯”å¦‚ä½ç½®ä¿¡æ¯ç­‰)ï¼Œä¸€ä¸² base64 VLQ(veriable- length quantity å¯å˜é•¿åº¦å€¼)ç¼–ç ;</li><li>file:æ‰“åŒ…åçš„æ–‡ä»¶(æµè§ˆå™¨åŠ è½½çš„æ–‡ä»¶);</li><li>sourceContent:è½¬æ¢å‰çš„å…·ä½“ä»£ç ä¿¡æ¯(å’Œ sources æ˜¯å¯¹åº”çš„å…³ç³»);</li><li>sourceRoot:æ‰€æœ‰çš„ sources ç›¸å¯¹çš„æ ¹ç›®å½•;</li></ul></li></ul><h3 id="ç”Ÿæˆ-SourceMap">ç”Ÿæˆ SourceMap</h3><blockquote><p>å¦‚ä½•åœ¨ä½¿ç”¨ webpack æ‰“åŒ…çš„æ—¶å€™ï¼Œç”Ÿæˆå¯¹åº”çš„ source-map?</p></blockquote><ul><li><p>webpack ä¸ºæˆ‘ä»¬æä¾›äº†éå¸¸å¤šçš„é€‰é¡¹(ç›®å‰æ˜¯ 26 ä¸ª)ï¼Œæ¥å¤„ç† source-map;</p></li><li><p>å‚è€ƒæ–‡æ¡£ï¼š<a href="https://webpack.docschina.org/configuration/devtool/">https://webpack.docschina.org/configuration/devtool/</a></p></li><li><p>é€‰æ‹©ä¸åŒçš„å€¼ï¼Œç”Ÿæˆçš„ source-map ä¼šç¨å¾®æœ‰å·®å¼‚ï¼Œæ‰“åŒ…çš„è¿‡ç¨‹ä¹Ÿä¼šæœ‰æ€§èƒ½çš„å·®å¼‚ï¼Œå¯ä»¥æ ¹æ®ä¸åŒçš„æƒ…å†µè¿›è¡Œ é€‰æ‹©;</p></li></ul><blockquote><p>ä¸‹é¢å‡ ä¸ªå€¼ä¸ä¼šç”Ÿæˆ source-map</p></blockquote><ul><li><p>false:ä¸ä½¿ç”¨ source-mapï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ä»»ä½•å’Œ source-map ç›¸å…³çš„å†…å®¹ã€‚</p></li><li><p>none:production æ¨¡å¼ä¸‹çš„é»˜è®¤å€¼ï¼ˆä»€ä¹ˆå€¼éƒ½ä¸å†™ï¼‰ï¼Œä¸ç”Ÿæˆ source-mapã€‚</p></li><li><p>eval:development æ¨¡å¼ä¸‹çš„é»˜è®¤å€¼ï¼Œä¸ç”Ÿæˆ source-map</p><ul><li>ä½†æ˜¯å®ƒä¼šåœ¨ eval æ‰§è¡Œçš„ä»£ç ä¸­ï¼Œæ·»åŠ  //# sourceURL=;</li><li>å®ƒä¼šè¢«æµè§ˆå™¨åœ¨æ‰§è¡Œæ—¶è§£æï¼Œå¹¶ä¸”åœ¨è°ƒè¯•é¢æ¿ä¸­ç”Ÿæˆå¯¹åº”çš„ä¸€äº›æ–‡ä»¶ç›®å½•ï¼Œæ–¹ä¾¿æˆ‘ä»¬è°ƒè¯•ä»£ç ;</li></ul></li></ul><blockquote><p>ä½¿ç”¨ source-map çš„å€¼</p></blockquote><ul><li><p>source-map</p><ul><li>ç”Ÿæˆç‹¬ç«‹çš„ source-map æ–‡ä»¶ï¼Œå¹¶åœ¨æ‰“åŒ…åçš„ JS æ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªæ³¨é‡ŠæŒ‡å‘ source-map æ–‡ä»¶ï¼›<ul><li>æ³¨é‡Šï¼š `` //# sourceMappingURL=bundle.js.map`</li></ul></li></ul></li><li><p>eval-source-map</p><ul><li>source-map ä»¥ DataUrl çš„å½¢å¼æ·»åŠ åˆ° eval å‡½æ•°åé¢</li></ul></li><li><p>inline-source-map</p><ul><li>source-map ä»¥ DataUrl çš„å½¢å¼æ·»åŠ åˆ°æ‰“åŒ…åçš„ JS æ–‡ä»¶åé¢ï¼ˆæ³¨é‡Šï¼‰</li></ul></li><li><p>cheap-source-map:</p><ul><li>ä¼šç”Ÿæˆ source-mapï¼Œä½†æ˜¯ä¼šæ›´åŠ é«˜æ•ˆä¸€äº›(cheap ä½å¼€é”€)ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ç”Ÿæˆåˆ—æ˜ å°„(Column Mapping)</li><li>å› ä¸ºåœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦è¡Œä¿¡æ¯é€šå¸¸å°±å¯ä»¥å®šä½åˆ°é”™è¯¯äº†</li></ul></li><li><p>cheap-module-source-map:</p><ul><li>ä¼šç”Ÿæˆ source-mapï¼Œç±»ä¼¼äº cheap-source-mapï¼Œä½†æ˜¯å¯¹æºè‡ª loader çš„ source-map å¤„ç†ä¼šæ›´å¥½ã€‚</li><li>å¯¹æºè‡ª loader çš„ source-map å¤„ç†ä¼šæ›´å¥½ï¼Œå®˜æ–¹ä¹Ÿæ²¡æœ‰ç»™å‡ºå¾ˆå¥½çš„è§£é‡Š å…¶å®æ˜¯å¦‚æœ loader å¯¹æˆ‘ä»¬çš„æºç è¿›è¡Œäº†ç‰¹æ®Šçš„å¤„ç†ï¼Œæ¯”å¦‚ babel,ä¼šæ¢å¤æˆæºæ–‡ä»¶çš„ä»£ç æ¨¡å—æ ¼å¼ï¼Œä¾‹å¦‚ä¸ä¼šåˆ é™¤è‡ªå®šä¹‰çš„ç©ºè¡Œã€‚</li></ul></li><li><p>hidden-source-map:</p><ul><li>ä¼šç”Ÿæˆ sourcemapï¼Œä½†æ˜¯ä¸ä¼šå¯¹ source-map æ–‡ä»¶è¿›è¡Œå¼•ç”¨;</li><li>ç›¸å½“äºåˆ é™¤äº†æ‰“åŒ…æ–‡ä»¶ä¸­å¯¹ sourcemap çš„å¼•ç”¨æ³¨é‡Š</li><li># sourceMappingURL=bundle.js.map</li><li>å¦‚æœæ‰‹åŠ¨æ·»åŠ è¿›æ¥ï¼Œé‚£ä¹ˆ source-map å°±ä¼šç”Ÿæ•ˆäº†</li></ul></li><li><p>nosources-source-map:</p><ul><li>ä¼šç”Ÿæˆ sourcemapï¼Œä½†æ˜¯ç”Ÿæˆçš„ sourcemap åªæœ‰é”™è¯¯ä¿¡æ¯çš„æç¤ºï¼Œä¸ä¼šç”Ÿæˆæºä»£ç æ–‡ä»¶;</li><li>ç‚¹å‡»é”™è¯¯ä¿¡æ¯ä¹Ÿæ— æ³•æŸ¥çœ‹æºç </li></ul></li></ul><blockquote><p>å¤šä¸ªå€¼çš„ç»„åˆ</p></blockquote><ul><li><p>äº‹å®ä¸Šï¼Œwebpack æä¾›ç»™æˆ‘ä»¬çš„ 26 ä¸ªå€¼ï¼Œæ˜¯å¯ä»¥è¿›è¡Œå¤šç»„åˆçš„ã€‚</p></li><li><p>ç»„åˆçš„è§„åˆ™å¦‚ä¸‹:</p></li><li><p>inline-|hidden-|eval:ä¸‰ä¸ªå€¼æ—¶ä¸‰é€‰ä¸€;</p></li><li><p>nosources:å¯é€‰å€¼;</p></li><li><p>cheap å¯é€‰å€¼ï¼Œå¹¶ä¸”å¯ä»¥è·Ÿéš module çš„å€¼;</p></li></ul><blockquote><p>é‚£ä¹ˆåœ¨å¼€å‘ä¸­ï¼Œæœ€ä½³çš„å®è·µæ˜¯ä»€ä¹ˆå‘¢?</p></blockquote><ul><li><p>å¼€å‘é˜¶æ®µ:æ¨èä½¿ç”¨ source-map æˆ–è€… cheap-module-source-map</p><ul><li>è¿™åˆ†åˆ«æ˜¯ vue å’Œ react ä½¿ç”¨çš„å€¼ï¼Œå¯ä»¥è·å–è°ƒè¯•ä¿¡æ¯ï¼Œæ–¹ä¾¿å¿«é€Ÿå¼€å‘;</li></ul></li><li><p>æµ‹è¯•é˜¶æ®µ:æ¨èä½¿ç”¨ source-map æˆ–è€… cheap-module-source-map</p><ul><li>æµ‹è¯•é˜¶æ®µæˆ‘ä»¬ä¹Ÿå¸Œæœ›åœ¨æµè§ˆå™¨ä¸‹çœ‹åˆ°æ­£ç¡®çš„é”™è¯¯æç¤º;</li></ul></li><li><p>å‘å¸ƒé˜¶æ®µ:falseã€ç¼ºçœå€¼(ä¸å†™)</p></li></ul><hr/><p><a href="https://juejin.cn/post/6965677810862161950">æ˜é‡‘åŸæ–‡é“¾æ¥</a></p><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯ LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯ LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å· ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://lebronchao-1304295623.cos.ap-guangzhou.myqcloud.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼&lt;br/&gt;å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼&lt;br/&gt;&lt;a href=&quot;https://juejin.cn/post/6965677810862161950&quot;&gt;æ˜é‡‘åŸæ–‡é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;/blo</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Webpack" scheme="https://lebronchao.com/tags/Webpack/"/>
    
    <category term="æ‰“åŒ…æ„å»º" scheme="https://lebronchao.com/tags/%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA/"/>
    
    <category term="å‰ç«¯" scheme="https://lebronchao.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://lebronchao.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="Loader" scheme="https://lebronchao.com/tags/Loader/"/>
    
  </entry>
  
</feed>
