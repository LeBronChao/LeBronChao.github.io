<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>LeBronChao&#39;s Blog</title>
  
  
  <link href="https://lebronchao.com/atom.xml" rel="self"/>
  
  <link href="https://lebronchao.com/"/>
  <updated>2021-08-01T16:11:46.000Z</updated>
  <id>https://lebronchao.com/</id>
  
  <author>
    <name>LeBronChao-</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>[æ·±å…¥æµ…å‡ºLB]æ‰‹æŠŠæ‰‹å¸¦ä½ å®ç°ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨</title>
    <link href="https://lebronchao.com/2021/08/02/LoadBalance%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
    <id>https://lebronchao.com/2021/08/02/LoadBalance%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/</id>
    <published>2021-08-01T16:11:46.000Z</published>
    <updated>2021-08-01T16:11:46.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Load Balanceè´Ÿè½½å‡è¡¡ ğŸŒ¡</h1><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/(null)-20210622002849831.(null)" alt="img"></p><blockquote><p>ç®€ä»‹</p></blockquote><p>è´Ÿè½½å‡è¡¡ï¼Œå«ä¹‰å°±æ˜¯æ ¹æ®ä¸€å®šç®—æ³•å°†è´Ÿè½½ï¼ˆå·¥ä½œä»»åŠ¡ï¼‰è¿›è¡Œå¹³è¡¡ï¼Œåˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šè¿è¡Œã€æ‰§è¡Œï¼Œå¸¸è§çš„ä¸ºWebæœåŠ¡å™¨ã€ä¼ä¸šæ ¸å¿ƒåº”ç”¨æœåŠ¡å™¨å’Œå…¶ä»–ä¸»è¦ä»»åŠ¡æœåŠ¡å™¨ç­‰ï¼Œä»è€ŒååŒå®Œæˆå·¥ä½œä»»åŠ¡ã€‚è´Ÿè½½å‡è¡¡åœ¨åŸæœ‰çš„ç½‘ç»œç»“æ„ä¸Šæä¾›äº†ä¸€ç§é€æ˜ä¸”æœ‰æ•ˆçš„çš„æ–¹æ³•æ‰©å±•æœåŠ¡å™¨å’Œç½‘ç»œè®¾å¤‡çš„å¸¦å®½ã€åŠ å¼ºç½‘ç»œæ•°æ®å¤„ç†èƒ½åŠ›ã€å¢åŠ ååé‡ã€æé«˜ç½‘ç»œçš„å¯ç”¨æ€§å’Œçµæ´»æ€§ï¼ŒåŒæ—¶æ‰¿å—ä½æ›´å¤§çš„å¹¶å‘é‡çº§ã€‚</p><blockquote><p>ç®€å•æ¥è¯´å°±æ˜¯å°†å¤§é‡çš„å¹¶å‘è¯·æ±‚å¤„ç†è½¬å‘ç»™å¤šä¸ªåç«¯èŠ‚ç‚¹å¤„ç†ï¼Œå‡å°‘å·¥ä½œå“åº”æ—¶é—´ã€‚</p></blockquote><ul><li><p>é¿å…èµ„æºæµªè´¹</p></li><li><p>é¿å…æœåŠ¡ä¸å¯ç”¨</p></li></ul><h1>ä¸€ã€åˆ†ç±»</h1><h2 id="å››å±‚ï¼ˆä¼ è¾“å±‚ï¼‰">å››å±‚ï¼ˆä¼ è¾“å±‚ï¼‰</h2><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/image-20210622002908874.png" alt="image-20210622002908874"></p><p>å››å±‚å³OSIä¸ƒå±‚æ¨¡å‹ä¸­çš„ä¼ è¾“å±‚ï¼Œæœ‰TCPã€UDPåè®®ï¼Œè¿™ä¸¤ç§åè®®ä¸­åŒ…å«æºIPã€ç›®æ ‡IPä»¥å¤–ï¼Œè¿˜åŒ…å«æºç«¯å£å·åŠç›®æ ‡ç«¯å£å·ã€‚å››å±‚è´Ÿè½½å‡è¡¡åœ¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚åï¼Œé€šè¿‡ä¿®æ”¹æŠ¥æ–‡çš„åœ°å€ä¿¡æ¯ï¼ˆIP + PORTï¼‰å°†æµé‡è½¬å‘åˆ°åº”ç”¨æœåŠ¡å™¨ã€‚</p><h2 id="ä¸ƒå±‚ï¼ˆåº”ç”¨å±‚ï¼‰">ä¸ƒå±‚ï¼ˆåº”ç”¨å±‚ï¼‰</h2><blockquote><p>ä»£ç†è´Ÿè½½å‡è¡¡</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/image-20210622002927473.png" alt="image-20210622002927473"></p><p>ä¸ƒå±‚å³OSIä¸ƒå±‚æ¨¡å‹ä¸­çš„åº”ç”¨å±‚ï¼Œåº”ç”¨å±‚åè®®è¾ƒå¤šï¼Œå¸¸ç”¨çš„ä¸ºHTTP/HTTPSã€‚ä¸ƒå±‚è´Ÿè½½å‡è¡¡å¯ä»¥ç»™äºˆè¿™äº›åè®®æ¥è´Ÿè½½ã€‚è¿™äº›åº”ç”¨å±‚åè®®ä¸­ä¼šåŒ…å«å¾ˆå¤šæœ‰æ„ä¹‰çš„å†…å®¹ã€‚æ¯”å¦‚åŒä¸€ä¸ªWebæœåŠ¡å™¨çš„è´Ÿè½½å‡è¡¡ï¼Œé™¤äº†æ ¹æ®IP + PORTè¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œè¿˜å¯ä»¥æ ¹æ®ä¸ƒå±‚çš„URLã€Cookieã€æµè§ˆå™¨ç±»åˆ«ã€è¯­è¨€ã€è¯·æ±‚ç±»å‹æ¥å†³å®šã€‚</p><blockquote><p>å››å±‚è´Ÿè½½å‡è¡¡çš„æœ¬è´¨æ˜¯è½¬å‘ï¼Œä¸ƒå±‚è´Ÿè½½å‡è¡¡çš„æœ¬è´¨æ˜¯å†…å®¹äº¤æ¢å’Œä»£ç†ã€‚</p></blockquote><table><thead><tr><th></th><th><strong>å››å±‚è´Ÿè½½å‡è¡¡</strong></th><th><strong>ä¸ƒå±‚è´Ÿè½½å‡è¡¡</strong></th></tr></thead><tbody><tr><td><strong>åŸºäº</strong></td><td>IP + PORT</td><td>URL æˆ– ä¸»æœºIP</td></tr><tr><td><strong>ç±»ä¼¼</strong></td><td>è·¯ç”±å™¨</td><td>ä»£ç†æœåŠ¡å™¨</td></tr><tr><td><strong>å¤æ‚åº¦</strong></td><td>ä½</td><td>é«˜</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>é«˜ï¼Œæ— éœ€è§£æå†…å®¹</td><td>ä¸­ï¼Œéœ€ç®—æ³•è¯†åˆ«URL Headerã€Cookieç­‰</td></tr><tr><td><strong>å®‰å…¨æ€§</strong></td><td>ä½ï¼Œæ— æ³•è¯†åˆ«DDoSæ”»å‡»</td><td>é«˜ï¼Œå¯é˜²å¾¡SYN Floodæ”»å‡»</td></tr><tr><td><strong>æ‰©å±•åŠŸèƒ½</strong></td><td>æ— </td><td>å†…å®¹ç¼“å­˜ã€å›¾ç‰‡é˜²ç›—é“¾ç­‰</td></tr></tbody></table><h1>äºŒã€å¸¸è§ç®—æ³•</h1><blockquote><p>å‰ç½®æ•°æ®ç»“æ„</p></blockquote><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> urlObj&#123;</span><br><span class="line">  url:<span class="built_in">string</span>,</span><br><span class="line">  weight:<span class="built_in">number</span> <span class="comment">// ä»…åœ¨æƒé‡è½®è¯¢æ—¶ç”Ÿæ•ˆ</span></span><br><span class="line">&#125;</span><br><span class="line">urlDesc: urlObj[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> urlCollectObj&#123;</span><br><span class="line">  count: <span class="built_in">number</span>, <span class="comment">// è¿æ¥æ•°</span></span><br><span class="line">  costTime: <span class="built_in">number</span>, <span class="comment">// å“åº”æ—¶é—´</span></span><br><span class="line">  connection: <span class="built_in">number</span>, <span class="comment">// å®æ—¶è¿æ¥æ•°</span></span><br><span class="line">&#125;</span><br><span class="line">urlCollect: urlCollectObj[]</span><br></pre></td></tr></table></figure><h2 id="Random">Random</h2><blockquote><p>éšæœº</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/image-20210622002949591.png" alt="image-20210622002949591"></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Random = <span class="function">(<span class="params">urlDesc</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> urlCollect = [];</span><br><span class="line"></span><br><span class="line">  <span class="comment">//  æ”¶é›†url</span></span><br><span class="line">  urlDesc.forEach(<span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">    urlCollect.push(val.url);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//  ç”Ÿæˆéšæœºæ•°ä¸‹æ ‡è¿”å›ç›¸åº”URL</span></span><br><span class="line">    <span class="keyword">const</span> pos = <span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random() * urlCollect.length);</span><br><span class="line">    <span class="keyword">return</span> urlCollect[pos];</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = Random;</span><br></pre></td></tr></table></figure><h2 id="Weighted-Round-Robin">Weighted Round Robin</h2><blockquote><p>æƒé‡è½®è¯¢ç®—æ³•</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/image-20210622003000250.png" alt="image-20210622003000250"></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> WeiRoundRobin = <span class="function">(<span class="params">urlDesc</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> pos = <span class="number">0</span>,</span><br><span class="line">    urlCollect = [],</span><br><span class="line">    copyUrlDesc = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(urlDesc));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ ¹æ®æƒé‡æ”¶é›†url</span></span><br><span class="line">  <span class="keyword">while</span> (copyUrlDesc.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; copyUrlDesc.length; i++) &#123;</span><br><span class="line">      urlCollect.push(copyUrlDesc[i].url);</span><br><span class="line">      copyUrlDesc[i].weight--;</span><br><span class="line">      <span class="keyword">if</span> (copyUrlDesc[i].weight === <span class="number">0</span>) &#123;</span><br><span class="line">        copyUrlDesc.splice(i, <span class="number">1</span>);</span><br><span class="line">        i--;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è½®è¯¢è·å–URLå‡½æ•°</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> res = urlCollect[pos++];</span><br><span class="line">    <span class="keyword">if</span> (pos === urlCollect.length) &#123;</span><br><span class="line">      pos = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = WeiRoundRobin;</span><br></pre></td></tr></table></figure><h2 id="IP-Hash-URL-Hash">IP Hash &amp; URL Hash</h2><blockquote><p>æºIP / URL Hash</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/image-20210622003030857.png" alt="image-20210622003030857"></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; Hash &#125; = <span class="built_in">require</span>(<span class="string">&quot;../util&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> IpHash = <span class="function">(<span class="params">urlDesc</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> urlCollect = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> urlDesc) &#123;</span><br><span class="line">    <span class="comment">// æ”¶é›†url</span></span><br><span class="line">    urlCollect.push(urlDesc[key].url);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">sourceInfo</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ç”ŸæˆHashåè¿›åˆ¶æ•°å€¼</span></span><br><span class="line">    <span class="keyword">const</span> hashInfo = Hash(sourceInfo);</span><br><span class="line">    <span class="comment">// å–ä½™ä¸ºä¸‹æ ‡</span></span><br><span class="line">    <span class="keyword">const</span> urlPos = <span class="built_in">Math</span>.abs(hashInfo) % urlCollect.length;</span><br><span class="line">    <span class="comment">// è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> urlCollect[urlPos];</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = IpHash;</span><br></pre></td></tr></table></figure><h2 id="Consistent-Hash">Consistent Hash</h2><blockquote><p>ä¸€è‡´æ€§Hash</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/image-20210622003051914.png" alt="image-20210622003051914"></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; Hash &#125; = <span class="built_in">require</span>(<span class="string">&quot;../util&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ConsistentHash = <span class="function">(<span class="params">urlDesc</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> urlHashMap = &#123;&#125;,</span><br><span class="line">    hashCollect = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> urlDesc) &#123;</span><br><span class="line">    <span class="comment">// æ”¶é›†urlHashè¿›æ•°ç»„å’Œç”ŸæˆHashMap</span></span><br><span class="line">    <span class="keyword">const</span> &#123; url &#125; = urlDesc[key];</span><br><span class="line">    <span class="keyword">const</span> hash = Hash(url);</span><br><span class="line">    urlHashMap[hash] = url;</span><br><span class="line">    hashCollect.push(hash);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å°†hashæ•°ç»„ä»å°åˆ°å¤§æ’åº</span></span><br><span class="line">  hashCollect = hashCollect.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">sourceInfo</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ç”ŸæˆHashåè¿›åˆ¶æ•°å€¼</span></span><br><span class="line">    <span class="keyword">const</span> hashInfo = Hash(sourceInfo);</span><br><span class="line">    <span class="comment">// éå†hashæ•°ç»„æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ¯”æºä¿¡æ¯hashå€¼å¤§çš„ï¼Œå¹¶é€šè¿‡hashMapè¿”å›url</span></span><br><span class="line">    hashCollect.forEach(<span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (val &gt;= hashInfo) &#123;</span><br><span class="line">        <span class="keyword">return</span> urlHashMap[val];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// æ²¡æ‰¾å¤§åˆ™è¿”å›æœ€å¤§çš„</span></span><br><span class="line">    <span class="keyword">return</span> urlHashMap[hashCollect[hashCollect.length - <span class="number">1</span>]];</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = ConsistentHash;</span><br></pre></td></tr></table></figure><h2 id="Least-Connections">Least Connections</h2><blockquote><p>æœ€å°è¿æ¥æ•°</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/image-20210622003136462.png" alt="image-20210622003136462"></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> leastConnections = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">urlCollect</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> min = <span class="built_in">Number</span>.POSITIVE_INFINITY,</span><br><span class="line">      url = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éå†å¯¹è±¡æ‰¾åˆ°æœ€å°‘è¿æ¥æ•°çš„åœ°å€</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> urlCollect) &#123;</span><br><span class="line">      <span class="keyword">const</span> val = urlCollect[key].connection;</span><br><span class="line">      <span class="keyword">if</span> (val &lt; min) &#123;</span><br><span class="line">        min = val;</span><br><span class="line">        url = key;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = leastConnections;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼šurlCollectä¸ºè´Ÿè½½å‡å±æ•°æ®ç»Ÿè®¡å¯¹è±¡ï¼Œæœ‰ä»¥ä¸‹å±æ€§</p></blockquote><ul><li><p>connectionå®æ—¶è¿æ¥æ•°</p></li><li><p>countå¤„ç†è¯·æ±‚æ¬¡æ•°</p></li><li><p>costTimeå“åº”æ—¶é—´ã€‚</p></li></ul><h2 id="FAIR">FAIR</h2><blockquote><p>æœ€å°å“åº”æ—¶é—´</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/image-20210622003155965.png" alt="image-20210622003155965"></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Fair = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">urlCollect</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> min = <span class="built_in">Number</span>.POSITIVE_INFINITY,</span><br><span class="line">      url = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">     <span class="comment">// æ‰¾åˆ°è€—æ—¶æœ€å°‘çš„url </span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> urlCollect) &#123;</span><br><span class="line">      <span class="keyword">const</span> urlObj = urlCollect[key];</span><br><span class="line">      <span class="keyword">if</span> (urlObj.costTime &lt; min) &#123;</span><br><span class="line">        min = urlObj.costTime;</span><br><span class="line">        url = key;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = Fair;</span><br></pre></td></tr></table></figure><blockquote><p>çœ‹åˆ°è¿™é‡Œæ˜¯ä¸æ˜¯æ„Ÿè§‰ç®—æ³•éƒ½æŒºç®€å•çš„ ğŸ¥±</p></blockquote><blockquote><p>æœŸå¾…ä¸€ä¸‹æ¨¡å—å››çš„å®ç°å§ğŸ˜</p></blockquote><h1>ä¸‰ã€å¥åº·ç›‘æµ‹</h1><blockquote><p>å¥åº·ç›‘æµ‹å³å¯¹åº”ç”¨æœåŠ¡å™¨çš„å¥åº·ç›‘æµ‹ï¼Œä¸ºé˜²æ­¢æŠŠè¯·æ±‚è½¬å‘åˆ°å¼‚å¸¸çš„åº”ç”¨æœåŠ¡å™¨ä¸Šï¼Œåº”ä½¿ç”¨å¥åº·ç›‘æµ‹ç­–ç•¥ã€‚åº”å¯¹ä¸åŒçš„ä¸šåŠ¡æ•æ„Ÿç¨‹åº¦ï¼Œå¯ç›¸åº”è°ƒæ•´ç­–ç•¥å’Œé¢‘ç‡ã€‚</p></blockquote><h2 id="HTTP-HTTPS-å¥åº·ç›‘æµ‹æ­¥éª¤ï¼ˆä¸ƒå±‚ï¼‰">HTTP / HTTPS å¥åº·ç›‘æµ‹æ­¥éª¤ï¼ˆä¸ƒå±‚ï¼‰</h2><ol><li>è´Ÿè½½å‡è¡¡èŠ‚ç‚¹å‘åº”ç”¨æœåŠ¡å™¨å‘é€HEADè¯·æ±‚ã€‚</li><li>åº”ç”¨æœåŠ¡å™¨æ¥æ”¶åˆ°HEADè¯·æ±‚åæ ¹æ®æƒ…å†µè¿”å›ç›¸åº”çŠ¶æ€ç ã€‚</li><li>è‹¥åœ¨è¶…æ—¶æ—¶é—´å†…æœªæ”¶åˆ°è¿”å›çš„çŠ¶æ€ç ï¼Œåˆ™åˆ¤æ–­ä¸ºè¶…æ—¶ï¼Œå¥åº·æ£€æŸ¥å¤±è´¥ã€‚</li><li>è‹¥åœ¨è¶…æ—¶æ—¶é—´å†…æ”¶åˆ°è¿”å›çš„çŠ¶æ€ç ï¼Œè´Ÿè½½å‡è¡¡èŠ‚ç‚¹è¿›è¡Œæ¯”å¯¹ï¼Œåˆ¤æ–­å¥åº·æ£€æŸ¥æ˜¯å¦æˆåŠŸã€‚</li></ol><h2 id="TCPå¥åº·æ£€æŸ¥æ­¥éª¤ï¼ˆå››å±‚ï¼‰">TCPå¥åº·æ£€æŸ¥æ­¥éª¤ï¼ˆå››å±‚ï¼‰</h2><ol><li>è´Ÿè½½å‡è¡¡èŠ‚ç‚¹å‘å†…ç½‘åº”ç”¨æœåŠ¡å™¨IP + PORT å‘TCP SYNè¯·æ±‚æ•°æ®åŒ…ã€‚</li><li>å†…ç½‘åº”ç”¨æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œè‹¥åœ¨æ­£å¸¸ç›‘å¬ï¼Œåˆ™è¿”å›SYN + ACKæ•°æ®åŒ…ã€‚</li><li>è‹¥åœ¨è¶…æ—¶æ—¶é—´å†…æœªæ”¶åˆ°è¿”å›çš„æ•°æ®åŒ…ï¼Œåˆ™åˆ¤æ–­æœåŠ¡æ— å“åº”ã€å¥åº·æ£€æŸ¥å¤±è´¥ï¼Œå¹¶å‘å†…ç½‘åº”ç”¨æœåŠ¡å™¨å‘é€RSTæ•°æ®åŒ…ä¸­æ–­TCPè¿æ¥ã€‚</li><li>è‹¥åœ¨è¶…æ—¶æ—¶é—´å†…æ”¶åˆ°è¿”å›çš„æ•°æ®åŒ…ï¼Œåˆ™åˆ¤å®šæœåŠ¡å¥åº·è¿è¡Œï¼Œå‘èµ·RSTæ•°æ®åŒ…ä¸­æ–­TCPè¿æ¥ã€‚</li></ol><h2 id="UDPå¥åº·æ£€æŸ¥æ­¥éª¤ï¼ˆå››å±‚ï¼‰">UDPå¥åº·æ£€æŸ¥æ­¥éª¤ï¼ˆå››å±‚ï¼‰</h2><ol><li>è´Ÿè½½å‡è¡¡èŠ‚ç‚¹å‘å†…ç½‘åº”ç”¨æœåŠ¡å™¨IP + PORTå‘é€UDPæŠ¥æ–‡ã€‚</li><li>è‹¥å†…ç½‘åº”ç”¨æœåŠ¡å™¨æœªæ­£å¸¸ç›‘å¬ï¼Œåˆ™è¿”å›<code>PORT XX unreachable</code>çš„ICMPæŠ¥é”™ä¿¡æ¯ï¼Œåä¹‹ä¸ºæ­£å¸¸ã€‚</li><li>è‹¥åœ¨è¶…æ—¶æ—¶é—´å†…æ”¶åˆ°äº†æŠ¥é”™ä¿¡æ¯ï¼Œåˆ™åˆ¤æ–­æœåŠ¡å¼‚å¸¸ï¼Œå¥åº·æ£€æŸ¥å¤±è´¥ã€‚</li><li>è‹¥åœ¨è¶…æ—¶æ—¶é—´å†…æœªæ”¶åˆ°æŠ¥é”™ä¿¡æ¯ï¼Œåˆ™åˆ¤æ–­æœåŠ¡å¥åº·è¿è¡Œã€‚</li></ol><h1>å››ã€VIPæŠ€æœ¯</h1><blockquote><p>Vrtual IP</p></blockquote><h2 id="è™šæ‹ŸIP">è™šæ‹ŸIP</h2><ul><li>åœ¨TCP / IPæ¶æ„ä¸‹ï¼Œæ‰€æœ‰æƒ³ä¸Šç½‘çš„ç”µè„‘ï¼Œä¸è®ºä»¥ä½•ç§å½¢å¼è¿ä¸Šç½‘ç»œï¼Œéƒ½ä¸éœ€è¦æœ‰ä¸€ä¸ªå”¯ä¸€çš„IPåœ°å€ã€‚äº‹å®ä¸ŠIPåœ°å€æ˜¯ä¸»æœºç¡¬ä»¶ç‰©ç†åœ°å€çš„ä¸€ç§æŠ½è±¡ã€‚</li><li>ç®€å•æ¥è¯´åœ°å€åˆ†ä¸ºä¸¤ç§<ul><li>MACç‰©ç†åœ°å€</li><li>IPé€»è¾‘åœ°å€</li></ul></li><li>è™šæ‹ŸIPæ˜¯ä¸€ä¸ªæœªåˆ†é…ç»™çœŸå®ä¸»æœºçš„IPï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹å¤–æä¾›çš„æœåŠ¡å™¨çš„ä¸»æœºé™¤äº†æœ‰ä¸€ä¸ªçœŸå®IPè¿˜æœ‰ä¸€ä¸ªè™šIPï¼Œè¿™ä¸¤ä¸ªIPä¸­çš„ä»»æ„ä¸€ä¸ªéƒ½å¯ä»¥è¿æ¥åˆ°è¿™å°ä¸»æœºã€‚<ul><li>é€šè¿‡è™šæ‹ŸIPå¯¹åº”çœŸå®ä¸»æœºçš„MACåœ°å€å®ç°</li></ul></li><li>è™šæ‹ŸIPä¸€èˆ¬ç”¨ä½œè¾¾åˆ°é«˜å¯ç”¨çš„ç›®çš„ï¼Œæ¯”å¦‚è®©æ‰€æœ‰é¡¹ç›®ä¸­çš„æ•°æ®åº“é“¾æ¥é…ç½®éƒ½æ˜¯è¿™ä¸ªè™šæ‹ŸIPï¼Œå½“ä¸»æœåŠ¡å™¨å‘ç”Ÿæ•…éšœæ— æ³•å¯¹å¤–æä¾›æœåŠ¡æ—¶ï¼ŒåŠ¨æ€å°†è¿™ä¸ªè™šIPåˆ‡æ¢åˆ°å¤‡ç”¨æœåŠ¡å™¨ã€‚</li></ul><h2 id="è™šæ‹ŸIPåŸç†">è™šæ‹ŸIPåŸç†</h2><ol><li>ARPæ˜¯åœ°å€è§£æåè®®ï¼Œä½œç”¨ä¸ºå°†ä¸€ä¸ªIPåœ°å€è½¬æ¢ä¸ºMACåœ°å€ã€‚</li><li>æ¯å°ä¸»æœºéƒ½æœ‰ARPé«˜é€Ÿç¼“å­˜ï¼Œå­˜å‚¨åŒä¸€ä¸ªç½‘ç»œå†…IPåœ°å€ä¸MACåœ°å€çš„æ˜ å°„å…³ç³»ï¼Œä¸»æœºå‘é€æ•°æ®ä¼šå…ˆä»è¿™ä¸ªç¼“å­˜ä¸­æŸ¥è¯¢ç›®æ ‡IPå¯¹åº”MACåœ°å€ï¼Œå‘è¿™ä¸ªMACåœ°å€å‘é€æ•°æ®ã€‚æ“ä½œç³»ç»Ÿè‡ªåŠ¨ç»´æŠ¤è¿™ä¸ªç¼“å­˜ã€‚</li><li>Linuxä¸‹å¯ç”¨ARPå‘½ä»¤æ“ä½œARPé«˜é€Ÿç¼“å­˜</li></ol><ul><li><p>æ¯”å¦‚å­˜åœ¨ä¸»æœºAï¼ˆ192.168.1.6ï¼‰å’Œä¸»æœºBï¼ˆ192.168.1.8ï¼‰ã€‚Aä½œä¸ºå¯¹å¤–æœåŠ¡çš„ä¸»æœåŠ¡å™¨ï¼ŒBä½œä¸ºå¤‡ä»½æœºå™¨ï¼Œä¸¤å°æœåŠ¡å™¨ä¹‹é—´é€šè¿‡HeartBeaté€šä¿¡ã€‚</p></li><li><p>å³ä¸»æœåŠ¡å™¨ä¼šå®šæ—¶ç»™å¤‡ä»½æœåŠ¡å™¨å‘é€æ•°æ®åŒ…ï¼Œå‘ŠçŸ¥ä¸»æœåŠ¡å™¨æ­£å¸¸ï¼Œå½“å¤‡ä»½æœåŠ¡å™¨åœ¨è§„å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°ä¸»æœåŠ¡å™¨çš„HeartBeatï¼Œä¼šè®¤ä¸ºä¸»æœåŠ¡å™¨å®•æœºã€‚</p></li><li><p>æ­¤æ—¶å¤‡ä»½æœåŠ¡å™¨å°±å‡çº§ä¸ºä¸»æœåŠ¡å™¨ã€‚</p><ul><li>æœåŠ¡å™¨Bå°†è‡ªå·±çš„ARPç¼“å­˜å‘é€å‡ºå»ï¼Œå‘ŠçŸ¥è·¯ç”±å™¨ä¿®æ”¹è·¯ç”±è¡¨ï¼Œå‘ŠçŸ¥è™šæ‹ŸIPåœ°å€åº”è¯¥æŒ‡å‘192.168.1.8.</li><li>è¿™æ—¶å¤–æ¥å†æ¬¡è®¿é—®è™šæ‹ŸIPçš„æ—¶å€™ï¼Œæœºå™¨Bå°±ä¼šå˜æˆä¸»æœåŠ¡å™¨ï¼Œè€ŒAé™çº§ä¸ºå¤‡ä»½æœåŠ¡å™¨ã€‚</li><li>è¿™æ ·å°±å®Œæˆäº†ä¸»ä»æœºå™¨çš„åˆ‡æ¢ï¼Œè¿™ä¸€åˆ‡å¯¹å¤–éƒ½æ˜¯æ— æ„ŸçŸ¥ã€é€æ˜çš„ã€‚</li></ul></li></ul><h1>äº”ã€åŸºäº nodejs å®ç°ä¸€ä¸ªç®€å•çš„è´Ÿè½½å‡è¡¡</h1><h2 id="é¢„æœŸæ•ˆæœ">é¢„æœŸæ•ˆæœ</h2><blockquote><p>ç¼–è¾‘config.jså<code>npm run start</code>å³å¯å¯åŠ¨å‡è¡¡å™¨å’Œåç«¯æœåŠ¡èŠ‚ç‚¹</p></blockquote><ul><li><p>urlDescï¼šåç«¯æœåŠ¡èŠ‚ç‚¹é…ç½®å¯¹è±¡ï¼Œweightä»…åœ¨WeightRoundRobinç®—æ³•æ—¶èµ·ä½œç”¨</p></li><li><p>portï¼šå‡è¡¡å™¨ç›‘å¬ç«¯å£</p></li><li><p>algorithmï¼šç®—æ³•åç§°ï¼ˆæ¨¡å—äºŒä¸­çš„ç®—æ³•å‡å·²å®ç°ï¼‰</p></li><li><p>workerNumï¼šåç«¯æœåŠ¡ç«¯å£å¼€å¯è¿›ç¨‹æ•°ï¼Œæä¾›å¹¶å‘èƒ½åŠ›ã€‚</p></li><li><p>balancerNumï¼šå‡è¡¡å™¨ç«¯å£å¼€å¯è¿›ç¨‹æ•°ï¼Œæä¾›å¹¶å‘èƒ½åŠ›ã€‚</p></li><li><p>workerFilePathï¼šåç«¯æœåŠ¡èŠ‚ç‚¹æ‰§è¡Œæ–‡ä»¶ï¼Œæ¨èä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;ALGORITHM, BASE_URL&#125; = <span class="built_in">require</span>(<span class="string">&quot;./constant&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    urlDesc: [</span><br><span class="line">        &#123;</span><br><span class="line">            url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;<span class="number">16666</span>&#125;</span>`</span>,</span><br><span class="line">            weight: <span class="number">6</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;<span class="number">16667</span>&#125;</span>`</span>,</span><br><span class="line">            weight: <span class="number">1</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;<span class="number">16668</span>&#125;</span>`</span>,</span><br><span class="line">            weight: <span class="number">1</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;<span class="number">16669</span>&#125;</span>`</span>,</span><br><span class="line">            weight: <span class="number">1</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;<span class="number">16670</span>&#125;</span>`</span>,</span><br><span class="line">            weight: <span class="number">2</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;<span class="number">16671</span>&#125;</span>`</span>,</span><br><span class="line">            weight: <span class="number">1</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            url: <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;<span class="number">16672</span>&#125;</span>`</span>,</span><br><span class="line">            weight: <span class="number">4</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    ],</span><br><span class="line">    port: <span class="number">8080</span>,</span><br><span class="line">    algorithm: ALGORITHM.RANDOM,</span><br><span class="line">    workerNum: <span class="number">5</span>ï¼Œ</span><br><span class="line">    balancerNum: <span class="number">5</span>ï¼Œ</span><br><span class="line">    workerFilePath:path.resolve(__dirname, <span class="string">&quot;./worker.js&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¶æ„è®¾è®¡å›¾">æ¶æ„è®¾è®¡å›¾</h2><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/image-20210622003323078.png" alt="image-20210622003323078"></p><h2 id="å…ˆæ¥çœ‹çœ‹ä¸»æµç¨‹-main-js">å…ˆæ¥çœ‹çœ‹ä¸»æµç¨‹ main.js</h2><ol><li><p>åˆå§‹åŒ–è´Ÿè½½å‡è¡¡ç»Ÿè®¡å¯¹è±¡balanceDataBase</p><ul><li>balanceDataBaseæ˜¯ä¸€ä¸ªDataBaseç±»å®ä¾‹ï¼Œç”¨äºç»Ÿè®¡è´Ÿè½½å‡è¡¡æ•°æ®ï¼ˆåç»­ä¼šè®²åˆ°ï¼‰.</li></ul></li><li><p>è¿è¡Œå‡è¡¡å™¨</p><ul><li>å¤šè¿›ç¨‹æ¨¡å‹ï¼Œæä¾›å¹¶å‘èƒ½åŠ›ã€‚</li></ul></li><li><p>è¿è¡Œåç«¯æœåŠ¡èŠ‚ç‚¹</p><ul><li>å¤šçº¿ç¨‹+å¤šè¿›ç¨‹æ¨¡å‹ï¼Œè¿è¡Œå¤šä¸ªæœåŠ¡èŠ‚ç‚¹å¹¶æä¾›å¹¶å‘èƒ½åŠ›ã€‚</li></ul></li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;urlDesc, balancerNum&#125; = <span class="built_in">require</span>(<span class="string">&quot;./config&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> cluster = <span class="built_in">require</span>(<span class="string">&quot;cluster&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> cpusLen = <span class="built_in">require</span>(<span class="string">&quot;os&quot;</span>).cpus().length;</span><br><span class="line"><span class="keyword">const</span> &#123;DataBase&#125; = <span class="built_in">require</span>(<span class="string">&quot;./util&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;Worker&#125; = <span class="built_in">require</span>(<span class="string">&#x27;worker_threads&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> runWorker = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// é˜²æ­¢ç›‘å¬ç«¯å£æ•° &gt; CPUæ ¸æ•°</span></span><br><span class="line">    <span class="keyword">const</span> urlObjArr = urlDesc.slice(<span class="number">0</span>, cpusLen);</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–åˆ›å»ºå­çº¿ç¨‹</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; urlObjArr.length; i++) &#123;</span><br><span class="line">        createWorkerThread(urlObjArr[i].url);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> runBalancer = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// è®¾ç½®å­è¿›ç¨‹æ‰§è¡Œæ–‡ä»¶</span></span><br><span class="line">    cluster.setupMaster(&#123;<span class="attr">exec</span>: path.resolve(__dirname, <span class="string">&quot;./balancer.js&quot;</span>)&#125;);</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–åˆ›å»ºå­è¿›ç¨‹</span></span><br><span class="line">    <span class="keyword">let</span> max</span><br><span class="line">    <span class="keyword">if</span> (balancerNum) &#123;</span><br><span class="line">        max = balancerNum &gt; cpusLen ? cpusLen : balancerNum</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        max = <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; max; i++) &#123;</span><br><span class="line">        createBalancer();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–è´Ÿè½½å‡è¡¡æ•°æ®ç»Ÿè®¡å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> balanceDataBase = <span class="keyword">new</span> DataBase(urlDesc);</span><br><span class="line"><span class="comment">// è¿è¡Œå‡è¡¡å™¨</span></span><br><span class="line">runBalancer();</span><br><span class="line"><span class="comment">// è¿è¡Œåç«¯æœåŠ¡èŠ‚ç‚¹</span></span><br><span class="line">runWorker();</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºå‡è¡¡å™¨ï¼ˆcreateBalancerå‡½æ•°ï¼‰">åˆ›å»ºå‡è¡¡å™¨ï¼ˆcreateBalancerå‡½æ•°ï¼‰</h3><ol><li>åˆ›å»ºè¿›ç¨‹</li><li>ç›‘å¬è¿›ç¨‹é€šä¿¡æ¶ˆæ¯<ul><li>ç›‘å¬æ›´æ–°å“åº”æ—¶é—´äº‹ä»¶å¹¶æ‰§è¡Œæ›´æ–°å‡½æ•°<ul><li>ç”¨äºFAIRç®—æ³•ï¼ˆæœ€å°å“åº”æ—¶é—´ï¼‰ã€‚</li></ul></li><li>ç›‘å¬è·å–ç»Ÿè®¡å¯¹è±¡äº‹ä»¶å¹¶è¿”å›</li></ul></li><li>ç›‘å¬å¼‚å¸¸é€€å‡ºå¹¶é‡æ–°åˆ›å»ºï¼Œè¿›ç¨‹å®ˆæŠ¤ã€‚</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> createBalancer = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºè¿›ç¨‹</span></span><br><span class="line">    <span class="keyword">const</span> worker = cluster.fork();</span><br><span class="line">    worker.on(<span class="string">&quot;message&quot;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// ç›‘å¬æ›´æ–°å“åº”æ—¶é—´äº‹ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> (msg.type === <span class="string">&quot;updateCostTime&quot;</span>) &#123;</span><br><span class="line">            balanceDataBase.updateCostTime(msg.URL, msg.costTime)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç›‘å¬è·å–urlç»Ÿè®¡å¯¹è±¡äº‹ä»¶å¹¶è¿”å›</span></span><br><span class="line">        <span class="keyword">if</span> (msg.type === <span class="string">&quot;getUrlCollect&quot;</span>) &#123;</span><br><span class="line">            worker.send(&#123;<span class="attr">type</span>: <span class="string">&quot;getUrlCollect&quot;</span>, <span class="attr">urlCollect</span>: balanceDataBase.urlCollect&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// ç›‘å¬å¼‚å¸¸é€€å‡ºäº‹ä»¶å¹¶é‡æ–°åˆ›å»ºè¿›ç¨‹</span></span><br><span class="line">    worker.on(<span class="string">&quot;exit&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        createBalancer();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºåç«¯æœåŠ¡èŠ‚ç‚¹ï¼ˆcreateWorkerThreadå‡½æ•°ï¼‰">åˆ›å»ºåç«¯æœåŠ¡èŠ‚ç‚¹ï¼ˆcreateWorkerThreadå‡½æ•°ï¼‰</h3><ol><li><p>åˆ›å»ºçº¿ç¨‹</p></li><li><p>è§£æéœ€è¦ç›‘å¬çš„ç«¯å£</p></li><li><p>å‘å­çº¿ç¨‹é€šä¿¡ï¼Œå‘é€éœ€è¦ç›‘å¬çš„ç«¯å£</p></li><li><p>é€šè¿‡çº¿ç¨‹é€šä¿¡ï¼Œç›‘å¬å­çº¿ç¨‹äº‹ä»¶</p><ul><li><p>ç›‘å¬è¿æ¥äº‹ä»¶ï¼Œå¹¶è§¦å‘å¤„ç†å‡½æ•°ã€‚</p></li><li><p>ç›‘å¬æ–­å¼€è¿æ¥äº‹ä»¶å¹¶è§¦å‘å¤„ç†å‡½æ•°ã€‚</p></li><li><p>ç”¨äºç»Ÿè®¡è´Ÿè½½å‡è¡¡åˆ†å¸ƒå’Œå®æ—¶è¿æ¥æ•°ã€‚</p></li></ul></li><li><p>ç›‘å¬å¼‚å¸¸é€€å‡ºå¹¶é‡æ–°åˆ›å»ºï¼Œçº¿ç¨‹å®ˆæŠ¤ã€‚</p></li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> createWorkerThread = <span class="function">(<span class="params">listenUrl</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºçº¿ç¨‹</span></span><br><span class="line">    <span class="keyword">const</span> worker = <span class="keyword">new</span> Worker(path.resolve(__dirname, <span class="string">&quot;./workerThread.js&quot;</span>));</span><br><span class="line">    <span class="comment">// è·å–ç›‘å¬ç«¯å£</span></span><br><span class="line">    <span class="keyword">const</span> listenPort = listenUrl.split(<span class="string">&quot;:&quot;</span>)[<span class="number">2</span>];</span><br><span class="line">    <span class="comment">// å‘å­çº¿ç¨‹å‘é€è¦ç›‘å¬çš„ç«¯å£å·</span></span><br><span class="line">    worker.postMessage(&#123;<span class="attr">type</span>: <span class="string">&quot;port&quot;</span>, <span class="attr">port</span>: listenPort&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¥æ”¶å­çº¿ç¨‹æ¶ˆæ¯ç»Ÿè®¡è¿›ç¨‹è¢«è®¿é—®æ¬¡æ•°</span></span><br><span class="line">    worker.on(<span class="string">&quot;message&quot;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// ç›‘å¬è¿æ¥äº‹ä»¶å¹¶è§¦å‘è®¡æ•°äº‹ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> (msg.type === <span class="string">&quot;connect&quot;</span>) &#123;</span><br><span class="line">            balanceDataBase.add(msg.port);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç›‘å¬æ–­å¼€è¿æ¥äº‹ä»¶å¹¶è§¦å‘è®¡æ•°äº‹ä»¶</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (msg.type === <span class="string">&quot;disconnect&quot;</span>) &#123;</span><br><span class="line">            balanceDataBase.sub(msg.port);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// ç›‘å¬å¼‚å¸¸é€€å‡ºäº‹ä»¶å¹¶é‡æ–°åˆ›å»ºè¿›ç¨‹</span></span><br><span class="line">    worker.on(<span class="string">&quot;exit&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        createWorkerThread(listenUrl);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å†æ¥çœ‹çœ‹å‡è¡¡å™¨å·¥ä½œæµç¨‹-balancer-js">å†æ¥çœ‹çœ‹å‡è¡¡å™¨å·¥ä½œæµç¨‹ balancer.js</h2><ol><li>è·å–getURLå·¥å…·å‡½æ•°</li><li>ç›‘å¬è¯·æ±‚å¹¶ä»£ç†<ol><li>è·å–éœ€è¦ä¼ å…¥getURLå·¥å…·å‡½æ•°çš„å‚æ•°ã€‚</li><li>é€šè¿‡getURLå·¥å…·å‡½æ•°è·å–å‡è¡¡ä»£ç†ç›®çš„åœ°å€URL</li><li>è®°å½•è¯·æ±‚å¼€å§‹æ—¶é—´</li><li>å¤„ç†è·¨åŸŸ</li><li>è¿”å›å“åº”</li><li>é€šè¿‡è¿›ç¨‹é€šä¿¡ï¼Œè§¦å‘å“åº”æ—¶é—´æ›´æ–°äº‹ä»¶ã€‚</li></ol></li></ol><blockquote><p>æ³¨1ï¼šLoadBalanceå‡½æ•°å³é€šè¿‡ç®—æ³•åç§°è¿”å›ä¸åŒçš„getURLå·¥å…·å‡½æ•°ï¼Œå„ç®—æ³•å®ç°è§æ¨¡å—äºŒï¼šå¸¸è§ç®—æ³•</p></blockquote><blockquote><p>æ³¨2ï¼šgetSourceå‡½æ•°å³å¤„ç†å‚æ•°å¹¶è¿”å›ï¼ŒgetURLä¸ºä¸Šé¢è®²åˆ°çš„è·å–URLå·¥å…·å‡½æ•°ã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> cpusLen = <span class="built_in">require</span>(<span class="string">&quot;os&quot;</span>).cpus().length;</span><br><span class="line"><span class="keyword">const</span> LoadBalance = <span class="built_in">require</span>(<span class="string">&quot;./algorithm&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&quot;axios&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"><span class="keyword">const</span> &#123;urlFormat, ipFormat&#125; = <span class="built_in">require</span>(<span class="string">&quot;./util&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;ALGORITHM, BASE_URL&#125; = <span class="built_in">require</span>(<span class="string">&quot;./constant&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;urlDesc, algorithm, port&#125; = <span class="built_in">require</span>(<span class="string">&quot;./config&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> run = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–è½¬å‘URLå·¥å…·å‡½æ•°</span></span><br><span class="line">    <span class="keyword">const</span> getURL = LoadBalance(urlDesc.slice(<span class="number">0</span>, cpusLen), algorithm);</span><br><span class="line">    <span class="comment">// ç›‘å¬è¯·æ±‚å¹¶å‡è¡¡ä»£ç†</span></span><br><span class="line">    app.get(<span class="string">&quot;/&quot;</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">        <span class="comment">// è·å–éœ€è¦ä¼ å…¥çš„å‚æ•°</span></span><br><span class="line">        <span class="keyword">const</span> source = <span class="keyword">await</span> getSource(req);</span><br><span class="line">        <span class="comment">// è·å–URL</span></span><br><span class="line">        <span class="keyword">const</span> URL = getURL(source);</span><br><span class="line">        <span class="comment">// res.redirect(301, URL) é‡å®šå‘è´Ÿè½½å‡è¡¡</span></span><br><span class="line">        <span class="comment">// è®°å½•è¯·æ±‚å¼€å§‹æ—¶é—´</span></span><br><span class="line">        <span class="keyword">const</span> start = <span class="built_in">Date</span>.now();</span><br><span class="line">        <span class="comment">// ä»£ç†è¯·æ±‚</span></span><br><span class="line">        axios.get(URL).then(<span class="keyword">async</span> (response) =&gt; &#123;</span><br><span class="line">            <span class="comment">// è·å–è´Ÿè½½å‡è¡¡ç»Ÿè®¡å¯¹è±¡å¹¶è¿”å›</span></span><br><span class="line">            <span class="keyword">const</span> urlCollect = <span class="keyword">await</span> getUrlCollect();</span><br><span class="line">            <span class="comment">// å¤„ç†è·¨åŸŸ</span></span><br><span class="line">            res.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">            response.data.urlCollect = urlCollect;</span><br><span class="line">            <span class="comment">// è¿”å›æ•°æ®</span></span><br><span class="line">            res.send(response.data);</span><br><span class="line">            <span class="comment">// è®°å½•ç›¸åº”æ—¶é—´å¹¶æ›´æ–°</span></span><br><span class="line">            <span class="keyword">const</span> costTime = <span class="built_in">Date</span>.now() - start;</span><br><span class="line">            process.send(&#123;<span class="attr">type</span>: <span class="string">&quot;updateCostTime&quot;</span>, costTime, URL&#125;)</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// è´Ÿè½½å‡è¡¡æœåŠ¡å™¨å¼€å§‹ç›‘å¬è¯·æ±‚</span></span><br><span class="line">    app.listen(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Load Balance Server Running at <span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">run();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getSource = <span class="keyword">async</span> (req) =&gt; &#123;</span><br><span class="line">    <span class="keyword">switch</span> (algorithm) &#123;</span><br><span class="line">        <span class="keyword">case</span> ALGORITHM.IP_HASH:</span><br><span class="line">            <span class="keyword">return</span> ipFormat(req);</span><br><span class="line">        <span class="keyword">case</span> ALGORITHM.URL_HASH:</span><br><span class="line">            <span class="keyword">return</span> urlFormat(req);</span><br><span class="line">        <span class="keyword">case</span> ALGORITHM.CONSISTENT_HASH:</span><br><span class="line">            <span class="keyword">return</span> urlFormat(req);</span><br><span class="line">        <span class="keyword">case</span> ALGORITHM.LEAST_CONNECTIONS:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">await</span> getUrlCollect();</span><br><span class="line">        <span class="keyword">case</span> ALGORITHM.FAIR:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">await</span> getUrlCollect();</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="å¦‚ä½•åœ¨å‡è¡¡å™¨ä¸­è·å–è´Ÿè½½å‡è¡¡ç»Ÿè®¡å¯¹è±¡-getUrlCollect">å¦‚ä½•åœ¨å‡è¡¡å™¨ä¸­è·å–è´Ÿè½½å‡è¡¡ç»Ÿè®¡å¯¹è±¡ getUrlCollect</h3><ol><li>é€šè¿‡è¿›ç¨‹é€šä¿¡ï¼Œå‘çˆ¶è¿›ç¨‹å‘é€è·å–æ¶ˆæ¯ã€‚</li><li>åŒæ—¶å¼€å§‹ç›‘å¬çˆ¶è¿›ç¨‹é€šä¿¡æ¶ˆæ¯ï¼Œæ¥æ”¶åä½¿ç”¨Promise resovleè¿”å›ã€‚</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è·å–è´Ÿè½½å‡è¡¡ç»Ÿè®¡å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> getUrlCollect = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            process.send(&#123;<span class="attr">type</span>: <span class="string">&quot;getUrlCollect&quot;</span>&#125;)</span><br><span class="line">            process.on(<span class="string">&quot;message&quot;</span>, <span class="function"><span class="params">msg</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (msg.type === <span class="string">&quot;getUrlCollect&quot;</span>) &#123;</span><br><span class="line">                    resolve(msg.urlCollect)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            reject(e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¦‚ä½•å®ç°æœåŠ¡èŠ‚ç‚¹å¹¶å‘-workerThread-js">å¦‚ä½•å®ç°æœåŠ¡èŠ‚ç‚¹å¹¶å‘ workerThread.js</h2><blockquote><p>ä½¿ç”¨å¤šçº¿ç¨‹+å¤šè¿›ç¨‹æ¨¡å‹ï¼Œä¸ºæ¯ä¸ªæœåŠ¡èŠ‚ç‚¹æä¾›å¹¶å‘èƒ½åŠ›ã€‚</p></blockquote><h3 id="ä¸»è¿›ç¨‹æµç¨‹">ä¸»è¿›ç¨‹æµç¨‹</h3><ol><li>æ ¹æ®é…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºç›¸åº”æ•°é‡æœåŠ¡èŠ‚ç‚¹ã€‚<ol><li>åˆ›å»ºè¿›ç¨‹</li><li>ç›‘å¬çˆ¶çº¿ç¨‹æ¶ˆæ¯ï¼ˆæœåŠ¡èŠ‚ç‚¹ç›‘å¬ç«¯å£ï¼‰ï¼Œå¹¶è½¬å‘ç»™å­è¿›ç¨‹ã€‚</li><li>ç›‘å¬å­è¿›ç¨‹æ¶ˆæ¯ï¼Œå¹¶è½¬å‘ç»™çˆ¶çº¿ç¨‹ï¼ˆå»ºç«‹è¿æ¥ã€æ–­å¼€è¿æ¥äº‹ä»¶ï¼‰ã€‚</li><li>ç›‘å¬å¼‚å¸¸é€€å‡ºå¹¶é‡æ–°å»ºç«‹ã€‚</li></ol></li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> cluster = <span class="built_in">require</span>(<span class="string">&quot;cluster&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> cpusLen = <span class="built_in">require</span>(<span class="string">&quot;os&quot;</span>).cpus().length;</span><br><span class="line"><span class="keyword">const</span> &#123;parentPort&#125; = <span class="built_in">require</span>(<span class="string">&#x27;worker_threads&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;workerNum, workerFilePath&#125; = <span class="built_in">require</span>(<span class="string">&quot;./config&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (cluster.isMaster) &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºå·¥ä½œè¿›ç¨‹å‡½æ•°</span></span><br><span class="line">    <span class="keyword">const</span> createWorker = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿›ç¨‹</span></span><br><span class="line">        <span class="keyword">const</span> worker = cluster.fork();</span><br><span class="line">        <span class="comment">// ç›‘å¬çˆ¶çº¿ç¨‹æ¶ˆæ¯ï¼Œå¹¶è½¬å‘ç»™å­è¿›ç¨‹ã€‚</span></span><br><span class="line">        parentPort.on(<span class="string">&quot;message&quot;</span>, <span class="function"><span class="params">msg</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (msg.type === <span class="string">&quot;port&quot;</span>) &#123;</span><br><span class="line">                worker.send(&#123;<span class="attr">type</span>: <span class="string">&quot;port&quot;</span>, <span class="attr">port</span>: msg.port&#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// ç›‘å¬å­è¿›ç¨‹æ¶ˆæ¯å¹¶è½¬å‘ç»™çˆ¶çº¿ç¨‹</span></span><br><span class="line">        worker.on(<span class="string">&quot;message&quot;</span>, <span class="function"><span class="params">msg</span> =&gt;</span> &#123;</span><br><span class="line">            parentPort.postMessage(msg);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// ç›‘å¬è¿›ç¨‹å¼‚å¸¸é€€å‡ºå¹¶é‡æ–°åˆ›å»º</span></span><br><span class="line">        worker.on(<span class="string">&quot;exit&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            createWorker();</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æŒ‰é…ç½®åˆ›å»ºè¿›ç¨‹ï¼Œä½†ä¸å¯å¤§äºCPUæ ¸æ•°</span></span><br><span class="line">    <span class="keyword">let</span> max</span><br><span class="line">    <span class="keyword">if</span> (workerNum) &#123;</span><br><span class="line">        max = workerNum &gt; cpusLen ? cpusLen : workerNum</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        max = <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; max; i++) &#123;</span><br><span class="line">        createWorker();</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// åç«¯æœåŠ¡æ‰§è¡Œæ–‡ä»¶</span></span><br><span class="line">    <span class="built_in">require</span>(workerFilePath)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="å­è¿›ç¨‹æµç¨‹-worker-jsï¼ˆconfig-workerFilePathï¼‰">å­è¿›ç¨‹æµç¨‹ worker.jsï¼ˆconfig.workerFilePathï¼‰</h3><ol><li>é€šè¿‡è¿›ç¨‹é—´é€šä¿¡ï¼Œå‘çˆ¶è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼Œè§¦å‘å»ºç«‹è¿æ¥äº‹ä»¶ã€‚</li><li>è¿”å›ç›¸åº”ã€‚</li><li>é€šè¿‡è¿›ç¨‹é—´é€šä¿¡ï¼Œå‘çˆ¶è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼Œè§¦å‘æ–­å¼€è¿æ¥äº‹ä»¶ã€‚</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"><span class="keyword">let</span> port = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&quot;/&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// è§¦å‘è¿æ¥äº‹ä»¶</span></span><br><span class="line">    process.send(&#123;<span class="attr">type</span>: <span class="string">&quot;connect&quot;</span>, port&#125;);</span><br><span class="line">    <span class="comment">// æ‰“å°ä¿¡æ¯</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;HTTP Version: &quot;</span> + req.httpVersion);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Connection PORT Is &quot;</span> + port);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> msg = <span class="string">&quot;Hello My PORT is &quot;</span> + port;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å›å“åº”</span></span><br><span class="line">    res.send(&#123;msg&#125;);</span><br><span class="line">    <span class="comment">// è§¦å‘æ–­å¼€è¿æ¥äº‹ä»¶</span></span><br><span class="line">    process.send(&#123;<span class="attr">type</span>: <span class="string">&quot;disconnect&quot;</span>, port&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¥æ”¶ä¸»è¿›é€šä¿¡æ¶ˆæ¯ä¸­çš„ç«¯å£å£å¹¶ç›‘å¬</span></span><br><span class="line">process.on(<span class="string">&quot;message&quot;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (msg.type === <span class="string">&quot;port&quot;</span>) &#123;</span><br><span class="line">        port = msg.port;</span><br><span class="line">        app.listen(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;Worker Listening &quot;</span> + port);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="æœ€åæ¥çœ‹çœ‹DataBaseç±»">æœ€åæ¥çœ‹çœ‹DataBaseç±»</h2><ul><li>æˆå‘˜ï¼š</li></ul><ol><li>statusï¼šä»»åŠ¡é˜Ÿåˆ—çŠ¶æ€</li><li>urlCollectï¼šæ•°æ®ç»Ÿè®¡å¯¹è±¡ï¼ˆæä¾›ç»™å„ç®—æ³•ä½¿ç”¨ / å±•ç¤ºæ•°æ®ï¼‰<ol><li>countï¼šå¤„ç†è¯·æ±‚æ•°</li><li>costTimeï¼šå“åº”æ—¶é—´</li><li>connectionï¼šå®æ—¶è¿æ¥æ•°</li></ol></li><li>addæ–¹æ³•<ol><li>å¢åŠ è¿æ¥æ•°å’Œå®æ—¶è¿æ¥æ•°</li></ol></li><li>subæ–¹æ³•<ol><li>å‡å°‘å®æ—¶è¿æ¥æ•°</li></ol></li><li>updateCostTimeæ–¹æ³•<ol><li>æ›´æ–°å“åº”æ—¶é—´</li></ol></li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DataBase</span> </span>&#123;</span><br><span class="line">    urlCollect = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">    <span class="title">constructor</span> (<span class="params">urlObj</span>) &#123;</span><br><span class="line">        urlObj.forEach(<span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.urlCollect[val.url] = &#123;</span><br><span class="line">                count: <span class="number">0</span>,</span><br><span class="line">                costTime: <span class="number">0</span>,</span><br><span class="line">                connection: <span class="number">0</span>,</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¢åŠ è¿æ¥æ•°å’Œå®æ—¶è¿æ¥æ•°</span></span><br><span class="line">    add (port) &#123;</span><br><span class="line">        <span class="keyword">const</span> url = <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;port&#125;</span>`</span>;</span><br><span class="line">        <span class="built_in">this</span>.urlCollect[url].count++;</span><br><span class="line">        <span class="built_in">this</span>.urlCollect[url].connection++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‡å°‘å®æ—¶è¿æ¥æ•°</span></span><br><span class="line">    sub (port) &#123;</span><br><span class="line">        <span class="keyword">const</span> url = <span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span>:<span class="subst">$&#123;port&#125;</span>`</span>;</span><br><span class="line">        <span class="built_in">this</span>.urlCollect[url].connection--;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ›´æ–°å“åº”æ—¶é—´</span></span><br><span class="line">    updateCostTime (url, time) &#123;</span><br><span class="line">        <span class="built_in">this</span>.urlCollect[url].costTime = time;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æœ€ç»ˆæ•ˆæœ">æœ€ç»ˆæ•ˆæœ</h2><blockquote><p>åšäº†ä¸ªå¯è§†åŒ–å›¾è¡¨æ¥çœ‹å‡è¡¡æ•ˆæœ(Random)âœ”ï¸</p></blockquote><blockquote><p>çœ‹èµ·æ¥å‡è¡¡æ•ˆæœè¿˜ä¸é”™ğŸ§</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/(null)-20210622003557369.(null)" alt="img"></p><h1>å°ä½œä¸š</h1><blockquote><p>æƒ³æ‰‹åŠ¨å®ç°ä¸€ä¸‹è´Ÿè½½å‡è¡¡å™¨ / çœ‹çœ‹æºç çš„åŒå­¦éƒ½å¯ä»¥çœ‹çœ‹ ğŸ‘‰ğŸ»   <a href="https://github.com/LeBronChao/LoadBalancer">ä»£ç ä»“åº“</a></p></blockquote><h1>å…­ã€çŸ¥è¯†æ‰©å±•</h1><h2 id="clusterå¤šè¿›ç¨‹ä¸ºä»€ä¹ˆå¯ä»¥ç›‘å¬ä¸€ä¸ªç«¯å£">clusterå¤šè¿›ç¨‹ä¸ºä»€ä¹ˆå¯ä»¥ç›‘å¬ä¸€ä¸ªç«¯å£?</h2><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/image-20210622003752283.png" alt="image-20210622003752283"></p><ol><li>é€šè¿‡cluster.isMasteråˆ¤æ–­æ˜¯å¦ä¸ºä¸»è¿›ç¨‹ï¼Œä¸»è¿›ç¨‹ä¸è´Ÿè´£ä»»åŠ¡å¤„ç†ï¼Œåªè´Ÿè´£ç®¡ç†å’Œè°ƒåº¦å·¥ä½œå­è¿›ç¨‹ã€‚</li><li>masterä¸»è¿›ç¨‹å¯åŠ¨äº†ä¸€ä¸ªTCPæœåŠ¡å™¨ï¼ŒçœŸæ­£ç›‘å¬ç«¯å£çš„åªæœ‰è¿™ä¸ªTCPæœåŠ¡å™¨ã€‚è¯·æ±‚è§¦å‘äº†è¿™ä¸ªTCPæœåŠ¡å™¨çš„<code>connection</code>äº‹ä»¶åï¼Œé€šè¿‡å¥æŸ„è½¬å‘ï¼ˆIPCï¼‰ç»™å·¥ä½œè¿›ç¨‹å¤„ç†ã€‚<ol><li>å¥æŸ„è½¬å‘å¯è½¬å‘TCPæœåŠ¡å™¨ã€TCPå¥—æ¥å­—ã€UDPå¥—æ¥å­—ã€IPCç®¡é“</li><li>IPCåªæ”¯æŒä¼ è¾“å­—ç¬¦ä¸²ï¼Œä¸æ”¯æŒä¼ è¾“å¯¹è±¡ï¼ˆå¯åºåˆ—åŒ–ï¼‰ã€‚</li><li>è½¬å‘æµç¨‹ï¼šçˆ¶è¿›ç¨‹å‘é€ -&gt; stringfy &amp;&amp; send(fd) -&gt; IPC -&gt; get(fd) &amp;&amp; parse -&gt; å­è¿›ç¨‹æ¥æ”¶</li><li>fdä¸ºå¥æŸ„æ–‡ä»¶æè¿°ç¬¦ã€‚</li></ol></li><li>å¦‚ä½•é€‰æ‹©å·¥ä½œè¿›ç¨‹?<ol><li>clusteræ¨¡å—å†…ç½®äº†RoundRobinç®—æ³•ï¼Œè½®è¯¢é€‰æ‹©å·¥ä½œè¿›ç¨‹ã€‚</li></ol></li><li>ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨clusterè¿›è¡Œè´Ÿè½½å‡è¡¡?<ol><li>æ‰‹åŠ¨å®ç°å¯æ ¹æ®ä¸åŒåœºæ™¯é€‰æ‹©ä¸åŒçš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚</li></ol></li></ol><h2 id="Nodeæ€ä¹ˆå®ç°è¿›ç¨‹é—´é€šä¿¡çš„ï¼Ÿ">Nodeæ€ä¹ˆå®ç°è¿›ç¨‹é—´é€šä¿¡çš„ï¼Ÿ</h2><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/(null)-20210622003758932.(null)" alt="img"></p><ol><li>å¸¸è§çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼<ol><li>ç®¡é“é€šä¿¡<ol><li>åŒ¿åç®¡é“</li><li>å‘½åç®¡é“</li></ol></li><li>ä¿¡å·é‡</li><li>å…±äº«å†…å­˜</li><li>Socket</li><li>æ¶ˆæ¯é˜Ÿåˆ—</li></ol></li><li>Nodeä¸­å®ç°IPCé€šé“æ˜¯ä¾èµ–äºlibuvã€‚Windowsä¸‹ç”±å‘½åç®¡é“å®ç°ï¼Œ*nixç³»ç»Ÿåˆ™é‡‡ç”¨Domain Socketå®ç°ã€‚</li><li>è¡¨ç°åœ¨åº”ç”¨å±‚ä¸Šçš„è¿›ç¨‹é—´é€šä¿¡åªæœ‰ç®€å•çš„messageäº‹ä»¶å’Œsend()æ–¹æ³•ï¼Œæ¥å£ååˆ†ç®€æ´å’Œæ¶ˆæ¯åŒ–ã€‚</li><li>IPCç®¡é“æ˜¯å¦‚ä½•å»ºç«‹çš„ï¼Ÿ<ol><li>çˆ¶è¿›ç¨‹å…ˆé€šè¿‡ç¯å¢ƒå˜é‡å‘ŠçŸ¥å­è¿›ç¨‹ç®¡é“çš„æ–‡ä»¶æè¿°ç¬¦</li><li>çˆ¶è¿›ç¨‹åˆ›å»ºå­è¿›ç¨‹</li><li>å­è¿›ç¨‹å¯åŠ¨ï¼Œé€šè¿‡æ–‡ä»¶æè¿°ç¬¦è¿æ¥å·²å­˜åœ¨çš„IPCç®¡é“ï¼Œä¸çˆ¶è¿›ç¨‹å»ºç«‹è¿æ¥ã€‚</li></ol></li></ol><h2 id="å¤šè¿›ç¨‹-VS-å¤šçº¿ç¨‹">å¤šè¿›ç¨‹ VS å¤šçº¿ç¨‹</h2><h3 id="å¤šè¿›ç¨‹">å¤šè¿›ç¨‹</h3><ol><li>æ•°æ®å…±äº«å¤æ‚ï¼Œéœ€è¦IPCã€‚æ•°æ®æ˜¯åˆ†å¼€çš„ï¼ŒåŒæ­¥ç®€å•ã€‚</li><li>å ç”¨å†…å­˜å¤šï¼ŒCPUåˆ©ç”¨ç‡ä½ã€‚</li><li>åˆ›å»ºé”€æ¯å¤æ‚ï¼Œé€Ÿåº¦æ…¢</li><li>è¿›ç¨‹ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¼šç›¸äº’å½±å“</li><li>å¯ç”¨äºå¤šæœºå¤šæ ¸åˆ†å¸ƒå¼ï¼Œæ˜“äºæ‰©å±•</li></ol><h3 id="å¤šçº¿ç¨‹">å¤šçº¿ç¨‹</h3><ol><li>å…±äº«è¿›ç¨‹æ•°æ®ï¼Œæ•°æ®å…±äº«ç®€å•ï¼ŒåŒæ­¥å¤æ‚ã€‚</li><li>å ç”¨å†…å­˜å°‘ï¼ŒCPUåˆ©ç”¨ç‡é«˜ã€‚</li><li>åˆ›å»ºé”€æ¯ç®€å•ï¼Œé€Ÿåº¦å¿«ã€‚</li><li>çº¿ç¨‹åŒå‘¼å¸å…±å‘½è¿ã€‚</li><li>åªèƒ½ç”¨äºå¤šæ ¸åˆ†å¸ƒå¼ã€‚</li></ol><h1>ä¸ƒã€ç”±æœ¬æ¬¡åˆ†äº«äº§ç”Ÿçš„ä¸€äº›æƒ³æ³•</h1><blockquote><p>æ¬¢è¿ç•™è¨€è®¨è®º</p></blockquote><ol><li>Node.jséé˜»å¡å¼‚æ­¥I/Oé€Ÿåº¦å¿«ï¼Œå‰ç«¯æ‰©å±•æœåŠ¡ç«¯ä¸šåŠ¡ï¼Ÿ</li><li>ä¼ä¸šå®è·µï¼Œè¯´æ˜Nodeè¿˜æ˜¯å¯é çš„ï¼Ÿ<ol><li>é˜¿é‡ŒNodeä¸­å°æ¶æ„</li><li>è…¾è®¯CloudBaseäº‘å¼€å‘Node</li><li>å¤§é‡Node.jså…¨æ ˆå·¥ç¨‹å¸ˆå²—ä½</li></ol></li><li>Nodeè®¡ç®—å¯†é›†å‹ä¸å‹å¥½ï¼Ÿ<ol><li>Serverlessç››è¡Œï¼Œè®¡ç®—å¯†é›†å‹ç”¨C++/Go/Javaç¼–å†™ï¼Œä»¥Faasçš„æ–¹å¼è°ƒç”¨ã€‚</li></ol></li><li>Nodeç”Ÿæ€ä¸å¦‚å…¶ä»–æˆç†Ÿçš„è¯­è¨€<ol><li>é˜¿é‡Œè¾“å‡ºäº†Javaç”Ÿæ€</li><li>æ˜¯ä¸æ˜¯å¯ä»¥çœ‹å‡†è¶‹åŠ¿ï¼Œæ‰“é€ Nodeç”Ÿæ€ä»¥å¢å¼ºå›¢é˜Ÿå½±å“åŠ›ã€‚</li></ol></li><li>æœªé›¨ç»¸ç¼ªï¼Œå°†Node &amp; æœåŠ¡ç«¯ä¸šåŠ¡çŸ¥è¯†åŠ å…¥å­¦ä¹ è®¡åˆ’ / è§„åˆ’ä¸“é¢˜åˆ†äº«ï¼Ÿ</li><li>è®¨è®º</li></ol><ul><li><a href="https://www.zhihu.com/question/357717742/answer/926367671"> Node.js åš Web åç«¯ä¼˜åŠ¿ä¸ºä»€ä¹ˆè¿™ä¹ˆå¤§ï¼Ÿ - çŸ¥ä¹ (zhihu.com)</a></li></ul><h1>å…«ã€å‚è€ƒèµ„æ–™</h1><ol><li><a href="https://help.aliyun.com/document_detail/85958.html">å¥åº·æ£€æŸ¥æ¦‚è¿° - è´Ÿè½½å‡è¡¡</a></li><li>ã€Šæ·±å…¥æµ…å‡ºNode.jsã€‹</li><li><a href="http://nodejs.cn/">Node.js (nodejs.cn)</a></li><li><a href="https://juejin.cn/post/6844903908385488903#heading-17">æ·±å…¥ç†è§£Node.js ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹ </a></li></ol><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Load Balanceè´Ÿè½½å‡è¡¡ ğŸŒ¡&lt;/h1&gt;
&lt;p&gt;&lt;img src= &quot;/img/loading.gif&quot; data-lazy-src=&quot;https://bloginfo.lebronchao.com/doc-image/(null)-202106220028498</summary>
      
    
    
    
    <category term="è®¡ç®—æœºç½‘ç»œ" scheme="https://lebronchao.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"/>
    
    
    <category term="è®¡ç®—æœºç½‘ç»œ" scheme="https://lebronchao.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"/>
    
    <category term="è´Ÿè½½å‡è¡¡" scheme="https://lebronchao.com/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
    
    <category term="Node" scheme="https://lebronchao.com/tags/Node/"/>
    
    <category term="è¿›ç¨‹" scheme="https://lebronchao.com/tags/%E8%BF%9B%E7%A8%8B/"/>
    
    <category term="çº¿ç¨‹" scheme="https://lebronchao.com/tags/%E7%BA%BF%E7%A8%8B/"/>
    
    <category term="è¿›ç¨‹é—´é€šä¿¡" scheme="https://lebronchao.com/tags/%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/"/>
    
  </entry>
  
  <entry>
    <title>[å»ºè®®æ”¶è—]ä½ æƒ³çŸ¥é“çš„Vue3æ ¸å¿ƒæºç è¿™é‡Œéƒ½æœ‰</title>
    <link href="https://lebronchao.com/2021/07/07/Vue3%E6%A0%B8%E5%BF%83%E6%BA%90%E7%A0%81/"/>
    <id>https://lebronchao.com/2021/07/07/Vue3%E6%A0%B8%E5%BF%83%E6%BA%90%E7%A0%81/</id>
    <published>2021-07-06T17:09:08.000Z</published>
    <updated>2021-07-06T17:09:08.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Effectå’ŒReactive</h1><blockquote><p>effectä½œä¸ºVueå“åº”å¼åŸç†ä¸­çš„æ ¸å¿ƒï¼Œåœ¨Computedã€Watchã€Reactiveä¸­éƒ½æœ‰å‡ºç°</p><p>ä¸»è¦å’ŒReactive(Proxy)ã€trackã€triggerç­‰å‡½æ•°é…åˆå®ç°æ”¶é›†ä¾èµ–ï¼Œè§¦å‘ä¾èµ–æ›´æ–°</p></blockquote><ul><li>Effect<ul><li>å‰¯ä½œç”¨ä¾èµ–å‡½æ•°</li></ul></li><li>Track<ul><li>ä¾èµ–æ”¶é›†</li></ul></li><li>Trigger<ul><li>ä¾èµ–è§¦å‘</li></ul></li></ul><h2 id="Effect">Effect</h2><blockquote><p>effectå¯ä»¥è¢«ç†è§£ä¸ºä¸€ä¸ªå‰¯ä½œç”¨å‡½æ•°ï¼Œè¢«å½“åšä¾èµ–æ”¶é›†ï¼Œåœ¨å“åº”å¼æ•°æ®æ›´æ–°åè¢«è§¦å‘ã€‚</p><p>Vueçš„å“åº”å¼APIä¾‹å¦‚Computedã€Watchéƒ½æœ‰ç”¨åˆ°effectæ¥å®ç°</p></blockquote><ul><li>å…ˆæ¥çœ‹çœ‹å…¥å£å‡½æ•°<ul><li>å…¥å£å‡½æ•°ä¸»è¦æ˜¯ä¸€äº›é€»è¾‘å¤„ç†ï¼Œæ ¸å¿ƒé€»è¾‘ä½äºcreateReactiveEffect</li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">effect</span>&lt;<span class="title">T</span> = <span class="title">any</span>&gt;(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  fn: () =&gt; T,</span></span></span><br><span class="line"><span class="function"><span class="params">  options: ReactiveEffectOptions = EMPTY_OBJ</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">ReactiveEffect</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// å¦‚æœå·²ç»æ˜¯effectï¼Œåˆ™é‡ç½®</span></span><br><span class="line">  <span class="keyword">if</span> (isEffect(fn)) &#123;</span><br><span class="line">    fn = fn.raw</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// åˆ›å»ºeffect</span></span><br><span class="line">  <span class="keyword">const</span> effect = createReactiveEffect(fn, options)</span><br><span class="line">  <span class="comment">// å¦‚æœä¸æ˜¯æƒ°æ€§æ‰§è¡Œï¼Œå…ˆæ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">  <span class="keyword">if</span> (!options.lazy) &#123;</span><br><span class="line">    effect()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> effect</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>createReactiveEffect</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> effectStack: ReactiveEffect[] = []</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createReactiveEffect</span>&lt;<span class="title">T</span> = <span class="title">any</span>&gt;(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  fn: () =&gt; T,</span></span></span><br><span class="line"><span class="function"><span class="params">  options: ReactiveEffectOptions</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">ReactiveEffect</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> effect = <span class="function"><span class="keyword">function</span> <span class="title">reactiveEffect</span>(<span class="params"></span>): <span class="title">unknown</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ²¡æœ‰æ¿€æ´»ï¼Œè¯´æ˜è°ƒç”¨äº†effect stopå‡½æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (!effect.active) &#123;</span><br><span class="line">      <span class="comment">// æ— è°ƒåº¦è€…åˆ™ç›´æ¥è¿”å›ï¼Œå¦åˆ™æ‰§è¡Œfn</span></span><br><span class="line">      <span class="keyword">return</span> options.scheduler ? <span class="literal">undefined</span> : fn()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­EffectStackä¸­æœ‰æ²¡æœ‰effectï¼Œæœ‰åˆ™ä¸å¤„ç†</span></span><br><span class="line">    <span class="keyword">if</span> (!effectStack.includes(effect)) &#123;</span><br><span class="line">      <span class="comment">// æ¸…é™¤effect</span></span><br><span class="line">      cleanup(effect)</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * å¼€å§‹é‡æ–°æ”¶é›†ä¾èµ–</span></span><br><span class="line"><span class="comment">        * å‹å…¥stack</span></span><br><span class="line"><span class="comment">        * å°†effectè®¾ç½®ä¸ºactiveEffect</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        enableTracking()</span><br><span class="line">        effectStack.push(effect)</span><br><span class="line">        activeEffect = effect</span><br><span class="line">        <span class="keyword">return</span> fn()</span><br><span class="line">      &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * å®Œæˆåå°†effectå¼¹å‡º</span></span><br><span class="line"><span class="comment">        * é‡ç½®ä¾èµ–</span></span><br><span class="line"><span class="comment">        * é‡ç½®activeEffect</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        effectStack.pop()</span><br><span class="line">        resetTracking()</span><br><span class="line">        activeEffect = effectStack[effectStack.length - <span class="number">1</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">as</span> ReactiveEffect</span><br><span class="line">  effect.id = uid++ <span class="comment">// è‡ªå¢idï¼Œeffectå”¯ä¸€æ ‡è¯†</span></span><br><span class="line">  effect.allowRecurse = !!options.allowRecurse</span><br><span class="line">  effect._isEffect = <span class="literal">true</span> <span class="comment">// æ˜¯å¦æ˜¯effect</span></span><br><span class="line">  effect.active = <span class="literal">true</span>  <span class="comment">// æ˜¯å¦æ¿€æ´»</span></span><br><span class="line">  effect.raw = fn   <span class="comment">// æŒ‚è½½åŸå§‹å¯¹è±¡</span></span><br><span class="line">  effect.deps = []  <span class="comment">// å½“å‰effectçš„depæ•°ç»„</span></span><br><span class="line">  effect.options = options  <span class="comment">// ä¼ å…¥çš„options</span></span><br><span class="line">  <span class="keyword">return</span> effect</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¯æ¬¡effectè¿è¡Œéƒ½ä¼šé‡æ–°æ”¶é›†ä¾èµ–ï¼Œdepsæ˜¯effectçš„ä¾èµ–æ•°ç»„ï¼Œéœ€è¦å…¨éƒ¨æ¸…ç©º</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cleanup</span>(<span class="params">effect: ReactiveEffect</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; deps &#125; = effect</span><br><span class="line">  <span class="keyword">if</span> (deps.length) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; deps.length; i++) &#123;</span><br><span class="line">      deps[i].delete(effect)</span><br><span class="line">    &#125;</span><br><span class="line">    deps.length = <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Track">Track</h2><blockquote><p>Trackè¿™ä¸ªå‡½æ•°å¸¸å‡ºç°åœ¨reactiveçš„getterå‡½æ•°ä¸­ï¼Œç”¨äºä¾èµ–æ”¶é›†</p><p>æºç è¯¦è§£è§æ³¨é‡Š</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">track</span>(<span class="params">target: <span class="built_in">object</span>, <span class="keyword">type</span>: TrackOpTypes, key: unknown</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// activeEffectä¸ºç©ºè¡¨ç¤ºæ²¡æœ‰ä¾èµ–</span></span><br><span class="line">  <span class="keyword">if</span> (!shouldTrack || activeEffect === <span class="literal">undefined</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// targetMapä¾èµ–ç®¡ç†Mapï¼Œç”¨äºæ”¶é›†ä¾èµ–</span></span><br><span class="line">  <span class="comment">// æ£€æŸ¥targetMapä¸­æœ‰æ²¡æœ‰targetï¼Œæ²¡æœ‰åˆ™æ–°å»º</span></span><br><span class="line">  <span class="keyword">let</span> depsMap = targetMap.get(target)</span><br><span class="line">  <span class="keyword">if</span> (!depsMap) &#123;</span><br><span class="line">    targetMap.set(target, (depsMap = <span class="keyword">new</span> <span class="built_in">Map</span>()))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// depç”¨æ¥æ”¶é›†ä¾èµ–å‡½æ•°ï¼Œå½“ç›‘å¬çš„keyå€¼å‘ç”Ÿå˜åŒ–ï¼Œè§¦å‘depä¸­çš„ä¾èµ–å‡½æ•°æ›´æ–°</span></span><br><span class="line">  <span class="keyword">let</span> dep = depsMap.get(key)</span><br><span class="line">  <span class="keyword">if</span> (!dep) &#123;</span><br><span class="line">    depsMap.set(key, (dep = <span class="keyword">new</span> <span class="built_in">Set</span>()))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!dep.has(activeEffect)) &#123;</span><br><span class="line">    dep.add(activeEffect)</span><br><span class="line">    activeEffect.deps.push(dep)</span><br><span class="line">    <span class="comment">// å¼€å‘ç¯å¢ƒä¼šè§¦å‘onTrackï¼Œä»…ç”¨äºè°ƒè¯•</span></span><br><span class="line">    <span class="keyword">if</span> (__DEV__ &amp;&amp; activeEffect.options.onTrack) &#123;</span><br><span class="line">      activeEffect.options.onTrack(&#123;</span><br><span class="line">        effect: activeEffect,</span><br><span class="line">        target,</span><br><span class="line">        <span class="keyword">type</span>,</span><br><span class="line">        key</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Trigger">Trigger</h2><blockquote><p>Triggerå¸¸å‡ºç°åœ¨reactiveä¸­çš„setterå‡½æ•°ä¸­ï¼Œç”¨äºè§¦å‘ä¾èµ–æ›´æ–°</p><p>æºç è¯¦è§£è§æ³¨é‡Š</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trigger</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  target: <span class="built_in">object</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  <span class="keyword">type</span>: TriggerOpTypes,</span></span></span><br><span class="line"><span class="function"><span class="params">  key?: unknown,</span></span></span><br><span class="line"><span class="function"><span class="params">  newValue?: unknown,</span></span></span><br><span class="line"><span class="function"><span class="params">  oldValue?: unknown,</span></span></span><br><span class="line"><span class="function"><span class="params">  oldTarget?: <span class="built_in">Map</span>&lt;unknown, unknown&gt; | <span class="built_in">Set</span>&lt;unknown&gt;</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// è·å–ä¾èµ–Mapï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸éœ€è¦è§¦å‘</span></span><br><span class="line">  <span class="keyword">const</span> depsMap = targetMap.get(target)</span><br><span class="line">  <span class="keyword">if</span> (!depsMap) &#123;</span><br><span class="line">    <span class="comment">// never been tracked</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä½¿ç”¨Setä¿å­˜éœ€è¦è§¦å‘çš„effectï¼Œé¿å…é‡å¤</span></span><br><span class="line">  <span class="keyword">const</span> effects = <span class="keyword">new</span> <span class="built_in">Set</span>&lt;ReactiveEffect&gt;()</span><br><span class="line">  <span class="comment">// å®šä¹‰ä¾èµ–æ·»åŠ å‡½æ•°</span></span><br><span class="line">  <span class="keyword">const</span> add = <span class="function">(<span class="params">effectsToAdd: <span class="built_in">Set</span>&lt;ReactiveEffect&gt; | <span class="literal">undefined</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (effectsToAdd) &#123;</span><br><span class="line">      effectsToAdd.forEach(<span class="function"><span class="params">effect</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (effect !== activeEffect || effect.allowRecurse) &#123;</span><br><span class="line">          effects.add(effect)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å°†depsMapä¸­çš„ä¾èµ–æ·»åŠ åˆ°effectsä¸­</span></span><br><span class="line">  <span class="comment">// åªä¸ºäº†ç†è§£å’ŒåŸç†çš„è¯   å„ä¸ªåˆ†æ”¯ä¸ç”¨ç»†çœ‹</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">type</span> === TriggerOpTypes.CLEAR) &#123;</span><br><span class="line">    <span class="comment">// collection being cleared</span></span><br><span class="line">    <span class="comment">// trigger all effects for target</span></span><br><span class="line">    depsMap.forEach(add)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key === <span class="string">&#x27;length&#x27;</span> &amp;&amp; isArray(target)) &#123;</span><br><span class="line">    depsMap.forEach(<span class="function">(<span class="params">dep, key</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (key === <span class="string">&#x27;length&#x27;</span> || key &gt;= (newValue <span class="keyword">as</span> <span class="built_in">number</span>)) &#123;</span><br><span class="line">        add(dep)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// schedule runs for SET | ADD | DELETE</span></span><br><span class="line">    <span class="keyword">if</span> (key !== <span class="built_in">void</span> <span class="number">0</span>) &#123;</span><br><span class="line">      add(depsMap.get(key))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// also run for iteration key on ADD | DELETE | Map.SET</span></span><br><span class="line">    <span class="keyword">switch</span> (<span class="keyword">type</span>) &#123;</span><br><span class="line">      <span class="keyword">case</span> TriggerOpTypes.ADD:</span><br><span class="line">        <span class="keyword">if</span> (!isArray(target)) &#123;</span><br><span class="line">          add(depsMap.get(ITERATE_KEY))</span><br><span class="line">          <span class="keyword">if</span> (isMap(target)) &#123;</span><br><span class="line">            add(depsMap.get(MAP_KEY_ITERATE_KEY))</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isIntegerKey(key)) &#123;</span><br><span class="line">          <span class="comment">// new index added to array -&gt; length changes</span></span><br><span class="line">          add(depsMap.get(<span class="string">&#x27;length&#x27;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">case</span> TriggerOpTypes.DELETE:</span><br><span class="line">        <span class="keyword">if</span> (!isArray(target)) &#123;</span><br><span class="line">          add(depsMap.get(ITERATE_KEY))</span><br><span class="line">          <span class="keyword">if</span> (isMap(target)) &#123;</span><br><span class="line">            add(depsMap.get(MAP_KEY_ITERATE_KEY))</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">case</span> TriggerOpTypes.SET:</span><br><span class="line">        <span class="keyword">if</span> (isMap(target)) &#123;</span><br><span class="line">          add(depsMap.get(ITERATE_KEY))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å°è£…effectsæ‰§è¡Œå‡½æ•°</span></span><br><span class="line">  <span class="keyword">const</span> run = <span class="function">(<span class="params">effect: ReactiveEffect</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (__DEV__ &amp;&amp; effect.options.onTrigger) &#123;</span><br><span class="line">      effect.options.onTrigger(&#123;</span><br><span class="line">        effect,</span><br><span class="line">        target,</span><br><span class="line">        key,</span><br><span class="line">        <span class="keyword">type</span>,</span><br><span class="line">        newValue,</span><br><span class="line">        oldValue,</span><br><span class="line">        oldTarget</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦‚æœå­˜åœ¨scheduleråˆ™è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">if</span> (effect.options.scheduler) &#123;</span><br><span class="line">      effect.options.scheduler(effect)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      effect()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è§¦å‘effectsä¸­çš„æ‰€æœ‰ä¾èµ–å‡½æ•°</span></span><br><span class="line">  effects.forEach(run)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Reactive">Reactive</h2><blockquote><p>äº†è§£äº†Trackç”¨äºä¾èµ–æ”¶é›†ï¼ŒTriggerç”¨äºä¾èµ–è§¦å‘ï¼Œé‚£ä¹ˆä»–ä»¬çš„è°ƒç”¨æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™å‘¢?æ¥çœ‹çœ‹Reactiveçš„æºç å°±æ¸…æ¥šäº†ï¼Œæºç è¯¦è§£è§æ³¨é‡Šã€‚</p><p>æ³¨ï¼šæºç ç»“æ„è¾ƒä¸ºå¤æ‚ï¼ˆå°è£…ï¼‰ï¼Œä¸ºä¾¿äºç†è§£åŸç†ï¼Œä»¥ä¸‹ä¸ºç®€åŒ–æºç ã€‚</p></blockquote><ul><li>æ€»ç»“æ¥è¯´<ul><li>åœ¨getteræ—¶è¿›è¡Œä¾èµ–æ”¶é›†</li><li>åœ¨setteræ—¶è§¦å‘ä¾èµ–æ›´æ–°</li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reactive</span>(<span class="params">target:<span class="built_in">object</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(target,&#123;</span><br><span class="line">        <span class="function"><span class="title">get</span>(<span class="params">target: Target, key: <span class="built_in">string</span> | symbol, receiver: <span class="built_in">object</span></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="built_in">Reflect</span>.get(target, key, receiver)</span><br><span class="line">            track(target, TrackOpTypes.GET, key)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="title">set</span>(<span class="params">target: <span class="built_in">object</span>, key: <span class="built_in">string</span> | symbol, value: unknown, receiver: <span class="built_in">object</span></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">let</span> oldValue = (target <span class="keyword">as</span> <span class="built_in">any</span>)[key]</span><br><span class="line">            <span class="keyword">const</span> result = <span class="built_in">Reflect</span>.set(target, key, value, receiver)</span><br><span class="line">            <span class="comment">// trigger(target, TriggerOpTypes.ADD, key, value)</span></span><br><span class="line">            trigger(target, TriggerOpTypes.SET, key, value, oldValue)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>Computed</h1><blockquote><p>Computedæ˜¯Vueä¸­å¸¸ç”¨ä¸”å¥½ç”¨çš„ä¸€ä¸ªå±æ€§ï¼Œè¿™ä¸ªå±æ€§çš„å€¼åœ¨ä¾èµ–æ”¹å˜ååŒæ­¥è¿›è¡Œæ”¹å˜ï¼Œåœ¨ä¾èµ–æœªæ”¹å˜æ—¶ä½¿ç”¨ç¼“å­˜çš„å€¼ã€‚</p></blockquote><ul><li>Vue2<ul><li>åœ¨Vue2ä¸­Computedçš„å®ç°é€šè¿‡åµŒå¥—watcherï¼Œå®ç°å“åº”å¼æ•°æ®çš„ä¾èµ–æ”¶é›†ï¼Œé—´æ¥é“¾å¼è§¦å‘ä¾èµ–æ›´æ–°ã€‚</li></ul></li><li>Vue3ä¸­å‡ºç°äº†effectï¼Œé‡æ–°å®ç°äº†Computedå±æ€§<ul><li>effectå¯ä»¥è¢«ç†è§£ä¸ºå‰¯ä½œç”¨å‡½æ•°ï¼Œè¢«å½“åšä¾èµ–æ”¶é›†ï¼Œåœ¨å“åº”å¼æ•°æ®æ›´æ–°åè¢«è§¦å‘ã€‚</li></ul></li></ul><blockquote><p>Show me the Code</p></blockquote><ul><li>è¯»å®Œè¿™æ®µcomputedå‡½æ•°ä¼šå‘ç°ï¼Œè¿™é‡Œåªæ˜¯åšäº†ç®€è¦çš„getterå’Œsetterçš„èµ‹å€¼å¤„ç†<ul><li>computedæ”¯æŒä¸¤ç§å†™æ³•<ul><li>å‡½æ•°</li><li>getterã€setter</li></ul></li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">computed</span>&lt;<span class="title">T</span>&gt;(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  getterOrOptions: ComputedGetter&lt;T&gt; | WritableComputedOptions&lt;T&gt;</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> getter: ComputedGetter&lt;T&gt;</span><br><span class="line">  <span class="keyword">let</span> setter: ComputedSetter&lt;T&gt;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (isFunction(getterOrOptions)) &#123;</span><br><span class="line">    getter = getterOrOptions</span><br><span class="line">    setter = __DEV__</span><br><span class="line">      ? <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.warn(<span class="string">&#x27;Write operation failed: computed value is readonly&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      : NOOP</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    getter = getterOrOptions.get</span><br><span class="line">    setter = getterOrOptions.set</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> ComputedRefImpl(</span><br><span class="line">    getter,</span><br><span class="line">    setter,</span><br><span class="line">    isFunction(getterOrOptions) || !getterOrOptions.set</span><br><span class="line">  ) <span class="keyword">as</span> <span class="built_in">any</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ ¸å¿ƒé€»è¾‘éƒ½åœ¨ComputedRefImplä¸­ï¼Œæˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹<ul><li>é€šè¿‡dirtyå˜é‡æ ‡è®°æ•°æ®æ˜¯å¦ä¸ºæ—§æ•°æ®</li><li>åœ¨å“åº”å¼æ•°æ®æ›´æ–°åå°†dirtyèµ‹å€¼ä¸ºtrue</li><li>åœ¨ä¸‹ä¸€æ¬¡getæ—¶ï¼Œdirtyä¸ºtrueæ—¶è¿›è¡Œé‡æ–°è®¡ç®—ï¼Œå¹¶å°†dirtyèµ‹å€¼ä¸ºfalse</li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComputedRefImpl</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> _value!: T</span><br><span class="line">  <span class="keyword">private</span> _dirty = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">readonly</span> effect: ReactiveEffect&lt;T&gt;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">readonly</span> __v_isRef = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">readonly</span> [ReactiveFlags.IS_READONLY]: <span class="built_in">boolean</span></span><br><span class="line"></span><br><span class="line">  <span class="title">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    getter: ComputedGetter&lt;T&gt;,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> <span class="keyword">readonly</span> _setter: ComputedSetter&lt;T&gt;,</span></span><br><span class="line"><span class="params">    isReadonly: <span class="built_in">boolean</span></span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>.effect = effect(getter, &#123;</span><br><span class="line">      lazy: <span class="literal">true</span>,</span><br><span class="line">      <span class="comment">// å“åº”å¼æ•°æ®æ›´æ–°åå°†dirtyèµ‹å€¼ä¸ºtrue</span></span><br><span class="line">      <span class="comment">// ä¸‹æ¬¡æ‰§è¡Œgetteråˆ¤æ–­dirtyä¸ºtrueå³é‡æ–°è®¡ç®—computedå€¼</span></span><br><span class="line">      scheduler: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">this</span>._dirty) &#123;</span><br><span class="line">          <span class="built_in">this</span>._dirty = <span class="literal">true</span></span><br><span class="line">          <span class="comment">// æ´¾å‘æ‰€æœ‰å¼•ç”¨å½“å‰è®¡ç®—å±æ€§çš„å‰¯ä½œç”¨å‡½æ•°effect </span></span><br><span class="line">          trigger(toRaw(<span class="built_in">this</span>), TriggerOpTypes.SET, <span class="string">&#x27;value&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>[ReactiveFlags.IS_READONLY] = isReadonly</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">value</span>() &#123;</span><br><span class="line">    <span class="comment">// the computed ref may get wrapped by other proxies e.g. readonly() #3376</span></span><br><span class="line">    <span class="keyword">const</span> self = toRaw(<span class="built_in">this</span>)</span><br><span class="line">    <span class="comment">// å½“å“åº”å¼æ•°æ®æ›´æ–°ådirtyä¸ºtrue</span></span><br><span class="line">    <span class="comment">// é‡æ–°è®¡ç®—æ•°æ®åï¼Œå°†dirtyèµ‹å€¼ä¸ºfalse</span></span><br><span class="line">    <span class="keyword">if</span> (self._dirty) &#123;</span><br><span class="line">      self._value = <span class="built_in">this</span>.effect()</span><br><span class="line">      self._dirty = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä¾èµ–æ”¶é›†</span></span><br><span class="line">    track(self, TrackOpTypes.GET, <span class="string">&#x27;value&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¿”å›è®¡ç®—åçš„å€¼</span></span><br><span class="line">    <span class="keyword">return</span> self._value</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">set</span> <span class="title">value</span>(<span class="params">newValue: T</span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>._setter(newValue)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>Watch</h1><blockquote><p>Watchä¸»è¦ç”¨äºå¯¹æŸä¸ªå˜é‡çš„ç›‘å¬ï¼Œå¹¶åšç›¸åº”çš„å¤„ç†</p><p>Vue3ä¸­ä¸ä»…é‡æ„äº†watchï¼Œè¿˜å¤šäº†ä¸€ä¸ªWatchEffect API</p></blockquote><ul><li>Watch</li></ul><blockquote><p>ç”¨äºå¯¹æŸä¸ªå˜é‡çš„ç›‘å¬ï¼ŒåŒæ—¶å¯ä»¥é€šè¿‡callBackæ‹¿åˆ°æ–°å€¼å’Œæ—§å€¼</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">watch(state, <span class="function">(<span class="params">state, prevState</span>)=&gt;</span>&#123;&#125;)</span><br></pre></td></tr></table></figure><ul><li>WatchEffect</li></ul><blockquote><p>æ¯æ¬¡æ›´æ–°éƒ½ä¼šæ‰§è¡Œï¼Œè‡ªåŠ¨æ”¶é›†ä½¿ç”¨åˆ°çš„ä¾èµ–</p></blockquote><blockquote><p>æ— æ³•è·å–åˆ°æ–°å€¼å’Œæ—§å€¼ï¼Œå¯æ‰‹åŠ¨åœæ­¢ç›‘å¬</p></blockquote><blockquote><p><code>onInvalidate(fn)</code>ä¼ å…¥çš„å›è°ƒä¼šåœ¨ <code>watchEffect</code> é‡æ–°è¿è¡Œæˆ–è€… <code>watchEffect</code> åœæ­¢çš„æ—¶å€™æ‰§è¡Œ</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> stop = watchEffect(<span class="function">(<span class="params">onInvalidate</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    onInvalidate(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)    </span><br><span class="line"><span class="comment">// æ‰‹åŠ¨åœæ­¢ç›‘å¬</span></span><br><span class="line">stop()</span><br></pre></td></tr></table></figure><h2 id="watchå’ŒwatchEffectçš„ä¸åŒç‚¹">watchå’ŒwatchEffectçš„ä¸åŒç‚¹</h2><ul><li>watchæƒ°æ€§æ‰§è¡Œï¼ŒwatchEffectæ¯æ¬¡ä»£ç åŠ è½½éƒ½ä¼šæ‰§è¡Œ</li><li>watchå¯æŒ‡å®šç›‘å¬å˜é‡ï¼ŒwatchEffectè‡ªåŠ¨ä¾èµ–æ”¶é›†</li><li>watchå¯è·å–æ–°æ—§å€¼ï¼ŒwatchEffectä¸è¡Œ</li><li>watchEffectæœ‰onInvalidateåŠŸèƒ½ï¼Œwatchæ²¡æœ‰</li><li>watchåªå¯ç›‘å¬refã€reactiveç­‰å¯¹è±¡ï¼ŒwatchEffectåªå¯ç›‘å¬å…·ä½“å±æ€§</li></ul><h2 id="Source-Code">Source Code</h2><blockquote><p>Show me the Code</p></blockquote><ul><li>è¿™é‡Œå¯ä»¥çœ‹åˆ°watchå’ŒwatchEffetçš„æ ¸å¿ƒé€»è¾‘éƒ½å°è£…åˆ°äº†doWatchä¸­</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// watch</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">watch</span>&lt;<span class="title">T</span> = <span class="title">any</span>, <span class="title">Immediate</span> <span class="title">extends</span> <span class="title">Readonly</span>&lt;<span class="title">boolean</span>&gt; = <span class="title">false</span>&gt;(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  source: T | WatchSource&lt;T&gt;,</span></span></span><br><span class="line"><span class="function"><span class="params">  cb: <span class="built_in">any</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  options?: WatchOptions&lt;Immediate&gt;</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">WatchStopHandle</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (__DEV__ &amp;&amp; !isFunction(cb)) &#123;</span><br><span class="line">    warn(</span><br><span class="line">      <span class="string">`\`watch(fn, options?)\` signature has been moved to a separate API. `</span> +</span><br><span class="line">        <span class="string">`Use \`watchEffect(fn, options?)\` instead. \`watch\` now only `</span> +</span><br><span class="line">        <span class="string">`supports \`watch(source, cb, options?) signature.`</span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> doWatch(source <span class="keyword">as</span> <span class="built_in">any</span>, cb, options)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">watchEffect</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  effect: WatchEffect,</span></span></span><br><span class="line"><span class="function"><span class="params">  options?: WatchOptionsBase</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">WatchStopHandle</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> doWatch(effect, <span class="literal">null</span>, options)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>doWatch</li></ul><blockquote><p>ä»¥ä¸‹ä¸ºåˆ å‡ç‰ˆæºç ï¼Œç†è§£æ ¸å¿ƒåŸç†å³å¯</p><p>è¯¦æƒ…è§æ³¨é‡Š</p></blockquote><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doWatch</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  source: WatchSource | WatchSource[] | WatchEffect | object,</span></span></span><br><span class="line"><span class="function"><span class="params">  cb: WatchCallback | <span class="literal">null</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  &#123; immediate, deep, flush, onTrack, onTrigger &#125;: WatchOptions = EMPTY_OBJ,</span></span></span><br><span class="line"><span class="function"><span class="params">  instance = currentInstance</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">WatchStopHandle</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> getter: <span class="function">() =&gt;</span> any</span><br><span class="line">  <span class="keyword">let</span> forceTrigger = <span class="literal">false</span></span><br><span class="line">  <span class="keyword">let</span> isMultiSource = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¯¹ä¸åŒçš„æƒ…å†µåšgetterèµ‹å€¼</span></span><br><span class="line">  <span class="keyword">if</span> (isRef(source)) &#123;</span><br><span class="line">    <span class="comment">// refé€šè¿‡.valueè·å–</span></span><br><span class="line">    getter = <span class="function">() =&gt;</span> (source <span class="keyword">as</span> Ref).value</span><br><span class="line">    forceTrigger = !!(source <span class="keyword">as</span> Ref)._shallow</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isReactive(source)) &#123;</span><br><span class="line">    <span class="comment">// reactiveç›´æ¥è·å–</span></span><br><span class="line">    getter = <span class="function">() =&gt;</span> source</span><br><span class="line">    deep = <span class="literal">true</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isArray(source)) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯æ•°ç»„ï¼Œåšéå†å¤„ç†</span></span><br><span class="line">    isMultiSource = <span class="literal">true</span></span><br><span class="line">    forceTrigger = source.some(isReactive)</span><br><span class="line">    getter = <span class="function">() =&gt;</span></span><br><span class="line">      source.map(<span class="function"><span class="params">s</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isRef(s)) &#123;</span><br><span class="line">          <span class="keyword">return</span> s.value</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isReactive(s)) &#123;</span><br><span class="line">          <span class="keyword">return</span> traverse(s)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isFunction(s)) &#123;</span><br><span class="line">          <span class="keyword">return</span> callWithErrorHandling(s, instance, ErrorCodes.WATCH_GETTER, [</span><br><span class="line">            instance &amp;&amp; (instance.proxy <span class="keyword">as</span> any)</span><br><span class="line">          ])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          __DEV__ &amp;&amp; warnInvalidSource(s)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isFunction(source)) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯å‡½æ•°çš„æƒ…å†µ</span></span><br><span class="line">    <span class="comment">// æœ‰cbåˆ™ä¸ºwatchï¼Œæ²¡æœ‰åˆ™ä¸ºwatchEffect</span></span><br><span class="line">    <span class="keyword">if</span> (cb) &#123;</span><br><span class="line">      <span class="comment">// getter with cb</span></span><br><span class="line">      getter = <span class="function">() =&gt;</span></span><br><span class="line">        callWithErrorHandling(source, instance, ErrorCodes.WATCH_GETTER, [</span><br><span class="line">          instance &amp;&amp; (instance.proxy <span class="keyword">as</span> any)</span><br><span class="line">        ])</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// no cb -&gt; simple effect</span></span><br><span class="line">      getter = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance &amp;&amp; instance.isUnmounted) &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cleanup) &#123;</span><br><span class="line">          cleanup()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> callWithAsyncErrorHandling(</span><br><span class="line">          source,</span><br><span class="line">          instance,</span><br><span class="line">          ErrorCodes.WATCH_CALLBACK,</span><br><span class="line">          [onInvalidate]</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// å¼‚å¸¸æƒ…å†µ</span></span><br><span class="line">    getter = NOOP</span><br><span class="line">    <span class="comment">// æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    __DEV__ &amp;&amp; warnInvalidSource(source)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ·±åº¦ç›‘å¬é€»è¾‘å¤„ç†</span></span><br><span class="line">  <span class="keyword">if</span> (cb &amp;&amp; deep) &#123;</span><br><span class="line">    <span class="keyword">const</span> baseGetter = getter</span><br><span class="line">    getter = <span class="function">() =&gt;</span> traverse(baseGetter())</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> cleanup: <span class="function">() =&gt;</span> <span class="keyword">void</span></span><br><span class="line">  <span class="keyword">let</span> onInvalidate: InvalidateCbRegistrator = <span class="function">(<span class="params">fn: () =&gt; <span class="keyword">void</span></span>) =&gt;</span> &#123;</span><br><span class="line">    cleanup = runner.options.onStop = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      callWithErrorHandling(fn, instance, ErrorCodes.WATCH_CLEANUP)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è®°å½•oldValueï¼Œå¹¶é€šè¿‡runnerè·å–newValue</span></span><br><span class="line">  <span class="comment">// callbackçš„å°è£…å¤„ç†ä¸ºjob</span></span><br><span class="line">  <span class="keyword">let</span> oldValue = isMultiSource ? [] : INITIAL_WATCHER_VALUE</span><br><span class="line">  <span class="keyword">const</span> job: SchedulerJob = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!runner.active) &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (cb) &#123;</span><br><span class="line">      <span class="comment">// watch(source, cb)</span></span><br><span class="line">      <span class="keyword">const</span> newValue = runner()</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        deep ||</span><br><span class="line">        forceTrigger ||</span><br><span class="line">        (isMultiSource</span><br><span class="line">          ? (newValue <span class="keyword">as</span> any[]).some(<span class="function">(<span class="params">v, i</span>) =&gt;</span></span><br><span class="line">              hasChanged(v, (oldValue <span class="keyword">as</span> any[])[i])</span><br><span class="line">            )</span><br><span class="line">          : hasChanged(newValue, oldValue)) ||</span><br><span class="line">        (__COMPAT__ &amp;&amp;</span><br><span class="line">          isArray(newValue) &amp;&amp;</span><br><span class="line">          isCompatEnabled(DeprecationTypes.WATCH_ARRAY, instance))</span><br><span class="line">      ) &#123;</span><br><span class="line">        <span class="comment">// cleanup before running cb again</span></span><br><span class="line">        <span class="keyword">if</span> (cleanup) &#123;</span><br><span class="line">          cleanup()</span><br><span class="line">        &#125;</span><br><span class="line">        callWithAsyncErrorHandling(cb, instance, ErrorCodes.WATCH_CALLBACK, [</span><br><span class="line">          newValue,</span><br><span class="line">          <span class="comment">// pass undefined as the old value when it&#x27;s changed for the first time</span></span><br><span class="line">          oldValue === INITIAL_WATCHER_VALUE ? <span class="literal">undefined</span> : oldValue,</span><br><span class="line">          onInvalidate</span><br><span class="line">        ])</span><br><span class="line">        oldValue = newValue</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// watchEffect</span></span><br><span class="line">      runner()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// important: mark the job as a watcher callback so that scheduler knows</span></span><br><span class="line">  <span class="comment">// it is allowed to self-trigger (#1727)</span></span><br><span class="line">  job.allowRecurse = !!cb</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// é€šè¿‡è¯»å–é…ç½®ï¼Œå¤„ç†jobçš„è§¦å‘æ—¶æœº</span></span><br><span class="line">  <span class="comment">// å¹¶å†æ¬¡å°†jobçš„æ‰§è¡Œå°è£…åˆ°schedulerä¸­</span></span><br><span class="line">  <span class="keyword">let</span> scheduler: ReactiveEffectOptions[<span class="string">&#x27;scheduler&#x27;</span>]</span><br><span class="line">  <span class="keyword">if</span> (flush === <span class="string">&#x27;sync&#x27;</span>) &#123; <span class="comment">// åŒæ­¥æ‰§è¡Œ</span></span><br><span class="line">    scheduler = job</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (flush === <span class="string">&#x27;post&#x27;</span>) &#123; <span class="comment">// æ›´æ–°åæ‰§è¡Œ</span></span><br><span class="line">    scheduler = <span class="function">() =&gt;</span> queuePostRenderEffect(job, instance &amp;&amp; instance.suspense)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// default: &#x27;pre&#x27;</span></span><br><span class="line">    <span class="comment">// æ›´æ–°å‰æ‰§è¡Œ</span></span><br><span class="line">    scheduler = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!instance || instance.isMounted) &#123;</span><br><span class="line">        queuePreFlushCb(job)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// with &#x27;pre&#x27; option, the first call must happen before</span></span><br><span class="line">        <span class="comment">// the component is mounted so it is called synchronously.</span></span><br><span class="line">        job()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä½¿ç”¨effectå‰¯ä½œç”¨å¤„ç†ä¾èµ–æ”¶é›†ï¼Œåœ¨ä¾èµ–æ›´æ–°åè°ƒç”¨schedulerï¼ˆå…¶ä¸­å°è£…äº†callbackçš„æ‰§è¡Œï¼‰</span></span><br><span class="line">  <span class="keyword">const</span> runner = effect(getter, &#123;</span><br><span class="line">    lazy: <span class="literal">true</span>,</span><br><span class="line">    onTrack,</span><br><span class="line">    onTrigger,</span><br><span class="line">    scheduler</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ”¶é›†ä¾èµ–</span></span><br><span class="line">  recordInstanceBoundEffect(runner, instance)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¯»å–é…ç½®ï¼Œè¿›è¡Œwatchåˆå§‹åŒ–</span></span><br><span class="line">  <span class="comment">// æ˜¯å¦æœ‰cb</span></span><br><span class="line">  <span class="keyword">if</span> (cb) &#123;</span><br><span class="line">    <span class="comment">// æ˜¯å¦ç«‹åˆ»æ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">if</span> (immediate) &#123;</span><br><span class="line">      job()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      oldValue = runner()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (flush === <span class="string">&#x27;post&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// æ˜¯å¦æ›´æ–°åæ‰§è¡Œ</span></span><br><span class="line">    queuePostRenderEffect(runner, instance &amp;&amp; instance.suspense)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    runner()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿”å›æ‰‹åŠ¨åœæ­¢å‡½æ•°</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    stop(runner)</span><br><span class="line">    <span class="keyword">if</span> (instance) &#123;</span><br><span class="line">      remove(instance.effects!, runner)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>Mixin</h1><blockquote><p>Mixinæ„ä¸ºæ··åˆï¼Œæ˜¯å…¬å…±é€»è¾‘å°è£…åˆ©å™¨ã€‚</p><p>åŸç†æ¯”è¾ƒç®€å•ï¼Œé‚£å°±æ˜¯åˆå¹¶ã€‚</p></blockquote><ul><li>åˆå¹¶åˆ†ä¸ºå¯¹è±¡çš„åˆå¹¶å’Œç”Ÿå‘½å‘¨æœŸçš„åˆå¹¶<ul><li>å¯¹è±¡ï¼ŒmergeOption<ul><li>ç±»å‹Object.assignçš„åˆå¹¶ï¼Œä¼šå‡ºç°è¦†ç›–ç°è±¡</li></ul></li><li>ç”Ÿå‘½å‘¨æœŸï¼ŒmergeHook<ul><li>åˆå¹¶ä¼šå°†ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸæ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¾æ¬¡è°ƒç”¨</li></ul></li></ul></li><li>mergeOptions</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeOptions</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  to: <span class="built_in">any</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  <span class="keyword">from</span>: <span class="built_in">any</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  instance?: ComponentInternalInstance | <span class="literal">null</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  strats = instance &amp;&amp; instance.appContext.config.optionMergeStrategies</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (__COMPAT__ &amp;&amp; isFunction(<span class="keyword">from</span>)) &#123;</span><br><span class="line">    <span class="keyword">from</span> = <span class="keyword">from</span>.options</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; mixins, <span class="attr">extends</span>: extendsOptions &#125; = <span class="keyword">from</span></span><br><span class="line"></span><br><span class="line">  extendsOptions &amp;&amp; mergeOptions(to, extendsOptions, instance, strats)</span><br><span class="line">  mixins &amp;&amp;</span><br><span class="line">    mixins.forEach(<span class="function">(<span class="params">m: ComponentOptionsMixin</span>) =&gt;</span></span><br><span class="line">      mergeOptions(to, m, instance, strats)</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">   <span class="comment">// å¯¹mixinä¸­çš„å¯¹è±¡è¿›è¡Œéå†</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> <span class="keyword">from</span>) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœå­˜åœ¨åˆ™è¿›è¡Œè¦†ç›–å¤„ç†</span></span><br><span class="line">    <span class="keyword">if</span> (strats &amp;&amp; hasOwn(strats, key)) &#123;</span><br><span class="line">      to[key] = strats[key](to[key], <span class="keyword">from</span>[key], instance &amp;&amp; instance.proxy, key)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœä¸å­˜åœ¨åˆ™ç›´æ¥èµ‹å€¼</span></span><br><span class="line">      to[key] = <span class="keyword">from</span>[key]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> to</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>mergeHook</li></ul><blockquote><p>ç®€å•ç²—æš´æ”¾è¿›Setï¼Œè°ƒç”¨æ—¶ä¾æ¬¡è°ƒç”¨</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeHook</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  to: <span class="built_in">Function</span>[] | <span class="built_in">Function</span> | <span class="literal">undefined</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  <span class="keyword">from</span>: <span class="built_in">Function</span> | <span class="built_in">Function</span>[]</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>([...toArray(to), ...toArray(<span class="keyword">from</span>)]))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>Vuex4</h1><blockquote><p>Vuexæ˜¯åœ¨Vueä¸­å¸¸ç”¨çš„çŠ¶æ€ç®¡ç†åº“ï¼Œåœ¨Vue3å‘å¸ƒåï¼Œè¿™ä¸ªçŠ¶æ€ç®¡ç†åº“ä¹Ÿéšä¹‹å‘å‡ºäº†é€‚é…Vue3çš„Vuex4</p></blockquote><h2 id="å¿«é€Ÿè¿‡Vuex3-xåŸç†">å¿«é€Ÿè¿‡Vuex3.xåŸç†</h2><ul><li><p>ä¸ºä»€ä¹ˆæ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥é€šè¿‡</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">this</span>.$store</span><br></pre></td></tr></table></figure><p>è®¿é—®åˆ°storeæ•°æ®ï¼Ÿ</p><ul><li>åœ¨beforeCreateæ—¶ï¼Œé€šè¿‡mixinçš„æ–¹å¼æ³¨å…¥äº†store</li></ul></li><li><p>ä¸ºä»€ä¹ˆVuexä¸­çš„æ•°æ®éƒ½æ˜¯å“åº”å¼çš„</p><ul><li>åˆ›å»ºstoreçš„æ—¶å€™è°ƒç”¨çš„æ˜¯<code>new Vue</code>,åˆ›å»ºäº†ä¸€ä¸ªVueå®ä¾‹ï¼Œç›¸å½“äºå€Ÿç”¨äº†Vueçš„å“åº”å¼ã€‚</li></ul></li><li><p>mapXxxxæ˜¯æ€ä¹ˆè·å–åˆ°storeä¸­çš„æ•°æ®å’Œæ–¹æ³•çš„</p><ul><li>mapXxxxåªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œåº•å±‚å®ç°ä¹Ÿæ˜¯ä»$storeä¸­è·å–ç„¶åè¿”å›åˆ°computed / methodsä¸­ã€‚</li></ul></li></ul><blockquote><p>æ€»çš„æ¥çœ‹ï¼Œå¯ä»¥æŠŠVue3.xç†è§£ä¸ºä¸€ä¸ªæ¯ä¸ªç»„ä»¶éƒ½æ³¨å…¥äº†çš„mixin?</p></blockquote><h2 id="Vuex4åŸç†æ¢ç©¶">Vuex4åŸç†æ¢ç©¶</h2><blockquote><p>å»é™¤å†—ä½™ä»£ç çœ‹æœ¬è´¨</p></blockquote><h3 id="createStore">createStore</h3><ul><li>ä»createStoreå¼€å§‹çœ‹èµ·<ul><li>å¯ä»¥å‘ç°Vuex4ä¸­çš„stateæ˜¯é€šè¿‡reactive APIå»åˆ›å»ºçš„å“åº”å¼æ•°æ®ï¼ŒVuex3ä¸­æ˜¯é€šè¿‡new Vueå®ä¾‹</li><li>dispatchã€commitçš„å®ç°åŸºæœ¬æ˜¯å°è£…äº†ä¸€å±‚æ‰§è¡Œï¼Œä¸ç”¨è¿‡äºå…³å¿ƒ</li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">createStore</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Store(options)</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span></span>&#123;</span><br><span class="line">    <span class="title">constructor</span> (<span class="params">options = &#123;&#125;</span>)&#123;</span><br><span class="line">        <span class="comment">// çœç•¥è‹¥å¹²ä»£ç ...</span></span><br><span class="line">        <span class="built_in">this</span>._modules = <span class="keyword">new</span> ModuleCollection(options)</span><br><span class="line">        <span class="keyword">const</span> state = <span class="built_in">this</span>._modules.root.state</span><br><span class="line">        resetStoreState(<span class="built_in">this</span>, state)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// bind commit and dispatch to self</span></span><br><span class="line">        <span class="keyword">const</span> store = <span class="built_in">this</span></span><br><span class="line">        <span class="keyword">const</span> &#123; dispatch, commit &#125; = <span class="built_in">this</span></span><br><span class="line">        <span class="built_in">this</span>.dispatch = <span class="function"><span class="keyword">function</span> <span class="title">boundDispatch</span> (<span class="params"><span class="keyword">type</span>, payload</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> dispatch.call(store, <span class="keyword">type</span>, payload)</span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="built_in">this</span>.commit = <span class="function"><span class="keyword">function</span> <span class="title">boundCommit</span> (<span class="params"><span class="keyword">type</span>, payload, options</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> commit.call(store, <span class="keyword">type</span>, payload, options)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// çœç•¥è‹¥å¹²ä»£ç ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resetStoreState</span> (<span class="params">store, state, hot</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// çœç•¥è‹¥å¹²ä»£ç ...</span></span><br><span class="line">    store._state = reactive(&#123;</span><br><span class="line">        data: state</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// çœç•¥è‹¥å¹²ä»£ç ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="install">install</h3><ul><li>Vuexæ˜¯ä»¥æ’ä»¶çš„å½¢å¼åœ¨Vueä¸­ä½¿ç”¨çš„ï¼Œåœ¨createAppæ—¶è°ƒç”¨installå®‰è£…</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">createAppAPI</span>&lt;<span class="title">HostElement</span>&gt;(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  render: RootRenderFunction,</span></span></span><br><span class="line"><span class="function"><span class="params">  hydrate?: RootHydrateFunction</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">CreateAppFunction</span>&lt;<span class="title">HostElement</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">createApp</span>(<span class="params">rootComponent, rootProps = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// çœç•¥éƒ¨åˆ†ä»£ç ....</span></span><br><span class="line">    <span class="keyword">const</span> app: App = (context.app = &#123;</span><br><span class="line">      _uid: uid++,</span><br><span class="line">      _component: rootComponent <span class="keyword">as</span> ConcreteComponent,</span><br><span class="line">      _props: rootProps,</span><br><span class="line">      _container: <span class="literal">null</span>,</span><br><span class="line">      _context: context,</span><br><span class="line"></span><br><span class="line">      version,</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// çœç•¥éƒ¨åˆ†ä»£ç ....</span></span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="title">use</span>(<span class="params">plugin: Plugin, ...options: <span class="built_in">any</span>[]</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (installedPlugins.has(plugin)) &#123;</span><br><span class="line">          __DEV__ &amp;&amp; warn(<span class="string">`Plugin has already been applied to target app.`</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (plugin &amp;&amp; isFunction(plugin.install)) &#123;</span><br><span class="line">          installedPlugins.add(plugin)</span><br><span class="line">          plugin.install(app, ...options)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isFunction(plugin)) &#123;</span><br><span class="line">          installedPlugins.add(plugin)</span><br><span class="line">          plugin(app, ...options)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">          warn(</span><br><span class="line">            <span class="string">`A plugin must either be a function or an object with an &quot;install&quot; `</span> +</span><br><span class="line">              <span class="string">`function.`</span></span><br><span class="line">          )</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> app</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// çœç•¥éƒ¨åˆ†ä»£ç  ....</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Store ç±»çš„install<ul><li>å®ç°é€šè¿‡injectè·å–</li><li>å®ç°this.$storeè·å–</li></ul></li></ul><blockquote><p>ä¸‹é¢æ¥ç€çœ‹provideå®ç°</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">install (app, injectKey) &#123;</span><br><span class="line">  <span class="comment">// å®ç°é€šè¿‡injectè·å–</span></span><br><span class="line">  app.provide(injectKey || storeKey, <span class="built_in">this</span>)</span><br><span class="line">  <span class="comment">// å®ç°this.$storeè·å–</span></span><br><span class="line">  app.config.globalProperties.$store = <span class="built_in">this</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="app-provideå®ç°">app.provideå®ç°</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">provide</span>(<span class="params">key, value</span>)</span> &#123;</span><br><span class="line">  <span class="comment">// å·²å­˜åœ¨åˆ™è­¦å‘Š</span></span><br><span class="line">  <span class="keyword">if</span> (__DEV__ &amp;&amp; (key <span class="keyword">as</span> <span class="built_in">string</span> | symbol) <span class="keyword">in</span> context.provides) &#123;</span><br><span class="line">    warn(</span><br><span class="line">      <span class="string">`App already provides property with key &quot;<span class="subst">$&#123;<span class="built_in">String</span>(key)&#125;</span>&quot;. `</span> +</span><br><span class="line">        <span class="string">`It will be overwritten with the new value.`</span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å°†storeæ”¾å…¥contextçš„provideä¸­</span></span><br><span class="line">  context.provides[key <span class="keyword">as</span> <span class="built_in">string</span>] = value</span><br><span class="line">  <span class="keyword">return</span> app</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// contextç›¸å…³   contextä¸ºä¸Šä¸‹æ–‡å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> context = createAppContext()</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">createAppContext</span>(<span class="params"></span>): <span class="title">AppContext</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    app: <span class="literal">null</span> <span class="keyword">as</span> <span class="built_in">any</span>,</span><br><span class="line">    config: &#123;</span><br><span class="line">      isNativeTag: NO,</span><br><span class="line">      performance: <span class="literal">false</span>,</span><br><span class="line">      globalProperties: &#123;&#125;,</span><br><span class="line">      optionMergeStrategies: &#123;&#125;,</span><br><span class="line">      errorHandler: <span class="literal">undefined</span>,</span><br><span class="line">      warnHandler: <span class="literal">undefined</span>,</span><br><span class="line">      compilerOptions: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    mixins: [],</span><br><span class="line">    components: &#123;&#125;,</span><br><span class="line">    directives: &#123;&#125;,</span><br><span class="line">    provides: <span class="built_in">Object</span>.create(<span class="literal">null</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Vue-useStore">Vue.useStore</h3><ul><li>åœ¨Vue3 Composition APIä¸­ä½¿ç”¨Vuex</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useStore &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">    <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">const</span> store = useStore();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>useStoreçš„å®ç°</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useStore</span> (<span class="params">key = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> inject(key !== <span class="literal">null</span> ? key : storeKey)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Vue-inject">Vue.inject</h3><ul><li>é€šè¿‡provideæ—¶å­˜å…¥çš„keyå–å‡ºstore</li><li>æœ‰çˆ¶çº§å®ä¾‹åˆ™å–çˆ¶çº§å®ä¾‹çš„providesï¼Œæ²¡æœ‰åˆ™å–æ ¹å®ä¾‹çš„provides</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inject</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  key: InjectionKey&lt;<span class="built_in">any</span>&gt; | <span class="built_in">string</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  defaultValue?: unknown,</span></span></span><br><span class="line"><span class="function"><span class="params">  treatDefaultAsFactory = <span class="literal">false</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> instance = currentInstance || currentRenderingInstance</span><br><span class="line">  <span class="keyword">if</span> (instance) &#123;</span><br><span class="line">    <span class="comment">// æœ‰çˆ¶çº§å®ä¾‹åˆ™å–çˆ¶çº§å®ä¾‹çš„providesï¼Œæ²¡æœ‰åˆ™å–æ ¹å®ä¾‹çš„provides</span></span><br><span class="line">    <span class="keyword">const</span> provides =</span><br><span class="line">      instance.parent == <span class="literal">null</span></span><br><span class="line">        ? instance.vnode.appContext &amp;&amp; instance.vnode.appContext.provides</span><br><span class="line">        : instance.parent.provides</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡provideæ—¶å­˜å…¥çš„keyå–å‡ºstore</span></span><br><span class="line">    <span class="keyword">if</span> (provides &amp;&amp; (key <span class="keyword">as</span> <span class="built_in">string</span> | symbol) <span class="keyword">in</span> provides) &#123;</span><br><span class="line">      <span class="keyword">return</span> provides[key <span class="keyword">as</span> <span class="built_in">string</span>]</span><br><span class="line">    <span class="comment">// çœç•¥ä¸€éƒ¨åˆ†ä»£ç ......</span></span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Vue-provide">Vue.provide</h3><ul><li>Vueçš„provide APIä¹Ÿæ¯”è¾ƒç®€å•ï¼Œç›¸å½“äºç›´æ¥é€šè¿‡key/valueèµ‹å€¼</li><li>å½“å‰å®ä¾‹provideså’Œçˆ¶çº§å®ä¾‹providesç›¸åŒæ—¶ï¼Œé€šè¿‡åŸå‹é“¾å»ºç«‹è¿æ¥</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">provide</span>&lt;<span class="title">T</span>&gt;(<span class="params">key: InjectionKey&lt;T&gt; | <span class="built_in">string</span> | <span class="built_in">number</span>, value: T</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!currentInstance) &#123;</span><br><span class="line">    <span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">      warn(<span class="string">`provide() can only be used inside setup().`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> provides = currentInstance.provides</span><br><span class="line">    <span class="keyword">const</span> parentProvides =</span><br><span class="line">      currentInstance.parent &amp;&amp; currentInstance.parent.provides</span><br><span class="line">    <span class="keyword">if</span> (parentProvides === provides) &#123;</span><br><span class="line">      provides = currentInstance.provides = <span class="built_in">Object</span>.create(parentProvides)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// TS doesn&#x27;t allow symbol as index type</span></span><br><span class="line">    provides[key <span class="keyword">as</span> <span class="built_in">string</span>] = value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ³¨å…¥">æ³¨å…¥</h3><ul><li>ä¸ºä»€ä¹ˆæ¯ä¸ªç»„ä»¶å®ä¾‹éƒ½æœ‰Storeå¯¹è±¡äº†?<ul><li>åœ¨åˆ›å»ºç»„ä»¶å®ä¾‹çš„æ—¶å€™æ³¨å…¥äº†provides</li></ul></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createComponentInstance</span>(<span class="params">vnode, parent, suspense</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">type</span> = vnode.type;</span><br><span class="line">    <span class="keyword">const</span> appContext = (parent ? parent.appContext : vnode.appContext) || emptyAppContext;</span><br><span class="line">    <span class="keyword">const</span> instance = &#123;</span><br><span class="line">        parent,</span><br><span class="line">        appContext,</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        provides: parent ? parent.provides : <span class="built_in">Object</span>.create(appContext.provides),</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¯ä»vueä¸­å¼•å…¥provideã€injectã€getCurrentInstanceç­‰APIè¿›è¡Œåº“å¼€å‘ / é«˜é˜¶ç”¨æ³•ï¼Œè¿™é‡Œä¸è¿‡å¤šèµ˜è¿°ã€‚</p></blockquote><h1>Diffç®—æ³•ä¼˜åŒ–</h1><blockquote><p>äº†è§£Vue3çš„Diffç®—æ³•ä¼˜åŒ–å‰ï¼Œå¯ä»¥å…ˆäº†è§£ä¸€ä¸‹<a href="https://juejin.cn/post/6944887985531781133">Vue2çš„Diffç®—æ³•</a></p><p>æœ¬éƒ¨åˆ†æ³¨é‡æŠŠç®—æ³•è®²æ¸…æ¥šï¼Œå°†ä¸è¿›è¡Œé€è¡Œæºç åˆ†æ</p></blockquote><ul><li>Vue3ä¸­çš„ä¸»è¦ä¼˜åŒ–ç‚¹ä¸º<ul><li>åœ¨updateChildrenæ—¶åŒç«¯æ¯”è¾ƒ -&gt; æœ€é•¿é€’å¢å­åºåˆ—</li><li>å…¨é‡Diff -&gt; é™æ€æ ‡è®° + éå…¨é‡Diff</li><li>é™æ€æå‡</li></ul></li></ul><h2 id="updateChildren">updateChildren</h2><ul><li>Vue2<ul><li>å¤´ - å¤´æ¯”è¾ƒ</li><li>å°¾ - å°¾æ¯”è¾ƒ</li><li>å¤´ - å°¾æ¯”è¾ƒ</li><li>å°¾ - å¤´æ¯”è¾ƒ</li></ul></li><li>Vue3<ul><li>å¤´ - å¤´æ¯”è¾ƒ</li><li>å°¾ - å°¾æ¯”è¾ƒ</li><li>åŸºäºæœ€é•¿é€’å¢å­åºåˆ—è¿›è¡Œç§»åŠ¨ / åˆ é™¤ / æ–°å¢</li></ul></li></ul><h3 id="ä¸¾ä¸ªğŸŒ°">ä¸¾ä¸ªğŸŒ°</h3><ul><li>oldChild [a,b,c,d,e,f,g]</li><li>newChild [a,b,f,c,d,e,h,g]</li></ul><ol><li>é¦–å…ˆè¿›è¡Œå¤´ - å¤´æ¯”è¾ƒ,æ¯”è¾ƒåˆ°ä¸ä¸€æ ·çš„èŠ‚ç‚¹æ—¶è·³å‡ºå¾ªç¯<ul><li>å¾—åˆ°[a,b]</li></ul></li><li>ç„¶åè¿›è¡Œå°¾ - å°¾æ¯”è¾ƒï¼Œæ¯”è¾ƒåˆ°ä¸ä¸€æ ·çš„èŠ‚ç‚¹æ—¶è·³å‡ºå¾ªç¯<ul><li>å¾—åˆ°[g]</li></ul></li><li>å‰©ä½™[f,c,d,e,h]<ul><li>é€šè¿‡newIndexToOldIndexMapç”Ÿæˆæ•°ç»„[5, 2, 3, 4, -1]</li><li>å¾—å‡ºæœ€é•¿é€’å¢å­åºåˆ—[2, 3, 4]å¯¹åº”èŠ‚ç‚¹ä¸º[c, d, e]</li><li>å‰©ä½™çš„èŠ‚ç‚¹åŸºäº[c, d, e]è¿›è¡Œç§»åŠ¨ / æ–°å¢ / åˆ é™¤</li></ul></li></ol><blockquote><p><strong>æœ€é•¿é€’å¢å­åºåˆ—</strong> å‡å°‘Domå…ƒç´ çš„ç§»åŠ¨ï¼Œè¾¾åˆ°æœ€å°‘çš„ dom æ“ä½œä»¥å‡å°å¼€é”€ã€‚</p><p>å…³äºæœ€é•¿é€’å¢å­åºåˆ—ç®—æ³•å¯ä»¥çœ‹çœ‹<a href="https://github.com/labuladong/fucking-algorithm/blob/master/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E7%B3%BB%E5%88%97/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E8%AE%BE%E8%AE%A1%EF%BC%9A%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97.md">æœ€é•¿é€’å¢å­åºåˆ—</a></p></blockquote><h2 id="é™æ€æ ‡è®°">é™æ€æ ‡è®°</h2><blockquote><p>Vue2ä¸­å¯¹vdomè¿›è¡Œå…¨é‡Diffï¼ŒVue3ä¸­å¢åŠ äº†é™æ€æ ‡è®°è¿›è¡Œéå…¨é‡Diff</p><p>å¯¹vnodeæ‰“äº†åƒä»¥ä¸‹æšä¸¾å†…çš„é™æ€æ ‡è®°</p></blockquote><ul><li>patchFlag</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="built_in">enum</span> PatchFlags&#123;</span><br><span class="line">  TEXT = <span class="number">1</span> ,  <span class="comment">//åŠ¨æ€æ–‡æœ¬èŠ‚ç‚¹</span></span><br><span class="line">  CLASS = <span class="number">1</span> &lt;&lt; <span class="number">1</span>, <span class="comment">//2   åŠ¨æ€class</span></span><br><span class="line">  STYLE = <span class="number">1</span> &lt;&lt; <span class="number">2</span>, <span class="comment">//4   åŠ¨æ€style</span></span><br><span class="line">  PROPS = <span class="number">1</span> &lt;&lt; <span class="number">3</span>, <span class="comment">//8                åŠ¨æ€å±æ€§ï¼Œä½†ä¸åŒ…å«ç±»åå’Œæ ·å¼</span></span><br><span class="line">  FULL_PROPS = <span class="number">1</span> &lt;&lt; <span class="number">4</span>, <span class="comment">//16   å…·æœ‰åŠ¨æ€keyå±æ€§ï¼Œå½“keyæ”¹å˜æ—¶ï¼Œéœ€è¿›è¡Œå®Œæ•´çš„diffæ¯”è¾ƒ</span></span><br><span class="line">  HYDRATE_EVENTS = <span class="number">1</span> &lt;&lt; <span class="number">5</span>,<span class="comment">//32  å¸¦æœ‰ç›‘å¬äº‹ä»¶çš„èŠ‚ç‚¹</span></span><br><span class="line">  STABLE_FRAGMENT = <span class="number">1</span> &lt;&lt; <span class="number">6</span>, <span class="comment">//64  ä¸€ä¸ªä¸ä¼šæ”¹å˜å­èŠ‚ç‚¹é¡ºåºçš„fragment</span></span><br><span class="line">  KEYED_FRAGMENT = <span class="number">1</span> &lt;&lt; <span class="number">7</span>,  <span class="comment">//128 å¸¦æœ‰keyå±æ€§çš„fragmentæˆ–éƒ¨åˆ†å­èŠ‚ç‚¹æœ‰key</span></span><br><span class="line">  UNKEYEN_FRAGMENT = <span class="number">1</span> &lt;&lt; <span class="number">8</span>,   <span class="comment">//256  å­èŠ‚ç‚¹æ²¡æœ‰keyçš„fragment</span></span><br><span class="line">  NEED_PATCH = <span class="number">1</span> &lt;&lt; <span class="number">9</span>,   <span class="comment">//512   ä¸€ä¸ªèŠ‚ç‚¹åªä¼šè¿›è¡Œépropsæ¯”è¾ƒ</span></span><br><span class="line">  DYNAMIC_SLOTS = <span class="number">1</span> &lt;&lt; <span class="number">10</span>,<span class="comment">//1024   åŠ¨æ€slot</span></span><br><span class="line">  HOISTED = -<span class="number">1</span>,   <span class="comment">//é™æ€èŠ‚ç‚¹ </span></span><br><span class="line">  <span class="comment">//æŒ‡ç¤ºåœ¨diffè¿‡ç¨‹ä¸­è¦é€€å‡ºä¼˜åŒ–æ¨¡å¼</span></span><br><span class="line">  BAIL = -<span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¸ªğŸŒ°-2">ä¸¾ä¸ªğŸŒ°</h3><ul><li>æ¨¡æ¿é•¿è¿™æ ·</li></ul><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ç”Ÿæˆvdomæºç </li></ul><blockquote><p>å¯¹msgå˜é‡è¿›è¡Œäº†æ ‡è®°</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createVNode <span class="keyword">as</span> _createVNode, toDisplayString <span class="keyword">as</span> _toDisplayString, openBlock <span class="keyword">as</span> _openBlock, createBlock <span class="keyword">as</span> _createBlock &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, [</span><br><span class="line">    _createVNode(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;Hello World&quot;</span>),</span><br><span class="line">    _createVNode(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, _toDisplayString(_ctx.msg), <span class="number">1</span> <span class="comment">/* TEXT */</span>)</span><br><span class="line">  ]))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check the console for the AST</span></span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“">æ€»ç»“</h3><ul><li>å¯¹vnodeè¿›è¡Œæ ‡è®°ï¼Œå°†éœ€è¦åŠ¨æ€æ›´æ–°å’Œä¸éœ€è¦åŠ¨æ€æ›´æ–°çš„èŠ‚ç‚¹è¿›è¡Œåˆ†ç±»</li><li>é™æ€èŠ‚ç‚¹ä»…éœ€åˆ›å»ºä¸€æ¬¡ï¼Œæ¸²æŸ“ç›´æ¥å¤ç”¨ï¼Œä¸å‚ä¸diffç®—æ³•æµç¨‹ã€‚</li></ul><h2 id="é™æ€æå‡">é™æ€æå‡</h2><ul><li><p>Vue2ä¸­æ— è®ºæ˜¯å…ƒç´ æ˜¯å¦å‚ä¸æ›´æ–°ï¼Œæ¯æ¬¡éƒ½ä¼šé‡æ–°åˆ›å»º</p></li><li><p>Vue3ä¸­å¯¹äºä¸å‚ä¸æ›´æ–°çš„å…ƒç´ ï¼Œåªä¼šè¢«åˆ›å»ºä¸€æ¬¡ï¼Œä¹‹åä¼šåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶å€™è¢«ä¸åœåœ°å¤ç”¨</p></li><li><p>ä»¥åæ¯æ¬¡è¿›è¡Œrenderçš„æ—¶å€™ï¼Œå°±ä¸ä¼šé‡å¤åˆ›å»ºè¿™äº›é™æ€çš„å†…å®¹ï¼Œè€Œæ˜¯ç›´æ¥ä»ä¸€å¼€å§‹å°±åˆ›å»ºå¥½çš„å¸¸é‡ä¸­å–å°±è¡Œäº†ã€‚</p></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createVNode <span class="keyword">as</span> _createVNode, toDisplayString <span class="keyword">as</span> _toDisplayString, openBlock <span class="keyword">as</span> _openBlock, createBlock <span class="keyword">as</span> _createBlock &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* é™æ€æå‡å‰</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, [</span><br><span class="line">    _createVNode(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;Xmo&quot;</span>),</span><br><span class="line">    _createVNode(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;Xmo&quot;</span>),</span><br><span class="line">    _createVNode(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;Xmo&quot;</span>),</span><br><span class="line">    _createVNode(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, _toDisplayString(_ctx.msg), <span class="number">1</span> <span class="comment">/* TEXT */</span>)</span><br><span class="line">  ]))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* é™æ€æå‡å</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> _hoisted_1 = <span class="comment">/*#__PURE__*/</span>_createVNode(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;Xmo&quot;</span>, -<span class="number">1</span> <span class="comment">/* HOISTED */</span>)</span><br><span class="line"><span class="keyword">const</span> _hoisted_2 = <span class="comment">/*#__PURE__*/</span>_createVNode(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;Xmo&quot;</span>, -<span class="number">1</span> <span class="comment">/* HOISTED */</span>)</span><br><span class="line"><span class="keyword">const</span> _hoisted_3 = <span class="comment">/*#__PURE__*/</span>_createVNode(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;Xmo&quot;</span>, -<span class="number">1</span> <span class="comment">/* HOISTED */</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, [</span><br><span class="line">    _hoisted_1,</span><br><span class="line">    _hoisted_2,</span><br><span class="line">    _hoisted_3,</span><br><span class="line">    _createVNode(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, _toDisplayString(_ctx.msg), <span class="number">1</span> <span class="comment">/* TEXT */</span>)</span><br><span class="line">  ]))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check the console for the AST</span></span><br></pre></td></tr></table></figure><h1>cacheHandlers äº‹ä»¶ä¾¦å¬å™¨ç¼“å­˜</h1><ul><li><p>é»˜è®¤æƒ…å†µä¸‹onClickä¼šè¢«è§†ä¸ºåŠ¨æ€ç»‘å®šï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½ä¼šå»è¿½è¸ªå®ƒçš„å˜åŒ–</p></li><li><p>ä½†æ˜¯å› ä¸ºæ˜¯åŒä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥æ²¡æœ‰è¿½è¸ªå˜åŒ–ï¼Œç›´æ¥ç¼“å­˜èµ·æ¥å¤ç”¨å³å¯ã€‚</p></li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ¨¡æ¿</span></span><br><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;button <span class="meta">@click</span>=<span class="string">&quot;onClick&quot;</span>&gt;btn&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¼“å­˜å‰</span></span><br><span class="line"><span class="comment">// è¿™é‡Œæˆ‘ä»¬è¿˜æ²¡æœ‰å¼€å¯äº‹ä»¶ç›‘å¬ç¼“å­˜ï¼Œç†Ÿæ‚‰çš„é™æ€æ ‡è®° 8 /* PROPS */ å‡ºç°äº†ï¼Œ</span></span><br><span class="line"><span class="comment">// å®ƒå°†æ ‡ç­¾çš„ Props ï¼ˆå±æ€§ï¼‰ æ ‡è®°åŠ¨æ€å±æ€§ã€‚</span></span><br><span class="line"><span class="comment">// å¦‚æœæˆ‘ä»¬å­˜åœ¨å±æ€§ä¸ä¼šæ”¹å˜ï¼Œä¸å¸Œæœ›è¿™ä¸ªå±æ€§è¢«æ ‡è®°ä¸ºåŠ¨æ€ï¼Œé‚£ä¹ˆå°±éœ€è¦ cacheHandler çš„å‡ºåœºäº†ã€‚</span></span><br><span class="line"><span class="keyword">import</span> &#123; createVNode <span class="keyword">as</span> _createVNode, openBlock <span class="keyword">as</span> _openBlock, createBlock <span class="keyword">as</span> _createBlock &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, [</span><br><span class="line">    _createVNode(<span class="string">&quot;button&quot;</span>, &#123; <span class="attr">onClick</span>: _ctx.onClick &#125;, <span class="string">&quot;btn&quot;</span>, <span class="number">8</span> <span class="comment">/* PROPS */</span>, [<span class="string">&quot;onClick&quot;</span>])</span><br><span class="line">  ]))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check the console for the AST</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¼“å­˜å</span></span><br><span class="line"><span class="keyword">import</span> &#123; createVNode <span class="keyword">as</span> _createVNode, openBlock <span class="keyword">as</span> _openBlock, createBlock <span class="keyword">as</span> _createBlock &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createBlock(<span class="string">&quot;div&quot;</span>, <span class="literal">null</span>, [</span><br><span class="line">    _createVNode(<span class="string">&quot;button&quot;</span>, &#123;</span><br><span class="line">      onClick: _cache[<span class="number">1</span>] || (_cache[<span class="number">1</span>] = <span class="function">(<span class="params">...args</span>) =&gt;</span> (_ctx.onClick(...args)))</span><br><span class="line">    &#125;, <span class="string">&quot;btn&quot;</span>)</span><br><span class="line">  ]))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check the console for the AST</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>å®ƒçš„æ„æ€å¾ˆæ˜æ˜¾ï¼ŒonClick æ–¹æ³•è¢«å­˜å…¥ cacheã€‚</p><p>åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå¦‚æœèƒ½åœ¨ç¼“å­˜ä¸­æ‰¾åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒå°†ç›´æ¥è¢«ä½¿ç”¨ã€‚</p><p>å¦‚æœæ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆå°†è¿™ä¸ªæ–¹æ³•æ³¨å…¥ç¼“å­˜ã€‚</p><p>æ€»ä¹‹ï¼Œå°±æ˜¯æŠŠæ–¹æ³•ç»™ç¼“å­˜äº†ã€‚</p></blockquote><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Effectå’ŒReactive&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;effectä½œä¸ºVueå“åº”å¼åŸç†ä¸­çš„æ ¸å¿ƒï¼Œåœ¨Computedã€Watchã€Reactiveä¸­éƒ½æœ‰å‡ºç°&lt;/p&gt;
&lt;p&gt;ä¸»è¦å’ŒReactive(Proxy)ã€trackã€triggerç­‰å‡½æ•°é…åˆå®ç°æ”¶é›†</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://lebronchao.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="Front End" scheme="https://lebronchao.com/tags/Front-End/"/>
    
    <category term="Vue" scheme="https://lebronchao.com/tags/Vue/"/>
    
    <category term="SPA" scheme="https://lebronchao.com/tags/SPA/"/>
    
    <category term="æºç åˆ†æ" scheme="https://lebronchao.com/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>[æ·±å…¥æµ…å‡º]JavaScript GC åƒåœ¾å›æ”¶æœºåˆ¶</title>
    <link href="https://lebronchao.com/2021/06/22/JavaScipt-GC/"/>
    <id>https://lebronchao.com/2021/06/22/JavaScipt-GC/</id>
    <published>2021-06-22T15:32:35.000Z</published>
    <updated>2021-06-22T15:32:35.000Z</updated>
    
    <content type="html"><![CDATA[<h1>[ç§‘æ™®]JavaScript GC</h1><h1>ä¸ºä»€ä¹ˆéœ€è¦åƒåœ¾å›æ”¶</h1><ul><li>åœ¨C / C++ä¸­ï¼Œè·Ÿè¸ªå†…å­˜çš„ä½¿ç”¨å’Œç®¡ç†å†…å­˜å¯¹å¼€å‘è€…æ¥è¯´æ˜¯å¾ˆå¤§çš„è´Ÿæ‹…<ul><li>JavaScriptæ˜¯ä½¿ç”¨åƒåœ¾å›æ”¶æœºåˆ¶çš„è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰§è¡Œç¯å¢ƒè´Ÿè´£åœ¨ä»£ç æ‰§è¡Œæ—¶ç®¡ç†å†…å­˜ï¼Œå¸®å¼€å‘è€…å¸ä¸‹äº†è¿™ä¸ªè´Ÿæ‹…</li><li>é€šè¿‡è‡ªåŠ¨å†…å­˜ç®¡ç†å®ç°å†…å­˜çš„åˆ†é…å’Œèµ„æºçš„å›æ”¶</li><li>åŸºæœ¬æ€è·¯å¾ˆç®€å•ï¼Œç¡®å®šå“ªä¸ªå˜é‡ä¸ä¼šå†è¢«ä½¿ç”¨äº†ï¼ŒæŠŠå®ƒçš„å†…å­˜ç©ºé—´é‡Šæ”¾</li><li>è¿™ä¸ªè¿‡ç¨‹æ˜¯å‘¨æœŸæ€§çš„ï¼Œæ„æ€æ˜¯è¿™ä¸ªåƒåœ¾å›æ”¶ç¨‹åºæ¯éš”ä¸€æ®µæ—¶é—´å°±ä¼šè¿è¡Œä¸€æ¬¡</li></ul></li><li>åƒJSä¸­çš„å¯¹è±¡ã€å­—ç¬¦ä¸²ã€å¯¹è±¡çš„å†…å­˜æ˜¯ä¸å›ºå®šçš„ï¼Œåªæœ‰çœŸæ­£ç”¨åˆ°çš„æ—¶å€™æ‰ä¼šåŠ¨æ€åˆ†é…å†…å­˜<ul><li>è¿™äº›å†…å­˜éœ€åœ¨ä¸ä½¿ç”¨åè¿›è¡Œé‡Šæ”¾ä»¥ä¾¿å†æ¬¡ä½¿ç”¨ï¼Œå¦åˆ™åœ¨è®¡ç®—æœºå¯ç”¨å†…å­˜è€—å°½åé€ æˆå´©æºƒ</li></ul></li><li>æµè§ˆå™¨å‘å±•å²ä¸Šçš„åƒåœ¾å›æ”¶æ³•ä¸»è¦æœ‰<ul><li>å¼•ç”¨è®¡æ•°æ³•</li><li>æ ‡è®°æ¸…é™¤æ³•</li></ul></li></ul><h1>å¼•ç”¨è®¡æ•°æ³•</h1><h2 id="æ€è·¯">æ€è·¯</h2><ul><li>å˜é‡åªæ˜¯å¯¹å€¼è¿›è¡Œå¼•ç”¨</li><li>å½“å˜é‡å¼•ç”¨è¯¥å€¼æ—¶ï¼Œå¼•ç”¨æ¬¡æ•°+1</li><li>å½“è¯¥å˜é‡çš„å¼•ç”¨è¢«è¦†ç›–æˆ–è€…æ¸…é™¤æ—¶ï¼Œå¼•ç”¨æ¬¡æ•°-1</li><li>å½“å¼•ç”¨æ¬¡æ•°ä¸º0æ—¶ï¼Œå°±å¯ä»¥å®‰å…¨åœ°é‡Šæ”¾è¿™å—å†…å­˜ã€‚</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]   <span class="comment">// [1, 0, 1]è¿™å—å†…å­˜è¢«arrå¼•ç”¨  å¼•ç”¨æ¬¡æ•°ä¸º1</span></span><br><span class="line">arr = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]  <span class="comment">// [1, 0, 1]çš„å†…å­˜å¼•ç”¨æ¬¡æ•°ä¸º0è¢«é‡Šæ”¾  </span></span><br><span class="line">                 <span class="comment">// [0, 1, 0]çš„å†…å­˜è¢«arrå¼•ç”¨   å¼•ç”¨æ¬¡æ•°ä¸º1</span></span><br><span class="line"><span class="keyword">const</span> tmp = arr  <span class="comment">// [0, 1, 0]çš„å†…å­˜è¢«tmpå¼•ç”¨   å¼•ç”¨æ¬¡æ•°ä¸º2</span></span><br></pre></td></tr></table></figure><h2 id=""></h2><h2 id="å¾ªç¯å¼•ç”¨é—®é¢˜">å¾ªç¯å¼•ç”¨é—®é¢˜</h2><blockquote><p>Netscape Navigator 3.0 é‡‡ç”¨</p></blockquote><ul><li>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒObjectAå’ŒObjectBçš„å±æ€§åˆ†åˆ«ç›¸äº’å¼•ç”¨</li><li>é€ æˆè¿™ä¸ªå‡½æ•°æ‰§è¡Œåï¼ŒObjectè¢«å¼•ç”¨çš„æ¬¡æ•°ä¸ä¼šå˜æˆ0ï¼Œå½±å“äº†æ­£å¸¸çš„GCã€‚</li><li>å¦‚æœæ‰§è¡Œå¤šæ¬¡ï¼Œå°†é€ æˆä¸¥é‡çš„å†…å­˜æ³„æ¼ã€‚</li><li>è€Œæ ‡è®°æ¸…é™¤æ³•åˆ™ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> ObjectA = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">    <span class="keyword">let</span> ObjectB = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line"></span><br><span class="line">    ObjectA.p = ObjectB;</span><br><span class="line">    ObjectB.p = ObjectA;   </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Example();</span><br></pre></td></tr></table></figure><ul><li>è§£å†³æ–¹æ³•ï¼šåœ¨å‡½æ•°ç»“æŸæ—¶å°†å…¶æŒ‡å‘null</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">ObjectA = <span class="literal">null</span>;</span><br><span class="line">ObjectB = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure><h1>æ ‡è®°æ¸…é™¤æ³•</h1><blockquote><p>ä¸ºäº†è§£å†³å¾ªç¯å¼•ç”¨é€ æˆçš„å†…å­˜æ³„æ¼é—®é¢˜ï¼ŒNetscape Navigator 4.0 å¼€å§‹é‡‡ç”¨æ ‡è®°æ¸…é™¤æ³•</p></blockquote><blockquote><p>åˆ°äº† 2008 å¹´ï¼ŒIEã€Firefoxã€Operaã€Chrome å’Œ Safari éƒ½åœ¨è‡ªå·±çš„ JavaScript å®ç°ä¸­é‡‡ç”¨æ ‡è®°æ¸…ç†(æˆ– å…¶å˜ä½“)ï¼Œåªæ˜¯åœ¨è¿è¡Œåƒåœ¾å›æ”¶çš„é¢‘ç‡ä¸Šæœ‰æ‰€å·®å¼‚ã€‚</p></blockquote><h2 id="æ€è·¯-2">æ€è·¯</h2><ul><li>åœ¨å˜é‡è¿›å…¥æ‰§è¡Œä¸Šä¸‹æ–‡æ—¶æ‰“ä¸Šâ€œè¿›å…¥â€æ ‡è®°</li><li>åŒæ—¶åœ¨å˜é‡ç¦»å¼€æ‰§è¡Œä¸Šä¸‹æ–‡æ—¶ä¹Ÿæ‰“ä¸Šâ€œç¦»å¼€â€æ ‡è®°<ul><li>ä»æ­¤ä»¥åï¼Œæ— æ³•è®¿é—®è¿™ä¸ªå˜é‡</li><li>åœ¨ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶è¿›è¡Œå†…å­˜çš„é‡Šæ”¾</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params">n</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> a = <span class="number">1</span>, b = <span class="number">2</span>, c = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">return</span> n * a * b * c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ ‡è®°Exampleè¿›å…¥æ‰§è¡Œä¸Šä¸‹æ–‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> n = <span class="number">1</span>;  <span class="comment">// æ ‡è®°nè¿›å…¥æ‰§è¡Œä¸Šä¸‹æ–‡</span></span><br><span class="line">Example(n);   <span class="comment">// æ ‡è®°a,b,cè¿›å…¥æ‰§è¡Œä¸Šä¸‹æ–‡</span></span><br><span class="line"><span class="built_in">console</span>.log(n); <span class="comment">// æ ‡è®°a, b, cç¦»å¼€æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œç­‰å¾…åƒåœ¾å›æ”¶</span></span><br></pre></td></tr></table></figure><h2 id="constå’Œletå£°æ˜æå‡æ€§èƒ½">constå’Œletå£°æ˜æå‡æ€§èƒ½</h2><ul><li>constå’Œletä¸ä»…æœ‰åŠ©äºæ”¹å–„ä»£ç é£æ ¼ï¼ŒåŒæ—¶æœ‰åˆ©äºåƒåœ¾å›æ”¶æ€§èƒ½çš„æå‡</li><li>constå’Œletä½¿JSæœ‰äº†å—çº§ä½œç”¨åŸŸï¼Œå½“å—çº§ä½œç”¨åŸŸæ¯”å‡½æ•°ä½œç”¨åŸŸæ›´æ—©ç»“æŸæ—¶ï¼Œåƒåœ¾å›æ”¶ç¨‹åºæ›´æ—©ä»‹å…¥</li><li>å°½æ—©å›æ”¶è¯¥å›æ”¶çš„å†…å­˜ï¼Œæå‡äº†åƒåœ¾å›æ”¶çš„æ€§èƒ½</li></ul><h1>V8å¼•æ“çš„åƒåœ¾å›æ”¶</h1><blockquote><p>V8å¼•æ“çš„åƒåœ¾å›æ”¶é‡‡ç”¨æ ‡è®°æ¸…é™¤æ³•ä¸åˆ†ä»£å›æ”¶æ³•</p></blockquote><blockquote><p>åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€ç”Ÿä»£</p></blockquote><h2 id="æ–°ç”Ÿä»£">æ–°ç”Ÿä»£</h2><blockquote><p>æ–°ç”Ÿä»£åƒåœ¾å›æ”¶é‡‡ç”¨<code>Scavenge</code> ç®—æ³•</p></blockquote><blockquote><p>åˆ†é…ç»™å¸¸ç”¨å†…å­˜å’Œæ–°åˆ†é…çš„å°é‡å†…å­˜</p></blockquote><ul><li><p>å†…å­˜å¤§å°</p><ul><li>32ä½ç³»ç»Ÿ16Må†…å­˜</li><li>64ä½ç³»ç»Ÿ32Må†…å­˜</li></ul></li><li><p>åˆ†åŒº</p><ul><li>æ–°ç”Ÿä»£å†…å­˜åˆ†ä¸ºä»¥ä¸‹ä¸¤åŒºï¼Œå†…å­˜å„å ä¸€åŠ</li><li>From space</li><li>To space</li></ul></li><li><p>è¿è¡Œ</p><ul><li>å®é™…è¿è¡Œçš„åªæœ‰From space</li><li>To spaceå¤„äºç©ºé—²çŠ¶æ€</li></ul></li><li><p><code>Scavenge</code>ç®—æ³•</p><ul><li>å½“From spaceå†…å­˜ä½¿ç”¨å°†è¦è¾¾åˆ°ä¸Šé™æ—¶å¼€å§‹åƒåœ¾å›æ”¶ï¼Œå°†From spaceä¸­çš„ä¸å¯è¾¾å¯¹è±¡éƒ½æ‰“ä¸Šæ ‡è®°</li><li>å°†From spaceçš„æœªæ ‡è®°å¯¹è±¡å¤åˆ¶åˆ°To spaceã€‚<ul><li>è§£å†³äº†å†…å­˜æ•£è½åˆ†å—çš„é—®é¢˜ï¼ˆä¸è¿ç»­çš„å†…å­˜ç©ºé—´ï¼‰</li><li>ç›¸å½“äºç”¨ç©ºé—´æ¢æ—¶é—´ã€‚</li></ul></li><li>ç„¶åæ¸…ç©ºFrom spaceã€å°†å…¶é—²ç½®ï¼Œä¹Ÿå°±æ˜¯è½¬å˜ä¸ºTo spaceï¼Œä¿—ç§°åè½¬ã€‚</li></ul></li><li><p>æ–°ç”Ÿä»£ -&gt; è€ç”Ÿä»£</p><ul><li>æ–°ç”Ÿä»£å­˜æ”¾çš„æ˜¯æ–°åˆ†é…çš„å°é‡å†…å­˜ï¼Œå¦‚æœè¾¾åˆ°ä»¥ä¸‹æ¡ä»¶ä¸­çš„ä¸€ä¸ªï¼Œå°†è¢«åˆ†é…è‡³è€ç”Ÿä»£<ul><li>å†…å­˜å¤§å°è¾¾åˆ°From spaceçš„25%</li><li>ç»å†äº†From space &lt;-&gt; To spaceçš„ä¸€ä¸ªè½®å›</li></ul></li></ul></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/(null)-20210607231001850.(null)" alt="img"></p><h2 id="è€ç”Ÿä»£">è€ç”Ÿä»£</h2><blockquote><p>è€ç”Ÿä»£é‡‡ç”¨<code>mark-sweep</code>æ ‡è®°æ¸…é™¤å’Œ<code>mark-compact</code>æ ‡è®°æ•´ç†</p></blockquote><blockquote><p>é€šå¸¸å­˜æ”¾è¾ƒå¤§çš„å†…å­˜å—å’Œä»æ–°ç”Ÿä»£åˆ†é…è¿‡æ¥çš„å†…å­˜å—</p></blockquote><ul><li>å†…å­˜å¤§å°<ul><li>32ä½ç³»ç»Ÿ700Må·¦å³</li><li>64ä½ç³»ç»Ÿ1.4Gå·¦å³</li></ul></li><li>åˆ†åŒº<ul><li>Old Object Space<ul><li>å­—é¢çš„è€ç”Ÿä»£ï¼Œå­˜æ”¾çš„æ˜¯æ–°ç”Ÿä»£åˆ†é…è¿‡æ¥çš„å†…å­˜ã€‚</li></ul></li><li>Large Object Space<ul><li>å­˜æ”¾å…¶ä»–åŒºåŸŸæ”¾ä¸ä¸‹çš„è¾ƒå¤§çš„å†…å­˜ï¼ŒåŸºæœ¬éƒ½è¶…è¿‡1M</li></ul></li><li>Map Space<ul><li>å­˜æ”¾å­˜å‚¨å¯¹è±¡çš„æ˜ å°„å…³ç³»</li></ul></li><li>Code Space<ul><li>å­˜å‚¨ç¼–è¯‘åçš„ä»£ç </li></ul></li></ul></li><li>å›æ”¶æµç¨‹<ul><li>æ ‡è®°åˆ†ç±»ï¼ˆä¸‰è‰²æ ‡è®°ï¼‰<ul><li>æœªè¢«æ‰«æï¼Œå¯å›æ”¶ï¼Œä¸‹é¢ç®€ç§°<code>1ç±»</code></li><li>æ‰«æä¸­ï¼Œä¸å¯å›æ”¶ï¼Œä¸‹é¢ç®€ç§°<code>2ç±»</code></li><li>æ‰«æå®Œæˆï¼Œä¸å¯å›æ”¶ï¼Œä¸‹é¢ç®€ç§°<code>3ç±»</code></li></ul></li><li>éå†<ul><li>é‡‡ç”¨æ·±åº¦ä¼˜å…ˆéå†ï¼Œéå†æ¯ä¸ªå¯¹è±¡ã€‚</li><li>é¦–å…ˆå°†éæ ¹éƒ¨å¯¹è±¡å…¨éƒ¨æ ‡è®°ä¸º<code>1ç±»</code>ï¼Œç„¶åè¿›è¡Œæ·±åº¦ä¼˜å…ˆéå†ã€‚</li><li>éå†è¿‡ç¨‹ä¸­å°†å¯¹è±¡å‹å…¥æ ˆï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å¯¹è±¡è¢«æ ‡è®°ä¸º<code>2ç±»</code>ã€‚</li><li>éå†å®Œæˆå¯¹è±¡å‡ºæ ˆï¼Œè¿™ä¸ªå¯¹è±¡è¢«æ ‡è®°ä¸º<code>3ç±»</code>ã€‚</li><li>æ•´ä¸ªè¿‡ç¨‹ç›´è‡³æ ˆç©º</li></ul></li><li>Mark-sweep<ul><li>æ ‡è®°å®Œæˆä¹‹åï¼Œå°†æ ‡è®°ä¸º<code>1ç±»</code>çš„å¯¹è±¡è¿›è¡Œå†…å­˜é‡Šæ”¾<br><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/(null)-20210607231013225-20210607231556621.(null)" alt="img"></li></ul></li><li>Mark-compact<ul><li>åƒåœ¾å›æ”¶å®Œæˆä¹‹åï¼Œå†…å­˜ç©ºé—´æ˜¯ä¸è¿ç»­çš„ã€‚</li><li>è¿™æ ·å®¹æ˜“é€ æˆæ— æ³•åˆ†é…è¾ƒå¤§çš„å†…å­˜ç©ºé—´çš„é—®é¢˜ï¼Œä»è€Œè§¦å‘åƒåœ¾å›æ”¶ã€‚</li><li>æ‰€ä»¥ï¼Œä¼šæœ‰Mark-compactæ­¥éª¤å°†æœªè¢«å›æ”¶çš„å†…å­˜å—æ•´ç†ä¸ºè¿ç»­åœ°å†…å­˜ç©ºé—´ã€‚</li><li>é¢‘ç¹è§¦å‘åƒåœ¾å›æ”¶ä¼šå½±å“å¼•æ“çš„æ€§èƒ½ï¼Œå†…å­˜ç©ºé—´ä¸è¶³æ—¶ä¹Ÿä¼šä¼˜å…ˆè§¦å‘Mark-compact</li></ul></li></ul></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/(null)-20210607231009280.(null)" alt="img"></p><h2 id="åƒåœ¾å›æ”¶ä¼˜åŒ–">åƒåœ¾å›æ”¶ä¼˜åŒ–</h2><ul><li>å¢é‡æ ‡è®°<ul><li>å¦‚æœç”¨é›†ä¸­çš„ä¸€æ®µæ—¶é—´è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œæ–°ç”Ÿä»£å€’è¿˜å¥½ï¼Œè€ç”Ÿä»£å¦‚æœéå†è¾ƒå¤§çš„å¯¹è±¡ï¼Œå¯èƒ½ä¼šé€ æˆå¡é¡¿ã€‚</li><li>å¢é‡æ ‡è®°ï¼šä½¿åƒåœ¾å›æ”¶ç¨‹åºå’Œåº”ç”¨é€»è¾‘ç¨‹åºäº¤æ›¿è¿è¡Œï¼Œæ€æƒ³ç±»ä¼¼Time Slicing</li></ul></li><li>å¹¶è¡Œå›æ”¶<ul><li>åœ¨åƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸­ï¼Œå¼€å¯è‹¥å¹²è¾…åŠ©çº¿ç¨‹ï¼Œæé«˜åƒåœ¾å›æ”¶æ•ˆç‡ã€‚</li></ul></li><li>å¹¶å‘å›æ”¶<ul><li>åœ¨é€»è¾‘ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå¼€å¯è‹¥å¹²è¾…åŠ©çº¿ç¨‹è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œæ¸…ç†å’Œä¸»çº¿ç¨‹æ²¡æœ‰ä»»ä½•é€»è¾‘å…³ç³»çš„å†…å­˜ã€‚</li></ul></li></ul><h1>å†…å­˜æ³„éœ²åœºæ™¯</h1><h2 id="å…¨å±€å˜é‡">å…¨å±€å˜é‡</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// exm1</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    exm = <span class="string">&#x27;LeBron&#x27;</span>   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// exm2</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.exm = <span class="string">&#x27;LeBron&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">Example()</span><br></pre></td></tr></table></figure><h2 id="æœªæ¸…é™¤çš„å®šæ—¶å™¨">æœªæ¸…é™¤çš„å®šæ—¶å™¨</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// clearInterval(timer)</span></span><br></pre></td></tr></table></figure><h2 id="é—­åŒ…">é—­åŒ…</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn, time</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> timeout = <span class="literal">null</span>; </span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (timeout) &#123;</span><br><span class="line">      <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    timeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;, time);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fn = debounce(handler, <span class="number">1000</span>); <span class="comment">// fnå¼•ç”¨äº†timeout</span></span><br></pre></td></tr></table></figure><h2 id="æœªæ¸…é™¤çš„DOMå…ƒç´ å¼•ç”¨">æœªæ¸…é™¤çš„DOMå…ƒç´ å¼•ç”¨</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> element = &#123;</span><br><span class="line">    <span class="comment">// æ­¤å¤„å¼•ç”¨äº†DOMå…ƒç´ </span></span><br><span class="line">    button:<span class="built_in">document</span>.getElementById(<span class="string">&#x27;LeBron&#x27;</span>),</span><br><span class="line">    select:<span class="built_in">document</span>.getElementById(<span class="string">&#x27;select&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.body.removeChild(<span class="built_in">document</span>.getElementById(<span class="string">&#x27;LeBron&#x27;</span>))</span><br></pre></td></tr></table></figure><h1>å¦‚ä½•æ£€æµ‹å†…å­˜æ³„æ¼</h1><blockquote><p>è¿™ä¸ªå…¶å®ä¸éš¾ï¼Œæµè§ˆå™¨åŸå¸¦çš„å¼€å‘è€…å·¥å…·Performanceå°±å¯ä»¥</p></blockquote><ul><li>æ­¥éª¤<ul><li>F12æ‰“å¼€å¼€å‘è€…å·¥å…·</li><li>é€‰æ‹©Performanceå·¥å…·æ </li><li>å‹¾é€‰å±å¹•æˆªå›¾å’ŒMemory</li><li>ç‚¹å‡»å¼€å§‹å½•åˆ¶</li><li>ä¸€æ®µæ—¶é—´ä¹‹åç»“æŸå½•åˆ¶</li></ul></li><li>ç»“æœ<ul><li>å †å†…å­˜ä¼šå‘¨æœŸæ€§åœ°åˆ†é…å’Œé‡Šæ”¾</li><li>å¦‚æœå †å†…å­˜çš„minå€¼åœ¨é€æ¸ä¸Šå‡åˆ™å­˜åœ¨å†…å­˜æ³„æ¼</li></ul></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/(null)-20210622234127287.(null)" alt="img"></p><h1>ä¼˜åŒ–å†…å­˜ä½¿ç”¨</h1><ol><li>å°½é‡ä¸åœ¨forå¾ªç¯ä¸­å®šä¹‰å‡½æ•°</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// exm</span></span><br><span class="line"><span class="keyword">const</span> fn = <span class="function">(<span class="params">idx</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> idx * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="number">1000</span>;i++)&#123;</span><br><span class="line">        <span class="comment">//const fn = (idx) =&gt; &#123;</span></span><br><span class="line">        <span class="comment">//    return idx * 2;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="keyword">const</span> res = fn(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>å°½é‡ä¸åœ¨forå¾ªç¯ä¸­å®šä¹‰å¯¹è±¡</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line">  <span class="keyword">let</span> res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">    <span class="comment">// const obj = &#123;</span></span><br><span class="line">    <span class="comment">//   a: i,</span></span><br><span class="line">    <span class="comment">//   b: i * 2,</span></span><br><span class="line">    <span class="comment">//   c: i * 3,</span></span><br><span class="line">    <span class="comment">// &#125;;</span></span><br><span class="line">    obj.a = i;</span><br><span class="line">    obj.b = i * <span class="number">2</span>;</span><br><span class="line">    obj.c = i * <span class="number">3</span>;</span><br><span class="line">    res += <span class="built_in">JSON</span>.stringify(obj);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>æ¸…ç©ºæ•°ç»„</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">arr = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">arr.length = <span class="number">0</span>; <span class="comment">// æ¸…ç©ºäº†æ•°ç»„ï¼Œæ•°ç»„ç±»å‹ä¸å˜</span></span><br><span class="line"><span class="comment">// arr = []  // é‡æ–°ç”³è¯·äº†ä¸€å—ç©ºæ•°ç»„å¯¹è±¡å†…å­˜</span></span><br></pre></td></tr></table></figure><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;[ç§‘æ™®]JavaScript GC&lt;/h1&gt;
&lt;h1&gt;ä¸ºä»€ä¹ˆéœ€è¦åƒåœ¾å›æ”¶&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨C / C++ä¸­ï¼Œè·Ÿè¸ªå†…å­˜çš„ä½¿ç”¨å’Œç®¡ç†å†…å­˜å¯¹å¼€å‘è€…æ¥è¯´æ˜¯å¾ˆå¤§çš„è´Ÿæ‹…
&lt;ul&gt;
&lt;li&gt;JavaScriptæ˜¯ä½¿ç”¨åƒåœ¾å›æ”¶æœºåˆ¶çš„è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰§è¡Œç¯å¢ƒè´Ÿè´£åœ¨ä»£ç æ‰§è¡Œæ—¶ç®¡ç†</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Front End" scheme="https://lebronchao.com/tags/Front-End/"/>
    
    <category term="JavaScript" scheme="https://lebronchao.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>[æ‰“åŒ…ä¼˜åŒ–]Webpackä½“ç§¯å‹ç¼©</title>
    <link href="https://lebronchao.com/2021/06/07/Webpack%E4%BD%93%E7%A7%AF%E5%8E%8B%E7%BC%A9/"/>
    <id>https://lebronchao.com/2021/06/07/Webpack%E4%BD%93%E7%A7%AF%E5%8E%8B%E7%BC%A9/</id>
    <published>2021-06-07T15:57:14.000Z</published>
    <updated>2021-06-07T15:57:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼<br/>å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼</p><p>[<a href="https://juejin.cn/post/6969018138591494158">æ‰“åŒ…ä¼˜åŒ–]Webpackä½“ç§¯å‹ç¼© (juejin.cn)</a></p></blockquote><h1>HTTPå‹ç¼©</h1><ul><li><p>HTTPå‹ç¼©æ˜¯ä¸€ç§å†…ç½®åœ¨ æœåŠ¡å™¨ å’Œ å®¢æˆ·ç«¯ ä¹‹é—´çš„ï¼Œä»¥æ”¹è¿›ä¼ è¾“é€Ÿåº¦å’Œå¸¦å®½åˆ©ç”¨ç‡çš„æ–¹å¼;</p></li><li><p>HTTPå‹ç¼©çš„æµç¨‹ä»€ä¹ˆå‘¢?</p><ul><li>ç¬¬ä¸€æ­¥:HTTPæ•°æ®åœ¨æœåŠ¡å™¨å‘é€å‰å°±å·²ç»è¢«å‹ç¼©äº†;(å¯ä»¥åœ¨webpackä¸­å®Œæˆ)</li><li>ç¬¬äºŒæ­¥:å…¼å®¹çš„æµè§ˆå™¨åœ¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œä¼šå‘ŠçŸ¥æœåŠ¡å™¨è‡ªå·±æ”¯æŒå“ªäº›å‹ç¼©æ ¼å¼;</li><li>ç¬¬ä¸‰æ­¥:æœåŠ¡å™¨åœ¨æµè§ˆå™¨æ”¯æŒçš„å‹ç¼©æ ¼å¼ä¸‹ï¼Œç›´æ¥è¿”å›å¯¹åº”çš„å‹ç¼©åçš„æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨å“åº”å¤´ä¸­å‘ŠçŸ¥æµè§ˆå™¨;</li></ul></li></ul><h2 id="å‹ç¼©æ ¼å¼">å‹ç¼©æ ¼å¼</h2><ol><li><p>compress â€“ UNIXçš„â€œcompressâ€ç¨‹åºçš„æ–¹æ³•(å†å²æ€§åŸå› ï¼Œä¸æ¨èå¤§å¤šæ•°åº”ç”¨ä½¿ç”¨ï¼Œåº”è¯¥ä½¿ç”¨gzipæˆ–</p><p>deflate);</p></li><li><p>deflate â€“ åŸºäºdeflateç®—æ³•(å®šä¹‰äºRFC 1951)çš„å‹ç¼©ï¼Œä½¿ç”¨zlibæ•°æ®æ ¼å¼å°è£…;</p></li><li><p>gzip â€“ GNU zipæ ¼å¼(å®šä¹‰äºRFC 1952)ï¼Œæ˜¯ç›®å‰ä½¿ç”¨æ¯”è¾ƒå¹¿æ³›çš„å‹ç¼©ç®—æ³•;</p></li><li><p>br â€“ ä¸€ç§æ–°çš„å¼€æºå‹ç¼©ç®—æ³•ï¼Œä¸“ä¸ºHTTPå†…å®¹çš„ç¼–ç è€Œè®¾è®¡;</p></li></ol><h2 id="Webpackå¯¹æ–‡ä»¶å‹ç¼©">Webpackå¯¹æ–‡ä»¶å‹ç¼©</h2><blockquote><p>ä½¿ç”¨CompressionPluginå¯¹æ–‡ä»¶è¿›è¡Œå‹ç¼©</p></blockquote><ul><li><p>å®‰è£…</p><ul><li><code>npm install compression-webpack-plugin</code></li></ul></li><li><p>webpack.prod.js</p><ul><li>thresholdï¼šxä»¥ä¸Šçš„æ–‡ä»¶æ‰è¿›è¡Œå‹ç¼©</li><li>minRatioï¼šæœ€å°å‹ç¼©æ¯”ï¼Œå°äºåˆ™ä¸å‹ç¼©</li><li>testï¼šæ­£åˆ™åŒ¹é…çš„æ–‡ä»¶æ‰å‹ç¼©</li><li>alogorithmï¼šå‹ç¼©ç®—æ³•</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> CompressionPlugin = <span class="built_in">require</span>(<span class="string">&quot;compression-webpack-plugin&quot;</span>)</span><br><span class="line"></span><br><span class="line">plugins:[</span><br><span class="line">    <span class="keyword">new</span>  CompressionPlugin(&#123;</span><br><span class="line">        threshold: <span class="number">0</span>,</span><br><span class="line">        minRatio:<span class="number">0.6</span>,</span><br><span class="line">        test:<span class="regexp">/\.(css|js)/i</span>,</span><br><span class="line">        algorithm:<span class="string">&quot;gzip&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h2 id="HTMLæ–‡ä»¶ä¸­ä»£ç çš„å‹ç¼©">HTMLæ–‡ä»¶ä¸­ä»£ç çš„å‹ç¼©</h2><ul><li><p>ä¹‹å‰ä½¿ç”¨äº†HtmlWebpackPluginæ’ä»¶æ¥ç”ŸæˆHTMLçš„æ¨¡æ¿ï¼Œäº‹å®ä¸Šå®ƒè¿˜æœ‰ä¸€äº›å…¶ä»–çš„é…ç½®:</p></li><li><p>inject:è®¾ç½®æ‰“åŒ…çš„èµ„æºæ’å…¥çš„ä½ç½®</p><ul><li>trueã€ false ã€bodyã€head</li></ul></li><li><p>cache:è®¾ç½®ä¸ºtrueï¼Œåªæœ‰å½“æ–‡ä»¶æ”¹å˜æ—¶ï¼Œæ‰ä¼šç”Ÿæˆæ–°çš„æ–‡ä»¶(é»˜è®¤å€¼ä¹Ÿæ˜¯true)</p></li><li><p>minify:é»˜è®¤ä¼šä½¿ç”¨ä¸€ä¸ªæ’ä»¶html-minifier-terser</p></li><li><p>webpack.prod.js</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">        title: <span class="string">&quot;LeBronChao Webpack&quot;</span>,</span><br><span class="line">        template: <span class="string">&quot;./src/index.html&quot;</span>,</span><br><span class="line">        inject:<span class="string">&quot;body&quot;</span>,</span><br><span class="line">        cache:<span class="literal">true</span>,</span><br><span class="line">        minify: isProduction ? &#123;</span><br><span class="line">            removeComments: <span class="literal">true</span>, <span class="comment">// æ˜¯å¦åˆ é™¤æ³¨é‡Š</span></span><br><span class="line">            removeRedundantAttributes:<span class="literal">true</span>, <span class="comment">// æ˜¯å¦åˆ é™¤å¤šä½™ï¼ˆé»˜è®¤ï¼‰å±æ€§</span></span><br><span class="line">            removeEmptyAttributes:<span class="literal">true</span>,  <span class="comment">// æ˜¯å¦åˆ é™¤ç©ºå±æ€§</span></span><br><span class="line">            collapseWhitespace:<span class="literal">false</span>,  <span class="comment">// æŠ˜å ç©ºæ ¼</span></span><br><span class="line">            removeStyleLinkTypeAttributes:<span class="literal">true</span>, <span class="comment">// æ¯”å¦‚linkä¸­çš„type=&quot;text/css&quot;</span></span><br><span class="line">            minifyCSS:<span class="literal">true</span>, <span class="comment">// æ˜¯å¦å‹ç¼©styleæ ‡ç­¾å†…çš„css</span></span><br><span class="line">            minifyJS:&#123;  <span class="comment">// å‹ç¼©JSé€‰é¡¹ï¼Œå¯å‚è€ƒTerseré…ç½®</span></span><br><span class="line">                mangle:&#123;</span><br><span class="line">                    toplevel: <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;: <span class="literal">false</span></span><br><span class="line">    &#125;),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h2 id="InlineChunkHtmlPlugin">InlineChunkHtmlPlugin</h2><ul><li><p>å¦å¤–æœ‰ä¸€ä¸ªæ’ä»¶ï¼Œå¯ä»¥è¾…åŠ©å°†ä¸€äº›chunkå‡ºæ¥çš„æ¨¡å—ï¼Œå†…è”åˆ°htmlä¸­:</p><ul><li>æ¯”å¦‚runtimeçš„ä»£ç ï¼Œä»£ç é‡ä¸å¤§ï¼Œä½†æ˜¯æ˜¯å¿…é¡»åŠ è½½çš„;</li><li>é‚£ä¹ˆå¯ä»¥ç›´æ¥å†…è”åˆ°htmlä¸­;</li></ul></li><li><p>è¿™ä¸ªæ’ä»¶æ˜¯åœ¨react-dev-utilsä¸­å®ç°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å®‰è£…ä¸€ä¸‹:</p><ul><li><code>npm i react-dev-utils </code></li></ul></li><li><p>åœ¨productionçš„pluginsä¸­è¿›è¡Œé…ç½®ï¼ˆå†…è”runtimeæ–‡ä»¶ï¼‰:</p><ul><li>webpack.prod.js</li><li>å‚æ•°ä¸€ä¸ºHtmlWebpackPlugin</li><li>å‚æ•°äºŒä¸ºæ­£åˆ™åŒ¹é…è¡¨è¾¾å¼</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> InlieChunkHtmlPlugin = <span class="built_in">require</span>(<span class="string">&quot;react-dev-utils/InlineChunkHtmlPlugin&quot;</span>)</span><br><span class="line"></span><br><span class="line">plugins:[</span><br><span class="line">    <span class="keyword">new</span> InlieChunkHtmlPlugin(HtmlWebpackPlugin,[<span class="regexp">/runtime.+\.js/</span>])</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h2 id="Terser">Terser</h2><ul><li><p>ä»€ä¹ˆæ˜¯Terserå‘¢?</p><ul><li>Terseræ˜¯ä¸€ä¸ªJavaScriptçš„è§£é‡Š(Parser)ã€Mangler(ç»è‚‰æœº)/Compressor(å‹ç¼©æœº)çš„å·¥å…·é›†;</li><li>æ—©æœŸä¼šä½¿ç”¨ uglify-jsæ¥å‹ç¼©ã€ä¸‘åŒ–JavaScriptä»£ç ï¼Œä½†æ˜¯ç›®å‰å·²ç»ä¸å†ç»´æŠ¤ï¼Œå¹¶ä¸”ä¸æ”¯æŒES6+çš„ è¯­æ³•;</li><li>Terseræ˜¯ä» uglify-es fork è¿‡æ¥çš„ï¼Œå¹¶ä¸”ä¿ç•™å®ƒåŸæ¥çš„å¤§éƒ¨åˆ†APIä»¥åŠé€‚é… uglify-eså’Œuglify-js@3ç­‰; ä¹Ÿå°±æ˜¯è¯´ï¼ŒTerserå¯ä»¥å¸®åŠ©å‹ç¼©ã€ä¸‘åŒ–ä»£ç ï¼Œè®©æˆ‘ä»¬çš„bundleå˜å¾—æ›´å°ã€‚</li></ul></li><li><p>å› ä¸ºTerseræ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å·¥å…·ï¼Œæ‰€ä»¥å®ƒå¯ä»¥å•ç‹¬å®‰è£…:</p><ul><li><code>npm i terser -g</code></li></ul></li><li><p>å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨Terser</p><ul><li>å› ä¸ºä»–ä»¬çš„é…ç½®éå¸¸å¤šCompress optionå’ŒMangle option</li><li>è¯¦æƒ…æŸ¥çœ‹æ–‡æ¡£<ul><li><a href="https://github.com/terser/terser#compress-options">https://github.com/terser/terser#compress-options</a></li><li><a href="https://github.com/terser/terser#mangle-options">https://github.com/terser/terser#mangle-options</a></li></ul></li></ul></li></ul><h3 id="Webpackä¸­é…ç½®Terser">Webpackä¸­é…ç½®Terser</h3><ul><li><p>é¦–å…ˆï¼Œéœ€è¦æ‰“å¼€minimizeï¼Œè®©å…¶å¯¹ä»£ç è¿›è¡Œå‹ç¼©(é»˜è®¤productionæ¨¡å¼ä¸‹å·²ç»æ‰“å¼€äº†)</p></li><li><p>å…¶æ¬¡ï¼Œå¯ä»¥åœ¨minimizeråˆ›å»ºä¸€ä¸ªTerserPlugin:</p><ul><li>extractComments:é»˜è®¤å€¼ä¸ºtrueï¼Œè¡¨ç¤ºä¼šå°†æ³¨é‡ŠæŠ½å–åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­;<ul><li>åœ¨å¼€å‘ä¸­ï¼Œä¸å¸Œæœ›ä¿ç•™è¿™ä¸ªæ³¨é‡Šæ—¶ï¼Œå¯ä»¥è®¾ç½®ä¸ºfalse;</li></ul></li><li>parallel:ä½¿ç”¨å¤šè¿›ç¨‹å¹¶å‘è¿è¡Œæé«˜æ„å»ºçš„é€Ÿåº¦ï¼Œé»˜è®¤å€¼æ˜¯trueï¼Œå¹¶å‘è¿è¡Œçš„é»˜è®¤æ•°é‡: os.cpus().length - 1;<ul><li>ä¹Ÿå¯ä»¥è®¾ç½®è‡ªå·±çš„ä¸ªæ•°ï¼Œä½†æ˜¯ä½¿ç”¨é»˜è®¤å€¼å³å¯;</li></ul></li><li>terserOptions:è®¾ç½®terserç›¸å…³çš„é…ç½®<ul><li>compress:è®¾ç½®å‹ç¼©ç›¸å…³çš„é€‰é¡¹;</li><li>mangle:è®¾ç½®ä¸‘åŒ–ç›¸å…³çš„é€‰é¡¹ï¼Œå¯ä»¥ç›´æ¥è®¾ç½®ä¸ºtrue;</li><li>toplevel:åº•å±‚å˜é‡æ˜¯å¦è¿›è¡Œè½¬æ¢;</li><li>keep_classnames:ä¿ç•™ç±»çš„åç§°;</li></ul></li></ul></li></ul><h2 id="CSSå‹ç¼©">CSSå‹ç¼©</h2><ul><li><p>å¦ä¸€ä¸ªä»£ç çš„å‹ç¼©æ˜¯CSS:</p><ul><li>CSSå‹ç¼©é€šå¸¸æ˜¯å»é™¤æ— ç”¨çš„ç©ºæ ¼ç­‰ï¼Œå› ä¸ºå¾ˆéš¾å»ä¿®æ”¹é€‰æ‹©å™¨ã€å±æ€§çš„åç§°ã€å€¼ç­‰;</li><li>CSSçš„å‹ç¼©æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ä¸ªæ’ä»¶:css-minimizer-webpack-plugin;</li><li>css-minimizer-webpack-pluginæ˜¯ä½¿ç”¨cssnanoå·¥å…·æ¥ä¼˜åŒ–ã€å‹ç¼©CSS(ä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨);</li></ul></li><li><p>å®‰è£… css-minimizer-webpack-plugin:</p><ul><li><code>npm i css-minimizer-webpack-plugin</code></li></ul></li><li><p>åœ¨optimization.minimizerä¸­é…ç½®</p></li></ul><h2 id="é…ç½®ç¤ºä¾‹">é…ç½®ç¤ºä¾‹</h2><ul><li>webpack.prod.js</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;CleanWebpackPlugin&#125; = <span class="built_in">require</span>(<span class="string">&quot;clean-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;copy-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> isProduction = <span class="literal">true</span></span><br><span class="line"><span class="keyword">const</span> TerserPlugin = <span class="built_in">require</span>(<span class="string">&quot;terser-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> CssMiniMizerPlugin = <span class="built_in">require</span>(<span class="string">&quot;css-minimizer-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    mode: <span class="string">&quot;production&quot;</span>,</span><br><span class="line">    optimization: &#123;</span><br><span class="line">        chunkIds: <span class="string">&quot;deterministic&quot;</span>,</span><br><span class="line">        minimize:<span class="literal">true</span>,</span><br><span class="line">        minimizer:[</span><br><span class="line">            <span class="keyword">new</span> TerserPlugin(&#123;</span><br><span class="line">                extractComments:<span class="literal">true</span>,</span><br><span class="line">                parallel:<span class="literal">true</span>,</span><br><span class="line">                terserOptions:&#123;</span><br><span class="line">                    compress:<span class="literal">true</span>,</span><br><span class="line">                    mangle:<span class="literal">true</span>,</span><br><span class="line">                    toplevel:<span class="literal">false</span>,</span><br><span class="line">                    keep_classnames:<span class="literal">false</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;),</span><br><span class="line">            <span class="keyword">new</span> CssMiniMizerPlugin(&#123;</span><br><span class="line">                parallel:<span class="literal">true</span></span><br><span class="line">            &#125;)</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> CleanWebpackPlugin(),</span><br><span class="line">        <span class="keyword">new</span> CopyWebpackPlugin(&#123;</span><br><span class="line">            patterns: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">from</span>: <span class="string">&quot;public&quot;</span>,</span><br><span class="line">                    <span class="comment">// å¯ä¸å†™ï¼Œé»˜è®¤åˆ°output</span></span><br><span class="line">                    to: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                    globOptions: &#123;</span><br><span class="line">                        ignore: [<span class="string">&quot;**/index.html&quot;</span>, <span class="string">&quot;**/.DS_Store&quot;</span>, <span class="string">&quot;**/abc.txt&quot;</span>],</span><br><span class="line">                    &#125;,</span><br><span class="line">                &#125;,</span><br><span class="line">            ],</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>[<a href="https://juejin.cn/post/6969018138591494158">æ‰“åŒ…ä¼˜åŒ–]Webpackä½“ç§¯å‹ç¼© (juejin.cn)</a></p><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼&lt;br/&gt;å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;https://juejin.cn/post/6969018138591494158&quot;&gt;æ‰“åŒ…ä¼˜åŒ–]Webpackä½“ç§¯å‹ç¼©</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Webpack" scheme="https://lebronchao.com/tags/Webpack/"/>
    
    <category term="æ‰“åŒ…æ„å»º" scheme="https://lebronchao.com/tags/%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA/"/>
    
    <category term="å‰ç«¯" scheme="https://lebronchao.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://lebronchao.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="Loader" scheme="https://lebronchao.com/tags/Loader/"/>
    
  </entry>
  
  <entry>
    <title>[åˆ†äº«]Webpackæ‰“åŒ…åˆ†æå·¥å…·</title>
    <link href="https://lebronchao.com/2021/06/07/Webpack%E6%89%93%E5%8C%85%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/"/>
    <id>https://lebronchao.com/2021/06/07/Webpack%E6%89%93%E5%8C%85%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/</id>
    <published>2021-06-07T15:54:31.000Z</published>
    <updated>2021-06-07T15:54:31.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼<br/>å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼</p><p>[<a href="https://juejin.cn/post/6968275465572188191">åˆ†äº«]Webpackæ‰“åŒ…åˆ†æå·¥å…· (juejin.cn)</a></p></blockquote><h1>Webpackæ‰“åŒ…åˆ†æ</h1><blockquote><p>åˆ†äº«æ—¶é—´å’Œæ–‡ä»¶çš„åˆ†æå·¥å…·ï¼Œä¾¿äºè¿›è¡Œæ‰“åŒ…ä¼˜åŒ–ã€‚</p></blockquote><h2 id="æ‰“åŒ…çš„æ—¶é—´åˆ†æ">æ‰“åŒ…çš„æ—¶é—´åˆ†æ</h2><ul><li><p>å¦‚æœå¸Œæœ›çœ‹åˆ°æ¯ä¸€ä¸ªLoaderã€æ¯ä¸€ä¸ªPluginæ¶ˆè€—çš„æ‰“åŒ…æ—¶é—´ï¼Œå¯ä»¥å€ŸåŠ©äºä¸€ä¸ªæ’ä»¶:speed-measure-webpack-plugin</p><ul><li>æ³¨æ„:è¯¥æ’ä»¶åœ¨æœ€æ–°çš„webpackç‰ˆæœ¬ä¸­å­˜åœ¨ä¸€äº›å…¼å®¹æ€§çš„é—®é¢˜(å’Œéƒ¨åˆ†Pluginä¸å…¼å®¹)</li><li>æˆªæ­¢2021-3-10æ—¥ï¼Œä½†æ˜¯ç›®å‰è¯¥æ’ä»¶è¿˜åœ¨ç»´æŠ¤ï¼Œæ‰€ä»¥å¯ä»¥ç­‰å¾…åç»­æ˜¯å¦æ›´æ–°;</li></ul></li><li><p>å®‰è£…</p><ul><li><code>npm i speed-measure-webpack-plugin</code></li></ul></li><li><p>ä½¿ç”¨</p><ul><li>åˆ›å»ºæ’ä»¶å¯¼å‡ºçš„å¯¹è±¡ SpeedMeasurePlugin;</li><li>ä½¿ç”¨ smp.wrap åŒ…è£¹æˆ‘ä»¬å¯¼å‡ºçš„webpacké…ç½®;</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> SpeedMeasurePlugin = <span class="built_in">require</span>(<span class="string">&quot;speed-measure-webpack-plugin&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> smp = <span class="keyword">new</span> SpeedMeasurePlugin()</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">env</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> isProduction = env.production;</span><br><span class="line">    process.env.NODE_ENV = isProduction ? <span class="string">&quot;production&quot;</span> : <span class="string">&quot;development&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> config = isProduction ? prodConfig : devConfig</span><br><span class="line">    <span class="keyword">const</span> webpackConfig = merge(commonConfig(isProduction), config)</span><br><span class="line">    <span class="keyword">return</span> smp.wrap(webpackConfig)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ•ˆæœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/33dce190bd2344059ba35f5923d08985~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210502234038719"></p><h2 id="æ‰“åŒ…åçš„æ–‡ä»¶åˆ†æ">æ‰“åŒ…åçš„æ–‡ä»¶åˆ†æ</h2><h3 id="æ–¹æ¡ˆä¸€ï¼šç”Ÿæˆstats-jsonæ–‡ä»¶">æ–¹æ¡ˆä¸€ï¼šç”Ÿæˆstats.jsonæ–‡ä»¶</h3><ul><li>ç¼–è¾‘npm script</li></ul><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&quot;stats&quot;: &quot;webpack --config ./config/webpack.common.js --env production --profile --json=stats.json&quot;, </span><br></pre></td></tr></table></figure><ul><li><p>è¿è¡Œnpm run stats</p><ul><li>æ ¹ç›®å½•ä¸‹ç”Ÿæˆäº†ä¸€ä¸ªstats.json</li></ul></li><li><p>jsonæ–‡ä»¶å†…å®¹è¾ƒå¤æ‚ï¼Œå¯ä»¥å°†æ–‡ä»¶ä¸Šä¼ è‡³https://webpack.github.io/analyse/ è¿›è¡Œåˆ†æ</p></li><li><p>æ•ˆæœ</p></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9e4274bbeb174029a66c2476e471d03e~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p><h3 id="æ–¹æ¡ˆäºŒï¼šä½¿ç”¨webpack-bundle-analyzer">æ–¹æ¡ˆäºŒï¼šä½¿ç”¨webpack-bundle-analyzer</h3><ul><li><p>å®‰è£…</p><ul><li><code>npm install webpack-bundle-analyzer</code></li></ul></li><li><p>webpack.common.js</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;BundleAnalyzerPlugin&#125; = <span class="built_in">require</span>(<span class="string">&quot;webpack-bundle-analyzer&quot;</span>)</span><br><span class="line"></span><br><span class="line">plugins:[</span><br><span class="line">    <span class="keyword">new</span> BundleAnalyzerPlugin()</span><br><span class="line">]</span><br></pre></td></tr></table></figure><ul><li><p>åœ¨æ‰“åŒ…webpackçš„æ—¶å€™ï¼Œè¿™ä¸ªå·¥å…·æ‰“å¼€ä¸€ä¸ª8888ç«¯å£ä¸Šçš„æœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥ç›´è§‚çš„çœ‹åˆ°æ¯ä¸ªåŒ…çš„å¤§å°ã€‚</p><ul><li>æ¯”å¦‚æœ‰ä¸€ä¸ªåŒ…æ˜¯é€šè¿‡ä¸€ä¸ªVueç»„ä»¶æ‰“åŒ…çš„ï¼Œä½†æ˜¯éå¸¸çš„å¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘æ˜¯å¦å¯ä»¥æ‹†åˆ†å‡ºå¤šä¸ªç»„ä»¶ï¼Œå¹¶ä¸”å¯¹å…¶è¿›è¡Œæ‡’åŠ è½½;</li><li>æ¯”å¦‚ä¸€ä¸ªå›¾ç‰‡æˆ–è€…å­—ä½“æ–‡ä»¶ç‰¹åˆ«å¤§ï¼Œæ˜¯å¦å¯ä»¥å¯¹å…¶è¿›è¡Œå‹ç¼©æˆ–è€…å…¶ä»–çš„ä¼˜åŒ–å¤„ç†;</li></ul></li><li><p>æ•ˆæœ</p></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/7736de9810554f7fb63fcc2dce63b65f~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210502234139506"></p><p>[<a href="https://juejin.cn/post/6968275465572188191">åˆ†äº«]Webpackæ‰“åŒ…åˆ†æå·¥å…· (juejin.cn)</a></p><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼&lt;br/&gt;å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;https://juejin.cn/post/6968275465572188191&quot;&gt;åˆ†äº«]Webpackæ‰“åŒ…åˆ†æå·¥å…·</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Webpack" scheme="https://lebronchao.com/tags/Webpack/"/>
    
    <category term="æ‰“åŒ…æ„å»º" scheme="https://lebronchao.com/tags/%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA/"/>
    
    <category term="å‰ç«¯" scheme="https://lebronchao.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://lebronchao.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="Loader" scheme="https://lebronchao.com/tags/Loader/"/>
    
  </entry>
  
  <entry>
    <title>[æ‰“åŒ…ä¼˜åŒ–]Webpack DLL</title>
    <link href="https://lebronchao.com/2021/06/07/WebpackDLL/"/>
    <id>https://lebronchao.com/2021/06/07/WebpackDLL/</id>
    <published>2021-06-07T15:53:03.000Z</published>
    <updated>2021-06-07T15:53:03.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼<br/>å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼</p><p>[<a href="https://juejin.cn/post/6967164397127270436">æ‰“åŒ…ä¼˜åŒ–]Webpack DLL (juejin.cn)</a></p></blockquote><h1>è®¤è¯†DLLåº“</h1><ul><li><p>ä»€ä¹ˆæ˜¯DLL</p><ul><li>DLLå…¨ç§°æ˜¯åŠ¨æ€é“¾æ¥åº“(Dynamic Link Library)ï¼Œæ˜¯ä¸ºè½¯ä»¶åœ¨Windowsä¸­å®ç°å…±äº«å‡½æ•°åº“çš„ä¸€ç§å®ç°æ–¹å¼;</li><li>é‚£ä¹ˆwebpackä¸­ä¹Ÿæœ‰å†…ç½®DLLçš„åŠŸèƒ½ï¼Œå®ƒæŒ‡çš„æ˜¯å¯ä»¥å°†å¯ä»¥å…±äº«ï¼Œå¹¶ä¸”ä¸ç»å¸¸æ”¹å˜çš„ä»£ç ï¼ŒæŠ½å–æˆä¸€ä¸ªå…±äº«çš„åº“;</li><li>è¿™ä¸ªåº“åœ¨ä¹‹åç¼–è¯‘çš„è¿‡ç¨‹ä¸­ï¼Œä¼šè¢«å¼•å…¥åˆ°å…¶ä»–é¡¹ç›®çš„ä»£ç ä¸­ï¼Œå‡å°‘çš„æ‰“åŒ…çš„æ—¶é—´;</li></ul></li><li><p>DDLåº“çš„ä½¿ç”¨åˆ†ä¸ºä¸¤æ­¥:</p><ul><li>ç¬¬ä¸€æ­¥:æ‰“åŒ…ä¸€ä¸ªDLLåº“;</li><li>ç¬¬äºŒæ­¥:é¡¹ç›®ä¸­å¼•å…¥DLLåº“</li></ul></li></ul><h2 id="DLLæ‰“åŒ…">DLLæ‰“åŒ…</h2><blockquote><p>webpackå†…ç½®DllPluginå¸®åŠ©ç”ŸæˆDLLæ–‡ä»¶</p></blockquote><ul><li>webpack.common.js<ul><li>contextï¼šæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œ</li><li>entryï¼š<ul><li>keyï¼šnameï¼ˆplaceholderï¼‰</li><li>valueï¼šè¦æ‰“åŒ…çš„åŒ…å</li></ul></li><li>outputï¼ˆå¸¸è§„ï¼‰</li><li>plugins<ul><li>DllPlugin<ul><li>nameï¼šå®šä¹‰ç”Ÿæˆdllæ–‡ä»¶çš„åç§°</li><li>pathï¼šç”Ÿæˆdllæ–‡ä»¶çš„æ–‡ä»¶è·¯å¾„</li></ul></li></ul></li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;DllPlugin&#125; = <span class="built_in">require</span>(<span class="string">&quot;webpack&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;merge&#125; = <span class="built_in">require</span>(<span class="string">&quot;webpack-merge&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig = <span class="function">(<span class="params">isProduction</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        context: path.resolve(__dirname, <span class="string">&quot;../&quot;</span>),</span><br><span class="line">        entry: &#123;</span><br><span class="line">            react:[<span class="string">&quot;react&quot;</span>,<span class="string">&quot;react-dom&quot;</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        output: &#123;</span><br><span class="line">           path:path.resolve(__dirname,<span class="string">&quot;../dll&quot;</span>),</span><br><span class="line">            filename:<span class="string">&quot;dll_[name].js&quot;</span>,</span><br><span class="line">            library:<span class="string">&quot;dll_[name]&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        plugins: [</span><br><span class="line">            <span class="keyword">new</span> DllPlugin(&#123;</span><br><span class="line">                name:<span class="string">&#x27;[name].manifest.json&#x27;</span>,</span><br><span class="line">                path:path.resolve(__dirname, <span class="string">&quot;../dll/[name].manifest.json&quot;</span>)</span><br><span class="line">            &#125;)</span><br><span class="line">        ],</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> devConfig = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.dev&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> prodConfig = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.prod&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">env</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> isProduction = env.production;</span><br><span class="line">    process.env.NODE_ENV = isProduction ? <span class="string">&quot;production&quot;</span> : <span class="string">&quot;development&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> config = isProduction ? prodConfig : devConfig</span><br><span class="line">    <span class="keyword">return</span> merge(commonConfig(isProduction), config)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ‰“åŒ…å®Œæˆåï¼Œåœ¨æ ¹ç›®å½•ä¸‹ä¼šæœ‰ä¸€ä¸ªdllæ–‡ä»¶å¤¹ï¼Œå†…æœ‰Dllæ–‡ä»¶å’Œç›¸åº”manifest.jsonæ–‡ä»¶ã€‚</p></blockquote><h2 id="DLLä½¿ç”¨">DLLä½¿ç”¨</h2><ul><li>å¦‚æœæˆ‘ä»¬çš„ä»£ç ä¸­ä½¿ç”¨äº†reactã€react-domï¼Œæœ‰é…ç½®splitChunksçš„æƒ…å†µä¸‹ï¼Œä»–ä»¬ä¼šè¿›è¡Œåˆ†åŒ…ï¼Œæ‰“åŒ…åˆ° ä¸€ä¸ªç‹¬ç«‹çš„chunkä¸­ã€‚<ul><li>ä½†æ˜¯ç°åœ¨æœ‰äº†dll_reactï¼Œä¸å†éœ€è¦å•ç‹¬å»æ‰“åŒ…å®ƒä»¬ï¼Œå¯ä»¥ç›´æ¥å»å¼•ç”¨dll_reactå³å¯:</li><li>ç¬¬ä¸€æ­¥:é€šè¿‡DllReferencePluginæ’ä»¶å‘ŠçŸ¥è¦ä½¿ç”¨çš„DLLåº“;</li><li>ç¬¬äºŒæ­¥:é€šè¿‡AddAssetHtmlPluginæ’ä»¶ï¼Œå°†æ‰“åŒ…çš„DLLåº“å¼•å…¥åˆ°Htmlæ¨¡å—ä¸­;</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> DllReferencePlugin(&#123;</span><br><span class="line">    context:path.resolve(__dirname, <span class="string">&quot;../&quot;</span>),</span><br><span class="line">    manifest:path.resolve(__dirname,<span class="string">&quot;../dll/react.manifest.json&quot;</span>)</span><br><span class="line">&#125;),</span><br><span class="line"><span class="keyword">new</span> AddAssetHtmlWebpackPlugin(&#123;</span><br><span class="line">    outputPath:<span class="string">&quot;../build/js&quot;</span>,</span><br><span class="line">    filepath:path.resolve(__dirname, <span class="string">&quot;../dll/dll_react.js&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure> <hr/><p>[<a href="https://juejin.cn/post/6967164397127270436">æ‰“åŒ…ä¼˜åŒ–]Webpack DLL (juejin.cn)</a></p><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼&lt;br/&gt;å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;https://juejin.cn/post/6967164397127270436&quot;&gt;æ‰“åŒ…ä¼˜åŒ–]Webpack DLL</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Webpack" scheme="https://lebronchao.com/tags/Webpack/"/>
    
    <category term="æ‰“åŒ…æ„å»º" scheme="https://lebronchao.com/tags/%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA/"/>
    
    <category term="å‰ç«¯" scheme="https://lebronchao.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://lebronchao.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="Loader" scheme="https://lebronchao.com/tags/Loader/"/>
    
  </entry>
  
  <entry>
    <title>[æ¢ç´¢]Webpack DevServerå’ŒHMRåŸç†</title>
    <link href="https://lebronchao.com/2021/06/07/WebpackDevServer%E5%92%8CHMR%E5%8E%9F%E7%90%86/"/>
    <id>https://lebronchao.com/2021/06/07/WebpackDevServer%E5%92%8CHMR%E5%8E%9F%E7%90%86/</id>
    <published>2021-06-07T15:49:57.000Z</published>
    <updated>2021-06-07T15:49:57.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼<br/>å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼</p><p>[<a href="https://juejin.cn/post/6966422095274180639">æ¢ç´¢]Webpack DevServerå’ŒHMRåŸç† (juejin.cn)</a></p></blockquote><h1>Webpack-Dev-Server</h1><blockquote><p>ä¸ºä»€ä¹ˆè¦æ­å»ºæœ¬åœ°æœåŠ¡å™¨</p></blockquote><ul><li><p>ç›®å‰å¼€å‘çš„ä»£ç ï¼Œä¸ºäº†è¿è¡Œéœ€è¦æœ‰ä¸¤ä¸ªæ“ä½œ</p><ul><li><code>npm run build</code>ç¼–è¯‘</li><li>é€šè¿‡live-serveræˆ–è€…ç›´æ¥é€šè¿‡æµè§ˆå™¨æ‰“å¼€htmlæ–‡ä»¶ï¼ŒæŸ¥çœ‹æ•ˆæœ</li></ul></li><li><p>ä¸ºäº†å®Œæˆè‡ªåŠ¨ç¼–è¯‘ï¼Œwebpackæä¾›äº†å‡ ç§å¯é€‰çš„æ–¹å¼</p><ul><li>Webpack watch mode</li><li>Webpack-dev-server</li><li>Webpack-dev-middleware</li></ul></li></ul><h2 id="Webpack-Watch-Mode">Webpack Watch Mode</h2><ul><li><p>webpackæä¾›äº†watchæ¨¡å¼</p><ul><li>åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œwebpackä¾èµ–å›¾ä¸­æ‰€æœ‰æ–‡ä»¶ï¼Œåªè¦æœ‰ä¸€ä¸ªå‘ç”Ÿäº†æ›´æ–°ï¼Œé‚£ä¹ˆä»£ç å°†è¢«é‡æ–°ç¼–è¯‘ã€‚</li><li>ä¸éœ€è¦æ‰‹åŠ¨<code>npm run build</code></li></ul></li><li><p>å¦‚ä½•å¼€å¯ï¼Ÿ</p><ul><li>æ–¹å¼ä¸€ï¼šåœ¨å¯¼å‡ºçš„é…ç½®ä¸­ï¼Œæ·»åŠ watch:true</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: <span class="string">&quot;./src/index.js&quot;</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">&quot;js/bundle.js&quot;</span>,</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">&quot;build&quot;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">    watch:<span class="literal">true</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ–¹å¼äºŒï¼šåœ¨å¯åŠ¨webapckçš„å‘½ä»¤ä¸­ï¼Œæ·»åŠ â€“watchæ ‡è¯†</li></ul><figure class="highlight"><table><tr><td class="code"><pre><span class="line">npm script:&#123;</span><br><span class="line"> &quot;watch&quot;: &quot;webpack --watch&quot;</span><br><span class="line">&#125;</span><br><span class="line"># npm run watch</span><br></pre></td></tr></table></figure><h2 id="Webpack-Dev-Server">Webpack Dev Server</h2><ul><li><p>ä¸Šé¢çš„æ–¹å¼å¯ä»¥ç›‘å¬åˆ°æ–‡ä»¶çš„å˜åŒ–ï¼Œä½†æ˜¯æ²¡æœ‰è‡ªåŠ¨åˆ·æ–°æµè§ˆå™¨çš„åŠŸèƒ½</p><ul><li>webpack-dev-serverå¯ä»¥å®ç°</li></ul></li><li><p>å®‰è£…</p><ul><li><code>npm install --save webpack-dev-server</code></li></ul></li><li><p>ä¿®æ”¹npm scriptï¼ŒåŒæ—¶å¯åœ¨é…ç½®æ–‡ä»¶ä¸­devServerå±æ€§ä¸‹é…ç½®devServer</p></li></ul><figure class="highlight"><table><tr><td class="code"><pre><span class="line">script:&#123;</span><br><span class="line">    &quot;serve&quot;:&quot;webpack serve&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>webpack-dev-serveråœ¨ç¼–è¯‘ä¹‹åä¸ä¼šå†™å…¥åˆ°ä»»ä½•è¾“å‡ºæ–‡ä»¶ã€‚è€Œæ˜¯å°†bundleæ–‡ä»¶ä¿ç•™åœ¨å†…å­˜ä¸­<ul><li>äº‹å®ä¸Šwebpck-dev-serverä½¿ç”¨äº†ä¸€ä¸ªå«memfsçš„åº“ã€‚</li></ul></li></ul><h2 id="Webpack-Dev-Middleware">Webpack Dev Middleware</h2><ul><li><p>webpack-dev-middlewareæ˜¯ä¸€ä¸ªå°è£…å™¨ï¼Œå®ƒå¯ä»¥æŠŠwebpackå¤„ç†è¿‡çš„æ–‡ä»¶å‘é€åˆ°ä¸€ä¸ªserver</p><ul><li>webpack-dev-serveråœ¨å†…éƒ¨ä½¿ç”¨äº†å®ƒï¼Œç„¶è€Œå®ƒä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„packageæ¥ä½¿ç”¨ï¼Œä»¥ä¾¿æ ¹æ®éœ€æ±‚è¿›è¡Œæ›´å¤šè‡ªå®šä¹‰é…ç½®</li><li>æ­é…ä¸€ä¸ªæœåŠ¡å™¨æ¥ä½¿ç”¨å®ƒï¼Œæ¯”å¦‚express.</li><li><code>npm install --save express webpack-dev-middleware</code></li></ul></li><li><p>ç¼–å†™Server.js</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&quot;webpack&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> webpackDevMiddleware = <span class="built_in">require</span>(<span class="string">&quot;webpack-dev-middleware&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span>  app = express()</span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&quot;./webpack.config&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> compiler = webpack(config)</span><br><span class="line"></span><br><span class="line">app.use(webpackDevMiddleware(compiler,&#123;</span><br><span class="line">    publicPath:config.output.publicPath</span><br><span class="line">&#125;),<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;è¿™é‡Œæ˜¯å›è°ƒå‡½æ•°&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3000</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Server running&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>Node Server.jså³å¯è¿è¡Œèµ·ä¸€ä¸ªæœåŠ¡ï¼Œå¹¶ç›‘å¬æ–‡ä»¶æ›´æ”¹å’Œåˆ·æ–°æµè§ˆå™¨ã€‚</li></ul><h2 id="PublicPath">PublicPath</h2><ul><li><p>Outputä¸­æœ‰ä¸¤ä¸ªå¾ˆé‡è¦çš„å±æ€§ï¼špathå’ŒpublicPath</p><ul><li>pathï¼šç”¨äºæŒ‡å®šæ–‡ä»¶çš„è¾“å‡ºè·¯å¾„ï¼Œæ˜¯ä¸€ä¸ªèšå †è·¯å¾„</li><li>publicPathï¼šé»˜è®¤æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œå®ƒä¸ºæˆ‘ä»¬é¡¹ç›®ä¸­çš„èµ„æºåˆ¶å®šä¸€ä¸ªå…¬å…±çš„è·¯å¾„publicPath</li></ul></li><li><p>è¿™ä¸ªpublicPathå¾ˆä¸å®¹æ˜“ç†è§£ï¼Œå…¶å®å°±æ˜¯ç»™æˆ‘ä»¬æ‰“åŒ…çš„èµ„æºï¼Œç»™å®ƒä¸€ä¸ªè·¯å¾„</p><ul><li>èµ„æºçš„è·¯å¾„ = output.publicePath + æ‰“åŒ…èµ„æºçš„è·¯å¾„(æ¯”å¦‚&quot;js/[name].bundle.js&quot;)</li></ul></li><li><p>å¸¸ç”¨çš„å€¼</p><ul><li>./ :æœ¬åœ°ç¯å¢ƒä¸‹å¯ä»¥ä½¿ç”¨è¿™ä¸ªç›¸å¯¹è·¯å¾„</li><li>/ :æœåŠ¡å™¨éƒ¨ç½²æ—¶ä½¿ç”¨ï¼ŒæœåŠ¡å™¨åœ°å€ + /js/[name].bundle.js</li></ul></li><li><p>devServerçš„publicPathã€outputçš„publicPathå’Œ[webpackDevMiddlewareçš„publicPath]éœ€ä¸€è‡´</p></li></ul><h2 id="ContentBase">ContentBase</h2><ul><li><p>devServerä¸­contentBaseå¯¹äºæˆ‘ä»¬ç›´æ¥è®¿é—®æ‰“åŒ…åçš„èµ„æºå…¶å®å¹¶æ²¡æœ‰å¤ªå¤§çš„ä½œç”¨ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å¦‚æœæˆ‘ä»¬æ‰“åŒ…åçš„èµ„æºï¼Œåˆä¾èµ–äºå…¶ä»–çš„ä¸€äº›èµ„æºï¼Œé‚£ä¹ˆå°±éœ€è¦æŒ‡å®šä»å“ªé‡Œæ¥æŸ¥æ‰¾è¿™ä¸ªå†…å®¹:</p><ul><li>æ¯”å¦‚åœ¨index.htmlä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¾èµ–ä¸€ä¸ª abc.js æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æˆ‘ä»¬å­˜æ”¾åœ¨ publicæ–‡ä»¶ä¸­;</li><li>åœ¨index.htmlä¸­ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•å»å¼•å…¥è¿™ä¸ªæ–‡ä»¶?<ul><li>æ¯”å¦‚ä»£ç æ˜¯è¿™æ ·çš„:<script src="./public/abc.js"></script>;</li><li>è¿™æ ·æ‰“åŒ…åæµè§ˆå™¨æ— æ³•é€šè¿‡ç›¸å¯¹è·¯å¾„å»æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹;</li><li>æ‰€ä»¥ä»£ç æ˜¯è¿™æ ·:<script src="/abc.js"></script>;</li><li>å¦‚ä½•è®©å®ƒå»æŸ¥æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶çš„å­˜åœ¨? è®¾ç½®contentBaseå³å¯;</li></ul></li></ul></li><li><p>å½“ç„¶åœ¨devServerä¸­è¿˜æœ‰ä¸€ä¸ªå¯ä»¥ç›‘å¬contentBaseå‘ç”Ÿå˜åŒ–åé‡æ–°ç¼–è¯‘çš„ä¸€ä¸ªå±æ€§ï¼šwatchContentBaseã€‚</p></li></ul><h2 id="Proxyä»£ç†">Proxyä»£ç†</h2><blockquote><p>proxyæ˜¯æˆ‘ä»¬å¼€å‘ä¸­å¸¸ç”¨çš„ä¸€ä¸ªé…ç½®é€‰é¡¹ï¼Œå®ƒçš„ç›®çš„è®¾ç½®ä»£ç†æ¥è§£å†³è·¨åŸŸè®¿é—®çš„é—®é¢˜</p></blockquote><ul><li>è®¾ç½®<ul><li>targetï¼šæ ‡è¯†çš„æ˜¯ä»£ç†åˆ°çš„ç›®æ ‡åœ°å€ï¼Œæ¯”å¦‚/api/momentä¼šè¢«ä»£ç†åˆ°http://localhost:8888/api/moment</li><li>pathRewriteï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„/apiä¹Ÿä¼šè¢«å†™å…¥åˆ°URLä¸­ï¼Œå¦‚æœå¸Œæœ›åˆ é™¤ï¼Œå¯ä»¥ä½¿ç”¨</li><li>secureï¼šé»˜è®¤æƒ…å†µä¸‹ä¸æ¥å—è½¬å‘åˆ°httpsçš„æœåŠ¡å™¨ï¼Œå¦‚æœå¸Œæœ›æ”¯æŒï¼Œè®¾ç½®ä¸ºfalse</li><li>changeOriginï¼šè¡¨ç¤ºæ˜¯å¦æ›´æ–°ä»£ç†åè¯·æ±‚headersä¸­çš„hoståœ°å€</li><li>historyApiFallbackï¼šè§£å†³SPAé¡µé¢åœ¨è·¯ç”±è·³è½¬åï¼Œè¿›è¡Œé¡µé¢åˆ·æ–°è¿”å›404çš„é”™è¯¯<ul><li>booleanå€¼ï¼šé»˜è®¤æ˜¯falseï¼Œå¦‚æœè®¾ç½®ä¸ºtrueï¼Œåˆ·æ–°çš„æ—¶å€™ï¼Œè¿”å›404é”™è¯¯æ—¶ï¼Œä¼šè‡ªåŠ¨è¿”å›index.htmlçš„å†…å®¹</li><li>objectå€¼ï¼šå¯ä»¥é…ç½®rewriteså±æ€§<ul><li>å¯ä»¥é…ç½®fromæ¥åŒ¹é…è·¯å¾„ï¼Œå†³å®šè¦è·³åˆ°å“ªä¸ªé¡µé¢ï¼Œè¯¦æƒ…æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ã€‚</li></ul></li></ul></li></ul></li></ul><h2 id="Other-Config">Other Config</h2><ul><li><p>hotOnly</p><ul><li>é»˜è®¤æƒ…å†µä¸‹å½“ä»£ç ç¼–è¯‘å¤±è´¥ä¿®å¤åä¼šåˆ·æ–°é¡µé¢ï¼Œä¸å¸Œæœ›åˆ·æ–°è®¾ç½®hotOnly:true</li></ul></li><li><p>hostä¸»æœºåœ°å€</p><ul><li>é»˜è®¤å€¼æ˜¯localhost</li><li>å¦‚æœå…¶ä»–PCä¹Ÿå¯ä»¥è®¿é—®å¯è®¾ç½®0.0.0.0</li></ul></li><li><p>localhostå’Œ0.0.0.0çš„åŒºåˆ«</p><ul><li>localhostæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŸŸåä¼šè¢«è§£æä¸º127.0.0.1</li><li>127.0.0.1æ˜¯ä¸€ä¸ªä¼šæ¢åœ°å€ï¼Œè¡¨è¾¾å¾—æ„æ€æ˜¯ä¸»æœºè‡ªå·±å‘å‡ºå»çš„åŒ…ï¼Œç›´æ¥è¢«è‡ªå·±æ¥å—<ul><li>æ­£å¸¸çš„æ•°æ®åº“åŒ…ç»å¸¸ åº”ç”¨å±‚ -&gt; ä¼ è¾“å±‚ -&gt; ç½‘ç»œå±‚ -&gt; æ•°æ®é“¾è·¯å±‚ -&gt; ç‰©ç†å±‚</li><li>è€Œå›ç¯åœ°å€ï¼Œåœ¨ç½‘è”ç»œå±‚ç›´æ¥å°±è¢«è·å–</li><li>ç›‘å¬127.0.0.1æ—¶ï¼ŒåŒä¸ªç½‘æ®µä¸‹çš„ä¸»æœºä¸­ï¼Œé€šè¿‡ipåœ°å€æ˜¯ä¸èƒ½è®¿é—®çš„ã€‚</li></ul></li><li>0.0.0.0ï¼šç›‘å¬IPV4ä¸Šæ‰€æœ‰çš„åœ°å€ï¼Œå†æ ¹æ®ç«¯å£æ‰¾åˆ°ä¸åŒçš„åº”ç”¨ç¨‹åºã€‚<ul><li>ç›‘å¬0.0.0.0æ—¶ï¼Œåœ¨åŒä¸€ä¸ªç½‘æ®µä¸‹çš„ä¸»æœºä¸­ï¼Œé€šè¿‡IPåœ°å€æ˜¯å¯ä»¥è®¿é—®çš„ã€‚</li></ul></li></ul></li><li><p>Port</p><ul><li>è®¾ç½®ç›‘å¬çš„ç«¯å£ï¼Œé»˜è®¤ä¸º8080</li></ul></li><li><p>openæ˜¯å¦æ‰“å¼€æµè§ˆå™¨</p><ul><li>é»˜è®¤ä¸ºfalseï¼Œtrueä¼šæ‰“å¼€æµè§ˆå™¨</li><li>ä¹Ÿå¯ä»¥è®¾ç½®ç±»ä¼¼äºGoogle Chromeç­‰å€¼</li></ul></li><li><p>compressæ˜¯å¦ä¸ºé™æ€æ–‡ä»¶å¼€å¯gzip compression</p><ul><li>é»˜è®¤æ˜¯æ˜¯falseï¼Œå¯ä»¥è®¾ç½®ä¸ºtrue</li></ul></li></ul><h2 id="é…ç½®ç¤ºä¾‹">é…ç½®ç¤ºä¾‹</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">    hot: <span class="literal">true</span>,</span><br><span class="line">    hostOnly:<span class="literal">true</span>,</span><br><span class="line">    host:<span class="string">&quot;0.0.0.0&quot;</span>,</span><br><span class="line">    port:<span class="number">8080</span>,</span><br><span class="line">    open:<span class="literal">true</span>,</span><br><span class="line">    compress:<span class="literal">true</span>,</span><br><span class="line">    proxy:&#123;</span><br><span class="line">        <span class="string">&quot;/api&quot;</span>:&#123;</span><br><span class="line">            target:<span class="string">&quot;http://localhost:8888&quot;</span>,</span><br><span class="line">            pathRewrite:&#123;</span><br><span class="line">                <span class="string">&quot;^/api&quot;</span>:<span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            secure:<span class="literal">false</span>,</span><br><span class="line">            changeOrigin:<span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>Hot Module Replacement</h1><ul><li><p>ä»€ä¹ˆæ˜¯HMR?</p><ul><li>HMRå…¨ç§°Hot Module Replacementï¼Œç¿»è¯‘ä¸ºæ¨¡å—çƒ­æ›¿æ¢</li><li>æ¨¡å—çƒ­æ›¿æ¢æ˜¯æŒ‡åœ¨åº”ç”¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ›¿æ¢ã€æ·»åŠ ã€åˆ é™¤æ¨¡å—ï¼Œè€Œæ— éœ€é‡æ–°åˆ·æ–°æ•´ä¸ªé¡µé¢ã€‚</li></ul></li><li><p>HMRé€šè¿‡å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼Œæ¥æé«˜å¼€å‘çš„é€Ÿåº¦ã€‚</p><ul><li>ä¸é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ï¼Œè¿™æ ·å¯ä»¥ä¿ç•™æŸäº›åº”ç”¨ç¨‹åºçš„çŠ¶æ€ä¸ä¸¢å¤±ï¼›</li><li>åªéœ€æ›´æ–°éœ€è¦å˜åŒ–çš„å†…å®¹ï¼ŒèŠ‚çœå¼€å‘æ—¶é—´</li><li>ä¿®æ”¹äº†cssã€jsæºä»£ç ï¼Œä¼šç«‹å³åœ¨æµè§ˆå™¨æ›´æ–°ï¼Œç›¸å½“äºç›´æ¥åœ¨æµè§ˆå™¨çš„devtoolsä¸­ç›´æ¥ä¿®æ”¹æ ·å¼ã€‚</li></ul></li><li><p>å¦‚ä½•ä½¿ç”¨HMRï¼Ÿ</p><ul><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œwebpack-dev-serverå·²ç»æ”¯æŒHMRï¼Œåªéœ€è¦å¼€å¯å³å¯ã€‚</li><li>åœ¨ä¸å¼€å¯HMRçš„æƒ…å†µä¸‹ï¼Œä¿®æ”¹äº†æºä»£ç åï¼Œæ•´ä¸ªé¡µé¢ä¼šè‡ªåŠ¨åˆ·æ–°ï¼Œä½¿ç”¨çš„æ˜¯live reloadingã€‚</li></ul></li><li><p>å¦‚ä½•å¼€å¯</p><ul><li>ä¿®æ”¹webpack.config.js</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: <span class="string">&quot;./src/index.js&quot;</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">&quot;js/bundle.js&quot;</span>,</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">&quot;build&quot;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">    watch:<span class="literal">true</span>,</span><br><span class="line">    mode: <span class="string">&quot;development&quot;</span>,</span><br><span class="line">    devServer:&#123;</span><br><span class="line">      hot:<span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><ul><li>æ›´æ–°åè¿˜æ˜¯åˆ·æ–°æ•´ä¸ªæµè§ˆå™¨ï¼Œå› ä¸ºéœ€è¦å®šä¹‰ä½¿ç”¨HMRçš„æ¨¡å—ã€‚</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="built_in">module</span>.hot)&#123;</span><br><span class="line">    <span class="built_in">module</span>.hot.accept(<span class="string">&quot;./App.vue&quot;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;vueæ›´æ–°äº†&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¡†æ¶çš„HMR">æ¡†æ¶çš„HMR</h2><blockquote><p>æœ‰ä¸€ä¸ªé—®é¢˜:åœ¨å¼€å‘å…¶ä»–é¡¹ç›®æ—¶ï¼Œæˆ‘ä»¬æ˜¯å¦éœ€è¦ç»å¸¸æ‰‹åŠ¨å»å†™å…¥ module.hot.accpetç›¸å…³çš„APIå‘¢?</p></blockquote><ul><li><p>æ¯”å¦‚å¼€å‘Vueã€Reacté¡¹ç›®ï¼Œæˆ‘ä»¬ä¿®æ”¹äº†ç»„ä»¶ï¼Œå¸Œæœ›è¿›è¡Œçƒ­æ›´æ–°ï¼Œè¿™ä¸ªæ—¶å€™åº”è¯¥å¦‚ä½•å»æ“ä½œ?</p></li><li><p>ç¤¾åŒºå·²ç»é’ˆå¯¹è¿™äº›æœ‰å¾ˆæˆç†Ÿçš„è§£å†³æ–¹æ¡ˆäº†:</p><ul><li>æ¯”å¦‚vueå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨vue-loaderï¼Œæ­¤loaderæ”¯æŒvueç»„ä»¶çš„HMRï¼Œæä¾›å¼€ç®±å³ç”¨çš„ä½“éªŒ;</li><li>æ¯”å¦‚reactå¼€å‘ä¸­ï¼Œæœ‰React Hot Loaderï¼Œå®æ—¶è°ƒæ•´reactç»„ä»¶(ç›®å‰Reactå®˜æ–¹å·²ç»å¼ƒç”¨äº†ï¼Œæ”¹æˆä½¿ç”¨react- refresh);</li></ul></li></ul><h2 id="Vueçš„HMR">Vueçš„HMR</h2><ul><li><p>Vueçš„åŠ è½½éœ€è¦vue-loaderï¼Œè€Œvue-loaderåŠ è½½çš„é»˜è®¤ä¼šè¿›è¡ŒHMRå¤„ç†</p></li><li><p>å®‰è£…åŠ è½½Vueæ‰€éœ€ä¾èµ–</p><ul><li><code>npm install vue-loader vue-template-compiler</code></li></ul></li><li><p>é…ç½®Webpack.config.js</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> VueLoaderPlugin = <span class="built_in">require</span>(<span class="string">&quot;vue-loader/lib/plugin&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">        &#123;</span><br><span class="line">            test: <span class="regexp">/\.vue$/</span>,</span><br><span class="line">            use: [<span class="string">&quot;vue-loader&quot;</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">   ]</span><br><span class="line">&#125;,</span><br><span class="line">plugins:[<span class="keyword">new</span> VueLoaderPlugin()]</span><br></pre></td></tr></table></figure><h2 id="Reactçš„HMR">Reactçš„HMR</h2><ul><li><p>åœ¨ä¹‹å‰ï¼ŒReactæ˜¯å€ŸåŠ©React Hot Loaderæ¥å®ç°HMRï¼Œç›®å‰å·²ç»æ”¹æˆä½¿ç”¨react-refeshæ¥å®ç°äº†</p></li><li><p>å®‰è£…ç›¸å…³ä¾èµ–</p><ul><li><code>npm install @pmmmwh/react-refresh-webpack-plugin react-refresh</code></li></ul></li><li><p>webpack.config.js</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> ReactRefreshWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;@pmmmwh/react-refresh-webpack-plugin&quot;</span>)</span><br><span class="line"></span><br><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> ReactRefreshWebpackPlugin(),</span><br><span class="line">],</span><br></pre></td></tr></table></figure><ul><li>babel.config.js</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    presets: [</span><br><span class="line">        [<span class="string">&quot;@babel/preset-env&quot;</span>, &#123;</span><br><span class="line">            useBuiltIns: <span class="string">&quot;usage&quot;</span>,</span><br><span class="line">            corejs: <span class="number">3.8</span></span><br><span class="line">        &#125;],</span><br><span class="line">        [<span class="string">&quot;@babel/preset-react&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;@babel/preset-typescript&quot;</span>]</span><br><span class="line">    ],</span><br><span class="line">    plugins: [</span><br><span class="line">        [<span class="string">&#x27;react-refresh/babel&#x27;</span>]</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="HMRçš„åŸç†">HMRçš„åŸç†</h2><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/98219680ad66478c89385a4e0fbaacd8~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210502184548214"></p><ul><li><p>é‚£ä¹ˆHMRçš„åŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¦‚ä½•å¯ä»¥åšåˆ°åªæ›´æ–°ä¸€ä¸ªæ¨¡å—ä¸­çš„å†…å®¹ï¼Ÿ</p><ul><li>webpack-dev-serverä¼šåˆ›å»ºä¸¤ä¸ªæœåŠ¡ï¼šæä¾›é™æ€èµ„æºçš„æœåŠ¡ï¼ˆexpressï¼‰å’ŒSocketï¼ˆnet.Socketï¼‰</li><li>Express Serverè´Ÿè´£ç›´æ¥æä¾›é™æ€èµ„æºæœåŠ¡ï¼ˆæ‰“åŒ…åçš„èµ„æºç›´æ¥è¢«æµè§ˆå™¨è¯·æ±‚å’Œè§£æï¼‰</li></ul></li><li><p>HMR Socket Serveræ˜¯ä¸€ä¸ªsocketé•¿è¿æ¥</p><ul><li>é•¿è¿æ¥æœ‰ä¸€ä¸ªæœ€å¥½çš„å¥½å¤„æ˜¯å»ºç«‹è¿æ¥ååŒæ–¹å¯ä»¥é€šä¿¡ï¼ˆæœåŠ¡å™¨å¯ä»¥ç›´æ¥å‘é€æ–‡ä»¶åˆ°å®¢æˆ·ç«¯ï¼‰</li><li>å½“æœåŠ¡æœŸé—´å¬åˆ°å¯¹åº”æ¨¡å—å‘ä¸Šå˜åŒ–æ—¶ï¼Œä¼šç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶.jsonï¼ˆmanifestæ–‡ä»¶ï¼‰å’Œ.jsæ–‡ä»¶ï¼ˆupdate chunkï¼‰</li><li>é€šè¿‡é•¿è¿æ¥ï¼Œå¯ä»¥ç›´æ¥å°†è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸»åŠ¨å‘é€ç»™å®¢æˆ·ç«¯ã€‚</li><li>æµè§ˆå™¨æ‹¿åˆ°ä¸¤ä¸ªæ–°çš„æ–‡ä»¶åï¼Œé€šè¿‡HMR runtimeæœºåˆ¶ï¼ŒåŠ è½½è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”é’ˆå¯¹ä¿®æ”¹çš„æ¨¡å—è¿›è¡Œæ›´æ–°ã€‚</li></ul><hr/></li></ul><p>[<a href="https://juejin.cn/post/6966422095274180639">æ¢ç´¢]Webpack DevServerå’ŒHMRåŸç† (juejin.cn)</a></p><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼&lt;br/&gt;å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;https://juejin.cn/post/6966422095274180639&quot;&gt;æ¢ç´¢]Webpack DevSe</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Webpack" scheme="https://lebronchao.com/tags/Webpack/"/>
    
    <category term="æ‰“åŒ…æ„å»º" scheme="https://lebronchao.com/tags/%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA/"/>
    
    <category term="å‰ç«¯" scheme="https://lebronchao.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://lebronchao.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="Loader" scheme="https://lebronchao.com/tags/Loader/"/>
    
  </entry>
  
  <entry>
    <title>Webpackæ¨¡å—åŒ–åŸç†å’ŒSourceMap</title>
    <link href="https://lebronchao.com/2021/05/25/Webpack%E6%A8%A1%E5%9D%97%E5%8C%96%E5%8E%9F%E7%90%86%E5%92%8CSourceMap/"/>
    <id>https://lebronchao.com/2021/05/25/Webpack%E6%A8%A1%E5%9D%97%E5%8C%96%E5%8E%9F%E7%90%86%E5%92%8CSourceMap/</id>
    <published>2021-05-25T15:31:43.000Z</published>
    <updated>2021-05-25T15:31:43.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼<br/>å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼<br/><a href="https://juejin.cn/post/6965677810862161950">æ˜é‡‘åŸæ–‡é“¾æ¥</a></p></blockquote><h1>Webpackæ¨¡å—åŒ–</h1><ul><li><p>Webpackæ‰“åŒ…çš„ä»£ç ï¼Œå…è®¸æˆ‘ä»¬ä½¿ç”¨å„ç§å„æ ·çš„æ¨¡å—åŒ–ï¼Œä½†æ˜¯æœ€å¸¸ç”¨çš„æ˜¯CommonJSã€ES Moduleã€‚</p></li><li><p>åŒ…æ‹¬å¦‚ä¸‹åŸç†:</p><ul><li>CommonJSæ¨¡å—åŒ–å®ç°åŸç†;</li><li>ES Moduleå®ç°åŸç†;</li><li>CommonJSåŠ è½½ES Moduleçš„åŸç†;</li><li>ES ModuleåŠ è½½CommonJSçš„åŸç†;</li></ul></li></ul><h2 id="CommonJSï¼š">CommonJSï¼š</h2><h3 id="æ‰“åŒ…å‰">æ‰“åŒ…å‰</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; dateFormat, priceFormat &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./js/format&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(dateFormat(<span class="string">&quot;abc&quot;</span>));</span><br><span class="line"><span class="built_in">console</span>.log(priceFormat(<span class="string">&quot;abc&quot;</span>));</span><br></pre></td></tr></table></figure><h3 id="æ‰“åŒ…å">æ‰“åŒ…å</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="comment">// æ¨¡å—çš„è·¯å¾„(key): å‡½æ•°(value)</span></span><br><span class="line"><span class="keyword">var</span> __webpack_modules__ = &#123;</span><br><span class="line">  <span class="string">&quot;./src/js/format.js&quot;</span>:</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">module</span></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">const</span> dateFormat = <span class="function">(<span class="params">date</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;2020-12-12&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> priceFormat = <span class="function">(<span class="params">price</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;100.00&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// å°†æˆ‘ä»¬è¦å¯¼å‡ºçš„å˜é‡, æ”¾å…¥åˆ°moduleå¯¹è±¡ä¸­çš„exportså¯¹è±¡</span></span><br><span class="line">      <span class="built_in">module</span>.exports = &#123;</span><br><span class="line">        dateFormat,</span><br><span class="line">        priceFormat</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªå¯¹è±¡, ä½œä¸ºåŠ è½½æ¨¡å—çš„ç¼“å­˜</span></span><br><span class="line"><span class="keyword">var</span> __webpack_module_cache__ = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜¯ä¸€ä¸ªå‡½æ•°, å½“æˆ‘ä»¬åŠ è½½ä¸€ä¸ªæ¨¡å—æ—¶, éƒ½ä¼šé€šè¿‡è¿™ä¸ªå‡½æ•°æ¥åŠ è½½</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 1.åˆ¤æ–­ç¼“å­˜ä¸­æ˜¯å¦å·²ç»åŠ è½½è¿‡</span></span><br><span class="line">  <span class="keyword">if</span> (__webpack_module_cache__[moduleId]) &#123;</span><br><span class="line">    <span class="keyword">return</span> __webpack_module_cache__[moduleId].exports;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2.ç»™moduleå˜é‡å’Œ__webpack_module_cache__[moduleId]èµ‹å€¼äº†åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">module</span> = __webpack_module_cache__[moduleId] = &#123; <span class="attr">exports</span>: &#123;&#125; &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3.åŠ è½½æ‰§è¡Œæ¨¡å—</span></span><br><span class="line">  __webpack_modules__[moduleId](<span class="built_in">module</span>, <span class="built_in">module</span>.exports, __webpack_require__);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4.å¯¼å‡ºmodule.exports &#123;dateFormat: function, priceForamt: function&#125;</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å…·ä½“å¼€å§‹æ‰§è¡Œä»£ç é€»è¾‘</span></span><br><span class="line">!<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 1.åŠ è½½./src/js/format.js</span></span><br><span class="line">  <span class="keyword">const</span> &#123; dateFormat, priceFormat &#125; = __webpack_require__(<span class="string">&quot;./src/js/format.js&quot;</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(dateFormat(<span class="string">&quot;abc&quot;</span>));</span><br><span class="line">  <span class="built_in">console</span>.log(priceFormat(<span class="string">&quot;abc&quot;</span>));</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure><h2 id="ES-Module">ES Module</h2><h3 id="æ‰“åŒ…å‰-2">æ‰“åŒ…å‰</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; sum, mul &#125; <span class="keyword">from</span> <span class="string">&quot;./js/math&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(mul(<span class="number">20</span>, <span class="number">30</span>));</span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">20</span>, <span class="number">30</span>));</span><br></pre></td></tr></table></figure><h3 id="æ‰“åŒ…å-2">æ‰“åŒ…å</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡, å¯¹è±¡é‡Œé¢æ”¾çš„æ˜¯æˆ‘ä»¬çš„æ¨¡å—æ˜ å°„</span></span><br><span class="line"><span class="keyword">var</span> __webpack_modules__ = &#123;</span><br><span class="line">  <span class="string">&quot;./src/es_index.js&quot;</span>:</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">__unused_webpack_module, __webpack_exports__, __webpack_require__</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// è°ƒç”¨rçš„ç›®çš„æ˜¯è®°å½•æ—¶ä¸€ä¸ª__esModule -&gt; true</span></span><br><span class="line">      __webpack_require__.r(__webpack_exports__);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// _js_math__WEBPACK_IMPORTED_MODULE_0__ == exports</span></span><br><span class="line">      <span class="keyword">var</span> _js_math__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(<span class="string">&quot;./src/js/math.js&quot;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="built_in">console</span>.log(_js_math__WEBPACK_IMPORTED_MODULE_0__.mul(<span class="number">20</span>, <span class="number">30</span>));</span><br><span class="line">      <span class="built_in">console</span>.log(_js_math__WEBPACK_IMPORTED_MODULE_0__.sum(<span class="number">20</span>, <span class="number">30</span>));</span><br><span class="line">    &#125;),</span><br><span class="line">  <span class="string">&quot;./src/js/math.js&quot;</span>:</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">__unused_webpack_module, __webpack_exports__, __webpack_require__</span>) </span>&#123;</span><br><span class="line">      __webpack_require__.r(__webpack_exports__);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// è°ƒç”¨äº†då‡½æ•°: ç»™exportsè®¾ç½®äº†ä¸€ä¸ªä»£ç†definition</span></span><br><span class="line">      <span class="comment">// exportså¯¹è±¡ä¸­æœ¬èº«æ˜¯æ²¡æœ‰å¯¹åº”çš„å‡½æ•°</span></span><br><span class="line">      __webpack_require__.d(__webpack_exports__, &#123;</span><br><span class="line">        <span class="string">&quot;sum&quot;</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> sum; &#125;,</span><br><span class="line">        <span class="string">&quot;mul&quot;</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> mul; &#125;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> sum = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> num1 + num2;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> mul = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> num1 * num2;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.æ¨¡å—çš„ç¼“å­˜</span></span><br><span class="line"><span class="keyword">var</span> __webpack_module_cache__ = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.requireå‡½æ•°çš„å®ç°(åŠ è½½æ¨¡å—)</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (__webpack_module_cache__[moduleId]) &#123;</span><br><span class="line">    <span class="keyword">return</span> __webpack_module_cache__[moduleId].exports;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">module</span> = __webpack_module_cache__[moduleId] = &#123;</span><br><span class="line">    <span class="built_in">exports</span>: &#123;&#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  __webpack_modules__[moduleId](<span class="built_in">module</span>, <span class="built_in">module</span>.exports, __webpack_require__);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">!<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// __webpack_require__è¿™ä¸ªå‡½æ•°å¯¹è±¡æ·»åŠ äº†ä¸€ä¸ªå±æ€§: d -&gt; å€¼function</span></span><br><span class="line">  __webpack_require__.d = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">exports</span>, definition</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> definition) &#123;</span><br><span class="line">      <span class="keyword">if</span> (__webpack_require__.o(definition, key) &amp;&amp; !__webpack_require__.o(<span class="built_in">exports</span>, key)) &#123;</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(<span class="built_in">exports</span>, key, &#123; <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">get</span>: definition[key] &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">!<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// __webpack_require__è¿™ä¸ªå‡½æ•°å¯¹è±¡æ·»åŠ äº†ä¸€ä¸ªå±æ€§: o -&gt; å€¼function </span></span><br><span class="line">  __webpack_require__.o = <span class="function"><span class="keyword">function</span> (<span class="params">obj, prop</span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.hasOwnProperty.call(obj, prop); &#125;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line">!<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// __webpack_require__è¿™ä¸ªå‡½æ•°å¯¹è±¡æ·»åŠ äº†ä¸€ä¸ªå±æ€§: r -&gt; å€¼function</span></span><br><span class="line">  __webpack_require__.r = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">exports</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Symbol</span> !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag) &#123;</span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(<span class="built_in">exports</span>, <span class="built_in">Symbol</span>.toStringTag, &#123; <span class="attr">value</span>: <span class="string">&#x27;Module&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(<span class="built_in">exports</span>, <span class="string">&#x27;__esModule&#x27;</span>, &#123; <span class="attr">value</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">__webpack_require__(<span class="string">&quot;./src/es_index.js&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="ES-Moduleå’ŒCommonJSæ··åˆå¯¼å…¥å¯¼å‡º">ES Moduleå’ŒCommonJSæ··åˆå¯¼å…¥å¯¼å‡º</h2><h3 id="æ‰“åŒ…å‰-3">æ‰“åŒ…å‰</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// es moduleå¯¼å‡ºå†…å®¹, CommonJSå¯¼å…¥å†…å®¹</span></span><br><span class="line"><span class="keyword">const</span> &#123; sum, mul &#125; = <span class="built_in">require</span>(<span class="string">&quot;./js/math&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// CommonJSå¯¼å‡ºå†…å®¹, es moduleå¯¼å…¥å†…å®¹</span></span><br><span class="line"><span class="keyword">import</span> &#123; dateFormat, priceFormat &#125; <span class="keyword">from</span> <span class="string">&quot;./js/format&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">20</span>, <span class="number">30</span>));</span><br><span class="line"><span class="built_in">console</span>.log(mul(<span class="number">20</span>, <span class="number">30</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(dateFormat(<span class="string">&quot;aaa&quot;</span>));</span><br><span class="line"><span class="built_in">console</span>.log(priceFormat(<span class="string">&quot;bbb&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(abc);</span><br></pre></td></tr></table></figure><h3 id="æ‰“åŒ…å-3">æ‰“åŒ…å</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> __webpack_modules__ = (&#123;</span><br><span class="line">  <span class="string">&quot;./src/index.js&quot;</span>:</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">__unused_webpack_module, __webpack_exports__, __webpack_require__</span>) </span>&#123;</span><br><span class="line"><span class="meta">      &quot;use strict&quot;</span>;</span><br><span class="line">      __webpack_require__.r(__webpack_exports__);</span><br><span class="line">      <span class="keyword">var</span> _js_format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(<span class="string">&quot;./src/js/format.js&quot;</span>);</span><br><span class="line">      <span class="keyword">var</span> _js_format__WEBPACK_IMPORTED_MODULE_0___default = __webpack_require__.n(_js_format__WEBPACK_IMPORTED_MODULE_0__);</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// es moduleå¯¼å‡ºå†…å®¹, CommonJSå¯¼å…¥å†…å®¹</span></span><br><span class="line">      <span class="keyword">const</span> math = __webpack_require__(<span class="string">&quot;./src/js/math.js&quot;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// CommonJSå¯¼å‡ºå†…å®¹, es moduleå¯¼å…¥å†…å®¹</span></span><br><span class="line">      <span class="built_in">console</span>.log(math.sum(<span class="number">20</span>, <span class="number">30</span>));</span><br><span class="line">      <span class="built_in">console</span>.log(math.mul(<span class="number">20</span>, <span class="number">30</span>));</span><br><span class="line">      <span class="built_in">console</span>.log(_js_format__WEBPACK_IMPORTED_MODULE_0___default().dateFormat(<span class="string">&quot;aaa&quot;</span>));</span><br><span class="line">      <span class="built_in">console</span>.log(_js_format__WEBPACK_IMPORTED_MODULE_0___default().priceFormat(<span class="string">&quot;bbb&quot;</span>));</span><br><span class="line">    &#125;),</span><br><span class="line">  <span class="string">&quot;./src/js/format.js&quot;</span>:</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">module</span></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">const</span> dateFormat = <span class="function">(<span class="params">date</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;2020-12-12&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> priceFormat = <span class="function">(<span class="params">price</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;100.00&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">module</span>.exports = &#123;</span><br><span class="line">        dateFormat,</span><br><span class="line">        priceFormat</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="string">&quot;./src/js/math.js&quot;</span>:</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">__unused_webpack_module, __webpack_exports__, __webpack_require__</span>) </span>&#123;</span><br><span class="line">      </span><br><span class="line">      __webpack_require__.r(__webpack_exports__);</span><br><span class="line">      __webpack_require__.d(__webpack_exports__, &#123;</span><br><span class="line">        <span class="string">&quot;sum&quot;</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> sum; &#125;,</span><br><span class="line">        <span class="string">&quot;mul&quot;</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> mul; &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">const</span> sum = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> num1 + num2;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> mul = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> num1 * num2;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> __webpack_module_cache__ = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The require function</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Check if module is in cache</span></span><br><span class="line">  <span class="keyword">if</span> (__webpack_module_cache__[moduleId]) &#123;</span><br><span class="line">    <span class="keyword">return</span> __webpack_module_cache__[moduleId].exports;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Create a new module (and put it into the cache)</span></span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">module</span> = __webpack_module_cache__[moduleId] = &#123;</span><br><span class="line">    <span class="comment">// no module.id needed</span></span><br><span class="line">    <span class="comment">// no module.loaded needed</span></span><br><span class="line">    <span class="built_in">exports</span>: &#123;&#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Execute the module function</span></span><br><span class="line">  __webpack_modules__[moduleId](<span class="built_in">module</span>, <span class="built_in">module</span>.exports, __webpack_require__);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Return the exports of the module</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">!<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// getDefaultExport function for compatibility with non-harmony modules</span></span><br><span class="line">  __webpack_require__.n = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">module</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> getter = <span class="built_in">module</span> &amp;&amp; <span class="built_in">module</span>.__esModule ?</span><br><span class="line">      <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">module</span>[<span class="string">&#x27;default&#x27;</span>]; &#125; :</span><br><span class="line">      <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">module</span>; &#125;;</span><br><span class="line">    __webpack_require__.d(getter, &#123; <span class="attr">a</span>: getter &#125;);</span><br><span class="line">    <span class="keyword">return</span> getter;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* webpack/runtime/define property getters */</span></span><br><span class="line">!<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// define getter functions for harmony exports</span></span><br><span class="line">  __webpack_require__.d = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">exports</span>, definition</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> definition) &#123;</span><br><span class="line">      <span class="keyword">if</span> (__webpack_require__.o(definition, key) &amp;&amp; !__webpack_require__.o(<span class="built_in">exports</span>, key)) &#123;</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(<span class="built_in">exports</span>, key, &#123; <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">get</span>: definition[key] &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* webpack/runtime/hasOwnProperty shorthand */</span></span><br><span class="line">!<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  __webpack_require__.o = <span class="function"><span class="keyword">function</span> (<span class="params">obj, prop</span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.hasOwnProperty.call(obj, prop); &#125;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* webpack/runtime/make namespace object */</span></span><br><span class="line">!<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// define __esModule on exports</span></span><br><span class="line">  __webpack_require__.r = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">exports</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Symbol</span> !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag) &#123;</span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(<span class="built_in">exports</span>, <span class="built_in">Symbol</span>.toStringTag, &#123; <span class="attr">value</span>: <span class="string">&#x27;Module&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(<span class="built_in">exports</span>, <span class="string">&#x27;__esModule&#x27;</span>, &#123; <span class="attr">value</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line">__webpack_require__(<span class="string">&quot;./src/index.js&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><blockquote><p>åŸç†éƒ½æ˜¯ç±»ä¼¼çš„</p></blockquote><ol><li>é€šè¿‡ä¸€ä¸ªwebpack_moduleå¯¹è±¡æ¥å­˜å‚¨æ¨¡å—åŒ–ä»£ç <ul><li>keyä¸ºæ–‡ä»¶åç§°</li><li>valueä¸ºæ–‡ä»¶ä»£ç </li></ul></li><li>é€šè¿‡webpack_module_cacheæ¥ç¼“å­˜æ¨¡å—åŒ–ä»£ç </li><li>é€šè¿‡webpack_requireæ¥ä»webpack_module_cacheæˆ–webpack_moduleä¸­è¯»å–å¹¶ä»å¼•å…¥ä»£ç </li></ol><h2 id="è®¤è¯†Source-Map">è®¤è¯†Source-Map</h2><blockquote><p><a href="https://developer.mozilla.org/en-US/docs/Mozilla/JavaScript_code_modules/SourceMap.jsm">å‚è€ƒæ–‡æ¡£ </a></p></blockquote><ul><li><p>æˆ‘ä»¬çš„ä»£ç é€šå¸¸è¿è¡Œåœ¨æµè§ˆå™¨ä¸Šæ—¶ï¼Œæ˜¯é€šè¿‡æ‰“åŒ…å‹ç¼©çš„:</p><ul><li>ä¹Ÿå°±æ˜¯çœŸå®è·‘åœ¨æµè§ˆå™¨ä¸Šçš„ä»£ç ï¼Œå’Œæˆ‘ä»¬ç¼–å†™çš„ä»£ç å…¶å®æ˜¯æœ‰å·®å¼‚çš„;</li><li>æ¯”å¦‚ES6çš„ä»£ç å¯èƒ½è¢«è½¬æ¢æˆES5;</li><li>æ¯”å¦‚å¯¹åº”çš„ä»£ç è¡Œå·ã€åˆ—å·åœ¨ç»è¿‡ç¼–è¯‘åè‚¯å®šä¼šä¸ä¸€è‡´;</li><li>æ¯”å¦‚ä»£ç è¿›è¡Œä¸‘åŒ–å‹ç¼©æ—¶ï¼Œä¼šå°†ç¼–ç åç§°ç­‰ä¿®æ”¹;</li><li>æ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨äº†TypeScriptç­‰æ–¹å¼ç¼–å†™çš„ä»£ç ï¼Œæœ€ç»ˆè½¬æ¢æˆJavaScript;</li></ul></li><li><p>é€šè¿‡SourceMapå¯ä»¥è°ƒè¯•è¿™ç§è½¬æ¢åä¸ä¸€è‡´çš„ä»£ç </p><ul><li>source-mapæ˜¯ä»å·²è½¬æ¢çš„ä»£ç ï¼Œæ˜ å°„åˆ°åŸå§‹çš„æºæ–‡ä»¶;</li><li>ä½¿æµè§ˆå™¨å¯ä»¥é‡æ„åŸå§‹æºå¹¶åœ¨è°ƒè¯•å™¨ä¸­æ˜¾ç¤ºé‡å»ºçš„åŸå§‹æº;</li><li>æ›´å®¹æ˜“å®šä½åˆ°æºæ–‡ä»¶é”™è¯¯</li></ul></li></ul><h3 id="å¦‚ä½•ä½¿ç”¨SourceMap">å¦‚ä½•ä½¿ç”¨SourceMap</h3><ul><li><p>ç¬¬ä¸€æ­¥:æ ¹æ®æºæ–‡ä»¶ï¼Œç”Ÿæˆsource-mapæ–‡ä»¶ï¼Œwebpackåœ¨æ‰“åŒ…æ—¶ï¼Œå¯ä»¥é€šè¿‡é…ç½®ç”Ÿæˆsource-map;</p><p><code>devtool:'source-map'</code></p></li><li><p>ç¬¬äºŒæ­¥:åœ¨è½¬æ¢åçš„ä»£ç ï¼Œæœ€åæ·»åŠ ä¸€ä¸ªæ³¨é‡Šï¼Œå®ƒæŒ‡å‘sourcemap;</p><p><code>//# sourceMappingURL=common.bundle.js.map</code></p></li><li><p>æµè§ˆå™¨ä¼šæ ¹æ®æˆ‘ä»¬çš„æ³¨é‡Šï¼ŒæŸ¥æ‰¾ç›¸åº”çš„source-mapï¼Œå¹¶ä¸”æ ¹æ®source-mapè¿˜åŸæˆ‘ä»¬çš„ä»£ç ï¼Œæ–¹ä¾¿è¿›è¡Œè°ƒè¯•ã€‚</p></li><li><p>åœ¨Chromeä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§å¦‚ä¸‹çš„æ–¹å¼æ‰“å¼€source-map:</p><ul><li>âˆšEnable JavaScript source maps</li><li>âˆšEnable CSS source maps</li></ul></li><li><p>æœ€åˆsource-mapç”Ÿæˆçš„æ–‡ä»¶å¸¦ä¸‹æ˜¯åŸå§‹æ–‡ä»¶çš„10å€ï¼Œç¬¬äºŒç‰ˆå‡å°‘äº†çº¦50%ï¼Œç¬¬ä¸‰ç‰ˆåˆå‡å°‘äº†50%ï¼Œæ‰€ä»¥ç›®å‰ä¸€ä¸ª 133kbçš„æ–‡ä»¶ï¼Œæœ€ç»ˆçš„source-mapçš„å¤§å°å¤§æ¦‚åœ¨300kbã€‚</p></li><li><p>ç›®å‰çš„source-mapé•¿ä»€ä¹ˆæ ·å­ï¼Ÿ</p><ul><li>version:å½“å‰ä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯æœ€æ–°çš„ç¬¬ä¸‰ç‰ˆ;</li><li>sources:ä»å“ªäº›æ–‡ä»¶è½¬æ¢è¿‡æ¥çš„source-mapå’Œæ‰“åŒ…çš„ä»£ç (æœ€åˆå§‹çš„æ–‡ä»¶);</li><li>names:è½¬æ¢å‰çš„å˜é‡å’Œå±æ€§åç§°(å› ä¸ºç›®å‰ä½¿ç”¨çš„æ˜¯developmentæ¨¡å¼ï¼Œæ‰€ä»¥ä¸éœ€è¦ä¿ç•™è½¬æ¢å‰çš„åç§°);</li><li>mappings:source-mapç”¨æ¥å’Œæºæ–‡ä»¶æ˜ å°„çš„ä¿¡æ¯(æ¯”å¦‚ä½ç½®ä¿¡æ¯ç­‰)ï¼Œä¸€ä¸²base64 VLQ(veriable- length quantityå¯å˜é•¿åº¦å€¼)ç¼–ç ;</li><li>file:æ‰“åŒ…åçš„æ–‡ä»¶(æµè§ˆå™¨åŠ è½½çš„æ–‡ä»¶);</li><li>sourceContent:è½¬æ¢å‰çš„å…·ä½“ä»£ç ä¿¡æ¯(å’Œsourcesæ˜¯å¯¹åº”çš„å…³ç³»);</li><li>sourceRoot:æ‰€æœ‰çš„sourcesç›¸å¯¹çš„æ ¹ç›®å½•;</li></ul></li></ul><h3 id="ç”ŸæˆSourceMap">ç”ŸæˆSourceMap</h3><blockquote><p>å¦‚ä½•åœ¨ä½¿ç”¨webpackæ‰“åŒ…çš„æ—¶å€™ï¼Œç”Ÿæˆå¯¹åº”çš„source-map?</p></blockquote><ul><li><p>webpackä¸ºæˆ‘ä»¬æä¾›äº†éå¸¸å¤šçš„é€‰é¡¹(ç›®å‰æ˜¯26ä¸ª)ï¼Œæ¥å¤„ç†source-map;</p></li><li><p>å‚è€ƒæ–‡æ¡£ï¼š<a href="https://webpack.docschina.org/configuration/devtool/">https://webpack.docschina.org/configuration/devtool/</a></p></li><li><p>é€‰æ‹©ä¸åŒçš„å€¼ï¼Œç”Ÿæˆçš„source-mapä¼šç¨å¾®æœ‰å·®å¼‚ï¼Œæ‰“åŒ…çš„è¿‡ç¨‹ä¹Ÿä¼šæœ‰æ€§èƒ½çš„å·®å¼‚ï¼Œå¯ä»¥æ ¹æ®ä¸åŒçš„æƒ…å†µè¿›è¡Œ é€‰æ‹©;</p></li></ul><blockquote><p>ä¸‹é¢å‡ ä¸ªå€¼ä¸ä¼šç”Ÿæˆsource-map</p></blockquote><ul><li><p>false:ä¸ä½¿ç”¨source-mapï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ä»»ä½•å’Œsource-mapç›¸å…³çš„å†…å®¹ã€‚</p></li><li><p>none:productionæ¨¡å¼ä¸‹çš„é»˜è®¤å€¼ï¼ˆä»€ä¹ˆå€¼éƒ½ä¸å†™ï¼‰ï¼Œä¸ç”Ÿæˆsource-mapã€‚</p></li><li><p>eval:developmentæ¨¡å¼ä¸‹çš„é»˜è®¤å€¼ï¼Œä¸ç”Ÿæˆsource-map</p><ul><li>ä½†æ˜¯å®ƒä¼šåœ¨evalæ‰§è¡Œçš„ä»£ç ä¸­ï¼Œæ·»åŠ  //# sourceURL=;</li><li>å®ƒä¼šè¢«æµè§ˆå™¨åœ¨æ‰§è¡Œæ—¶è§£æï¼Œå¹¶ä¸”åœ¨è°ƒè¯•é¢æ¿ä¸­ç”Ÿæˆå¯¹åº”çš„ä¸€äº›æ–‡ä»¶ç›®å½•ï¼Œæ–¹ä¾¿æˆ‘ä»¬è°ƒè¯•ä»£ç ;</li></ul></li></ul><blockquote><p>ä½¿ç”¨source-mapçš„å€¼</p></blockquote><ul><li><p>source-map</p><ul><li>ç”Ÿæˆç‹¬ç«‹çš„source-mapæ–‡ä»¶ï¼Œå¹¶åœ¨æ‰“åŒ…åçš„JSæ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªæ³¨é‡ŠæŒ‡å‘source-mapæ–‡ä»¶ï¼›<ul><li>æ³¨é‡Šï¼š   `` //# sourceMappingURL=bundle.js.map`</li></ul></li></ul></li><li><p>eval-source-map</p><ul><li>source-mapä»¥DataUrlçš„å½¢å¼æ·»åŠ åˆ°evalå‡½æ•°åé¢</li></ul></li><li><p>inline-source-map</p><ul><li>source-mapä»¥DataUrlçš„å½¢å¼æ·»åŠ åˆ°æ‰“åŒ…åçš„JSæ–‡ä»¶åé¢ï¼ˆæ³¨é‡Šï¼‰</li></ul></li><li><p>cheap-source-map:</p><ul><li>ä¼šç”Ÿæˆsource-mapï¼Œä½†æ˜¯ä¼šæ›´åŠ é«˜æ•ˆä¸€äº›(cheapä½å¼€é”€)ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ç”Ÿæˆåˆ—æ˜ å°„(Column Mapping)</li><li>å› ä¸ºåœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦è¡Œä¿¡æ¯é€šå¸¸å°±å¯ä»¥å®šä½åˆ°é”™è¯¯äº†</li></ul></li><li><p>cheap-module-source-map:</p><ul><li>ä¼šç”Ÿæˆsource-mapï¼Œç±»ä¼¼äºcheap-source-mapï¼Œä½†æ˜¯å¯¹æºè‡ªloaderçš„source-mapå¤„ç†ä¼šæ›´å¥½ã€‚</li><li>å¯¹æºè‡ªloaderçš„source-mapå¤„ç†ä¼šæ›´å¥½ï¼Œå®˜æ–¹ä¹Ÿæ²¡æœ‰ç»™å‡ºå¾ˆå¥½çš„è§£é‡Š å…¶å®æ˜¯å¦‚æœloaderå¯¹æˆ‘ä»¬çš„æºç è¿›è¡Œäº†ç‰¹æ®Šçš„å¤„ç†ï¼Œæ¯”å¦‚babel,ä¼šæ¢å¤æˆæºæ–‡ä»¶çš„ä»£ç æ¨¡å—æ ¼å¼ï¼Œä¾‹å¦‚ä¸ä¼šåˆ é™¤è‡ªå®šä¹‰çš„ç©ºè¡Œã€‚</li></ul></li><li><p>hidden-source-map:</p><ul><li>ä¼šç”Ÿæˆsourcemapï¼Œä½†æ˜¯ä¸ä¼šå¯¹source-mapæ–‡ä»¶è¿›è¡Œå¼•ç”¨;</li><li>ç›¸å½“äºåˆ é™¤äº†æ‰“åŒ…æ–‡ä»¶ä¸­å¯¹sourcemapçš„å¼•ç”¨æ³¨é‡Š</li><li># sourceMappingURL=bundle.js.map</li><li>å¦‚æœæ‰‹åŠ¨æ·»åŠ è¿›æ¥ï¼Œé‚£ä¹ˆsource-mapå°±ä¼šç”Ÿæ•ˆäº†</li></ul></li><li><p>nosources-source-map:</p><ul><li>ä¼šç”Ÿæˆsourcemapï¼Œä½†æ˜¯ç”Ÿæˆçš„sourcemapåªæœ‰é”™è¯¯ä¿¡æ¯çš„æç¤ºï¼Œä¸ä¼šç”Ÿæˆæºä»£ç æ–‡ä»¶;</li><li>ç‚¹å‡»é”™è¯¯ä¿¡æ¯ä¹Ÿæ— æ³•æŸ¥çœ‹æºç </li></ul></li></ul><blockquote><p>å¤šä¸ªå€¼çš„ç»„åˆ</p></blockquote><ul><li><p>äº‹å®ä¸Šï¼Œwebpackæä¾›ç»™æˆ‘ä»¬çš„26ä¸ªå€¼ï¼Œæ˜¯å¯ä»¥è¿›è¡Œå¤šç»„åˆçš„ã€‚</p></li><li><p>ç»„åˆçš„è§„åˆ™å¦‚ä¸‹:</p></li><li><p>inline-|hidden-|eval:ä¸‰ä¸ªå€¼æ—¶ä¸‰é€‰ä¸€;</p></li><li><p>nosources:å¯é€‰å€¼;</p></li><li><p>cheapå¯é€‰å€¼ï¼Œå¹¶ä¸”å¯ä»¥è·Ÿéšmoduleçš„å€¼;</p></li></ul><blockquote><p>é‚£ä¹ˆåœ¨å¼€å‘ä¸­ï¼Œæœ€ä½³çš„å®è·µæ˜¯ä»€ä¹ˆå‘¢?</p></blockquote><ul><li><p>å¼€å‘é˜¶æ®µ:æ¨èä½¿ç”¨ source-mapæˆ–è€…cheap-module-source-map</p><ul><li>è¿™åˆ†åˆ«æ˜¯vueå’Œreactä½¿ç”¨çš„å€¼ï¼Œå¯ä»¥è·å–è°ƒè¯•ä¿¡æ¯ï¼Œæ–¹ä¾¿å¿«é€Ÿå¼€å‘;</li></ul></li><li><p>æµ‹è¯•é˜¶æ®µ:æ¨èä½¿ç”¨ source-mapæˆ–è€…cheap-module-source-map</p><ul><li>æµ‹è¯•é˜¶æ®µæˆ‘ä»¬ä¹Ÿå¸Œæœ›åœ¨æµè§ˆå™¨ä¸‹çœ‹åˆ°æ­£ç¡®çš„é”™è¯¯æç¤º;</li></ul></li><li><p>å‘å¸ƒé˜¶æ®µ:falseã€ç¼ºçœå€¼(ä¸å†™)</p></li></ul><hr/><p><a href="https://juejin.cn/post/6965677810862161950">æ˜é‡‘åŸæ–‡é“¾æ¥</a></p><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼&lt;br/&gt;å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼&lt;br/&gt;&lt;a href=&quot;https://juejin.cn/post/6965677810862161950&quot;&gt;æ˜é‡‘åŸæ–‡é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;/blo</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Webpack" scheme="https://lebronchao.com/tags/Webpack/"/>
    
    <category term="æ‰“åŒ…æ„å»º" scheme="https://lebronchao.com/tags/%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA/"/>
    
    <category term="å‰ç«¯" scheme="https://lebronchao.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://lebronchao.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="Loader" scheme="https://lebronchao.com/tags/Loader/"/>
    
  </entry>
  
  <entry>
    <title>Webpack_PluginçŸ¥è¯†åˆ†äº«</title>
    <link href="https://lebronchao.com/2021/05/22/Webpack-Plugin%E7%9F%A5%E8%AF%86%E5%88%86%E4%BA%AB/"/>
    <id>https://lebronchao.com/2021/05/22/Webpack-Plugin%E7%9F%A5%E8%AF%86%E5%88%86%E4%BA%AB/</id>
    <published>2021-05-22T09:09:50.000Z</published>
    <updated>2021-05-22T09:09:50.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼<br/>å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼<br/><a href="https://juejin.cn/post/6963822022434504734">æ˜é‡‘åŸæ–‡é“¾æ¥</a></p></blockquote><h1>è®¤è¯†Plugin</h1><ul><li><p>Loaderæ˜¯ç”¨äºç‰¹å®šçš„æ¨¡å—ç±»å‹è¿›è¡Œè½¬æ¢;</p></li><li><p>Pluginå¯ä»¥ç”¨äºæ‰§è¡Œæ›´åŠ å¹¿æ³›çš„ä»»åŠ¡ï¼Œæ¯”å¦‚æ‰“åŒ…ä¼˜åŒ–ã€èµ„æºç®¡ç†ã€ç¯å¢ƒå˜é‡æ³¨å…¥ç­‰;</p></li></ul><h1>å¸¸ç”¨Plugin</h1><h2 id="CleanWebpackPlugin">CleanWebpackPlugin</h2><ul><li><p>æ¯æ¬¡ä¿®æ”¹äº†ä¸€äº›é…ç½®ï¼Œé‡æ–°æ‰“åŒ…æ—¶ï¼Œéƒ½éœ€è¦æ‰‹åŠ¨åˆ é™¤distæ–‡ä»¶å¤¹:</p></li><li><p>æˆ‘ä»¬å¯ä»¥å€ŸåŠ©äºä¸€ä¸ªæ’ä»¶æ¥å¸®åŠ©æˆ‘ä»¬å®Œæˆï¼Œè¿™ä¸ªæ’ä»¶å°±æ˜¯CleanWebpackPlugin;</p></li></ul><h3 id="å®‰è£…ï¼š">å®‰è£…ï¼š</h3><ul><li><code>npm install clean-webpack-plugin --save</code></li></ul><h3 id="é…ç½®ï¼š">é…ç½®ï¼š</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="built_in">require</span>(<span class="string">&quot;clean-webpack-plugin&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">&quot;./src/js/main.js&quot;</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&quot;bundle.js&quot;</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">&quot;build&quot;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;...&#125;,</span><br><span class="line">  plugins: [<span class="keyword">new</span> CleanWebpackPlugin()],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="HtmlWebpackPlugin">HtmlWebpackPlugin</h2><ul><li><p>æˆ‘ä»¬çš„HTMLæ–‡ä»¶æ˜¯ç¼–å†™åœ¨æ ¹ç›®å½•ä¸‹çš„ï¼Œè€Œæœ€ç»ˆæ‰“åŒ…çš„distæ–‡ä»¶å¤¹ä¸­æ˜¯æ²¡æœ‰index.htmlæ–‡ä»¶çš„ã€‚</p></li><li><p>åœ¨è¿›è¡Œé¡¹ç›®éƒ¨ç½²çš„æ—¶ï¼Œå¿…ç„¶ä¹Ÿæ˜¯éœ€è¦æœ‰å¯¹åº”çš„å…¥å£æ–‡ä»¶index.html;</p></li><li><p>æ‰€ä»¥æˆ‘ä»¬ä¹Ÿéœ€è¦å¯¹index.htmlè¿›è¡Œæ‰“åŒ…å¤„ç†;</p></li></ul><h3 id="å®‰è£…">å®‰è£…</h3><ul><li><code>npm install html-webpack-plugin --save</code></li></ul><h3 id="é…ç½®">é…ç½®</h3><ul><li><p>å¯ä¼ å…¥å˜é‡ä¾‹å¦‚titleï¼Œ</p></li><li><p>å¯è‡ªå®šä¹‰æ¨¡æ¿ï¼Œtemplateå¡«å†™æ¨¡æ¿è·¯å¾„</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">&quot;./src/js/main.js&quot;</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&quot;bundle.js&quot;</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">&quot;build&quot;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;...&#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      title: <span class="string">&quot;LeBronChao Webpack&quot;</span>,</span><br><span class="line">      template: <span class="string">&quot;./public/index.html&quot;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="æ¨¡æ¿å’Œå˜é‡å¼•ç”¨æ–¹æ³•">æ¨¡æ¿å’Œå˜é‡å¼•ç”¨æ–¹æ³•</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>&lt;%= htmlWebpackPlugin.options.title %&gt;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>LeBronChao Webpack<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="æ•ˆæœ">æ•ˆæœ</h3><ul><li><p>ç°åœ¨è‡ªåŠ¨åœ¨buildæ–‡ä»¶å¤¹ä¸­ï¼Œç”Ÿæˆäº†ä¸€ä¸ªindex.htmlçš„æ–‡ä»¶</p></li><li><p>è¯¥æ–‡ä»¶ä¸­ä¹Ÿè‡ªåŠ¨æ·»åŠ äº†æˆ‘ä»¬æ‰“åŒ…çš„bundle.jsæ–‡ä»¶</p></li><li><p>è¿™ä¸ªæ–‡ä»¶æ˜¯å¦‚ä½•ç”Ÿæˆçš„å‘¢?</p><ul><li>é»˜è®¤æƒ…å†µä¸‹æ˜¯æ ¹æ®ejsçš„ä¸€ä¸ªæ¨¡æ¿æ¥ç”Ÿæˆçš„;</li><li>åœ¨html-webpack-pluginçš„æºç ä¸­ï¼Œæœ‰ä¸€ä¸ªdefault_index.ejsæ¨¡å—;</li></ul></li></ul><h2 id="DefinePlugin">DefinePlugin</h2><blockquote><p>ç”¨äºå®šä¹‰å…¨å±€å¸¸é‡</p></blockquote><h3 id="å®‰è£…-2">å®‰è£…</h3><ul><li>Webpackå†…ç½®ï¼Œæ— éœ€å®‰è£…</li></ul><h3 id="é…ç½®-2">é…ç½®</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; DefinePlugin &#125; = <span class="built_in">require</span>(<span class="string">&quot;webpack&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">&quot;./src/js/main.js&quot;</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&quot;bundle.js&quot;</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">&quot;build&quot;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;...&#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> DefinePlugin(&#123;</span><br><span class="line">      BASE_URL: <span class="string">&quot;&#x27;./favicon.ico&#x27;&quot;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„äº‹é¡¹ï¼š</p><ol><li>å®šä¹‰çš„å˜é‡èµ‹å€¼æ—¶è‹¥ä¸ºå­—ç¬¦ä¸²éœ€åµŒå¥—å­—ç¬¦ä¸²ï¼Œè‹¥ä¸ºå˜é‡åœ¨&quot;&quot;å†…å¡«å†™å˜é‡ï¼Œå¦‚ä¸Šã€‚</li></ol></blockquote><h3 id="æ¨¡æ¿ä¸­çš„ä½¿ç”¨æ–¹æ³•">æ¨¡æ¿ä¸­çš„ä½¿ç”¨æ–¹æ³•</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>&lt;%= htmlWebpackPlugin.options.title %&gt;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%= BASE_URL %&gt;&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>LeBronChao Webpack<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="CopyWebpackPlugin">CopyWebpackPlugin</h2><ul><li>åœ¨vueçš„æ‰“åŒ…è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæˆ‘ä»¬å°†ä¸€äº›æ–‡ä»¶æ”¾åˆ°publicçš„ç›®å½•ä¸‹ï¼Œé‚£ä¹ˆè¿™ä¸ªç›®å½•ä¼šè¢«å¤åˆ¶åˆ°distæ–‡ä»¶å¤¹ä¸­ã€‚<ul><li>è¿™ä¸ªå¤åˆ¶çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨CopyWebpackPluginæ¥å®Œæˆ;</li></ul></li></ul><h3 id="å®‰è£…ï¼š-2">å®‰è£…ï¼š</h3><ul><li><code>npm install copy-webpack-plugin --save</code></li></ul><h3 id="é…ç½®ï¼š-2">é…ç½®ï¼š</h3><ul><li><p>å¤åˆ¶çš„è§„åˆ™åœ¨patternsä¸­è®¾ç½®;</p></li><li><p>from:è®¾ç½®ä»å“ªä¸€ä¸ªæºä¸­å¼€å§‹å¤åˆ¶;</p></li><li><p>to:å¤åˆ¶åˆ°çš„ä½ç½®ï¼Œå¯ä»¥çœç•¥ï¼Œä¼šé»˜è®¤å¤åˆ¶åˆ°æ‰“åŒ…çš„ç›®å½•ä¸‹,è·¯å¾„ç¼–å†™ä»¥æ‰“åŒ…ç›®å½•ä¸ºæ ¹ç›®å½•;</p></li><li><p>globOptions:è®¾ç½®ä¸€äº›é¢å¤–çš„é€‰é¡¹ï¼Œå…¶ä¸­ignoreå¯ä»¥ç¼–å†™éœ€è¦å¿½ç•¥çš„æ–‡ä»¶:</p><ul><li>DS_Store:macç›®å½•ä¸‹ä¼šè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªæ–‡ä»¶;</li><li>index.html:ä¹Ÿä¸éœ€è¦å¤åˆ¶ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»é€šè¿‡HtmlWebpackPluginå®Œæˆäº†index.htmlçš„ç”Ÿæˆ;</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;copy-webpack-plugin&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">&quot;./src/js/main.js&quot;</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&quot;bundle.js&quot;</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">&quot;build&quot;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;...&#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin(&#123;</span><br><span class="line">      patterns: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">from</span>: <span class="string">&quot;public&quot;</span>,</span><br><span class="line">          <span class="comment">// å¯ä¸å†™ï¼Œé»˜è®¤åˆ°output</span></span><br><span class="line">          to: <span class="string">&quot;build&quot;</span>,</span><br><span class="line">          globOptions: &#123;</span><br><span class="line">            ignore: [<span class="string">&quot;**/index.html&quot;</span>, <span class="string">&quot;**/.DS_Store&quot;</span>, <span class="string">&quot;**/abc.txt&quot;</span>],</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1>è‡ªå®šä¹‰Plugin</h1><ul><li><p>webpackæœ‰ä¸¤ä¸ªéå¸¸é‡è¦çš„ç±»Compilerå’ŒCompilation</p><ul><li>ä»–ä»¬é€šè¿‡æ³¨å…¥æ’ä»¶çš„æ–¹å¼ï¼Œæ¥ç›‘å¬webpackçš„æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸ</li><li>æ’ä»¶çš„æ³¨å…¥ç¦»ä¸å¼€å„ç§å„æ ·çš„Hook</li><li>Hookæ¥æºäºTapableåº“</li></ul></li><li><p>æƒ³è‡ªå®šä¹‰Pluginï¼Œå…ˆäº†è§£ä¸€ä¸ªåº“Tapable</p><ul><li>Tapableæ˜¯å®˜æ–¹ç¼–å†™å’Œç»´æŠ¤çš„ä¸€ä¸ªåº“</li><li>Tapableæ˜¯ç®¡ç†ç€éœ€è¦çš„Hookï¼Œè¿™äº›Hookå¯ä»¥åº”ç”¨åˆ°æ’ä»¶ä¸­</li></ul></li></ul><h2 id="Tapable-Hookåˆ†ç±»">Tapable Hookåˆ†ç±»</h2><ul><li><p>åŒæ­¥Sync</p><ul><li>SyncHook</li><li>SyncBailHook</li><li>SyncWaterfallHook</li><li>SyncLoopHook</li></ul></li><li><p>å¼‚æ­¥Async</p><ul><li>Paralleï¼ˆå¹¶è¡Œï¼‰<ul><li>AsyncPrarllelHook</li><li>AsyncParallelBailHook</li></ul></li><li>Seriesï¼ˆä¸²è¡Œï¼‰<ul><li>AsyncSeriesHook</li><li>AsyncSeriesBailHook</li><li>AsyncSeriresWaterfallHook</li></ul></li><li>åŒæ­¥å’Œå¼‚æ­¥çš„<ul><li>ä»¥syncå¼€å¤´çš„ä¸ºåŒæ­¥hook</li><li>ä»¥asyncå¼€å¤´çš„ï¼Œä¸¤ä¸ªäº‹ä»¶å¤„ç†å›è°ƒï¼Œä¸ä¼šç­‰å¾…ä¸Šä¸€æ¬¡å¤„ç†å›è°ƒç»“æŸåå†æ‰§è¡Œä¸‹ä¸€æ¬¡å›è°ƒã€‚</li></ul></li></ul></li><li><p>å…¶ä»–çš„ç±»åˆ«</p><ul><li>baillï¼šå½“æœ‰è¿”å›å€¼æ—¶ï¼Œå°±ä¸ä¼šæ‰§è¡Œåç»­çš„äº‹ä»¶è§¦å‘äº†ã€‚</li><li>Loopï¼šå½“è¿”å›å€¼ä¸ºtrueæ—¶ï¼Œå°±ä¼šåå¤æ‰§è¡Œè¯¥äº‹ä»¶ï¼Œå½“è¿”å›å€¼ä¸ºundefinedæˆ–è€…ä¸è¿”å›å†…å®¹æ—¶ï¼Œé€€å‡ºäº‹ä»¶</li><li>Waterfallï¼šå½“è¿”å›å€¼ä¸ä¸ºundefinedæ—¶ï¼Œä¼šå°†è¿™æ¬¡è¿”å›çš„ç»“æœä½œä¸ºä¸‹æ¬¡äº‹ä»¶çš„ç¬¬ä¸€ä¸ªå‚æ•°</li><li>Parallelï¼šå¹¶è¡Œï¼Œä¼šåŒæ—¶æ‰§è¡Œäº‹ä»¶å¤„ç†å›è°ƒçš„Hook</li><li>Seriesï¼šä¸²è¡Œï¼Œä¼šç­‰å¾…ä¸Šä¸€äº‹ä»¶å¤„ç†å›è°ƒçš„Hook</li></ul></li></ul><h2 id="Hookçš„ä½¿ç”¨è¿‡ç¨‹">Hookçš„ä½¿ç”¨è¿‡ç¨‹</h2><ol><li><p>åˆ›å»ºHookå¯¹è±¡</p><ul><li>New å¯¹è±¡ä¼ å…¥çš„æ•°ç»„ä¸ºéœ€ä¼ å…¥å‚æ•°key</li></ul></li><li><p>æ³¨å†ŒHookä¸­çš„äº‹ä»¶</p></li><li><p>è§¦å‘äº‹ä»¶</p></li></ol><ul><li>plugin.js</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;SyncWaterfallHook&#125; = <span class="built_in">require</span>(<span class="string">&quot;tapable&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tapableTest</span></span>&#123;</span><br><span class="line">    <span class="title">constructor</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.hooks = &#123;</span><br><span class="line">            syncHook:<span class="keyword">new</span> SyncWaterfallHook([<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;age&#x27;</span>])</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.hooks.syncHook.tap(<span class="string">&quot;event1&quot;</span>,<span class="function">(<span class="params">name, age</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;event1&quot;</span>, name, age);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;event1&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.hooks.syncHook.tap(<span class="string">&quot;event2&quot;</span>,<span class="function">(<span class="params">name, age</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;event2&quot;</span>, name, age);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">emit</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.hooks.syncHook.call(<span class="string">&quot;lebron&quot;</span>, <span class="number">21</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> index= <span class="keyword">new</span> tapableTest()</span><br><span class="line">index.emit()</span><br><span class="line"></span><br><span class="line"><span class="comment">// event1 lebron 21 </span></span><br><span class="line"><span class="comment">// event2 event1 21</span></span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰ä¸€ä¸ªAutoUploadPlugin">è‡ªå®šä¹‰ä¸€ä¸ªAutoUploadPlugin</h2><blockquote><p>å‰ç«¯å¼€å‘å®Œæˆåï¼Œç»å¸¸è¦æ‰“åŒ…ä¸Šä¼ ä»£ç ã€‚ä¸ªäººå¼€å‘è€…ä¸€èˆ¬ä¼šä½¿ç”¨Nginxéƒ¨ç½²æœåŠ¡ï¼Œæ¯æ¬¡ä¸Šä¼ ä»£ç å¤ªéº»çƒ¦äº†ï¼Œè‡ªå·±å†™ä¸ªPluginè®©ä»–è‡ªåŠ¨ä¸Šä¼ åˆ°Nginxæ–‡ä»¶å¤¹å§ã€‚</p></blockquote><ul><li>pluginé…ç½®<ul><li>hostï¼šä¸»æœºåœ°å€</li><li>usernameï¼šä¸»æœºç”¨æˆ·å</li><li>passwordï¼šä¸»æœºsshç™»å½•å¯†ç </li><li>remotePathï¼šè¿œç¨‹éƒ¨ç½²æœåŠ¡çš„æ–‡ä»¶å¤¹</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> AutoUploadPlugin = <span class="built_in">require</span>(<span class="string">&quot;../plugins/autoUploadPlugin&quot;</span>)</span><br><span class="line"></span><br><span class="line">plugins:[</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlgin(),</span><br><span class="line">    <span class="keyword">new</span> AutoUploadPlugin(&#123;</span><br><span class="line">        host:<span class="string">&quot;xx.xx.xx.xx&quot;</span>,</span><br><span class="line">        username:<span class="string">&quot;root&quot;</span>,</span><br><span class="line">        password:<span class="string">&quot;xxxxxxx&quot;</span>,</span><br><span class="line">        remotePath:<span class="string">&quot;/test&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><ul><li>AutoUploadPlugin.js<ul><li><p>å€ŸåŠ©node-sshåº“å®Œæˆè¿œç¨‹ç³»åˆ—æ“ä½œ</p><ol><li><code>npm i node-ssh</code></li></ol></li><li><p>Constructor</p><ol><li><p>ç”Ÿæˆsshå¯¹è±¡</p></li><li><p>æ¥æ”¶optionså‚æ•°-</p></li></ol></li><li><p>æ¯ä¸ªPluginéƒ½éœ€è¦ä¸€ä¸ªapplyå‡½æ•°æ¥æ³¨å†Œæ’ä»¶</p><ol><li>é€šè¿‡compilerå¯¹è±¡è°ƒç”¨hooksæ³¨å†Œäº‹ä»¶</li><li>é€šè¿‡compilationå¯¹è±¡è·å–æ‰“åŒ…è¾“å‡ºæ–‡ä»¶å¤¹è·¯å¾„</li><li>å»ºç«‹sshè¿æ¥</li><li>åˆ é™¤è¿œç¨‹æœåŠ¡å™¨ä¸­åŸæœ¬çš„å†…å®¹</li><li>ä¸Šä¼ ç”Ÿæˆåçš„æ–‡ä»¶åˆ°æœåŠ¡å™¨</li><li>å…³é—­sshè¿æ¥</li><li>æ‰§è¡Œå›è°ƒ</li></ol></li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; NodeSSH &#125; = <span class="built_in">require</span>(<span class="string">&quot;node-ssh&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AutoUploadPlugin</span> </span>&#123;</span><br><span class="line">    <span class="title">constructor</span> (<span class="params">options</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.ssh = <span class="keyword">new</span> NodeSSH()</span><br><span class="line">        <span class="built_in">this</span>.options = options</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    apply (compiler) &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨æ–‡ä»¶ç”Ÿæˆåçš„é’©å­</span></span><br><span class="line">        compiler.hooks.afterEmit.tapAsync(<span class="string">&quot;AutoUploadPlugin&quot;</span>, <span class="keyword">async</span> (compilation, callback) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 1. è·å–è¾“å‡ºçš„æ–‡ä»¶å¤¹è·¯å¾„</span></span><br><span class="line">            <span class="keyword">const</span> outputPath = compilation.outputOptions.path</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 2. è¿æ¥æœåŠ¡å™¨ï¼ˆsshï¼‰</span></span><br><span class="line">            <span class="keyword">await</span> <span class="built_in">this</span>.connectServer()</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 3. åˆ é™¤åŸæ¥ç›®å½•ä¸­çš„å†…å®¹</span></span><br><span class="line">            <span class="keyword">const</span> serverDir = <span class="built_in">this</span>.options.remotePath</span><br><span class="line">            <span class="keyword">await</span> <span class="built_in">this</span>.ssh.execCommand(<span class="string">`rm -rf <span class="subst">$&#123;serverDir&#125;</span>/*`</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 4. ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨</span></span><br><span class="line">            <span class="keyword">await</span> <span class="built_in">this</span>.uploadFiles(outputPath, serverDir)</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 5. å…³é—­SSH</span></span><br><span class="line">            <span class="built_in">this</span>.ssh.dispose();</span><br><span class="line"></span><br><span class="line">            callback()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> connectServer () &#123;</span><br><span class="line">        <span class="keyword">await</span> <span class="built_in">this</span>.ssh.connect(&#123;</span><br><span class="line">            host: <span class="built_in">this</span>.options.host,</span><br><span class="line">            username: <span class="built_in">this</span>.options.username,</span><br><span class="line">            password: <span class="built_in">this</span>.options.password</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> uploadFiles (localPath, remotePath) &#123;</span><br><span class="line">        <span class="keyword">const</span> status = <span class="keyword">await</span> <span class="built_in">this</span>.ssh.putDirectory(localPath, remotePath, &#123;</span><br><span class="line">            <span class="comment">// é€’å½’ä¸Šä¼ æ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line">            recursive: <span class="literal">true</span>,</span><br><span class="line">            <span class="comment">// å¹¶å‘æ•°</span></span><br><span class="line">            concurrency: <span class="number">10</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;Upload &quot;</span> + status ? <span class="string">&quot;æˆåŠŸ&quot;</span> : <span class="string">&quot;å¤±è´¥&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = AutoUploadPlugin</span><br></pre></td></tr></table></figure><p><a href="https://juejin.cn/post/6963822022434504734">æ˜é‡‘åŸæ–‡é“¾æ¥</a></p><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼&lt;br/&gt;å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼&lt;br/&gt;&lt;a href=&quot;https://juejin.cn/post/6963822022434504734&quot;&gt;æ˜é‡‘åŸæ–‡é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;/blo</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Webpack" scheme="https://lebronchao.com/tags/Webpack/"/>
    
    <category term="æ‰“åŒ…æ„å»º" scheme="https://lebronchao.com/tags/%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA/"/>
    
    <category term="å‰ç«¯" scheme="https://lebronchao.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://lebronchao.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="Loader" scheme="https://lebronchao.com/tags/Loader/"/>
    
  </entry>
  
  <entry>
    <title>Webpack LoaderçŸ¥è¯†åˆ†äº«</title>
    <link href="https://lebronchao.com/2021/05/18/Webpack%20Loader%E7%9F%A5%E8%AF%86%E5%88%86%E4%BA%AB/"/>
    <id>https://lebronchao.com/2021/05/18/Webpack%20Loader%E7%9F%A5%E8%AF%86%E5%88%86%E4%BA%AB/</id>
    <published>2021-05-18T15:57:56.000Z</published>
    <updated>2021-05-18T15:57:56.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼<br/>å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼</p></blockquote><h1>è®¤è¯†Loader</h1><blockquote><p>Loaderå¯ä»¥ç”¨äºå¯¹æ¨¡å—çš„æºä»£ç è¿›è¡Œè½¬æ¢ï¼›</p><p>åœ¨åŠ è½½è¿™ä¸ªæ¨¡å—æ—¶ï¼Œwebpackå…¶å®å¹¶ä¸çŸ¥é“å¦‚ä½•å¯¹å…¶è¿›è¡ŒåŠ è½½ï¼Œæˆ‘ä»¬å¿…é¡»å®šåˆ¶å¯¹åº”çš„loaderæ¥å®Œæˆè¿™ä¸ªåŠŸèƒ½ã€‚</p></blockquote><h2 id="loaderé…ç½®æ–¹å¼">loaderé…ç½®æ–¹å¼</h2><ul><li><p>å†…è”æ–¹å¼ï¼š<code>import &quot;css-loader!../css/index.css&quot;</code>; loaderå’Œæ–‡ä»¶è·¯å¾„ç”¨ï¼åˆ†éš”</p></li><li><p>é…ç½®æ–¹å¼ï¼šwebpack.config.js</p></li><li><p>é…ç½®æ–¹å¼è¡¨ç¤ºçš„æ„æ€æ˜¯åœ¨æˆ‘ä»¬çš„webpack.config.jsæ–‡ä»¶ä¸­å†™æ˜é…ç½®ä¿¡æ¯</p><ul><li>module.rulesä¸­å…è®¸æˆ‘ä»¬é…ç½®å¤šä¸ªloaderï¼ˆå› ä¸ºæˆ‘ä»¬ä¹Ÿä¼šç»§ç»­ä½¿ç”¨å…¶ä»–Loaderï¼Œæ¥å®Œæˆå…¶ä»–æ–‡ä»¶çš„åŠ è½½ï¼‰</li><li>è¿™ç§æ–¹å¼å¯ä»¥æ›´å¥½åœ°æ ‡è¯†loaderé…ç½®ï¼Œä¹Ÿæ–¹ä¾¿åæœŸçš„ç»´æŠ¤ï¼ŒåŒæ—¶ä¹Ÿè®©ä½ å¯¹å„ä¸ªLoaderæœ‰ä¸€ä¸ªå…¨å±€çš„æ¦‚è§ˆï¼›</li></ul></li><li><p>module.rulesçš„é…ç½®å¦‚ä¸‹</p></li><li><p>ruleså±æ€§å¯¹åº”çš„å€¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼š[Rule]</p></li><li><p>æ•°ç»„ä¸­å­˜æ”¾çš„æ˜¯ä¸€ä¸ªä¸ªRuleï¼ŒRuleæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡ä¸­å¯ä»¥è®¾ç½®å¤šä¸ªå±æ€§</p><ul><li>testå±æ€§ï¼šç”¨äºå¤šresourceï¼ˆèµ„æºï¼‰æ–‡ä»¶åè¿›è¡ŒåŒ¹é…ï¼Œé€šå¸¸ä¼šè®¾ç½®æˆæ­£åˆ™è¡¨è¾¾å¼ï¼›</li><li>useå±æ€§ï¼šå¯¹åº”çš„å€¼æ˜¯ä¸€ä¸ªæ•°ç»„[useEntry]<ul><li>æ‰§è¡Œé¡ºåºä»åå¾€å‰ï¼Œæ¯”å¦‚è§£æcssï¼Œcss-loaderåº”åœ¨style-loaderåé¢ã€‚</li><li>UseEntryæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡å¯¹è±¡çš„å±æ€§æ¥è®¾ç½®ä¸€äº›å…¶ä»–å±æ€§<ul><li>loaderï¼šå¿…é¡»æœ‰ä¸€ä¸ªloaderå±æ€§ï¼Œå¯¹åº”çš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</li><li>optionsï¼šå¯é€‰çš„å±æ€§ï¼Œå€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…å¯¹è±¡ï¼Œå€¼ä¼šè¢«ä¼ å…¥åˆ°loaderä¸­ï¼›</li><li>queryï¼šç›®å‰å·²è¢«optionsæ›¿ä»£</li></ul></li><li>ä¼ é€’å­—ç¬¦ä¸²ï¼ˆå¦‚ï¼šuse:[â€˜style-loaderâ€™]ï¼‰æ˜¯loaderå±æ€§çš„ç®€å†™ï¼ˆå¦‚ï¼šuse:[{loader:â€˜style-loaderâ€™}]ï¼‰</li></ul></li></ul></li></ul><h1>å¸¸è§Loader</h1><h2 id="CSS-loader">CSS loader</h2><ul><li><p>æˆ‘ä»¬å¯ä»¥å°†cssæ–‡ä»¶ä¹Ÿçœ‹æˆæ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡importæ¥åŠ è½½è¿™ä¸ªæ¨¡å—çš„</p></li><li><p>é‚£ä¹ˆéœ€è¦ä¸€ä¸ªä»€ä¹ˆæ ·çš„loaderå‘¢</p><ul><li><p>å¯¹äºåŠ è½½cssæ–‡ä»¶æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¯ä»¥è¯»å–cssæ–‡ä»¶çš„loader</p></li><li><p>æœ€å¸¸ç”¨çš„æ˜¯css-loader</p></li><li><p>åªè´Ÿè´£è§£æcssæ–‡ä»¶ï¼Œä¸ä¼šä½œç”¨äºé¡µé¢ï¼Œæ­¤å¤–è¿˜éœ€è¦style-loaderä½œç”¨äºé¡µé¢</p><p><code>npm i style-loader --save</code></p></li></ul></li><li><p>css-loaderçš„å®‰è£…ï¼š</p><p><code>npm install css-loader --save</code></p></li><li><p>ä»¥ä¸‹ä¸ºä¸€ä¸ªcss-loaderçš„é…ç½®æ–‡ä»¶</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">&quot;./src/js/main.js&quot;</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&quot;bundle.js&quot;</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">&quot;build&quot;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>, <span class="comment">//èµ„æºæ–‡ä»¶åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">&quot;style-loader&quot;</span>,</span><br><span class="line">            options: &#123;&#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="comment">// ç®€å†™ï¼š</span></span><br><span class="line">          <span class="comment">// â€œcss-loaderâ€</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="comment">// å®Œæ•´å†™æ³•</span></span><br><span class="line">            loader: <span class="string">&quot;css-loader&quot;</span>, <span class="comment">// å¯¹åº”çš„loader</span></span><br><span class="line">            options: &#123;&#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><p>lessåŒç†</p><p><code>npm install less-loader less --save</code>å®‰è£…è¿™ä¸¤ä¸ªæ’ä»¶å</p></li><li><p>ä¾æ¬¡åœ¨useæ•°ç»„å†…å†™å…¥style-loaderã€css-loaderã€less-loader</p></li></ul><h2 id="æµè§ˆå™¨å…¼å®¹æ€§">æµè§ˆå™¨å…¼å®¹æ€§</h2><ul><li><p>å¦‚æœåœ¨csså…¼å®¹æ€§å’Œjså…¼å®¹æ€§ä¸‹å…±äº«æˆ‘ä»¬çš„é…ç½®å…¼å®¹æ€§æ¡ä»¶å‘¢</p><ul><li>å°±æ˜¯å½“æˆ‘ä¹ˆä»¬è®¾ç½®äº†ä¸€ä¸ªæ¡ä»¶ï¼š&gt;1% last 2 version Firefoxã€Chromeâ€¦ not dead éƒ½æ˜¯å¯é€‰é¡¹ï¼Œå¤šä¸ªé€‰é¡¹ä»¥ï¼Œåˆ†éš”ä¸º || æ¡ä»¶ï¼›andä¸º&amp;&amp;å…³ç³»ï¼›å¯ç”¨notæ¡ä»¶</li><li>æ„æ€ä¸ºjsã€csså…¼å®¹å¸‚åœºå æœ‰ç‡å¤§äº1%çš„Firefoxã€Chromeæµè§ˆå™¨å’Œæœ€æ–°çš„ä¸¤ä¸ªç‰ˆæœ¬ï¼Œå¹¶ä¸”24ä¸ªæœˆå†…æœ‰å®˜æ–¹æ”¯æŒå’Œæ›´æ–°çš„æµè§ˆå™¨ï¼ˆdeadè¿‡æ»¤æ¡ä»¶ï¼‰</li></ul></li><li><p>åœ¨æ ¹ç›®å½•.browserlistrcæ–‡ä»¶ç¼–å†™æ¡ä»¶</p></li><li><p>é€šè¿‡å¯å®ç°å¯¹å¸‚åœºå æœ‰æ¯”ç‡çš„è¦å»ï¼Œç‰ˆæœ¬è¦æ±‚ç­‰è¿›è¡Œé…ç½®ï¼Œé€‚é…æµè§ˆå™¨</p></li><li><p>æ‰€ç”¨å·¥å…·ï¼š</p><ul><li>æ•°æ®æ¥æºï¼šbrowserlistï¼Œæµè§ˆå™¨å¸‚åœºå æœ‰ç‡ï¼Œç²¾ç¡®åˆ°æ¯ä¸ªç‰ˆæœ¬</li><li>å¤„ç†æ’ä»¶ï¼šautoprefixerã€babelã€postcss-preset-envç­‰</li></ul></li></ul><h2 id="è®¤è¯†PostCSSå·¥å…·">è®¤è¯†PostCSSå·¥å…·</h2><ul><li><p>ä»€ä¹ˆæ˜¯PostCSSå·¥å…·å‘¢ï¼Ÿ</p><ul><li>PostCSSæ˜¯ä¸€ä¸ªé€šè¿‡JavaScriptæ¥è½¬æ¢æ ·å¼çš„å·¥å…·</li><li>è¿™ä¸ªå·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œä¸€äº›CSSæ ·å¼çš„è½¬æ¢å’Œé€‚é…ï¼Œæ¯”å¦‚è‡ªåŠ¨æ·»åŠ æµè§ˆå™¨å‰ç¼€ã€cssæ ·å¼çš„å……å€¼ï¼›</li><li>ä½†æ˜¯å®ç°è¿™äº›åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©äºPostCSSæ’ä»¶</li></ul></li><li><p>å¦‚ä½•ä½¿ç”¨PostCSS</p></li></ul><ol><li>æŸ¥æ‰¾PostCSSåœ¨æ„å»ºå·¥å…·ä¸­çš„æ‰©å±•ï¼Œæ¯”å¦‚webpackä¸­çš„postcss-loaderï¼›</li><li>é€‰æ‹©å¯ä»¥æ·»åŠ ä½ éœ€è¦çš„PostCssç›¸å…³æ’ä»¶</li></ol><h3 id="æ‰‹åŠ¨ä½¿ç”¨PostCSS">æ‰‹åŠ¨ä½¿ç”¨PostCSS</h3><blockquote><p>ä½¿ç”¨postcss-cliæ“ä½œï¼Œéœ€è¦ç”¨åˆ°autoprefixeræ’ä»¶</p></blockquote><ol><li><code>npm install postcss postcss-cli --save</code></li><li><code>npm install autoprefixer --save</code></li><li><code>npx postcss --use autoprefixer  -o 'è¾“å‡ºè·¯å¾„'   'è¾“å‡ºè·¯å¾„' </code>ï¼Œä¾‹å¦‚ï¼š<ol><li><code>npx postcss --use autoprefixer  -o ./src/css/result.css ./src/css/user.css</code></li></ol></li></ol><h3 id="Webpacké…ç½®æ–‡ä»¶ä½¿ç”¨PostCSS">Webpacké…ç½®æ–‡ä»¶ä½¿ç”¨PostCSS</h3><ol><li>å®‰è£…postcss-loaderå’Œautoprefixer<ul><li><code>npm install postcss-loader autoprefixer --save</code></li></ul></li><li>ç¼–å†™é…ç½®æ–‡ä»¶<ul><li>css-loaderå¤„ç†å‰å…ˆç”¨postcss-loaderå¤„ç†</li><li>åœ¨optionsçš„postcssOptionsä¸­ï¼Œé…ç½®pluginsï¼Œä½¿ç”¨autoprefixer</li></ul></li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>, <span class="comment">//èµ„æºæ–‡ä»¶åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">&quot;style-loader&quot;</span>,</span><br><span class="line">            options: &#123;&#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="comment">// ç®€å†™ï¼š</span></span><br><span class="line">          <span class="comment">// â€œcss-loaderâ€</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="comment">// å®Œæ•´å†™æ³•</span></span><br><span class="line">            loader: <span class="string">&quot;css-loader&quot;</span>, <span class="comment">// å¯¹åº”çš„loader</span></span><br><span class="line">            options: &#123;&#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">&quot;postcss-loader&quot;</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              postcssOptions: &#123;</span><br><span class="line">                plugins: [<span class="built_in">require</span>(<span class="string">&quot;autoprefixer&quot;</span>)],</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h3 id="postcss-preset-env">postcss-preset-env</h3><ul><li><p>äº‹å®ä¸Šï¼Œåœ¨é…ç½®postcss-loaderæ—¶ï¼Œæˆ‘ä»¬é…ç½®æ’ä»¶å¹¶ä¸éœ€è¦ä½¿ç”¨autoprefixerã€‚</p></li><li><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ä¸ªæ’ä»¶:postcss-preset-env</p><ul><li><p>postcss-preset-envä¹Ÿæ˜¯ä¸€ä¸ªpostcssçš„æ’ä»¶;</p></li><li><p>å®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬å°†ä¸€äº›ç°ä»£çš„CSSç‰¹æ€§ï¼Œè½¬æˆå¤§å¤šæ•°æµè§ˆå™¨è®¤è¯†çš„CSSï¼Œå¹¶ä¸”ä¼šæ ¹æ®ç›®æ ‡æµè§ˆå™¨æˆ–è€…è¿è¡Œæ—¶ç¯ å¢ƒæ·»åŠ æ‰€éœ€çš„polyfill;</p><ul><li>ä¾‹å¦‚å…«ä½çš„åå…­è¿›åˆ¶é¢œè‰²ä¼šå¸®æˆ‘ä»¬è½¬æ¢æˆRGBA</li></ul></li><li><p>ä¹ŸåŒ…æ‹¬ä¼šè‡ªåŠ¨å¸®åŠ©æˆ‘ä»¬æ·»åŠ autoprefixer(æ‰€ä»¥ç›¸å½“äºå·²ç»å†…ç½®äº†autoprefixer);</p></li><li><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…postcss-preset-env:</p><p><code>npm install postcss-preset-env --save</code></p></li><li><p>ä¹‹åï¼Œæˆ‘ä»¬ç›´æ¥ä¿®æ”¹æ‰ä¹‹å‰çš„autoprefixerå³å¯:</p></li></ul></li><li><p>é…ç½®ç®€åŒ–</p><ul><li>åœ¨useä¸­åªå†™postcss-loader</li><li>åœ¨é¡¹ç›®æ ¹ç›®å½•å»ºç«‹postcss.config.jsï¼Œå†™å…¥é…ç½®</li></ul></li></ul><blockquote><p>webpack.config.js</p></blockquote><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">&quot;./src/js/main.js&quot;</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&quot;bundle.js&quot;</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">&quot;build&quot;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>, <span class="comment">//èµ„æºæ–‡ä»¶åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">&quot;style-loader&quot;</span>,</span><br><span class="line">            options: &#123;&#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="comment">// ç®€å†™ï¼š</span></span><br><span class="line">          <span class="comment">// â€œcss-loaderâ€</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="comment">// å®Œæ•´å†™æ³•</span></span><br><span class="line">            loader: <span class="string">&quot;css-loader&quot;</span>, <span class="comment">// å¯¹åº”çš„loader</span></span><br><span class="line">            options: &#123;&#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="string">&quot;postcss-loader&quot;</span>,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        use: [<span class="string">&quot;style-loader&quot;</span>, <span class="string">&quot;css-loader&quot;</span>, <span class="string">&quot;postcss-loader&quot;</span>, <span class="string">&quot;less-loader&quot;</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>postcss.config.js</p></blockquote><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">      <span class="comment">// å¼•å…¥</span></span><br><span class="line">      <span class="comment">// require(&quot;postcss-preset-env&quot;)</span></span><br><span class="line">      <span class="comment">//ç®€å†™</span></span><br><span class="line">      <span class="string">&quot;postcss-preset-env&quot;</span></span><br><span class="line">    ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="æ•ˆæœ">æ•ˆæœ</h3><blockquote><p>Before</p></blockquote><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-pseudo">:fullscreen</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.content</span>&#123;</span><br><span class="line">    user-select: none;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">2s</span> ease;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>After</p></blockquote><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">:-webkit-full-screen&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">:-ms-fullscreen&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">:fullscreen</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.content</span>&#123;</span><br><span class="line">    -webkit-user-select: none;</span><br><span class="line">       -moz-user-select: none;</span><br><span class="line">        -ms-user-select: none;</span><br><span class="line">            user-select: none;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">2s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBOztBQUZBOztBQUVBOztBQUZBOztBQUVBOztBQUVBO0lBQ0kseUJBQWlCO09BQWpCLHNCQUFpQjtRQUFqQixxQkFBaUI7WUFBakIsaUJBQWlCO0lBQ2pCLHVCQUF1QjtBQUMzQiIsImZpbGUiOiJyZXN1bHQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiOmZ1bGxzY3JlZW57XG5cbn1cblxuLmNvbnRlbnR7XG4gICAgdXNlci1zZWxlY3Q6IG5vbmU7XG4gICAgdHJhbnNpdGlvbjogYWxsIDJzIGVhc2U7XG59Il19 */</span></span><br></pre></td></tr></table></figure><h2 id="importLoaders">importLoaders</h2><ul><li><p>æ­£å¸¸cssæ–‡ä»¶è§£æé‡åˆ°@importï¼Œä¸ä¼šå†ä»useæ•°ç»„æœ€åä¸€ä¸ªloaderå¼€å§‹é‡æ–°è§£æ</p></li><li><p>é€šè¿‡è®¾ç½®importLoaderså¯ä»¥å®ç°é€’å½’è§£æ</p></li><li><p>å¡«å†™çš„æ•°å­—ä¸ºåœ¨useæ•°ç»„ä¸­å¾€åçš„loaderçš„æ•°é‡</p></li><li><p>ä¾‹å¦‚ï¼š</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">&quot;./src/js/main.js&quot;</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&quot;bundle.js&quot;</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">&quot;build&quot;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>, <span class="comment">//èµ„æºæ–‡ä»¶åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">&quot;style-loader&quot;</span>,</span><br><span class="line">            options: &#123;&#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="comment">// ç®€å†™ï¼š</span></span><br><span class="line">          <span class="comment">// â€œcss-loaderâ€</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="comment">// å®Œæ•´å†™æ³•</span></span><br><span class="line">            loader: <span class="string">&quot;css-loader&quot;</span>, <span class="comment">// å¯¹åº”çš„loader</span></span><br><span class="line">            options: &#123;</span><br><span class="line">              importLoaders: <span class="number">1</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="string">&quot;postcss-loader&quot;</span>,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">&quot;style-loader&quot;</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="comment">// å®Œæ•´å†™æ³•</span></span><br><span class="line">            loader: <span class="string">&quot;css-loader&quot;</span>, <span class="comment">// å¯¹åº”çš„loader</span></span><br><span class="line">            options: &#123;</span><br><span class="line">              importLoaders: <span class="number">2</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="string">&quot;postcss-loader&quot;</span>,</span><br><span class="line">          <span class="string">&quot;less-loader&quot;</span>,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="File-Loader">File Loader</h2><blockquote><p>å¸Œæœ›è§£æã€è¯»å–æ–‡ä»¶ï¼Œä¾‹å¦‚å›¾ç‰‡</p></blockquote><ol><li>å®‰è£…file-loader<ul><li><code>npm install --save file-loader</code></li></ul></li><li>ç¼–å†™é…ç½®æ–‡ä»¶</li></ol><blockquote><p>ruleï¼š</p></blockquote><ul><li>optionsè§£é‡Šï¼š<ul><li>name:è¾“å‡ºåç§°ï¼Œ[name]åç§°å¼•ç”¨ï¼Œ.å­—ç¬¦ï¼Œ[hash:6]å“ˆå¸Œä¿¡æ¯æˆªå–6ä½ï¼Œ[ext]åç¼€å</li><li>ouputPath:è¾“å‡ºçš„æ–‡ä»¶å¤¹ï¼Œä¹Ÿå¯ä»¥åœ¨æ–‡ä»¶åå‰åŠ  img/</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpe?g|gif|svg)$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader:<span class="string">&quot;file-loader&quot;</span>,</span><br><span class="line">            options:&#123;</span><br><span class="line">              name:<span class="string">&quot;[name].[hash:6].[ext]&quot;</span>,</span><br><span class="line">              outputPath:<span class="string">&quot;img&quot;</span></span><br><span class="line">              <span class="comment">// limitï¼ˆurl-loaderï¼‰</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ],</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><ul><li>å’Œfile-loaderæœ‰åŒæ ·åŠŸèƒ½çš„è¿˜æœ‰url-loader<ul><li>ä¸åŒçš„æ˜¯ï¼Œå®ƒä¸æ˜¯æ‰“åŒ…ï¼Œè€Œæ˜¯æŠŠå›¾ç‰‡è½¬ä¸ºBASE64ç¼–ç ã€‚</li><li>å¯ä»¥é€šè¿‡useå¯¹è±¡çš„optionsä¸‹å†™å…¥limitå±æ€§ï¼Œé™åˆ¶å¤§å°ï¼Œå¯¹å°å›¾ç‰‡è¿›è¡ŒBASE4ç¼–ç ï¼Œå‡å°‘è¯·æ±‚æ•°ã€‚</li></ul></li></ul><h2 id="Asset-module-type">Asset module type</h2><ul><li><p>æˆ‘ä»¬å½“å‰ä½¿ç”¨çš„webpackç‰ˆæœ¬æ˜¯webpack5:</p><ul><li>åœ¨webpack5ä¹‹å‰ï¼ŒåŠ è½½è¿™äº›èµ„æºæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€äº›loaderï¼Œæ¯”å¦‚raw-loader ã€url-loaderã€file-loader;</li><li>åœ¨webpack5ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨èµ„æºæ¨¡å—ç±»å‹(asset module type)ï¼Œæ¥æ›¿ä»£ä¸Šé¢çš„è¿™äº›loader;</li></ul></li><li><p>èµ„æºæ¨¡å—ç±»å‹(asset module type)ï¼Œé€šè¿‡æ·»åŠ  4 ç§æ–°çš„æ¨¡å—ç±»å‹ï¼Œæ¥æ›¿æ¢æ‰€æœ‰è¿™äº› loader:</p><ul><li>asset/resource å‘é€ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶å¹¶å¯¼å‡º URLã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ file-loader å®ç°;</li><li>asset/inline å¯¼å‡ºä¸€ä¸ªèµ„æºçš„ data URIã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ url-loader å®ç°;</li><li>asset/source å¯¼å‡ºèµ„æºçš„æºä»£ç ã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ raw-loader å®ç°;</li><li>asset åœ¨å¯¼å‡ºä¸€ä¸ª data URI å’Œå‘é€ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¹‹é—´è‡ªåŠ¨é€‰æ‹©ã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ url-loaderï¼Œå¹¶ä¸”é…ç½®èµ„æº</li></ul></li><li><p>æ¯”å¦‚åŠ è½½å›¾ç‰‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼:</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ‰“åŒ…å›¾ç‰‡</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpe?g|gif|svg)$/</span>,</span><br><span class="line">        type: <span class="string">&quot;asset/resource&quot;</span>,</span><br><span class="line">        generator: &#123;</span><br><span class="line">          filename: <span class="string">&quot;img/[name].[hash:6][ext]&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// BASE64ç¼–ç å¹¶é™åˆ¶å¤§å°</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpe?g|gif|svg)$/</span>,</span><br><span class="line">        type: <span class="string">&quot;asset/inline&quot;</span>,</span><br><span class="line">        parser: &#123;</span><br><span class="line">          dataUrlCondition: &#123;</span><br><span class="line">            maxSize: <span class="number">100</span> * <span class="number">1024</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// æ··åˆä½¿ç”¨ï¼Œé™åˆ¶å¤§å°ï¼Œåˆ¤æ–­æ‰“åŒ…æ–¹å¼</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpe?g|gif|svg)$/</span>,</span><br><span class="line">        type: <span class="string">&quot;asset&quot;</span>,</span><br><span class="line">        generator: &#123;</span><br><span class="line">          filename: <span class="string">&quot;img/[name].[hash:6][ext]&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        parser: &#123;</span><br><span class="line">          dataUrlCondition: &#123;</span><br><span class="line">            maxSize: <span class="number">100</span> * <span class="number">1024</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><ul><li>ä½†æ˜¯ï¼Œå¦‚ä½•å¯ä»¥è‡ªå®šä¹‰æ–‡ä»¶çš„è¾“å‡ºè·¯å¾„å’Œæ–‡ä»¶åå‘¢?<ul><li>æ–¹å¼ä¸€:ä¿®æ”¹outputï¼Œæ·»åŠ assetModuleFilenameå±æ€§;</li><li>æ–¹å¼äºŒ:åœ¨Ruleä¸­ï¼Œæ·»åŠ ä¸€ä¸ªgeneratorå±æ€§ï¼Œå¹¶ä¸”è®¾ç½®filename;</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ–¹å¼ä¸€ ouputå¯¹è±¡</span></span><br><span class="line">output: &#123;</span><br><span class="line">    filename: <span class="string">&quot;bundle.js&quot;</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">&quot;build&quot;</span>),</span><br><span class="line">    assetModuleFilename: <span class="string">&quot;img/[name].[hash:6][ext]&quot;</span>,</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// æ–¹å¼äºŒ ruleå¯¹è±¡ï¼ˆæ¨èï¼‰</span></span><br><span class="line">&#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpe?g|gif|svg)$/</span>,</span><br><span class="line">        type: <span class="string">&quot;asset/resource&quot;</span>,</span><br><span class="line">        generator: &#123;</span><br><span class="line">          filename: <span class="string">&quot;img/[name].[hash:6][ext]&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h3 id="åŠ è½½å­—ä½“æ–‡ä»¶">åŠ è½½å­—ä½“æ–‡ä»¶</h3><blockquote><p>ruleå¯¹è±¡ï¼š</p></blockquote><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        test: <span class="regexp">/\.ttf|eot|woff2?$/i</span>,</span><br><span class="line">        type: <span class="string">&quot;asset/resource&quot;</span>,</span><br><span class="line">        generator: &#123;</span><br><span class="line">          filename: <span class="string">&quot;font/[name].[hash:6][ext]&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h1>è‡ªå®šä¹‰Loader</h1><blockquote><p>Loaderæ˜¯ç”¨äºå¯¹æ¨¡å—çš„æºä»£ç è¿›è¡Œè½¬æ¢å¤„ç†ï¼Œä¹‹å‰å·²ç»ä½¿ç”¨è¿‡å¾ˆå¤šLoaderï¼Œä¾‹å¦‚css-loaderã€style-loaderã€babel-loaderç­‰</p></blockquote><ul><li><p>Loaderæœ¬è´¨æ˜¯ä¸€ä¸ªå¯¼å‡ºä¸ºå‡½æ•°çš„JavaScriptæ¨¡å—</p></li><li><p>Loader runneråº“ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œç„¶åå°†ä¸Šä¸€ä¸ªloaderäº§ç”Ÿçš„ç»“æœæˆ–è€…èµ„æºæ–‡ä»¶ä¼ å…¥è¿›å»ã€‚</p></li><li><p>ç¼–å†™ä¸€ä¸ªè‡ªå®šä¹‰Loaderä¼šæ¥æ”¶ä¸‰ä¸ªå‚æ•°</p><ul><li>contentï¼šèµ„æºæ–‡ä»¶å‚æ•°</li><li>mapï¼šsourcemapç›¸å…³æ•°æ®</li><li>metaï¼šä¸€äº›å…ƒæ•°æ®</li></ul></li><li><p>æ³¨ï¼šä¼ å…¥çš„è·¯å¾„æ˜¯å’Œcontentæœ‰å…³ç³»çš„</p><ul><li>webpack.config.js</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    context: path.resolve(__dirname, <span class="string">&quot;../&quot;</span>),</span><br><span class="line">    entry: <span class="string">&quot;./src/main.js&quot;</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">       path:path.resolve(__dirname,<span class="string">&quot;../build&quot;</span>),</span><br><span class="line">        filename:<span class="string">&quot;bundle.js&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules:[</span><br><span class="line">            &#123;</span><br><span class="line">                test:<span class="regexp">/\.js$/i</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    <span class="string">&quot;./loaders/demoLoader.js&quot;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœå¸Œæœ›ç›´æ¥å»åŠ è½½loaderæ–‡ä»¶å¤¹ï¼Œå¯ä»¥é…ç½®resoveLoaderå±æ€§</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">        rules:[</span><br><span class="line">            &#123;</span><br><span class="line">                test:<span class="regexp">/\.js$/i</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    <span class="string">&quot;demoLoader&quot;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">&#125;,</span><br><span class="line">resolveLoader:&#123;</span><br><span class="line">    modules:[<span class="string">&quot;./loaders&quot;</span>, <span class="string">&quot;node_modules&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¤šä¸ªLoaderä½¿ç”¨æ‰§è¡Œé¡ºåº<ul><li>ä»åå‘å‰ï¼Œä»å³å‘å·¦</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">rules:[</span><br><span class="line">    &#123;</span><br><span class="line">        test:<span class="regexp">/\.js$/i</span>,</span><br><span class="line">        use:[</span><br><span class="line">            <span class="string">&quot;demoLoader1&quot;</span>,</span><br><span class="line">            <span class="string">&quot;demoLoader2&quot;</span>,</span><br><span class="line">            <span class="string">&quot;demoLoader3&quot;</span>,</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/image-20210502234237127.png" alt="image.png"></p><h2 id="Pitch-Loaderå’Œenforce">Pitch-Loaderå’Œenforce</h2><blockquote><p>äº‹å®ä¸Šè¿˜æœ‰å¦ä¸€ç§Loaderï¼Œç§°ä¹‹ä¸ºPitchLoader</p></blockquote><ul><li><p>å…¶å®è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆloaderçš„æ‰§è¡Œé¡ºåºæ˜¯ç›¸åçš„</p><ul><li>run-loaderå…ˆä¼˜å…ˆæ‰§è¡ŒPitchLoaderï¼Œåœ¨æ‰§è¡ŒPitchLoaderæ—¶è¿›è¡ŒloaderIndex++ï¼›</li><li>run-loaderä¹‹åä¼šæ‰§è¡ŒNormalLoaderï¼Œåœ¨æ‰§è¡ŒNormalLoaderæ—¶è¿›è¡ŒloaderIndexâ€“ï¼›</li></ul></li><li><p>é‚£ä¹ˆï¼Œæ€ä¹ˆæ”¹å˜ä»–ä»¬çš„æ‰§è¡Œé¡ºåº?</p><ul><li>å¯ä»¥æ‹†åˆ†æˆå¤šä¸ªRuleå¯¹è±¡ï¼Œé€šè¿‡enforceæ¥æ”¹å˜å®ƒä»¬çš„é¡ºåº</li><li>enforceæ˜¯ruleå¯¹è±¡çš„ä¸€ä¸ªå±æ€§ã€‚</li></ul></li><li><p>enforceä¸€å…±æœ‰å››ç§æ–¹å¼</p><ul><li>é»˜è®¤æ‰€æœ‰loaderéƒ½æ˜¯normal</li><li>åœ¨è¡Œå†…è®¾ç½®çš„loaderéƒ½æ˜¯inline</li><li>ä¹Ÿå¯ä»¥é€šè¿‡enforceè®¾ç½®preå’Œpost</li></ul></li><li><p>åœ¨Pitchå’ŒNormalå®ƒä»¬çš„æ‰§è¡Œé¡ºåºåˆ†åˆ«æ˜¯</p><ul><li>postã€inlineã€normalã€pre</li><li>preã€normalã€inlineã€post</li></ul></li></ul><h2 id="åŒæ­¥çš„Loader">åŒæ­¥çš„Loader</h2><ul><li><p>ä»€ä¹ˆæ˜¯åŒæ­¥loader?</p><ul><li>é»˜è®¤åˆ›å»ºçš„Loaderå°±æ˜¯åŒæ­¥çš„Loader</li><li>è¿™ä¸ªLoaderå¿…é¡»é€šè¿‡returnæˆ–è€…this.callbackæ¥è¿”å›ç»“æœï¼Œäº¤ç»™ä¸‹ä¸€ä¸ªloaderæ¥å¤„ç†</li><li>é€šå¸¸åœ¨æœ‰é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œä¼šä½¿ç”¨this.callback</li></ul></li><li><p>this.callbackç”¨æ³•å¦‚ä¸‹</p><ul><li>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºERRæˆ–è€…null</li><li>ç¬¬äºŒä¸ªå‚æ•°æ˜¯stringæˆ–è€…buffer</li><li>loader.js</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">content</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;loader&quot;</span>, content)</span><br><span class="line">    <span class="built_in">this</span>.callback(<span class="literal">null</span>,content)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¼‚æ­¥çš„Loader">å¼‚æ­¥çš„Loader</h2><ul><li><p>ä»€ä¹ˆæ˜¯å¼‚æ­¥çš„Loader</p><ul><li>æœ‰æ—¶å€™ä½¿ç”¨Loaderè¿›è¡Œä¸€äº›å¼‚æ­¥çš„æ“ä½œ</li><li>æˆ‘ä»¬å¸Œæœ›åœ¨å¼‚æ­¥æ“ä½œå®Œæˆä¹‹åï¼Œå†è¿”å›è¿™ä¸ªloaderå¤„ç†çš„ç»“æœ</li><li>è¿™ä¸ªæ—¶å€™å°±è¦ä½¿ç”¨å¼‚æ­¥çš„Loaderäº†</li></ul></li><li><p>loader-runnerå·²ç»åœ¨æ‰§è¡Œloaderæ—¶ç»™æˆ‘ä»¬æä¾›äº†æ–¹æ³•ï¼Œè®©loaderå˜æˆä¸€ä¸ªå¼‚æ­¥çš„loader</p></li><li><p>loader.js</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">content</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> callback = <span class="built_in">this</span>.async()</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;async loader&quot;</span>,content)</span><br><span class="line">        callback(<span class="literal">null</span>, content)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¼ å…¥å’Œè·å–å‚æ•°">ä¼ å…¥å’Œè·å–å‚æ•°</h2><ul><li><p>åœ¨ä½¿ç”¨loaderæ—¶ä¼ å…¥å‚æ•°ï¼Œ</p></li><li><p>å¯ä»¥é€šè¿‡webpackå®˜æ–¹æä¾›çš„ä¸€ä¸ªè§£æåº“loader-utils</p><ul><li><code>npm i loader-utils</code></li></ul></li><li><p>webpack.config.js</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test:<span class="regexp">/\.js$/i</span>,</span><br><span class="line">    use:[</span><br><span class="line">        <span class="string">&quot;syncLoader&quot;</span>,</span><br><span class="line">        <span class="string">&quot;asyncLoader&quot;</span>,</span><br><span class="line">        &#123;</span><br><span class="line">            loader:<span class="string">&quot;optionLoader&quot;</span>,</span><br><span class="line">            options:&#123;</span><br><span class="line">                type:<span class="string">&quot;options&quot;</span>,</span><br><span class="line">                desc:<span class="string">&quot;demo&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>optionLoader.js</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; getOptions &#125;  = <span class="built_in">require</span>(<span class="string">&quot;loader-utils&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">content</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> callback = <span class="built_in">this</span>.async();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> options = getOptions(<span class="built_in">this</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;asyncLoader&quot;</span>,content, options)</span><br><span class="line">        callback(<span class="literal">null</span>, content)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  asyncLoader console.log(&quot;main.js&quot;) &#123; type: &#x27;options&#x27;, desc: &#x27;demo&#x27; &#125;</span></span><br></pre></td></tr></table></figure><h2 id="å‚æ•°æ ¡éªŒ">å‚æ•°æ ¡éªŒ</h2><ul><li><p>å¯ä»¥é€šè¿‡wepackå®˜æ–¹æä¾›çš„æ ¡éªŒåº“schema-utils</p><ul><li><code>npm i schema-utils</code></li></ul></li><li><p>schema.jsonï¼ˆæ ¡éªŒè§„åˆ™ï¼‰</p></li></ul><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;objcet&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;type&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;è¯·è¾“å…¥æ­£ç¡®çš„å‚æ•°ç±»å‹&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;desc&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;æè¿°å¿…é¡»ä¸ºå­—ç¬¦ä¸²ç±»å‹&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;additionalProperties&quot;</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>loader.js</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; getOptions &#125;  = <span class="built_in">require</span>(<span class="string">&quot;loader-utils&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; validate &#125; = <span class="built_in">require</span>(<span class="string">&quot;schema-utils&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> loaderSchema = <span class="built_in">require</span>(<span class="string">&quot;../schema/schema.json&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">content</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> callback = <span class="built_in">this</span>.async();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> options = getOptions(<span class="built_in">this</span>)</span><br><span class="line"></span><br><span class="line">    validate(loaderSchema, options)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;asyncLoader&quot;</span>,content, options)</span><br><span class="line">        callback(<span class="literal">null</span>, content)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="babel-loaderæ¡ˆä¾‹">babel-loaderæ¡ˆä¾‹</h2><ul><li><p>æˆ‘ä»¬çŸ¥é“babel-loaderå¯ä»¥è¿›è¡ŒJSä»£ç è½¬æ¢</p></li><li><p>æ¥ä¸‹æ¥å°è¯•å®šä¹‰ä¸€ä¸ªè‡ªå·±çš„babel-loader</p></li><li><p>myBabelLoader.js</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> babel = <span class="built_in">require</span>(<span class="string">&quot;@babel/core&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; getOptions &#125;  = <span class="built_in">require</span>(<span class="string">&quot;loader-utils&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; validate &#125; = <span class="built_in">require</span>(<span class="string">&quot;schema-utils&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> babelSchema = <span class="built_in">require</span>(<span class="string">&quot;../schema/babel.json&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">content</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> callback = <span class="built_in">this</span>.async();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> option = getOptions(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">    validate(babelSchema, option)</span><br><span class="line"></span><br><span class="line">    babel.transform(content, option, <span class="function">(<span class="params">err, res</span>) =&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            callback(err)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            callback(<span class="literal">null</span>, res.code)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>babelSchema.json</li></ul><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;presets&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;array&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;additinalProperties&quot;</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>webapck.config.js</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules:[</span><br><span class="line">        &#123;</span><br><span class="line">            test:<span class="regexp">/\.js$/i</span>,</span><br><span class="line">            use:[</span><br><span class="line">                <span class="string">&quot;syncLoader&quot;</span>,</span><br><span class="line">                <span class="string">&quot;asyncLoader&quot;</span>,</span><br><span class="line">                &#123;</span><br><span class="line">                    loader:<span class="string">&quot;optionLoader&quot;</span>,</span><br><span class="line">                    options:&#123;</span><br><span class="line">                        type:<span class="string">&quot;options&quot;</span>,</span><br><span class="line">                        desc:<span class="string">&quot;demo&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    loader:<span class="string">&quot;myBabelLoader&quot;</span>,</span><br><span class="line">                    options: &#123;</span><br><span class="line">                        presets:[<span class="string">&quot;@babel/preset-env&quot;</span>]</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰md-loader">è‡ªå®šä¹‰md-loader</h2><ul><li><p>å€ŸåŠ©markedå’Œhighlightåº“å®ç°markdownLoader</p><ul><li><code>npm i marked highlight.js</code></li></ul></li><li><p>webpack.config.js</p><ul><li>é…ç½®cssåŠ è½½å’ŒmdåŠ è½½è§„åˆ™</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">rules:[</span><br><span class="line">    &#123;</span><br><span class="line">      test:<span class="regexp">/\.css$/i</span>,</span><br><span class="line">      use:[</span><br><span class="line">          <span class="string">&quot;style-loader&quot;</span>,</span><br><span class="line">          <span class="string">&quot;css-loader&quot;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      test:<span class="regexp">/\.md$/i</span>,</span><br><span class="line">      use:[<span class="string">&quot;mdLoader&quot;</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><ul><li>mdLoader.js<ul><li>ä½¿ç”¨markedå’Œhighlightå¤„ç†contentï¼Œå¹¶è¿”å›æ¨¡å—åŒ–ä»£ç </li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> marked = <span class="built_in">require</span>(<span class="string">&quot;marked&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> hljs = <span class="built_in">require</span>(<span class="string">&quot;highlight.js&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">content</span>)</span>&#123;</span><br><span class="line">    marked.setOptions(&#123;</span><br><span class="line">        highlight:<span class="function"><span class="keyword">function</span> (<span class="params">code,lang</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> hljs.highlight(lang, code).value</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> htmlContent = marked(content)</span><br><span class="line">    <span class="keyword">const</span> innerContent = <span class="string">&quot;`&quot;</span> + htmlContent + <span class="string">&quot;`&quot;</span></span><br><span class="line">    <span class="keyword">const</span> moduleCode = <span class="string">`var code=<span class="subst">$&#123;innerContent&#125;</span>;export default code;`</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(moduleCode)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> moduleCode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>main.js<ul><li>åŒæ—¶å¼•å…¥cssæ–‡ä»¶</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> md <span class="keyword">from</span> <span class="string">&quot;./index.md&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;highlight.js/styles/default.css&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;main.js&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ele = <span class="built_in">document</span>.createElement(<span class="string">&quot;div&quot;</span>)</span><br><span class="line">ele.innerHTML = md;</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.body.appendChild(ele)</span><br></pre></td></tr></table></figure><ul><li>æ•ˆæœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/image-20210502234524690.png" alt="image-20210502234524690"></p><ul><li><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p></li><li><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p></li><li><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼&lt;br/&gt;å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1&gt;è®¤è¯†Loader&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;Loaderå¯ä»¥ç”¨äºå¯¹æ¨¡å—çš„æºä»£ç è¿›è¡Œè½¬æ¢ï¼›&lt;/p</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Webpack" scheme="https://lebronchao.com/tags/Webpack/"/>
    
    <category term="æ‰“åŒ…æ„å»º" scheme="https://lebronchao.com/tags/%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA/"/>
    
    <category term="å‰ç«¯" scheme="https://lebronchao.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://lebronchao.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="Loader" scheme="https://lebronchao.com/tags/Loader/"/>
    
  </entry>
  
  <entry>
    <title>åˆè¯†Webpack</title>
    <link href="https://lebronchao.com/2021/05/12/%E5%88%9D%E8%AF%86Webpack/"/>
    <id>https://lebronchao.com/2021/05/12/%E5%88%9D%E8%AF%86Webpack/</id>
    <published>2021-05-11T16:53:03.000Z</published>
    <updated>2021-05-11T16:53:03.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼</p><p>å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼</p></blockquote><h1>Webpackåˆä½“éªŒ</h1><h2 id="ç”¨Webpackè§£å†³ä»€ä¹ˆé—®é¢˜">ç”¨Webpackè§£å†³ä»€ä¹ˆé—®é¢˜</h2><ol><li>æ¨¡å—åŒ–</li><li>é«˜çº§ç‰¹æ€§ã€å¼€å‘æ•ˆç‡ã€å®‰å…¨æ€§<ul><li>ES6+ã€Typescriptã€saccã€less</li></ul></li><li>ç›‘å¬æ–‡ä»¶å˜åŒ–å¹¶åæ˜ åˆ°æµè§ˆå™¨ä¸Šï¼Œæé«˜å¼€å‘æ•ˆç‡</li><li>å¼€å‘å®Œæˆåçš„æ‰“åŒ…ï¼Œå‹ç¼©ã€åˆå¹¶ã€tree-shakingç­‰ä»¥åŠå…¶ä»–ç›¸å…³çš„ä¼˜åŒ–</li></ol><h2 id="Webpackæ˜¯ä»€ä¹ˆ">Webpackæ˜¯ä»€ä¹ˆ</h2><ul><li><p>Webpckæ˜¯ä¸€ä¸ªé™æ€çš„æ¨¡å—åŒ–æ‰“åŒ…å·¥å…·ï¼Œä¸ºç°ä»£çš„JSåº”ç”¨ç¨‹åº</p></li><li><p>æˆ‘ä»¬æ¥å¯¹ä¸Šé¢çš„è§£é‡Šè¿›è¡Œæ‹†è§£ï¼š</p><ul><li>æ‰“åŒ…bundlerï¼šwebpackå¯ä»¥å°†å¸®åŠ©æˆ‘ä»¬è¿›è¡Œæ‰“åŒ…ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªæ‰“åŒ…å·¥å…·ã€‚</li><li>é™æ€çš„staticï¼šè¿™æ ·è¡¨è¿°çš„åŸå› æ˜¯æˆ‘ä»¬æœ€ç»ˆå¯ä»¥å°†ä»£ç æ‰“åŒ…æˆæœ€ç»ˆçš„é™æ€èµ„æºï¼ˆéƒ¨ç½²åˆ°é™æ€æœåŠ¡å™¨ï¼‰</li><li>æ¨¡å—åŒ–moduleï¼šwebpacké»˜è®¤æ”¯æŒå„ç§æ¨¡å—åŒ–å¼€å‘ï¼ŒES Moduleã€CommonJSã€AMDç­‰</li><li>ç°ä»£çš„modernï¼šç°ä»£å‰ç«¯å¼€å‘é¢ä¸´å„ç§å„æ ·çš„é—®é¢˜ï¼Œæ‰å‚¬ç”Ÿäº†webpackçš„å‡ºç°å’Œå‘å±•</li></ul></li></ul><h2 id="Webpackå’ŒVite">Webpackå’ŒVite</h2><blockquote><p>Webpackä¼šè¢«Viteå–ä»£å—ï¼Ÿ</p></blockquote><ol><li>viteæ¨å‡ºåç¡®å®å¼•èµ·äº†å¾ˆå¤šçš„åå“ï¼Œä¹Ÿæœ‰å¾ˆå¤šäººçœ‹å¥½viteçš„å‘å±•</li><li>ä½†æ˜¯ç›®å‰viteå–ä»£webpackè¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°<ul><li>ç›®å‰vueé¡¹ç›®æ”¯æŒä½¿ç”¨viteï¼Œä¹Ÿæ”¯æŒä½¿ç”¨webpack</li><li>viteæœ€ç»ˆæ‰“åŒ…çš„è¿‡ç¨‹ï¼Œä¾ç„¶éœ€è¦å€ŸåŠ©äºrollupå®Œæˆ</li></ul></li><li>viteæ ¸å¿ƒæ€æƒ³å¹¶ä¸æ˜¯é¦–åˆ›<ul><li>äº‹å®ä¸Šï¼Œviteçš„æ€æƒ³å’Œä¹‹å‰çš„snowpackæ˜¯é‡åˆçš„ï¼Œè€Œä¸”ç›¸å¯¹ç›®å‰æ¥è¯´snowpackä¼šæ›´åŠ æˆç†Ÿ</li><li>å½“ç„¶ï¼Œåç»­å‘å±•æ¥çœ‹viteå¯èƒ½ä¼šè¶…è¶Šsnowpack</li></ul></li><li>webpackçš„æ›´æ–°è¿­ä»£<ul><li>webpackåœ¨å‘å±•å·¥ç¨‹ä¸­ï¼Œä¹Ÿä¼šä¸æ–­æ”¹è¿›è‡ªå·±ï¼Œå€Ÿé‰´å…¶ä»–å·¥å…·çš„ä¸€äº›ä¼˜åŠ¿å’Œæ€æƒ³</li><li>åœ¨è¿™ä¹ˆå¤šå¹´çš„å‘å±•ä¸­ï¼Œæ— è®ºæ˜¯è‡ªèº«çš„ä¼˜åŠ¿è¿˜æ˜¯ç”Ÿæ€éƒ½æ˜¯éå¸¸å¼ºå¤§çš„ã€‚</li></ul></li></ol><blockquote><p>å…³äºViteçš„æ€è€ƒ</p></blockquote><ol><li><p>å­¦ä¹ ä»»ä½•çš„ä¸œè¥¿ï¼Œé‡è¦çš„æ˜¯å­¦ä¹ æ ¸å¿ƒæ€æƒ³</p><ul><li>å­¦ä¹ äº†JSå­¦TSä¸æ˜¯ä»0å¼€å§‹</li><li>å­¦ä¹ äº†Vueï¼Œå­¦Reactä¹Ÿä¸æ˜¯ä»0å¼€å§‹</li></ul></li><li><p>ä»»ä½•å·¥å…·çš„å‡ºç°ï¼Œéƒ½æ˜¯æ›´å¥½åœ°æœåŠ¡äºæˆ‘ä»¬å¼€å‘</p><ul><li><p>æ— è®ºæ˜¯viteçš„å‡ºç°ï¼Œè¿˜æ˜¯ä»¥åæ–°çš„å·¥å…·å‡ºç°ï¼Œä¸è¦æœ‰ä»»ä½•æ’æ–¥çš„æ€æƒ³ï¼›</p></li><li><p>æˆ‘ä»¬è¦æ·±åˆ»åœ°æ˜ç™½ï¼Œå·¥å…·éƒ½æ˜¯ä¸ºäº†æ›´å¥½åœ°ç»™æˆ‘ä»¬æä¾›æœåŠ¡</p></li><li><p>ä¸å¯èƒ½å‡ºç°äº†æŸä¸ªå·¥å…·ï¼Œè®©æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡å˜å¾—æ›´ä½ï¼Œè€Œè¿™ä¸ªå·¥å…·å´å¯ä»¥å˜å¾—éå¸¸æµè¡Œï¼Œè¿™æ˜¯ä¸å­˜åœ¨çš„</p></li></ul></li></ol><h1>Webpacké»˜è®¤æ‰“åŒ…</h1><ul><li><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡webpackè¿›è¡Œæ‰“åŒ…ï¼Œä¹‹åè¿è¡Œæ‰“åŒ…ä¹‹åçš„ä»£ç </p><ul><li><p>åœ¨ç›®å½•ä¸‹ç›´æ¥æ‰§è¡Œwebpackå‘½ä»¤</p><p><code>webpack</code></p></li><li><p>ç›´æ¥åœ¨ç»ˆç«¯æ‰§è¡Œwebpackå¯èƒ½æœ¬æœºå®‰è£…ç‰ˆæœ¬å’Œé¡¹ç›®ç‰ˆæœ¬ä¸åŒï¼Œæ‰€ä»¥åœ¨package.jsonä¸­å®šä¹‰å‘½ä»¤ä¾‹å¦‚ï¼šâ€œbuildâ€:â€œwebpackâ€ï¼Œè¿™æ ·å°±ä¼šæ ¹æ®package.jsonä¸­çš„webpackç‰ˆæœ¬è¿›è¡Œæ‰“åŒ…ï¼ˆå‰ææ˜¯å·²installï¼‰ã€‚</p></li></ul></li><li><p>ç”Ÿæˆä¸€ä¸ªdistæ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜æ”¾ä¸€ä¸ªmain.jsæ–‡ä»¶ï¼Œå°±æ˜¯æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶</p><ul><li>è¿™ä¸ªæ–‡ä»¶ä¸­çš„ä»£ç è¢«å‹ç¼©å’Œä¸‘åŒ–äº†</li><li>æš‚æ—¶ä¸å…³å¿ƒä»–æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Œåç»­æˆ‘è®²webpackå®ç°æ¨¡å—åŒ–åŸç†æ—¶ä¼šå†æ¬¡è®²åˆ°ã€‚</li><li>å¦å¤–å‘ç°ä»£ç ä¸­ä¾ç„¶å­˜åœ¨ES6çš„è¯­æ³•ï¼Œæ¯”å¦‚ç®­å¤´å‡½æ•°ã€constç­‰ï¼Œè¿™æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹webpackå¹¶ä¸æ¸…æ¥šæˆ‘ä»¬æ‰“åŒ…åçš„æ–‡ä»¶æ˜¯å¦éœ€è¦è½¬æˆES5ä¹‹å‰çš„è¯­æ³•ï¼Œåç»­æˆ‘ä»¬éœ€è¦é€šè¿‡babelæ¥è¿›è¡Œè½¬æ¢å’Œè®¾ç½®ï¼›</li></ul></li><li><p>å‘ç°å¯ä»¥æ­£å¸¸è¿›è¡Œæ‰“åŒ…çš„ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œwebpackæ˜¯å¦‚ä½•ç¡®åœ°å…¥å£çš„ï¼Ÿ</p><ul><li>äº‹å®ä¸Šï¼Œæˆ‘ä»¬è¿è¡Œwebpackæ—¶ï¼Œwebpackä¼šæŸ¥æ‰¾åˆ°å½“å‰ç›®å½•ä¸‹çš„src/index.jsä½œä¸ºå…¥å£</li><li>æ‰€ä»¥ï¼Œå¦‚æœå½“å‰é¡¹ç›®ä¸­æ²¡æœ‰src/index.jsï¼Œé‚£ä¹ˆä¼šæŠ¥é”™</li></ul></li><li><p>å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æ¥æŒ‡å®šå…¥å£å’Œå‡ºå£ï¼Œä¾‹å¦‚(é€šå¸¸å†™é…ç½®æ–‡ä»¶)</p><p><code>npx webpack --entry ./src/main.js --output-path ./build</code></p></li></ul><h1>Webpacké…ç½®æ–‡ä»¶</h1><ul><li><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œwebpackéœ€è¦æ‰“åŒ…çš„é¡¹ç›®æ˜¯éå¸¸å¤æ‚çš„ï¼Œå¹¶ä¸”æˆ‘ä»¬éœ€è¦ä¸€ç³»åˆ—çš„é…ç½®æ¥æ»¡è¶³è¦æ±‚ï¼Œé»˜è®¤é…ç½®å¿…ç„¶æ˜¯ä¸å¯ä»¥çš„ã€‚</p></li><li><p>æˆ‘ä»¬å¯ä»¥åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªwebpack.config.jsæ–‡ä»¶ï¼Œæ¥ä½œä¸ºwebpackçš„é…ç½®æ–‡ä»¶,ä¾‹å¦‚</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">&quot;./src/main.js&quot;</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&quot;bundle.js&quot;</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">&quot;build&quot;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><p>ç»§ç»­æ‰§è¡Œwebpackå‘½ä»¤ï¼Œä¾ç„¶å¯ä»¥æ­£å¸¸æ‰“åŒ…</p></li><li><p>ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨webpack.config.jsä½œä¸ºæ–‡ä»¶åï¼Œä½¿ç”¨å‘½ä»¤å®šä¹‰è·¯å¾„å’Œæ–‡ä»¶åå³å¯ï¼Œä¾‹å¦‚</p></li><li><p><code>webpack --config  ./wk.congfig.js</code></p></li></ul><h1>Webpackä¾èµ–å›¾</h1><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/(null).png" alt="img"></p><blockquote><p>webpackåˆ°åº•æ˜¯å¦‚ä½•å¯¹æˆ‘ä»¬çš„é¡¹ç›®è¿›è¡Œæ‰“åŒ…çš„å‘¢ï¼Ÿ</p></blockquote><ul><li><p>äº‹å®ä¸Šwebpackåœ¨å¤„ç†åº”ç”¨ç¨‹åºçš„æ—¶å€™ï¼Œå®ƒä¼šæ ¹æ®å‘½ä»¤æˆ–è€…é…ç½®æ–‡ä»¶æ‰¾åˆ°å…¥é—¨æ–‡ä»¶ï¼›</p></li><li><p>ä»å…¥å£å¼€å§‹ï¼Œä¼šç”Ÿæˆä¸€ä¸ªä¾èµ–å…³ç³»å›¾ï¼Œè¿™ä¸ªä¾èµ–å…³ç³»å›¾ä¼šåŒ…å«åº”ç”¨ç¨‹åºä¸­æ‰€éœ€çš„æ‰€æœ‰æ¨¡å—ï¼ˆæ¯”å¦‚jsæ–‡ä»¶ã€cssæ–‡ä»¶ã€å­—ä½“ç­‰ï¼‰</p></li><li><p>ç„¶åéå†å›¾ç»“æ„ï¼Œæ‰“åŒ…ä¸€ä¸ªä¸ªæ¨¡å—ï¼ˆæ ¹æ®æ–‡ä»¶çš„ä¸åŒä½¿ç”¨ä¸åŒçš„loaderè§£æï¼‰</p></li></ul><h1>Modeé…ç½®</h1><ul><li><p>Modeé…ç½®é€‰é¡¹ï¼Œå¯ä»¥å‘ŠçŸ¥webpackä½¿ç”¨å“åº”æ¨¡å¼çš„å†…ç½®ä¼˜åŒ–:</p></li><li><p>é»˜è®¤å€¼æ˜¯production(ä»€ä¹ˆéƒ½ä¸è®¾ç½®çš„æƒ…å†µä¸‹);</p></li><li><p>å¯é€‰å€¼æœ‰:â€˜noneâ€™ | â€˜developmentâ€™ | â€˜productionâ€™;</p></li><li><p>è¿™å‡ ä¸ªé€‰é¡¹æœ‰ä»€ä¹ˆæ ·çš„åŒºåˆ«å‘¢?</p></li></ul><table><thead><tr><th><strong>é€‰é¡¹</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td><code>developtment</code></td><td>ä¼šå°†<code>DefinePlugin</code>ä¸­<code>process.env.NODE_ENV</code>çš„å€¼è®¾ç½®ä¸º``developtment`ï¼Œä¸ºæ¨¡å—å’Œchunkå¯ç”¨æœ‰æ•ˆçš„å</td></tr><tr><td><code>production</code></td><td>ä¼šå°†``DefinePlugin<code>ä¸­</code>process.env.NODE_ENV<code>çš„å€¼è®¾ç½®ä¸º</code>production<code>ã€‚ä¸ºæ¨¡å—å’Œchunkå¯ç”¨ç¡®å®šæ€§çš„æ··æ·†åç§°ï¼Œ</code>FlagDependencyUsagePlugin<code>ï¼Œ</code>FlagInlcudeedChunkPlugin<code>ï¼Œ</code>ModuleConcatenationPlugin<code>ï¼Œ</code>NoEmitOnErrorsPlugin<code>å’Œ</code>TerserPlugin`</td></tr><tr><td><code>none</code></td><td>ä¸ä½¿ç”¨ä»»ä½•é»˜è®¤ä¼˜åŒ–é€‰é¡¹</td></tr></tbody></table><blockquote><p>Modeé…ç½®ä»£è¡¨é…ç½®äº†æ›´å¤š</p></blockquote><ul><li>ç»¿è‰²é€‰é¡¹ = æ‰€æœ‰çº¢è‰²é€‰é¡¹</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/(null)-20210502174148481.(null)" alt="img"></p><h1>Webpackæ ¸å¿ƒæµç¨‹</h1><blockquote><p>å¼•ç”¨äº[<a href="https://juejin.cn/post/6949040393165996040">ä¸‡å­—æ€»ç»“] ä¸€æ–‡åƒé€ Webpack æ ¸å¿ƒåŸç†</a></p></blockquote><p>è¿™ä¸ªè¿‡ç¨‹æ ¸å¿ƒå®Œæˆäº† <strong>å†…å®¹è½¬æ¢ + èµ„æºåˆå¹¶</strong> ä¸¤ç§åŠŸèƒ½ï¼Œå®ç°ä¸ŠåŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼š</p><ul><li><p>åˆå§‹åŒ–é˜¶æ®µï¼š</p><ol><li><strong>åˆå§‹åŒ–å‚æ•°</strong>ï¼šä»é…ç½®æ–‡ä»¶ã€ é…ç½®å¯¹è±¡ã€Shell å‚æ•°ä¸­è¯»å–ï¼Œä¸é»˜è®¤é…ç½®ç»“åˆå¾—å‡ºæœ€ç»ˆçš„å‚æ•°</li><li><strong>åˆ›å»ºç¼–è¯‘å™¨å¯¹è±¡</strong>ï¼šç”¨ä¸Šä¸€æ­¥å¾—åˆ°çš„å‚æ•°åˆ›å»º Compiler å¯¹è±¡</li><li><strong>åˆå§‹åŒ–ç¼–è¯‘ç¯å¢ƒ</strong>ï¼šåŒ…æ‹¬æ³¨å…¥å†…ç½®æ’ä»¶ã€æ³¨å†Œå„ç§æ¨¡å—å·¥å‚ã€åˆå§‹åŒ– RuleSet é›†åˆã€åŠ è½½é…ç½®çš„æ’ä»¶ç­‰</li><li><strong>å¼€å§‹ç¼–è¯‘</strong>ï¼šæ‰§è¡Œ compiler å¯¹è±¡çš„ run æ–¹æ³•</li><li><strong>ç¡®å®šå…¥å£</strong>ï¼šæ ¹æ®é…ç½®ä¸­çš„ entry æ‰¾å‡ºæ‰€æœ‰çš„å…¥å£æ–‡ä»¶ï¼Œè°ƒç”¨ compilition.addEntry å°†å…¥å£æ–‡ä»¶è½¬æ¢ä¸º dependence å¯¹è±¡</li></ol></li><li><p>æ„å»ºé˜¶æ®µï¼š</p><ol><li><strong>ç¼–è¯‘æ¨¡å—(make)</strong>ï¼šæ ¹æ® entry å¯¹åº”çš„ dependence åˆ›å»º module å¯¹è±¡ï¼Œè°ƒç”¨ loader å°†æ¨¡å—è½¬è¯‘ä¸ºæ ‡å‡† JS å†…å®¹ï¼Œè°ƒç”¨ JS è§£é‡Šå™¨å°†å†…å®¹è½¬æ¢ä¸º AST å¯¹è±¡ï¼Œä»ä¸­æ‰¾å‡ºè¯¥æ¨¡å—ä¾èµ–çš„æ¨¡å—ï¼Œå† é€’å½’ æœ¬æ­¥éª¤ç›´åˆ°æ‰€æœ‰å…¥å£ä¾èµ–çš„æ–‡ä»¶éƒ½ç»è¿‡äº†æœ¬æ­¥éª¤çš„å¤„ç†</li><li><strong>å®Œæˆæ¨¡å—ç¼–è¯‘</strong>ï¼šä¸Šä¸€æ­¥é€’å½’å¤„ç†æ‰€æœ‰èƒ½è§¦è¾¾åˆ°çš„æ¨¡å—åï¼Œå¾—åˆ°äº†æ¯ä¸ªæ¨¡å—è¢«ç¿»è¯‘åçš„å†…å®¹ä»¥åŠå®ƒä»¬ä¹‹é—´çš„ <strong>ä¾èµ–å…³ç³»å›¾</strong></li></ol></li><li><p>ç”Ÿæˆé˜¶æ®µï¼š</p><ol><li><strong>è¾“å‡ºèµ„æº(seal)</strong>ï¼šæ ¹æ®å…¥å£å’Œæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç»„è£…æˆä¸€ä¸ªä¸ªåŒ…å«å¤šä¸ªæ¨¡å—çš„ Chunkï¼Œå†æŠŠæ¯ä¸ª Chunk è½¬æ¢æˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶åŠ å…¥åˆ°è¾“å‡ºåˆ—è¡¨ï¼Œè¿™æ­¥æ˜¯å¯ä»¥ä¿®æ”¹è¾“å‡ºå†…å®¹çš„æœ€åæœºä¼š</li><li><strong>å†™å…¥æ–‡ä»¶ç³»ç»Ÿ(emitAssets)</strong>ï¼šåœ¨ç¡®å®šå¥½è¾“å‡ºå†…å®¹åï¼Œæ ¹æ®é…ç½®ç¡®å®šè¾“å‡ºçš„è·¯å¾„å’Œæ–‡ä»¶åï¼ŒæŠŠæ–‡ä»¶å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿ</li></ol></li></ul><blockquote><p>å•æ¬¡æ„å»ºè¿‡ç¨‹è‡ªä¸Šè€Œä¸‹æŒ‰é¡ºåºæ‰§è¡Œï¼Œä¸‹é¢ä¼šå±•å¼€èŠèŠç»†èŠ‚ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œå¯¹ä¸Šè¿°æåŠçš„å„ç±»æŠ€æœ¯åè¯ä¸å¤ªç†Ÿæ‚‰çš„åŒå­¦ï¼Œå¯ä»¥å…ˆçœ‹çœ‹ç®€ä»‹ï¼š</p></blockquote><ul><li><p><code>Entry</code>ï¼šç¼–è¯‘å…¥å£ï¼Œwebpack ç¼–è¯‘çš„èµ·ç‚¹</p></li><li><p><code>Compiler</code>ï¼šç¼–è¯‘ç®¡ç†å™¨ï¼Œwebpack å¯åŠ¨åä¼šåˆ›å»º compiler å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸€ç›´å­˜æ´»çŸ¥é“ç»“æŸé€€å‡º</p></li><li><p><code>Compilation</code>ï¼šå•æ¬¡ç¼–è¾‘è¿‡ç¨‹çš„ç®¡ç†å™¨ï¼Œæ¯”å¦‚<code>watch = true</code> æ—¶ï¼Œè¿è¡Œè¿‡ç¨‹ä¸­åªæœ‰ä¸€ä¸ª <code>compiler </code>ä½†æ¯æ¬¡æ–‡ä»¶å˜æ›´è§¦å‘é‡æ–°ç¼–è¯‘æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ <code>compilation</code> å¯¹è±¡</p></li><li><p><code>Dependence</code>ï¼šä¾èµ–å¯¹è±¡ï¼Œwebpack åŸºäºè¯¥ç±»å‹è®°å½•æ¨¡å—é—´ä¾èµ–å…³ç³»</p></li><li><p><code>Module</code>ï¼šwebpack å†…éƒ¨æ‰€æœ‰èµ„æºéƒ½ä¼šä»¥â€œmoduleâ€å¯¹è±¡å½¢å¼å­˜åœ¨ï¼Œæ‰€æœ‰å…³äºèµ„æºçš„æ“ä½œã€è½¬è¯‘ã€åˆå¹¶éƒ½æ˜¯ä»¥ â€œmoduleâ€ ä¸ºåŸºæœ¬å•ä½è¿›è¡Œçš„</p></li><li><p><code>Chunk</code>ï¼šç¼–è¯‘å®Œæˆå‡†å¤‡è¾“å‡ºæ—¶ï¼Œwebpack ä¼šå°† <code>module</code> æŒ‰ç‰¹å®šçš„è§„åˆ™ç»„ç»‡æˆä¸€ä¸ªä¸€ä¸ªçš„ <code>chunk</code>ï¼Œè¿™äº› <code>chunk</code> æŸç§ç¨‹åº¦ä¸Šè·Ÿæœ€ç»ˆè¾“å‡ºä¸€ä¸€å¯¹åº”</p></li><li><p><code>Loader</code>ï¼šèµ„æºå†…å®¹è½¬æ¢å™¨ï¼Œå…¶å®å°±æ˜¯å®ç°ä»å†…å®¹ A è½¬æ¢ B çš„è½¬æ¢å™¨</p></li><li><p><code>Plugin</code>ï¼šwebpackæ„å»ºè¿‡ç¨‹ä¸­ï¼Œä¼šåœ¨ç‰¹å®šçš„æ—¶æœºå¹¿æ’­å¯¹åº”çš„äº‹ä»¶ï¼Œæ’ä»¶ç›‘å¬è¿™äº›äº‹ä»¶ï¼Œåœ¨ç‰¹å®šæ—¶é—´ç‚¹ä»‹å…¥ç¼–è¯‘è¿‡ç¨‹</p></li></ul><p>webpack ç¼–è¯‘è¿‡ç¨‹éƒ½æ˜¯å›´ç»•ç€è¿™äº›å…³é”®å¯¹è±¡å±•å¼€çš„ï¼Œæ›´è¯¦ç»†å®Œæ•´çš„ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒ <a href="https://juejin.cn/post/6948763207397965855">Webpack çŸ¥è¯†å›¾è°±</a> ã€‚</p><h1>Webpackå’ŒGulp</h1><ul><li><p>gulpçš„æ ¸å¿ƒç†å¿µæ˜¯task runner</p><ul><li>å¯ä»¥å®šä¹‰è‡ªå·±çš„ä¸€ç³»åˆ—ä»»åŠ¡ï¼Œç­‰å¾…ä»»åŠ¡è¢«æ‰§è¡Œ;</li><li>åŸºäºæ–‡ä»¶Streamçš„æ„å»ºæµ; pæˆ‘ä»¬å¯ä»¥ä½¿ç”¨gulpçš„æ’ä»¶ä½“ç³»æ¥å®ŒæˆæŸäº›ä»»åŠ¡;</li></ul></li><li><p>webpackçš„æ ¸å¿ƒç†å¿µæ˜¯module bundler pwebpackæ˜¯ä¸€ä¸ªæ¨¡å—åŒ–çš„æ‰“åŒ…å·¥å…·;</p><ul><li>å¯ä»¥ä½¿ç”¨å„ç§å„æ ·çš„loaderæ¥åŠ è½½ä¸åŒçš„æ¨¡å—;</li><li>å¯ä»¥ä½¿ç”¨å„ç§å„æ ·çš„æ’ä»¶åœ¨webpackæ‰“åŒ…çš„ç”Ÿå‘½å‘¨æœŸå®Œæˆå…¶ä»–çš„ä»»åŠ¡;</li></ul></li><li><p>gulpç›¸å¯¹äºwebpackçš„ä¼˜ç¼ºç‚¹:</p><ul><li>gulpç›¸å¯¹äºwebpackæ€æƒ³æ›´åŠ çš„ç®€å•ã€æ˜“ç”¨ï¼Œæ›´é€‚åˆç¼–å†™ä¸€äº›è‡ªåŠ¨åŒ–çš„ä»»åŠ¡;</li><li>ä½†æ˜¯ç›®å‰å¯¹äºå¤§å‹é¡¹ç›®ï¼ˆVueã€Reactã€Angularï¼‰å¹¶ä¸ä¼šä½¿ç”¨gulpæ¥æ„å»ºï¼Œæ¯”å¦‚é»˜è®¤gulpæ˜¯ä¸æ”¯æŒæ¨¡å—åŒ–çš„ã€‚</li></ul></li></ul><h1>ä¼˜è´¨æ–‡ç« æ¨èï¼š</h1><ol><li>[<a href="https://juejin.cn/post/6949040393165996040">ä¸‡å­—æ€»ç»“] ä¸€æ–‡åƒé€ Webpack æ ¸å¿ƒåŸç†</a></li><li>[<a href="https://juejin.cn/post/6955421936373465118">æºç è§£è¯»] Webpack æ’ä»¶æ¶æ„æ·±åº¦è®²è§£</a></li><li><a href="https://juejin.cn/post/6955878306981871623">ååˆ†é’Ÿç²¾è¿› Webpackï¼šmodule.issuer å±æ€§è¯¦è§£</a></li><li><a href="https://juejin.cn/post/6958811421224206343">æœ‰ç‚¹éš¾çš„ webpack çŸ¥è¯†ç‚¹ï¼šDependency Graph æ·±åº¦è§£æ</a></li><li><a href="https://juejin.cn/post/6960472347329429511">åˆ†äº«å‡ ä¸ª Webpack å®ç”¨åˆ†æå·¥å…·</a></li><li><a href="https://juejin.cn/post/6948763207397965855">åˆ†äº«ä¸€ä»½ Webpack çŸ¥è¯†å›¾è°±</a></li></ol><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å†™ä½œä¸æ˜“ï¼Œæœªç»ä½œè€…å…è®¸ç¦æ­¢ä»¥ä»»ä½•å½¢å¼è½¬è½½ï¼&lt;/p&gt;
&lt;p&gt;å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨ã€ç‚¹èµå’Œåˆ†äº«ï¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1&gt;Webpackåˆä½“éªŒ&lt;/h1&gt;
&lt;h2 id=&quot;ç”¨Webpackè§£å†³ä»€ä¹ˆé—®é¢˜&quot;&gt;ç”¨Webpackè§£å†³ä»€ä¹ˆ</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="Webpack" scheme="https://lebronchao.com/tags/Webpack/"/>
    
    <category term="æ‰“åŒ…æ„å»º" scheme="https://lebronchao.com/tags/%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA/"/>
    
    <category term="å‰ç«¯" scheme="https://lebronchao.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://lebronchao.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>æ‘„å½± | æ¹¾åŒºä¹‹å…‰</title>
    <link href="https://lebronchao.com/2021/04/06/%E6%91%84%E5%BD%B1-%E6%B9%BE%E5%8C%BA%E4%B9%8B%E5%85%89/"/>
    <id>https://lebronchao.com/2021/04/06/%E6%91%84%E5%BD%B1-%E6%B9%BE%E5%8C%BA%E4%B9%8B%E5%85%89/</id>
    <published>2021-04-05T17:20:12.000Z</published>
    <updated>2021-04-05T17:20:12.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœºèº«ï¼šSONY A7M2<br>é•œå¤´ï¼šSONY 24-70GM<br>å‡ºé•œï¼šæ— <br>åœ°ç‚¹ï¼šåä¾¨åŸÂ·æ¬¢ä¹æ¸¯æ¹¾</p></blockquote><div class="note info simple"><p>ç‚¹å‡»å¯çœ‹å¤§å›¾</p></div><div class="justified-gallery"><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC09976.JPG" alt="DSC09976"></p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC09985.JPG" alt="DSC09985"></p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC00001.JPG" alt="DSC00001"></p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC00006.JPG" alt="DSC00006"></p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC00028.JPG" alt="DSC00028"></p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC00033.JPG" alt="DSC00033"></p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC00044.JPG" alt="DSC00044"></p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC00003.JPG" alt="DSC00003"></p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC09997.JPG" alt="DSC09997"></p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC09978.JPG" alt="DSC09978"></p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC09987.JPG" alt="DSC09987"></p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC00083.JPG" alt="DSC00083"></p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC00150.JPG" alt="DSC00150"></p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC00155.JPG" alt="DSC00155"></p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/photo/DSC00161.JPG" alt="DSC00161"></p>          </div>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;æœºèº«ï¼šSONY A7M2&lt;br&gt;
é•œå¤´ï¼šSONY 24-70GM&lt;br&gt;
å‡ºé•œï¼šæ— &lt;br&gt;
åœ°ç‚¹ï¼šåä¾¨åŸÂ·æ¬¢ä¹æ¸¯æ¹¾&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;note info simple&quot;&gt;&lt;p&gt;ç‚¹å‡»å¯çœ‹å¤§å›¾&lt;/p&gt;
&lt;/di</summary>
      
    
    
    
    <category term="æ‘„å½±" scheme="https://lebronchao.com/categories/%E6%91%84%E5%BD%B1/"/>
    
    
    <category term="æ‘„å½±" scheme="https://lebronchao.com/tags/%E6%91%84%E5%BD%B1/"/>
    
    <category term="é£å…‰" scheme="https://lebronchao.com/tags/%E9%A3%8E%E5%85%89/"/>
    
    <category term="æ‘©å¤©è½®" scheme="https://lebronchao.com/tags/%E6%91%A9%E5%A4%A9%E8%BD%AE/"/>
    
    <category term="æ¬¢ä¹æ¸¯æ¹¾" scheme="https://lebronchao.com/tags/%E6%AC%A2%E4%B9%90%E6%B8%AF%E6%B9%BE/"/>
    
  </entry>
  
  <entry>
    <title>Vueè¿›é˜¶ Diffç®—æ³•è¯¦è§£ |  å­¦ä¹ ç¬”è®°</title>
    <link href="https://lebronchao.com/2021/03/24/Vue%E8%BF%9B%E9%98%B6-Diff%E7%AE%97%E6%B3%95%E8%AF%A6%E8%A7%A3-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>https://lebronchao.com/2021/03/24/Vue%E8%BF%9B%E9%98%B6-Diff%E7%AE%97%E6%B3%95%E8%AF%A6%E8%A7%A3-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2021-03-24T15:42:55.000Z</published>
    <updated>2021-03-24T15:42:55.000Z</updated>
    
    <content type="html"><![CDATA[<h1>ä¸€ã€è™šæ‹ŸDOM</h1><blockquote><p>ä»€ä¹ˆæ˜¯è™šæ‹ŸDOMï¼Ÿ</p></blockquote><p>è™šæ‹ŸDOMå°±æ˜¯æŠŠçœŸå®DOMæ ‘çš„ç»“æ„å’Œä¿¡æ¯æŠ½è±¡å‡ºæ¥ï¼Œä»¥å¯¹è±¡çš„å½¢å¼æ¨¡æ‹Ÿæ ‘å½¢ç»“æ„ï¼Œå¦‚ä¸‹ï¼š</p><p>çœŸå®DOM:</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„è™šæ‹ŸDOMå°±æ˜¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> vnode = &#123;</span><br><span class="line">    tag: <span class="string">&#x27;div&#x27;</span>,</span><br><span class="line">    children:[ &#123;<span class="attr">tag</span>:<span class="string">&#x27;p&#x27;</span>, <span class="attr">text</span>:<span class="string">&#x27;Hello World&#x27;</span>&#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹ŸDOMï¼Ÿ</p></blockquote><p>æ¸²æŸ“çœŸå®DOMä¼šæœ‰ä¸€å®šçš„å¼€é”€ï¼Œå¦‚æœæ¯æ¬¡ä¿®æ”¹æ•°æ®éƒ½è¿›è¡ŒçœŸå®DOMæ¸²æŸ“ï¼Œéƒ½ä¼šå¼•èµ·DOMæ ‘çš„é‡ç»˜å’Œé‡æ’ï¼Œæ€§èƒ½å¼€é”€å¾ˆå¤§ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰å¯èƒ½åªä¿®æ”¹ä¸€å°éƒ¨åˆ†æ•°æ®è€Œä¸æ¸²æŸ“æ•´ä¸ªDOMå‘¢ï¼Ÿè™šæ‹ŸDOMå’ŒDiffç®—æ³•å¯ä»¥å®ç°ã€‚</p><blockquote><p>æ€ä¹ˆå®ç°ï¼Ÿ</p></blockquote><ol><li>å…ˆæ ¹æ®çœŸå®DOMç”Ÿæˆä¸€é¢—è™šæ‹ŸDOMæ ‘</li><li>å½“æŸä¸ªDOMèŠ‚ç‚¹æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„Vnode</li><li>æ–°çš„Vnodeå’Œæ—§çš„oldVnodeè¿›è¡Œå¯¹æ¯”</li><li>é€šè¿‡patchå‡½æ•°ä¸€è¾¹æ¯”å¯¹ä¸€è¾¹ç»™çœŸå®DOMæ‰“è¡¥ä¸æˆ–è€…åˆ›å»ºVnodeã€ç§»é™¤oldVnodeç­‰</li></ol><blockquote><p>æœ‰ä»€ä¹ˆä¸ä¸€æ ·ï¼Ÿ</p></blockquote><ol><li>çœŸå®DOMæ“ä½œä¸ºä¸€ä¸ªå±æ€§ä¸€ä¸ªå±æ€§å»ä¿®æ”¹ï¼Œå¼€é”€è¾ƒå¤§ã€‚</li><li>è™šæ‹ŸDOMç›´æ¥ä¿®æ”¹æ•´ä¸ªDOMèŠ‚ç‚¹å†æ›¿æ¢çœŸå®DOM</li></ol><blockquote><p>è¿˜æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</p></blockquote><p>Vueçš„è™šæ‹ŸDOMæ•°æ®æ›´æ–°æœºåˆ¶æ˜¯<a href="https://cn.vuejs.org/v2/guide/reactivity.html#%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0%E9%98%9F%E5%88%97">å¼‚æ­¥æ›´æ–°é˜Ÿåˆ—</a>ï¼Œå¹¶ä¸æ˜¯æ•°æ®å˜æ›´é©¬ä¸Šæ›´æ–°DOMï¼Œè€Œæ˜¯è¢«æ¨è¿›ä¸€ä¸ªæ•°æ®æ›´æ–°å¼‚æ­¥é˜Ÿåˆ—ç»Ÿä¸€æ›´æ–°ã€‚æƒ³è¦é©¬ä¸Šæ‹¿åˆ°DOMæ›´æ–°åDOMä¿¡æ¯ï¼Ÿæœ‰ä¸ªAPIå« <a href="https://cn.vuejs.org/v2/api/">Vue.nextTick</a></p><h1>äºŒã€ Diffç®—æ³•</h1><h2 id="ä¼ ç»ŸDiffç®—æ³•">ä¼ ç»ŸDiffç®—æ³•</h2><blockquote><p>éå†ä¸¤æ£µæ ‘ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´éƒ½è¦åšä¸€æ¬¡æ¯”è¾ƒã€‚</p></blockquote><blockquote><p>æ¯”å¦‚ a-&gt;e ã€a-&gt;d ã€a-&gt;bã€a-&gt;cã€a-&gt;a</p></blockquote><ul><li>éå†å®Œæˆçš„æ—¶é—´å¤æ‚åº¦è¾¾åˆ°äº†O(n^2)</li><li>å¯¹æ¯”å®Œå·®å¼‚åè¿˜è¦è®¡ç®—æœ€å°è½¬æ¢æ–¹å¼ï¼Œå®ç°åå¤æ‚åº¦æ¥åˆ°äº†O(n^3)</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/(null)-20210326001324690.png" alt="img"></p><h2 id="Vueä¼˜åŒ–çš„Diffç®—æ³•">Vueä¼˜åŒ–çš„Diffç®—æ³•</h2><blockquote><p>Vueçš„diffç®—æ³•åªä¼šæ¯”è¾ƒåŒå±‚çº§çš„å…ƒç´ ï¼Œä¸è¿›è¡Œè·¨å±‚çº§æ¯”è¾ƒ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/(null)-20210324234529318-20210326001327579.(null)" alt="img"></p><h1>ä¸‰ã€ Vueä¸­çš„Diffç®—æ³•å®ç°</h1><h2 id="Vnodeåˆ†ç±»">Vnodeåˆ†ç±»</h2><ul><li>EmptyVNode: æ²¡æœ‰å†…å®¹çš„æ³¨é‡ŠèŠ‚ç‚¹</li><li>TextVNode: æ–‡æœ¬èŠ‚ç‚¹</li><li>ElementVNode: æ™®é€šå…ƒç´ èŠ‚ç‚¹</li><li>ComponentVNode: ç»„ä»¶èŠ‚ç‚¹</li><li>CloneVNode: å…‹éš†èŠ‚ç‚¹ï¼Œå¯ä»¥æ˜¯ä»¥ä¸Šä»»æ„ç±»å‹çš„èŠ‚ç‚¹ï¼Œå”¯ä¸€çš„åŒºåˆ«åœ¨äºisClonedå±æ€§ä¸ºtrue</li></ul><h2 id="Patchå‡½æ•°">Patchå‡½æ•°</h2><blockquote><p>patchå‡½æ•°æ¥æ”¶ä»¥ä¸‹å‚æ•°ï¼š</p></blockquote><ol><li>oldVnodeï¼šæ—§çš„è™šæ‹ŸèŠ‚ç‚¹</li><li>Vnodeï¼šæ–°çš„è™šæ‹ŸèŠ‚ç‚¹</li><li>hydratingï¼šæ˜¯å¦è¦å’ŒçœŸå®DOMæ··åˆ</li><li>removeOnlyï¼šç‰¹æ®Šçš„flagï¼Œç”¨äº transition-group</li></ol><blockquote><p>å¤„ç†æµç¨‹å¤§è‡´åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š</p></blockquote><ol><li>vnodeä¸å­˜åœ¨ï¼ŒoldVnodeå­˜åœ¨æ—¶ï¼Œç§»é™¤oldVnode</li><li>vnodeå­˜åœ¨ï¼ŒoldVnodeä¸å­˜åœ¨æ—¶ï¼Œåˆ›å»ºvnode</li><li>vnodeå’ŒoldVnodeéƒ½å­˜åœ¨æ—¶<ol><li>å¦‚æœvnodeå’ŒoldVnodeæ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹ï¼ˆé€šè¿‡sameVnodeå‡½æ•°å¯¹æ¯”  åç»­è¯¦è§£ï¼‰ï¼Œé€šè¿‡patchVnodeè¿›è¡Œåç»­æ¯”å¯¹å·¥ä½œ</li><li>å¦‚æœvnodeå’ŒoldVnodeä¸æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ ¹æ®vnodeåˆ›å»ºæ–°çš„å…ƒç´ å¹¶æŒ‚è½½è‡³oldVnodeçˆ¶å…ƒç´ ä¸‹ã€‚å¦‚æœç»„ä»¶æ ¹èŠ‚ç‚¹è¢«æ›¿æ¢ï¼Œéå†æ›´æ–°çˆ¶èŠ‚ç‚¹elementã€‚ç„¶åç§»é™¤æ—§èŠ‚ç‚¹ã€‚å¦‚æœoldVnodeæ˜¯æœåŠ¡ç«¯æ¸²æŸ“å…ƒç´ èŠ‚ç‚¹ï¼Œéœ€è¦ç”¨hydrateå‡½æ•°å°†è™šæ‹Ÿdomå’ŒçœŸæ˜¯domè¿›è¡Œæ˜ å°„</li></ol></li></ol><blockquote><p>æºç å¦‚ä¸‹ï¼Œå·²å†™å¥½æ³¨é‡Šä¾¿äºé˜…è¯»</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">patch</span>(<span class="params">oldVnode, vnode, hydrating, removeOnly</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœvnodeä¸å­˜åœ¨ï¼Œä½†æ˜¯oldVnodeå­˜åœ¨ï¼Œç§»é™¤oldVnode</span></span><br><span class="line">    <span class="keyword">if</span> (isUndef(vnode)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (isDef(oldVnode)) invokeDestroyHook(oldVnode)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> isInitialPatch = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">const</span> insertedVnodeQueue = []</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœoldVnodeä¸å­˜åœ¨ï¼Œä½†æ˜¯vnodeå­˜åœ¨æ—¶ï¼Œåˆ›å»ºvnode</span></span><br><span class="line">    <span class="keyword">if</span> (isUndef(oldVnode)) &#123;</span><br><span class="line">      isInitialPatch = <span class="literal">true</span></span><br><span class="line">      createElm(vnode, insertedVnodeQueue)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// å‰©ä½™æƒ…å†µä¸ºvnodeå’ŒoldVnodeéƒ½å­˜åœ¨</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// åˆ¤æ–­æ˜¯å¦ä¸ºçœŸå®DOMå…ƒç´ </span></span><br><span class="line">      <span class="keyword">const</span> isRealElement = isDef(oldVnode.nodeType)</span><br><span class="line">      <span class="keyword">if</span> (!isRealElement &amp;&amp; sameVnode(oldVnode, vnode)) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœvnodeå’ŒoldVnodeæ˜¯åŒä¸€ä¸ªï¼ˆé€šè¿‡sameVnodeå‡½æ•°è¿›è¡Œæ¯”å¯¹  åç»­è¯¦è§£ï¼‰</span></span><br><span class="line">        <span class="comment">// å—ç”¨patchVnodeå‡½æ•°è¿›è¡Œåç»­æ¯”å¯¹å·¥ä½œ ï¼ˆå‡½æ•°åç»­è¯¦è§£ï¼‰</span></span><br><span class="line">        patchVnode(oldVnode, vnode, insertedVnodeQueue, removeOnly)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// vnodeå’ŒoldVnodeä¸æ˜¯åŒä¸€ä¸ªçš„æƒ…å†µ</span></span><br><span class="line">        <span class="keyword">if</span> (isRealElement) &#123;</span><br><span class="line">          <span class="comment">// å¦‚æœå­˜åœ¨çœŸå®çš„èŠ‚ç‚¹ï¼Œå­˜åœ¨data-server-renderå±æ€§</span></span><br><span class="line">          <span class="keyword">if</span> (oldVnode.nodeType === <span class="number">1</span> &amp;&amp; oldVnode.hasAttribute(SSR_ATTR)) &#123;</span><br><span class="line">            <span class="comment">// å½“æ—§çš„Vnodeæ˜¯æœåŠ¡ç«¯æ¸²æŸ“å…ƒç´ ï¼Œhydratingè®°ä¸ºtrue</span></span><br><span class="line">            oldVnode.removeAttribute(SSR_ATTR)</span><br><span class="line">            hydrating = <span class="literal">true</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// éœ€è¦ç”¨hydrateå‡½æ•°å°†è™šæ‹ŸDOMå’ŒçœŸå®DOMè¿›è¡Œæ˜ å°„</span></span><br><span class="line">          <span class="keyword">if</span> (isTrue(hydrating)) &#123;</span><br><span class="line">            <span class="comment">// éœ€è¦åˆå¹¶åˆ°çœŸå®DOMä¸Š</span></span><br><span class="line">            <span class="keyword">if</span> (hydrate(oldVnode, vnode, insertedVnodeQueue)) &#123;</span><br><span class="line">              <span class="comment">// è°ƒç”¨inserté’©å­</span></span><br><span class="line">              invokeInsertHook(vnode, insertedVnodeQueue, <span class="literal">true</span>)</span><br><span class="line">              <span class="keyword">return</span> oldVnode</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">&#x27;production&#x27;</span>) &#123;</span><br><span class="line">              warn(</span><br><span class="line">                <span class="string">&#x27;The client-side rendered virtual DOM tree is not matching &#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;server-rendered content. This is likely caused by incorrect &#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;HTML markup, for example nesting block-level elements inside &#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&lt;p&gt;, or missing &lt;tbody&gt;. Bailing hydration and performing &#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;full client-side render.&#x27;</span></span><br><span class="line">              )</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// å¦‚æœä¸æ˜¯æœåŠ¡ç«¯æ¸²æŸ“å…ƒç´ æˆ–è€…åˆå¹¶åˆ°çœŸå®DOMå¤±è´¥ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªç©ºçš„VnodeèŠ‚ç‚¹å»æ›¿æ¢å®ƒ</span></span><br><span class="line">          oldVnode = emptyNodeAt(oldVnode)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–oldVnodeçˆ¶èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">const</span> oldElm = oldVnode.elm</span><br><span class="line">        <span class="keyword">const</span> parentElm = nodeOps.parentNode(oldElm)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ ¹æ®vnodeåˆ›å»ºä¸€ä¸ªçœŸå®DOMèŠ‚ç‚¹å¹¶æŒ‚è½½è‡³oldVnodeçš„çˆ¶èŠ‚ç‚¹ä¸‹</span></span><br><span class="line">        createElm(</span><br><span class="line">          vnode,</span><br><span class="line">          insertedVnodeQueue,</span><br><span class="line">          oldElm._leaveCb ? <span class="literal">null</span> : parentElm,</span><br><span class="line">          nodeOps.nextSibling(oldElm)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœç»„ä»¶æ ¹èŠ‚ç‚¹è¢«æ›¿æ¢ï¼Œéå†æ›´æ–°çˆ¶èŠ‚ç‚¹Element</span></span><br><span class="line">        <span class="keyword">if</span> (isDef(vnode.parent)) &#123;</span><br><span class="line">          <span class="keyword">let</span> ancestor = vnode.parent</span><br><span class="line">          <span class="keyword">const</span> patchable = isPatchable(vnode)</span><br><span class="line">          <span class="keyword">while</span> (ancestor) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; cbs.destroy.length; ++i) &#123;</span><br><span class="line">              cbs.destroy[i](ancestor)</span><br><span class="line">            &#125;</span><br><span class="line">            ancestor.elm = vnode.elm</span><br><span class="line">            <span class="keyword">if</span> (patchable) &#123;</span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; cbs.create.length; ++i) &#123;</span><br><span class="line">                cbs.create[i](emptyNode, ancestor)</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="comment">// #6513</span></span><br><span class="line">              <span class="comment">// invoke insert hooks that may have been merged by create hooks.</span></span><br><span class="line">              <span class="comment">// e.g. for directives that uses the &quot;inserted&quot; hook.</span></span><br><span class="line">              <span class="keyword">const</span> insert = ancestor.data.hook.insert</span><br><span class="line">              <span class="keyword">if</span> (insert.merged) &#123;</span><br><span class="line">                <span class="comment">// start at index 1 to avoid re-invoking component mounted hook</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; insert.fns.length; i++) &#123;</span><br><span class="line">                  insert.fns[i]()</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              registerRef(ancestor)</span><br><span class="line">            &#125;</span><br><span class="line">            ancestor = ancestor.parent</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é”€æ¯æ—§èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (isDef(parentElm)) &#123;</span><br><span class="line">          <span class="comment">// ç§»é™¤è€èŠ‚ç‚¹</span></span><br><span class="line">          removeVnodes(parentElm, [oldVnode], <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isDef(oldVnode.tag)) &#123;</span><br><span class="line">          <span class="comment">// è°ƒç”¨destroyé’©å­</span></span><br><span class="line">          invokeDestroyHook(oldVnode)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è°ƒç”¨inserté’©å­å¹¶è¿”å›èŠ‚ç‚¹</span></span><br><span class="line">    invokeInsertHook(vnode, insertedVnodeQueue, isInitialPatch)</span><br><span class="line">    <span class="keyword">return</span> vnode.elm</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="sameVnodeå‡½æ•°">sameVnodeå‡½æ•°</h2><blockquote><p>Vueæ€ä¹ˆåˆ¤æ–­æ˜¯ä¸æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹ï¼Ÿæµç¨‹å¦‚ä¸‹ï¼š</p></blockquote><ol><li>åˆ¤æ–­Keyå€¼æ˜¯å¦ä¸€æ ·</li><li>tagçš„å€¼æ˜¯å¦ä¸€æ ·</li><li>isCommentï¼Œè¿™ä¸ªä¸ç”¨å¤ªå…³æ³¨ã€‚</li><li>æ•°æ®ä¸€æ ·</li><li>sameInputType()ï¼Œä¸“é—¨å¯¹è¡¨å•è¾“å…¥é¡¹è¿›è¡Œåˆ¤æ–­çš„ï¼šinputä¸€æ ·ä½†æ˜¯é‡Œé¢çš„typeä¸ä¸€æ ·ç®—ä¸åŒçš„inputType</li></ol><blockquote><p>ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºkeyå¯¹diffç®—æ³•çš„è¾…åŠ©ä½œç”¨ï¼Œå¯ä»¥å¿«é€Ÿå®šä½æ˜¯å¦ä¸ºåŒä¸€ä¸ªå…ƒç´ ï¼Œå¿…é¡»ä¿è¯å”¯ä¸€æ€§ã€‚</p></blockquote><blockquote><p>å¦‚æœä½ ç”¨çš„æ˜¯indexä½œä¸ºkeyï¼Œæ¯æ¬¡æ‰“ä¹±é¡ºåºkeyéƒ½ä¼šæ”¹å˜ï¼Œå¯¼è‡´è¿™ç§åˆ¤æ–­å¤±æ•ˆï¼Œé™ä½äº†Diffçš„æ•ˆç‡ã€‚</p></blockquote><blockquote><p>å› æ­¤ï¼Œç”¨å¥½keyä¹Ÿæ˜¯Vueæ€§èƒ½ä¼˜åŒ–çš„ä¸€ç§æ–¹å¼ã€‚</p></blockquote><ul><li>æºç å¦‚ä¸‹ï¼š</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sameVnode</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    a.key === b.key &amp;&amp; (</span><br><span class="line">      (</span><br><span class="line">        a.tag === b.tag &amp;&amp;</span><br><span class="line">        a.isComment === b.isComment &amp;&amp;</span><br><span class="line">        isDef(a.data) === isDef(b.data) &amp;&amp;</span><br><span class="line">        sameInputType(a, b)</span><br><span class="line">      ) || (</span><br><span class="line">        isTrue(a.isAsyncPlaceholder) &amp;&amp;</span><br><span class="line">        a.asyncFactory === b.asyncFactory &amp;&amp;</span><br><span class="line">        isUndef(b.asyncFactory.error)</span><br><span class="line">      )</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="patchVnodeå‡½æ•°">patchVnodeå‡½æ•°</h2><blockquote><p>å‰ç½®æ¡ä»¶vnodeå’ŒoldVnodeæ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹</p></blockquote><blockquote><p>æ‰§è¡Œæµç¨‹ï¼š</p></blockquote><ol><li>å¦‚æœoldVnodeå’Œvnodeå¼•ç”¨ä¸€è‡´ï¼Œå¯ä»¥è®¤ä¸ºæ²¡æœ‰å˜åŒ–ï¼Œreturn</li><li>å¦‚æœoldVnodeçš„isAsyncPlaceholderå±æ€§ä¸ºtrueï¼Œè·³è¿‡æ£€æŸ¥å¼‚æ­¥ç»„ä»¶ï¼Œreturn</li><li>å¦‚æœoldVnodeè·Ÿvnodeéƒ½æ˜¯é™æ€èŠ‚ç‚¹ï¼Œä¸”å…·æœ‰ç›¸åŒçš„keyï¼ŒåŒæ—¶vnodeæ˜¯å…‹éš†èŠ‚ç‚¹æˆ–è€…v-onceæŒ‡ä»¤æ§åˆ¶çš„èŠ‚ç‚¹æ—¶ï¼Œåªéœ€è¦æŠŠoldVnode.elmå’ŒoldVnode.childéƒ½å¤åˆ¶åˆ°vnodeä¸Šï¼Œä¹Ÿä¸ç”¨å†æœ‰å…¶ä»–æ“ä½œï¼Œreturn</li><li>å¦‚æœvnodeä¸æ˜¯æ–‡æœ¬èŠ‚æˆ–æ³¨é‡ŠèŠ‚ç‚¹<ol><li>å¦‚æœvnodeå’ŒoldVnodeéƒ½æœ‰å­èŠ‚ç‚¹å¹¶ä¸”ä¸¤è€…å­èŠ‚ç‚¹ä¸ä¸€è‡´æ—¶ï¼Œå°±è°ƒç”¨updateChildrenæ›´æ–°å­èŠ‚ç‚¹</li><li>å¦‚æœåªæœ‰vnodeæœ‰è‡ªå­èŠ‚ç‚¹ï¼Œåˆ™è°ƒç”¨addVnodesåˆ›å»ºå­èŠ‚ç‚¹</li><li>å¦‚æœåªæœ‰oldVnodeæœ‰å­èŠ‚ç‚¹ï¼Œåˆ™è°ƒç”¨removeVnodesæŠŠè¿™äº›å­èŠ‚ç‚¹éƒ½åˆ é™¤</li><li>å¦‚æœvnodeæ–‡æœ¬ä¸ºundefinedï¼Œåˆ™æ¸…ç©ºvnode.elmæ–‡æœ¬</li></ol></li><li>å¦‚æœvnodeæ˜¯æ–‡æœ¬èŠ‚ç‚¹ä½†æ˜¯å’ŒoldVnodeæ–‡æœ¬å†…å®¹ä¸åŒï¼Œåªéœ€æ›´æ–°æ–‡æœ¬ã€‚</li></ol><blockquote><p>æºä»£ç å¦‚ä¸‹ï¼Œå·²å†™å¥½æ³¨é‡Šä¾¿äºé˜…è¯»</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">patchVnode</span>(<span class="params">oldVnode, vnode, insertedVnodeQueue, removeOnly</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ–°è€èŠ‚ç‚¹å¼•ç”¨ä¸€è‡´ï¼Œç›´æ¥è¿”å›ã€‚</span></span><br><span class="line">    <span class="keyword">if</span> (oldVnode === vnode) &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> elm = vnode.elm = oldVnode.elm</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœoldVnodeçš„isAsyncPlaceholderå±æ€§ä¸ºtrueï¼Œè·³è¿‡æ£€æŸ¥å¼‚æ­¥ç»„ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (isTrue(oldVnode.isAsyncPlaceholder)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (isDef(vnode.asyncFactory.resolved)) &#123;</span><br><span class="line">        hydrate(oldVnode.elm, vnode, insertedVnodeQueue)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        vnode.isAsyncPlaceholder = <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ–°æ—§éƒ½æ˜¯é™æ€èŠ‚ç‚¹ï¼Œvnodeçš„keyä¹Ÿç›¸åŒ</span></span><br><span class="line">    <span class="comment">// æ–°vnodeæ˜¯å…‹éš†æ‰€å¾—æˆ–æ–°vnodeæœ‰ v-onceå±æ€§</span></span><br><span class="line">    <span class="comment">// åˆ™è¿›è¡Œèµ‹å€¼ï¼Œç„¶åè¿”å›ã€‚vnodeçš„componentInstance ä¿æŒä¸å˜</span></span><br><span class="line">    <span class="keyword">if</span> (isTrue(vnode.isStatic) &amp;&amp;</span><br><span class="line">      isTrue(oldVnode.isStatic) &amp;&amp;</span><br><span class="line">      vnode.key === oldVnode.key &amp;&amp;</span><br><span class="line">      (isTrue(vnode.isCloned) || isTrue(vnode.isOnce))</span><br><span class="line">    ) &#123;</span><br><span class="line">      vnode.componentInstance = oldVnode.componentInstance</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> i</span><br><span class="line">    <span class="keyword">const</span> data = vnode.data</span><br><span class="line">    <span class="comment">// æ‰§è¡Œdata.hook.prepatch é’©å­</span></span><br><span class="line">    <span class="keyword">if</span> (isDef(data) &amp;&amp; isDef(i = data.hook) &amp;&amp; isDef(i = i.prepatch)) &#123;</span><br><span class="line">      i(oldVnode, vnode)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å­å…ƒç´ åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">const</span> oldCh = oldVnode.children</span><br><span class="line">    <span class="keyword">const</span> ch = vnode.children</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isDef(data) &amp;&amp; isPatchable(vnode)) &#123;</span><br><span class="line">      <span class="comment">// éå†è°ƒç”¨ cbs.update é’©å­å‡½æ•°ï¼Œæ›´æ–°oldVnodeæ‰€æœ‰å±æ€§</span></span><br><span class="line">      <span class="comment">// åŒ…æ‹¬attrsã€classã€domPropsã€eventsã€styleã€refã€directives</span></span><br><span class="line">      <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; cbs.update.length; ++i) cbs.update[i](oldVnode, vnode)</span><br><span class="line">      <span class="comment">// æ‰§è¡Œdata.hook.update é’©å­</span></span><br><span class="line">      <span class="keyword">if</span> (isDef(i = data.hook) &amp;&amp; isDef(i = i.update)) i(oldVnode, vnode)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Vnode çš„ texté€‰é¡¹ä¸ºundefined</span></span><br><span class="line">    <span class="keyword">if</span> (isUndef(vnode.text)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (isDef(oldCh) &amp;&amp; isDef(ch)) &#123;</span><br><span class="line">        <span class="comment">//æ–°è€èŠ‚ç‚¹çš„childrenä¸åŒï¼Œæ‰§è¡ŒupdateChildrenæ–¹æ³•</span></span><br><span class="line">        <span class="keyword">if</span> (oldCh !== ch) updateChildren(elm, oldCh, ch, insertedVnodeQueue, removeOnly)</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isDef(ch)) &#123;</span><br><span class="line">        <span class="comment">// oldVnode childrenä¸å­˜åœ¨ æ‰§è¡Œ addVnodesæ–¹æ³•</span></span><br><span class="line">        <span class="keyword">if</span> (isDef(oldVnode.text)) nodeOps.setTextContent(elm, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        addVnodes(elm, <span class="literal">null</span>, ch, <span class="number">0</span>, ch.length - <span class="number">1</span>, insertedVnodeQueue)</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isDef(oldCh)) &#123;</span><br><span class="line">        <span class="comment">// vnodeä¸å­˜åœ¨æ‰§è¡ŒremoveVnodesæ–¹æ³•</span></span><br><span class="line">        removeVnodes(elm, oldCh, <span class="number">0</span>, oldCh.length - <span class="number">1</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isDef(oldVnode.text)) &#123;</span><br><span class="line">        <span class="comment">// æ–°æ—§èŠ‚ç‚¹éƒ½æ˜¯undefinedï¼Œä¸”è€èŠ‚ç‚¹å­˜åœ¨textï¼Œæ¸…ç©ºæ–‡æœ¬ã€‚</span></span><br><span class="line">        nodeOps.setTextContent(elm, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (oldVnode.text !== vnode.text) &#123;</span><br><span class="line">      <span class="comment">// æ–°è€èŠ‚ç‚¹æ–‡æœ¬å†…å®¹ä¸åŒï¼Œæ›´æ–°æ–‡æœ¬</span></span><br><span class="line">      nodeOps.setTextContent(elm, vnode.text)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (isDef(data)) &#123;</span><br><span class="line">      <span class="comment">// æ‰§è¡Œdata.hook.postpatché’©å­ï¼Œè‡³æ­¤ patchå®Œæˆ</span></span><br><span class="line">      <span class="keyword">if</span> (isDef(i = data.hook) &amp;&amp; isDef(i = i.postpatch)) i(oldVnode, vnode)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="updateChildrenå‡½æ•°">updateChildrenå‡½æ•°</h2><blockquote><p>é‡ç‚¹ï¼ï¼ï¼</p></blockquote><blockquote><p>å‰ç½®æ¡ä»¶ï¼švnodeå’ŒoldVnodeçš„childrenä¸ç›¸ç­‰</p></blockquote><blockquote><p>æ•´ä½“çš„æ‰§è¡Œæ€è·¯å¦‚ä¸‹ï¼š</p></blockquote><ol><li><p>vnodeå¤´å¯¹æ¯”oldVnodeå¤´</p></li><li><p>vnodeå°¾å¯¹æ¯”oldVnodeå°¾</p></li><li><p>vnodeå¤´å¯¹æ¯”oldVnodeå°¾</p></li><li><p>vnodeå°¾å¯¹æ¯”oldVnodeå¤´</p><ul><li>åªè¦ç¬¦åˆä¸€ç§æƒ…å†µå°±è¿›è¡Œpatchï¼Œç§»åŠ¨èŠ‚ç‚¹ï¼Œç§»åŠ¨ä¸‹æ ‡ç­‰æ“ä½œ</li></ul></li><li><p>éƒ½ä¸å¯¹å†åœ¨oldChildä¸­æ‰¾ä¸€ä¸ªkeyå’ŒnewStartç›¸åŒçš„èŠ‚ç‚¹</p><ul><li><p>æ‰¾ä¸åˆ°ï¼Œæ–°å»ºä¸€ä¸ªã€‚</p></li><li><p>æ‰¾åˆ°ï¼Œè·å–è¿™ä¸ªèŠ‚ç‚¹ï¼Œåˆ¤æ–­å®ƒå’ŒnewStartVnodeæ˜¯ä¸æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹</p><ul><li>å¦‚æœæ˜¯ç›¸åŒèŠ‚ç‚¹ï¼Œè¿›è¡Œpatch  ç„¶åå°†è¿™ä¸ªèŠ‚ç‚¹æ’å…¥åˆ°oldStartä¹‹å‰ï¼ŒnewStartä¸‹æ ‡ç»§ç»­ç§»åŠ¨</li><li>å¦‚æœä¸æ˜¯ç›¸åŒèŠ‚ç‚¹ï¼Œéœ€è¦æ‰§è¡ŒcreateElmåˆ›å»ºæ–°å…ƒç´ </li></ul></li></ul></li></ol><blockquote><p>ä¸ºä»€ä¹ˆä¼šæœ‰å¤´å¯¹å°¾ã€å°¾å¯¹å¤´çš„æ“ä½œï¼Ÿ</p></blockquote><ul><li>å¯ä»¥å¿«é€Ÿæ£€æµ‹å‡ºreverseæ“ä½œï¼ŒåŠ å¿«diffæ•ˆç‡ã€‚</li></ul><blockquote><p>æºç å¦‚ä¸‹   å·²å†™å¥½æ³¨é‡Šä¾¿äºé˜…è¯»ï¼š</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateChildren</span>(<span class="params">parentElm, oldCh, newCh, insertedVnodeQueue, removeOnly</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// å®šä¹‰å˜é‡</span></span><br><span class="line">   <span class="keyword">let</span> oldStartIdx = <span class="number">0</span>  <span class="comment">// è€èŠ‚ç‚¹Childå¤´ä¸‹æ ‡</span></span><br><span class="line">   <span class="keyword">let</span> newStartIdx = <span class="number">0</span>  <span class="comment">// æ–°èŠ‚ç‚¹Childå¤´ä¸‹æ ‡</span></span><br><span class="line">   <span class="keyword">let</span> oldEndIdx = oldCh.length - <span class="number">1</span>  <span class="comment">// è€èŠ‚ç‚¹Childå°¾ä¸‹æ ‡</span></span><br><span class="line">   <span class="keyword">let</span> oldStartVnode = oldCh[<span class="number">0</span>]      <span class="comment">// è€èŠ‚ç‚¹Childå¤´ç»“ç‚¹</span></span><br><span class="line">   <span class="keyword">let</span> oldEndVnode = oldCh[oldEndIdx] <span class="comment">// è€èŠ‚ç‚¹Childå°¾ç»“ç‚¹</span></span><br><span class="line">   <span class="keyword">let</span> newEndIdx = newCh.length - <span class="number">1</span>   <span class="comment">// æ–°èŠ‚ç‚¹Childå°¾ä¸‹æ ‡</span></span><br><span class="line">   <span class="keyword">let</span> newStartVnode = newCh[<span class="number">0</span>]       <span class="comment">// æ–°èŠ‚ç‚¹Childå¤´ç»“ç‚¹</span></span><br><span class="line">   <span class="keyword">let</span> newEndVnode = newCh[newEndIdx]  <span class="comment">// æ–°èŠ‚ç‚¹Childå°¾ç»“ç‚¹</span></span><br><span class="line">   <span class="keyword">let</span> oldKeyToIdx, idxInOld, vnodeToMove, refElm  </span><br><span class="line"></span><br><span class="line">   <span class="comment">// removeOnly is a special flag used only by &lt;transition-group&gt;</span></span><br><span class="line">   <span class="comment">// to ensure removed elements stay in correct relative positions</span></span><br><span class="line">   <span class="comment">// during leaving transitions</span></span><br><span class="line">   <span class="keyword">const</span> canMove = !removeOnly</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">&#x27;production&#x27;</span>) &#123;</span><br><span class="line">     checkDuplicateKeys(newCh)</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// å®šä¹‰å¾ªç¯</span></span><br><span class="line">   <span class="keyword">while</span> (oldStartIdx &lt;= oldEndIdx &amp;&amp; newStartIdx &lt;= newEndIdx) &#123;</span><br><span class="line">     <span class="comment">// å­˜åœ¨æ£€æµ‹</span></span><br><span class="line">     <span class="keyword">if</span> (isUndef(oldStartVnode)) &#123;</span><br><span class="line">       oldStartVnode = oldCh[++oldStartIdx] <span class="comment">// Vnode has been moved left</span></span><br><span class="line">     &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isUndef(oldEndVnode)) &#123;</span><br><span class="line">       oldEndVnode = oldCh[--oldEndIdx]</span><br><span class="line"></span><br><span class="line">     <span class="comment">// å¦‚æœè€ç»“ç‚¹Childå¤´å’Œæ–°èŠ‚ç‚¹Childå¤´æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">     &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldStartVnode, newStartVnode)) &#123;</span><br><span class="line">       <span class="comment">// patchå·®å¼‚</span></span><br><span class="line">       patchVnode(oldStartVnode, newStartVnode, insertedVnodeQueue)</span><br><span class="line">       <span class="comment">// patchå®Œæˆ  ç§»åŠ¨èŠ‚ç‚¹ä½ç½®  ç»§ç»­æ¯”å¯¹ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">       oldStartVnode = oldCh[++oldStartIdx]</span><br><span class="line">       newStartVnode = newCh[++newStartIdx]</span><br><span class="line"></span><br><span class="line">     <span class="comment">// å¦‚æœè€ç»“ç‚¹Childå°¾å’Œæ–°èŠ‚ç‚¹Childå°¾æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">     &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldEndVnode, newEndVnode)) &#123;</span><br><span class="line">       <span class="comment">// patchå·®å¼‚</span></span><br><span class="line">       patchVnode(oldEndVnode, newEndVnode, insertedVnodeQueue)</span><br><span class="line">       <span class="comment">// patchå®Œæˆ  ç§»åŠ¨èŠ‚ç‚¹ä½ç½® ç»§ç»­æ¯”å¯¹ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">       oldEndVnode = oldCh[--oldEndIdx]</span><br><span class="line">       newEndVnode = newCh[--newEndIdx]</span><br><span class="line"></span><br><span class="line">     <span class="comment">// å¦‚æœè€ç»“ç‚¹Childå¤´å’Œæ–°èŠ‚ç‚¹Childå°¾æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">     &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldStartVnode, newEndVnode)) &#123; <span class="comment">// Vnode moved right</span></span><br><span class="line">        <span class="comment">// patchå·®å¼‚</span></span><br><span class="line">       patchVnode(oldStartVnode, newEndVnode, insertedVnodeQueue)</span><br><span class="line">       <span class="comment">// æŠŠoldStartèŠ‚ç‚¹æ”¾åˆ°oldEndèŠ‚ç‚¹åé¢</span></span><br><span class="line">       canMove &amp;&amp; nodeOps.insertBefore(parentElm, oldStartVnode.elm, nodeOps.nextSibling(oldEndVnode.elm))</span><br><span class="line">       <span class="comment">// patchå®Œæˆ  ç§»åŠ¨èŠ‚ç‚¹ä½ç½® ç»§ç»­æ¯”å¯¹ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">       oldStartVnode = oldCh[++oldStartIdx]</span><br><span class="line">       newEndVnode = newCh[--newEndIdx]</span><br><span class="line">     <span class="comment">// å¦‚æœè€ç»“ç‚¹Childå°¾å’Œæ–°èŠ‚ç‚¹Childå¤´æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">     &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldEndVnode, newStartVnode)) &#123; <span class="comment">// Vnode moved left</span></span><br><span class="line">        <span class="comment">// patchå·®å¼‚</span></span><br><span class="line">       patchVnode(oldEndVnode, newStartVnode, insertedVnodeQueue)</span><br><span class="line">       <span class="comment">// æŠŠoldEndèŠ‚ç‚¹æ”¾åˆ°oldStartèŠ‚ç‚¹å‰é¢</span></span><br><span class="line">       canMove &amp;&amp; nodeOps.insertBefore(parentElm, oldEndVnode.elm, oldStartVnode.elm)</span><br><span class="line">       <span class="comment">// patchå®Œæˆ  ç§»åŠ¨èŠ‚ç‚¹ä½ç½® ç»§ç»­æ¯”å¯¹ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">       oldEndVnode = oldCh[--oldEndIdx]</span><br><span class="line">       newStartVnode = newCh[++newStartIdx]</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="comment">// å¦‚æœæ²¡æœ‰ç›¸åŒçš„Keyï¼Œæ‰§è¡ŒcreateElmæ–¹æ³•åˆ›å»ºå…ƒç´ </span></span><br><span class="line">       <span class="keyword">if</span> (isUndef(oldKeyToIdx)) oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx)</span><br><span class="line">       idxInOld = isDef(newStartVnode.key) ?</span><br><span class="line">         oldKeyToIdx[newStartVnode.key] :</span><br><span class="line">         findIdxInOld(newStartVnode, oldCh, oldStartIdx, oldEndIdx)</span><br><span class="line">       <span class="keyword">if</span> (isUndef(idxInOld)) &#123; <span class="comment">// New element</span></span><br><span class="line">         createElm(newStartVnode, insertedVnodeQueue, parentElm, oldStartVnode.elm, <span class="literal">false</span>, newCh, newStartIdx)</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="comment">// æœ‰ç›¸åŒçš„Keyï¼Œåˆ¤æ–­è¿™ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦ä¸ºsameNode</span></span><br><span class="line">         vnodeToMove = oldCh[idxInOld]</span><br><span class="line">         <span class="keyword">if</span> (sameVnode(vnodeToMove, newStartVnode)) &#123;</span><br><span class="line">           <span class="comment">// å¦‚æœæ˜¯ç›¸åŒèŠ‚ç‚¹ï¼Œè¿›è¡Œpatch  ç„¶åä¸¾å°†oldStartæ’å…¥åˆ°oldStartä¹‹å‰ï¼ŒnewStartä¸‹æ ‡ç»§ç»­ç§»åŠ¨</span></span><br><span class="line">           patchVnode(vnodeToMove, newStartVnode, insertedVnodeQueue)</span><br><span class="line">           oldCh[idxInOld] = <span class="literal">undefined</span></span><br><span class="line">           canMove &amp;&amp; nodeOps.insertBefore(parentElm, vnodeToMove.elm, oldStartVnode.elm)</span><br><span class="line">         &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           <span class="comment">// å¦‚æœä¸æ˜¯ç›¸åŒèŠ‚ç‚¹ï¼Œéœ€è¦æ‰§è¡ŒcreateElmåˆ›å»ºæ–°å…ƒç´ </span></span><br><span class="line">           createElm(newStartVnode, insertedVnodeQueue, parentElm, oldStartVnode.elm, <span class="literal">false</span>, newCh, newStartIdx)</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       newStartVnode = newCh[++newStartIdx]</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// oldStartIdx &gt; oldEndIdxè¯´æ˜oldChildå…ˆéå†å®Œï¼Œä½¿ç”¨addVnodeæ–¹æ³•æ·»åŠ newStartIdxæŒ‡å‘çš„èŠ‚ç‚¹åˆ°newEndIdxçš„èŠ‚ç‚¹</span></span><br><span class="line">   <span class="keyword">if</span> (oldStartIdx &gt; oldEndIdx) &#123;</span><br><span class="line">     refElm = isUndef(newCh[newEndIdx + <span class="number">1</span>]) ? <span class="literal">null</span> : newCh[newEndIdx + <span class="number">1</span>].elm</span><br><span class="line">     addVnodes(parentElm, refElm, newCh, newStartIdx, newEndIdx, insertedVnodeQueue)</span><br><span class="line">   &#125; <span class="keyword">else</span> <span class="keyword">if</span> (newStartIdx &gt; newEndIdx) &#123;</span><br><span class="line">     <span class="comment">// å¦‚æœnewStartIdx &gt; newEndIdxè¯´æ˜newChildå…ˆéå†å®Œï¼Œremoveæ‰oldChildæœªéå†å®Œçš„èŠ‚ç‚¹</span></span><br><span class="line">     removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx)</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h1>å››ã€æ€»ç»“</h1><ol><li>æ­£ç¡®ä½¿ç”¨keyï¼Œå¯ä»¥å¿«é€Ÿæ‰§è¡ŒsameVnodeæ¯”å¯¹ï¼ŒåŠ é€ŸDiffæ•ˆç‡ï¼Œå¯ä»¥ä½œä¸ºæ€§èƒ½ä¼˜åŒ–çš„ä¸€ä¸ªç‚¹ã€‚</li><li>DIffåªåšåŒçº§æ¯”è¾ƒï¼Œä½¿ç”¨sameVnodeå‡½æ•°æ¯”å¯¹ï¼Œæ–‡æœ¬èŠ‚ç‚¹ç›´æ¥æ›¿æ¢æ–‡æœ¬å†…å®¹ã€‚</li><li>å­å…ƒç´ åˆ—è¡¨çš„Diffï¼Œè¿›è¡Œå¤´å¯¹å¤´ã€å°¾å¯¹å°¾ã€å¤´å¯¹å°¾ç­‰ç³»åˆ—æ¯”è¾ƒï¼Œç›´åˆ°éå†å®Œä¸¤ä¸ªå…ƒç´ çš„å­å…ƒç´ åˆ—è¡¨ã€‚<ul><li>æˆ–ä¸€ä¸ªåˆ—è¡¨å…ˆéå†å®Œäº†ï¼Œç›´æ¥addVnode / removeVnodeã€‚</li></ul></li></ol><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;ä¸€ã€è™šæ‹ŸDOM&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»€ä¹ˆæ˜¯è™šæ‹ŸDOMï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è™šæ‹ŸDOMå°±æ˜¯æŠŠçœŸå®DOMæ ‘çš„ç»“æ„å’Œä¿¡æ¯æŠ½è±¡å‡ºæ¥ï¼Œä»¥å¯¹è±¡çš„å½¢å¼æ¨¡æ‹Ÿæ ‘å½¢ç»“æ„ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;çœŸå®DOM:&lt;/p&gt;
&lt;figure class=&quot;h</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://lebronchao.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="Front End" scheme="https://lebronchao.com/tags/Front-End/"/>
    
    <category term="Vue" scheme="https://lebronchao.com/tags/Vue/"/>
    
    <category term="Diff ç®—æ³•" scheme="https://lebronchao.com/tags/Diff-%E7%AE%97%E6%B3%95/"/>
    
    <category term="è™šæ‹ŸDOM" scheme="https://lebronchao.com/tags/%E8%99%9A%E6%8B%9FDOM/"/>
    
  </entry>
  
  <entry>
    <title>æµ…æHTTPç¼“å­˜</title>
    <link href="https://lebronchao.com/2021/03/20/%E6%B5%85%E6%9E%90HTTP%E7%BC%93%E5%AD%98/"/>
    <id>https://lebronchao.com/2021/03/20/%E6%B5%85%E6%9E%90HTTP%E7%BC%93%E5%AD%98/</id>
    <published>2021-03-20T03:38:49.000Z</published>
    <updated>2021-03-20T03:38:49.000Z</updated>
    
    <content type="html"><![CDATA[<h1>ä¸ºä»€ä¹ˆéœ€è¦ç¼“å­˜</h1><ul><li>é€šè¿‡ç¼“å­˜æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›¸åº”åœºæ™¯ä¸‹å¤ç”¨ä»¥å‰è·å–çš„èµ„æºã€‚</li><li>æ˜¾è‘—æé«˜ç½‘ç«™çš„æ€§èƒ½å’Œå“åº”é€Ÿåº¦</li><li>å‡å°‘ç½‘ç»œæµé‡å’Œç­‰å¾…æ¸²æŸ“æ—¶é—´</li><li>é™ä½æœåŠ¡å™¨å‹åŠ›</li></ul><h1>HTTPç¼“å­˜ç±»å‹</h1><ul><li>å¼ºç¼“å­˜</li><li>åå•†ç¼“å­˜</li></ul><h1>å¼ºç¼“å­˜</h1><p>å¯¹äºå¼ºç¼“å­˜ï¼ŒæœåŠ¡å™¨è¿”å›çš„é™æ€èµ„æºå“åº”å¤´ä¼šè®¾ç½®ä¸€ä¸ªå¼ºåˆ¶ç¼“å­˜çš„æ—¶é—´ï¼Œåœ¨ç¼“å­˜æ—¶é—´å†…ï¼Œå¦‚åˆ·æ–°æµè§ˆå™¨è¯·æ±‚ç›¸åŒèµ„æºï¼Œåœ¨ç¼“å­˜æ—¶é—´æœªè¿‡æœŸçš„æƒ…å†µä¸‹ï¼Œåˆ™ç›´æ¥ä½¿ç”¨å·²ç¼“å­˜èµ„æºã€‚å¦‚ç¼“å­˜èµ„æºå·²è¿‡æœŸï¼Œæ‰§è¡Œåå•†ç¼“å­˜ç­–ç•¥ã€‚</p><ul><li>ä»¥ä¸‹ä¸ºä¸å¼ºç¼“å­˜ç›¸å…³çš„HTTPå¤´éƒ¨å­—æ®µ</li></ul><table><thead><tr><th><strong>å­—æ®µ</strong></th><th><strong>ç”¨é€”</strong></th><th>å®ä¾‹</th><th><strong>ä¼˜å…ˆçº§</strong></th><th><strong>HTTPç‰ˆæœ¬</strong></th></tr></thead><tbody><tr><td>Expires</td><td>å¼ºç¼“å­˜çš„è¿‡æœŸæ—¥æœŸ</td><td>Expires:Thu,06 Aug 2021 14:36:18 GMT</td><td>ä½</td><td>1.0</td></tr><tr><td>Cache-Control</td><td>æŒ‡å®šæŒ‡ä»¤å®ç°ç¼“å­˜æœºåˆ¶</td><td>Cache-Control:max-age=60</td><td>é«˜</td><td>1.1</td></tr></tbody></table><h2 id="Expires">Expires</h2><ul><li>å“åº”å¤´Expireså­—æ®µåŒ…å«å¼ºç¼“å­˜èµ„æºçš„è¿‡æœŸæ—¶é—´</li><li>å€¼ä¸º0è¡¨ç¤ºèµ„æºå·²è¿‡æœŸæˆ–éå¼ºç¼“å­˜</li></ul><h2 id="Cache-Control">Cache-Control</h2><p>é€šç”¨æ¶ˆæ¯å¤´å­—æ®µï¼Œé€šè¿‡æŒ‡ä»¤æ¥å®ç°ç¼“å­˜æœºåˆ¶ã€‚è¯´æ˜ä¸€ä¸‹å®¹æ˜“å¼„æ··çš„ä¸¤ä¸ªå­—æ®µï¼Œå…¶ä»–æŒ‡ä»¤å‚è€ƒ<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control">æŒ‡ä»¤å¤§å…¨</a>ã€‚</p><ul><li>no-cache</li></ul><p>åœ¨å‘å¸ƒç¼“å­˜å‰¯æœ¬ä¹‹å‰ï¼Œå¼ºåˆ¶è¦æ±‚ç¼“å­˜æŠŠè¯·æ±‚æäº¤ç»™åŸå§‹æœåŠ¡å™¨è¿›è¡ŒéªŒè¯(åå•†ç¼“å­˜éªŒè¯)ã€‚</p><ul><li>no-store</li></ul><p>ç¼“å­˜ä¸åº”å­˜å‚¨æœ‰å…³å®¢æˆ·ç«¯è¯·æ±‚æˆ–æœåŠ¡å™¨å“åº”çš„ä»»ä½•å†…å®¹ï¼Œå³ä¸ä½¿ç”¨ä»»ä½•ç¼“å­˜ã€‚</p><h2 id="Expires-å’Œ-Cache-Control-çš„åŒºåˆ«">Expires å’Œ Cache-Control çš„åŒºåˆ«</h2><ul><li>æ—¶é—´åŒºåˆ«<ul><li>Expires è¿‡æœŸæ—¶é—´ä¸ºç»å¯¹æ—¶é—´ï¼ŒæŒ‡æœªæ¥æŸä¸ªæ—¶é—´ç‚¹ç¼“å­˜è¿‡æœŸã€‚</li><li>Cache-Control ä¸ºç›¸å¯¹æ—¶é—´ï¼Œç›¸å¯¹äºå½“å‰æ—¶é—´ï¼Œå¦‚ 60s åç¼“å­˜è¿‡æœŸ</li></ul></li><li>ä¼˜å…ˆçº§<ul><li>Expires çš„ä¼˜å…ˆçº§ä½äº Cache-Control å­—æ®µ</li><li>åŒæ—¶å­˜åœ¨ Cache-Control å’Œ Expiresæ—¶ï¼Œä»¥ Cache-Control æŒ‡ä»¤ä¸ºå‡†</li></ul></li><li>HTTP ç‰ˆæœ¬<ul><li>Expires æ˜¯HTTP/1.0 æå‡ºçš„ï¼Œå…¶æµè§ˆå™¨å…¼å®¹æ€§æ›´å¥½</li><li>Cache-Control æ˜¯ HTTP/1.1 æå‡ºçš„ï¼Œæµè§ˆå™¨å…¼å®¹æ€§ä¸ä½³ï¼Œæ‰€ä»¥ Expires å’Œ Cache-Control å¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œåœ¨ä¸æ”¯æŒ Cache-Controlçš„æµè§ˆå™¨åˆ™ä»¥Expiresä¸ºå‡†</li></ul></li></ul><h1>åå•†ç¼“å­˜</h1><ul><li>åå•†ç¼“å­˜å³å’ŒæœåŠ¡å™¨åå•†æ˜¯å¦ä½¿ç”¨ç¼“å­˜ï¼Œé€šè¿‡åˆ¤æ–­åå†³å®šé‡æ–°åŠ è½½èµ„æº or HTTP StatusCode 304</li><li>ä»¥ä¸‹å­—æ®µå†³å®šæ˜¯å¦ä½¿ç”¨åå•†ç¼“å­˜ï¼Œè€Œéå¼ºç¼“å­˜ï¼š</li></ul><table><thead><tr><th><strong>å­—æ®µ</strong></th><th><strong>åå•†ç¼“å­˜</strong></th><th><strong>ä¼˜å…ˆçº§</strong></th></tr></thead><tbody><tr><td>Pragma</td><td>Pragma:no-cache</td><td>é«˜</td></tr><tr><td>Cache-Control</td><td>Cache-Control:no-cache / Cache-Control:max-age=0</td><td>ä½</td></tr></tbody></table><h2 id="Pragma">Pragma</h2><ul><li>Pragmaæ˜¯ä¸€ä¸ªHTTP1.0ä¸­è§„å®šçš„é€šç”¨é¦–éƒ¨ï¼Œå¦‚æœ Cache-Controlä¸å­˜åœ¨çš„è¯ï¼Œå®ƒçš„è¡Œä¸ºä¸ Cache-Control: no-cache ä¸€è‡´ã€‚å¼ºåˆ¶è¦æ±‚ç¼“å­˜æœåŠ¡å™¨åœ¨è¿”å›ç¼“å­˜çš„ç‰ˆæœ¬ä¹‹å‰å°†è¯·æ±‚æäº¤åˆ°æºå¤´æœåŠ¡å™¨è¿›è¡Œåå•†éªŒè¯ã€‚</li><li>Pragmaçš„å€¼å°±åªæœ‰ä¸€ä¸ªï¼Œno-cacheï¼Œå¹¶ä¸”å®ƒçš„ä¼˜å…ˆçº§æ¯”Cache-Controlé«˜ã€‚</li></ul><h2 id="Cache-Control-2">Cache-Control</h2><ul><li>ä¸Šæ–‡ä»‹ç»è¿‡Cache-Controlï¼Œå®ƒçš„æŒ‡ä»¤æ—¢å¯ä»¥ç”¨äºå¼ºç¼“å­˜åˆå¯åº”ç”¨äºåå•†ç¼“å­˜ç­–ç•¥ä¸­</li><li>å…¶ä¸­Cache-Control: no-cache å’Œ Cache-Control: max-age=0 çš„ä½œç”¨ä¸€æ ·ï¼Œå¼ºåˆ¶è¦æ±‚å‘èµ·è¯·æ±‚ç»™æœåŠ¡å™¨è¿›è¡ŒéªŒè¯ (åå•†èµ„æºéªŒè¯)ã€‚</li></ul><h1>åå•†ç­–ç•¥</h1><p>å½“å‡ºç°Pragmaå­—æ®µæˆ–è€…Cache-Control:no-cacheæ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨åå•†ç­–ç•¥ï¼Œå¸¸è§çš„ä¸¤å¯¹åå•†ç¼“å­˜å­—æ®µå¦‚ä¸‹</p><ul><li>ETag/If-None-Match</li><li>Last-Modified/If-Modfied-Since</li></ul><table><thead><tr><th><strong>å­—æ®µ</strong></th><th><strong>å¯¹åº”å­—æ®µ</strong></th><th><strong>å€¼</strong></th><th><strong>æè¿°</strong></th><th><strong>ä¼˜å…ˆçº§</strong></th></tr></thead><tbody><tr><td>Last-Modified</td><td>If-Modified-Since</td><td>GMTæ—¶é—´</td><td>æœåŠ¡ç«¯èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´</td><td>ä½</td></tr><tr><td>If-Modified-Since</td><td>Last-Modified</td><td>GMTæ—¶é—´</td><td>ä¸Šæ¬¡è¯·æ±‚å“åº”å¤´çš„Last-Modifiedï¼ŒéªŒè¯æ˜¯å¦ä¸ºæœåŠ¡ç«¯èµ„æºæœ€åä¿®æ”¹çš„æ—¶é—´ï¼Œæ˜¯è¿”å›304ï¼Œå¦è¿”å›200ã€‚</td><td>ä½</td></tr><tr><td>Etag</td><td>If-None-Match</td><td>å†…å®¹hash/æ–‡ä»¶ä¿¡æ¯</td><td>æœåŠ¡å™¨ç¼“å­˜èµ„æºçš„æ–‡ä»¶ä¿¡æ¯æˆ–æ–‡ä»¶å†…å®¹ç”Ÿæˆçš„å“ˆå¸Œå€¼</td><td>é«˜</td></tr><tr><td>If-None-Match</td><td>Etag</td><td>å†…å®¹hash/æ–‡ä»¶ä¿¡æ¯</td><td>ä¸Šæ¬¡è¯·æ±‚å“åº”å¤´çš„ETagï¼ŒéªŒè¯æœåŠ¡å™¨èµ„æºæœ‰æ²¡æœ‰ä¿®æ”¹ï¼Œæœ‰è¿”å›200ï¼Œæ²¡æœ‰è¿”å›304ã€‚</td><td>é«˜</td></tr></tbody></table><h2 id="ä¼˜ç¼ºç‚¹">ä¼˜ç¼ºç‚¹</h2><ul><li>å¦‚æœæœåŠ¡ç«¯ä¿®æ”¹äº†ä¸€æ®µä»£ç ï¼Œç„¶ååˆæ”¹å›å»äº†ã€‚<ul><li>æ­¤æ—¶èµ„æºæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´å˜äº†</li><li>å®é™…ä¸Šæ–‡ä»¶æ²¡æœ‰å‘ç”Ÿæ”¹å˜</li><li>è¿™æ ·ç¼“å­˜å°±å¤±æ•ˆäº†ï¼Œäº§ç”Ÿäº†ä¸å¿…è¦çš„ä¼ è¾“</li></ul></li><li>è€ŒETagå¯ä»¥æ ¹æ®å†…å®¹ç”Ÿæˆçš„hashæ¥æ¯”è¾ƒçš„ï¼Œåªè¦èµ„æºæ–‡ä»¶å†…å®¹ä¸å˜ï¼Œå°±ä¼šåº”ç”¨å®¢æˆ·ç«¯çš„ç¼“å­˜ï¼Œå‡å°‘ä¸å¿…è¦çš„ä¼ è¾“ã€‚</li><li>æ‰€ä»¥ETagæ¯”Last-Modifiedç¼“å­˜æ›´ç²¾ç¡®ã€é«˜æ•ˆå’ŒèŠ‚çœå¸¦å®½ã€‚</li></ul><h1>ETag</h1><h2 id="ä»€ä¹ˆæ˜¯ETagï¼Ÿ">ä»€ä¹ˆæ˜¯ETagï¼Ÿ</h2><p>Etagæ˜¯ Entity tagçš„ç¼©å†™ï¼Œå¯ä»¥ç†è§£ä¸ºâ€œè¢«è¯·æ±‚èµ„æºçš„æ‘˜è¦æ ‡è¯†â€ï¼ŒEtagæ˜¯æœåŠ¡ç«¯çš„ä¸€ä¸ªèµ„æºçš„æ ‡è¯†ï¼Œåœ¨ HTTP å“åº”å¤´ä¸­å°†å…¶ä¼ é€åˆ°å®¢æˆ·ç«¯ï¼Œç±»ä¼¼è¿™æ ·ï¼ŒETag:W/â€œ50b1c1d4f775c61:df3â€</p><h2 id="ETagæ ¼å¼">ETagæ ¼å¼</h2><ul><li>ETag:W/â€œxxxxxxxxâ€</li><li>ETag:â€œxxxxxxxâ€</li></ul><h3 id="å¼ºç±»å‹éªŒè¯">å¼ºç±»å‹éªŒè¯</h3><ul><li>æ¯”å¯¹èµ„æºæ¯ä¸ªå­—èŠ‚éƒ½è¦ä¸€æ ·ã€‚</li></ul><h3 id="W-å‰ç¼€ä»£è¡¨ä½¿ç”¨å¼±ç±»å‹éªŒè¯">W/å‰ç¼€ä»£è¡¨ä½¿ç”¨å¼±ç±»å‹éªŒè¯</h3><ul><li>ä¸éœ€è¦æ¯ä¸ªå­—èŠ‚éƒ½ä¸€æ ·ï¼Œä¾‹å¦‚é¡µè„šçš„æ—¶é—´orå±•ç¤ºçš„å¹¿å‘Šä¸ä¸€æ ·ï¼Œéƒ½å¯ä»¥è®¤ä¸ºæ˜¯ä¸€æ ·çš„ã€‚æ„å»ºåº”ç”¨äºå¼±éªŒè¯ç±»å‹çš„æ ‡ç­¾ï¼ˆetagï¼‰ä½“ç³»å¯èƒ½ä¼šæ¯”è¾ƒå¤æ‚ï¼Œå› ä¸ºè¿™ä¼šæ¶‰åŠåˆ°å¯¹é¡µé¢ä¸Šä¸åŒçš„å…ƒç´ çš„é‡è¦æ€§è¿›è¡Œæ’åºï¼Œä½†æ˜¯ä¼šå¯¹ç¼“å­˜æ€§èƒ½ä¼˜åŒ–ç›¸å½“æœ‰å¸®åŠ©ã€‚</li></ul><h2 id="ETagç”Ÿæˆéœ€è¦æ»¡è¶³ä»€ä¹ˆæ¡ä»¶ï¼Ÿ">ETagç”Ÿæˆéœ€è¦æ»¡è¶³ä»€ä¹ˆæ¡ä»¶ï¼Ÿ</h2><ol><li>å½“æ–‡ä»¶æ›´æ”¹æ—¶ï¼ŒETagå€¼å¿…é¡»æ”¹å˜</li><li>å°½é‡ä¾¿äºè®¡ç®—ï¼Œä¸ä¼šç‰¹åˆ«è€—CPUã€‚<ol><li>åˆ©ç”¨æ‘˜è¦ç®—æ³•ç”Ÿæˆï¼ˆMD5, SHA128, SHA256ï¼‰éœ€æ…é‡è€ƒè™‘ï¼Œè¿™äº›ä¸ºCPUå¯†é›†å‹è¿ç®—ã€‚</li></ol></li><li>å¿…é¡»æ¨ªå‘æ‰©å±•ï¼Œåˆ†å¸ƒå¼éƒ¨ç½²æ—¶å¤šä¸ªæœåŠ¡å™¨èŠ‚ç‚¹ä¸Šç”Ÿæˆçš„ETagå€¼ä¿æŒä¸€è‡´ã€‚</li></ol><h2 id="ETagæ˜¯æ€ä¹ˆç”Ÿæˆçš„ï¼ˆNginxï¼‰">ETagæ˜¯æ€ä¹ˆç”Ÿæˆçš„ï¼ˆNginxï¼‰</h2><p><a href="https://github.com/nginx/nginx/blob/6c3838f9ed45f5c2aa6a971a0da3cb6ffe45b61e/src/http/ngx_http_core_module.c#L1582">Nginxçš„æºç </a>ä¸­ETagç”±last_modifiedå’Œcontent_lengthæ‹¼æ¥è€Œæˆ</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">etag-&gt;value.len = ngx_sprintf(etag-&gt;value.data, <span class="string">&quot;\&quot;%xT-%xO\&quot;&quot;</span>,</span><br><span class="line">                                  r-&gt;headers_out.last_modified_time,</span><br><span class="line">                                  r-&gt;headers_out.content_length_n)</span><br><span class="line">                      - etag-&gt;value.data;                                </span><br></pre></td></tr></table></figure><ul><li>ç¿»è¯‘ä¸ºä»¥ä¸‹ä¼ªä»£ç </li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">etag = header.last_modified + <span class="string">&quot;-&quot;</span> + header.content_lenth</span><br></pre></td></tr></table></figure><ul><li>æ€»ç»“ï¼šNginxä¸­ETagç”±å“åº”å¤´çš„Last-Modifiedå’ŒContent-Lengthè¡¨ç¤ºä¸ºåå…­è¿›åˆ¶ç»„åˆè€Œæˆã€‚</li></ul><h3 id="Lodashç½‘ç«™è¯·æ±‚æ£€éªŒ">Lodashç½‘ç«™è¯·æ±‚æ£€éªŒ</h3><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/lodash%E8%AF%B7%E6%B1%82-20210325234424565.png" alt="img"></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> LAST_MODIFIED = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">parseInt</span>(<span class="string">&#x27;5fc4907d&#x27;</span>, <span class="number">16</span>) * <span class="number">1000</span>).toJSON()</span><br><span class="line"><span class="keyword">const</span> CONTENT_LENGTH = <span class="built_in">parseInt</span>(<span class="string">&#x27;f48&#x27;</span>, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(LAST_MODIFIED) <span class="comment">// 2020-11-30T06:26:05.000Z</span></span><br><span class="line"><span class="built_in">console</span>.log(CONTENT_LENGTH) <span class="comment">// 3912</span></span><br></pre></td></tr></table></figure><ul><li>è¾“å‡ºç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C-20210325234424619.png" alt="img"></p><ul><li>æ—¢ç„¶åœ¨nginxä¸­ETagç”±Last-Modifiedå’ŒContent-Lengthç»„æˆï¼Œé‚£å®ƒä¾¿ç®—æ˜¯ä¸€ä¸ªåŠ å¼ºç‰ˆçš„Last-Modifiedäº†ï¼Œé‚£åŠ å¼ºåœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿ</li><li>Last-Modifiedåªèƒ½ä½œç”¨äºç§’çº§çš„æ”¹å˜ï¼Œè€Œ nginx ä¸­çš„ ETag æ·»åŠ äº†æ–‡ä»¶å¤§å°çš„é™„åŠ æ¡ä»¶ï¼Œä¸ä»…å’Œä¿®æ”¹æ—¶é—´æœ‰å…³ï¼Œä¹Ÿå’Œå†…å®¹æœ‰å…³ï¼Œä½¿ä¹‹æ›´åŠ ç²¾ç¡®ã€‚</li></ul><h2 id="Last-Modifiedæ˜¯æ€ä¹ˆç”Ÿæˆçš„">Last-Modifiedæ˜¯æ€ä¹ˆç”Ÿæˆçš„</h2><p>åœ¨linuxä¸­</p><ul><li>mtimeï¼šmodified timeæŒ‡æ–‡ä»¶å†…å®¹æ”¹å˜çš„æ—¶é—´æˆ³</li><li>ctimeï¼šchange timeæŒ‡æ–‡ä»¶å±æ€§æ”¹å˜çš„æ—¶é—´æˆ³ï¼Œå±æ€§åŒ…æ‹¬mtimeã€‚è€Œåœ¨ windows ä¸Šï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯creation time</li><li>è€ŒHTTPæœåŠ¡é€‰æ‹©Last-Modifiedæ—¶ä¸€èˆ¬ä¼šé€‰æ‹©mtimeï¼Œè¡¨ç¤ºæ–‡ä»¶å†…å®¹ä¿®æ”¹çš„æ—¶é—´ï¼Œæ¥å…¼å®¹Windowså’ŒLinuxã€‚</li><li>ä»¥ä¸‹ä¸º<a href="https://github.com/nginx/nginx/blob/4bf4650f2f10f7bbacfe7a33da744f18951d416d/src/http/modules/ngx_http_static_module.c#L217">nginxæºç </a></li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">r-&gt;headers_out.status = NGX_HTTP_OK;     </span><br><span class="line">r-&gt;headers_out.content_length_n = of.size;     </span><br><span class="line">r-&gt;headers_out.last_modified_time = of.mtime;</span><br></pre></td></tr></table></figure><h2 id="å¦‚æœ-http-å“åº”å¤´ä¸­-ETag-å€¼æ”¹å˜äº†ï¼Œæ˜¯å¦æ„å‘³ç€æ–‡ä»¶å†…å®¹ä¸€å®šå·²ç»æ›´æ”¹ï¼Ÿ">å¦‚æœ http å“åº”å¤´ä¸­ ETag å€¼æ”¹å˜äº†ï¼Œæ˜¯å¦æ„å‘³ç€æ–‡ä»¶å†…å®¹ä¸€å®šå·²ç»æ›´æ”¹ï¼Ÿ</h2><ul><li>ä¸ä¸€å®š</li><li>æ–‡ä»¶åœ¨ä¸€ç§’å†…å‘ç”Ÿäº†æ”¹å˜è€Œä¸”æ–‡ä»¶å¤§å°ä¸å˜</li><li>è¿™ç§æƒ…å†µéå¸¸æç«¯ï¼Œæ¦‚ç‡å¾ˆä½</li><li>å› æ­¤åœ¨æ­£å¸¸æƒ…å†µä¸‹å¯ä»¥å®¹å¿ä¸€ä¸ªä¸å¤ªå®Œç¾ä½†æ˜¯é«˜æ•ˆçš„ç®—æ³•ã€‚</li></ul><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;ä¸ºä»€ä¹ˆéœ€è¦ç¼“å­˜&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ç¼“å­˜æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›¸åº”åœºæ™¯ä¸‹å¤ç”¨ä»¥å‰è·å–çš„èµ„æºã€‚&lt;/li&gt;
&lt;li&gt;æ˜¾è‘—æé«˜ç½‘ç«™çš„æ€§èƒ½å’Œå“åº”é€Ÿåº¦&lt;/li&gt;
&lt;li&gt;å‡å°‘ç½‘ç»œæµé‡å’Œç­‰å¾…æ¸²æŸ“æ—¶é—´&lt;/li&gt;
&lt;li&gt;é™ä½æœåŠ¡å™¨å‹åŠ›&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;HTTPç¼“å­˜ç±»å‹&lt;</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://lebronchao.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="HTTP" scheme="https://lebronchao.com/tags/HTTP/"/>
    
    <category term="ç¼“å­˜" scheme="https://lebronchao.com/tags/%E7%BC%93%E5%AD%98/"/>
    
    <category term="è®¡ç®—æœºç½‘ç»œ" scheme="https://lebronchao.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"/>
    
  </entry>
  
  <entry>
    <title>Vueçš„å‰ä¸–ä»Šç”Ÿ</title>
    <link href="https://lebronchao.com/2021/03/11/Vue%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/"/>
    <id>https://lebronchao.com/2021/03/11/Vue%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/</id>
    <published>2021-03-11T02:32:23.000Z</published>
    <updated>2021-03-11T02:32:23.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Vueçš„å‰ä¸–ä»Šç”Ÿ</h1><ul><li>2013 å°¤é›¨æºªä¸ªäººé¡¹ç›®</li><li>2014.2 0.1ç‰ˆæœ¬å‘å¸ƒ</li><li>2015.10  1.0ç‰ˆæœ¬å‘å¸ƒ<ul><li>æ¨¡æ¿è¯­æ³•æ”¹è¿›</li></ul></li><li>2016.9  2.0ç‰ˆæœ¬å‘å¸ƒ<ul><li>è·¨ç«¯</li><li>æ–°çš„æ¸²æŸ“æœºåˆ¶</li></ul></li><li>2019.10 3.0 alphaå‘å¸ƒ<ul><li>æ€§èƒ½</li><li>æ¶æ„</li><li>æŒ‰éœ€å¼•å…¥</li><li>Composition API</li><li>Proxy observer</li><li>AOTä¼˜åŒ–</li></ul></li></ul><h1>Vue 1 å“åº”å¼åŸç†</h1><h2 id="æ„å»ºå“åº”å¼å¯¹è±¡æµç¨‹">æ„å»ºå“åº”å¼å¯¹è±¡æµç¨‹</h2><ul><li>walkå‡½æ•°éå†dataå¯¹è±¡ä¸­çš„å±æ€§ï¼Œè°ƒç”¨defineReactiveå°†å…¶å˜æˆå“åº”å¼å¯¹è±¡<ul><li>å¯¹äºå¯¹è±¡å±æ€§è¿›è¡Œé€’å½’è°ƒç”¨walkï¼Œä»¥ä¿è¯dataæ•´ä¸ªå¯¹è±¡æ ‘ä¸­çš„å±æ€§éƒ½æ˜¯å“åº”å¼å¯¹è±¡ã€‚</li></ul></li><li>defineReactiveä¸­ä½¿ç”¨watchersæ•°ç»„å‚¨å­˜watcherï¼Œä½¿ç”¨Object.definePropertyçš„getå‡½æ•°æ”¶é›†watcherå’Œè¿”å›å€¼ï¼Œsetå‡½æ•°ç”¨æ¥è®¾ç½®å€¼å’Œå¯¹watchersä¸­çš„watcherè¿›è¡Œè§†å›¾æ›´æ–°ã€‚</li></ul><h2 id="Walkå‡½æ•°å®ç°">Walkå‡½æ•°å®ç°</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">walk</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Object</span>.keys(data).foreach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">        defineReactive(data, key, data[key])</span><br><span class="line">        <span class="comment">//å¯¹è±¡é€’å½’è°ƒç”¨walk</span></span><br><span class="line">        walk(data[key])</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="defineReactiveå‡½æ•°å®ç°">defineReactiveå‡½æ•°å®ç°</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">defineReactive</span>(<span class="params">obj, key, value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> oldValue = value;</span><br><span class="line">    <span class="keyword">const</span> watchers = []</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(obj, key, &#123;</span><br><span class="line">        <span class="function"><span class="title">get</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="comment">//æ”¶é›†watcher</span></span><br><span class="line">            watchers.push(currentWatcher)</span><br><span class="line">            <span class="keyword">return</span> oldValue</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="title">set</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(newValue === oldValue) <span class="keyword">return</span>;</span><br><span class="line">            oldValue = newValue;</span><br><span class="line">            watchers.forEach(<span class="function"><span class="params">watcher</span> =&gt;</span> wathcer.update())<span class="comment">//æ›´æ–°è§†å›¾</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="çœ‹äº†è¿™ä¹ˆä¹…Watcheråˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ">çœ‹äº†è¿™ä¹ˆä¹…Watcheråˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><img src= "/img/loading.gif" data-lazy-src="http://bloginfo.lebronchao.com/doc-image/16ab1c1b0537a783" alt=""></p><ul><li>Watcherç”¨äºè·å–æ•°æ®å’Œæ›´æ–°è§†å›¾ï¼Œå¹¶å®ç°vueæŒ‡ä»¤<ul><li>watcherä»dataä¸­getæ•°æ®renderè§†å›¾ï¼ŒåŒæ—¶dataä¸­çš„å“åº”å¼å¯¹è±¡åŠ«æŒå½“å‰watcherå¹¶â€œå‚¨å­˜â€èµ·æ¥</li><li>dataæ›´æ–°æ•°æ®ä¼šè§¦å‘å“åº”å¼å¯¹è±¡çš„setå‡½æ•°ï¼ŒæŠŠgetæ•°æ®æ—¶â€œå‚¨å­˜â€çš„watcherså–å‡ºéå†ï¼Œâ€œé€šçŸ¥â€å…¶æ›´æ–°è§†å›¾ã€‚</li><li>watcherâ€œæ¥åˆ°dataä¸­çš„æ•°æ®æ›´æ–°é€šçŸ¥â€ï¼Œé‡æ–°renderè§†å›¾ã€‚</li><li>è§†å›¾å‘ç”Ÿå˜åŒ–ä¼šè§¦å‘dataçš„ä¸­å“åº”å¼å¯¹è±¡çš„setå‡½æ•°ï¼Œå¾ªç¯å½¢æˆæ•°æ®æµã€‚</li></ul></li><li>ä¾‹ï¼š</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// vmæŒ‡å‘å½“å‰ç»„ä»¶ï¼ŒelæŒ‡å‘å½“å‰domèŠ‚ç‚¹ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºæ ‡ç­¾ç±»å‹ï¼Œç¬¬å››ä¸ªä¸ºå›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment">// currentWatcherä¸ºå…¨å±€å˜é‡æŒ‡é’ˆ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ™®é€šæ¸²æŸ“çš„watcher</span></span><br><span class="line">Watcher(vm, el, <span class="string">&#x27;text&#x27;</span>, <span class="function">() =&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// å°†currentWatcherå¯¹è±¡æŒ‡å‘å½“å‰watcherï¼ˆvdomèŠ‚ç‚¹ï¼‰ä¾›å“åº”å¼å¯¹è±¡çš„getå‡½æ•°è·å–</span></span><br><span class="line">    currentWatcher = <span class="built_in">this</span>;</span><br><span class="line">    <span class="comment">// è¯»å–æ˜¾ç¤ºçš„å†…å®¹</span></span><br><span class="line">    el.textContext = <span class="built_in">eval</span>(<span class="string">&#x27;vm.data.text&#x27;</span>)</span><br><span class="line">    <span class="comment">// è§£ç»‘currentWatcherï¼Œé˜²æ­¢å‘ç”Ÿé”™è¯¯ã€‚</span></span><br><span class="line">    currentWatcher = <span class="literal">null</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¸¦v-ifæŒ‡ä»¤çš„watcher</span></span><br><span class="line">Watcher(vm, el, <span class="string">&#x27;text&#x27;</span>, <span class="function">() =&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// å°†currentWatcherå¯¹è±¡æŒ‡å‘å½“å‰watcherï¼ˆvdomèŠ‚ç‚¹ï¼‰ä¾›å“åº”å¼å¯¹è±¡çš„getå‡½æ•°è·å–</span></span><br><span class="line">    currentWatcher = <span class="built_in">this</span>;</span><br><span class="line">    <span class="comment">// å®ç°v-ifæŒ‡ä»¤ï¼Œé€šè¿‡åˆ¤æ–­å˜é‡å€¼å†³å®šæ˜¯å¦æ˜¾ç¤ºè¯¥å…ƒç´ ,v-showåŸç†ç±»ä¼¼</span></span><br><span class="line">    el.style.display = <span class="built_in">eval</span>(<span class="string">&#x27;Boolean(vm.data.text)&#x27;</span>) ? <span class="string">&#x27;block&#x27;</span> : <span class="string">&#x27;none&#x27;</span></span><br><span class="line">    <span class="comment">// è§£ç»‘currentWatcherï¼Œé˜²æ­¢å‘ç”Ÿé”™è¯¯ã€‚</span></span><br><span class="line">    currentWatcher = <span class="literal">null</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h1>Vue 1 ä¸­å­˜åœ¨çš„å‡ ä¸ªæ˜æ˜¾é—®é¢˜</h1><ol><li>å¯åŠ¨æ—¶æ‹¦æˆªæ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€ï¼Œè¿›è¡Œé€’å½’å“åº”å¼ä»£ç†å½±å“é¦–æ¬¡æ¸²æŸ“é€Ÿåº¦</li><li>å†…å­˜å ç”¨ç‡é«˜ï¼Œä¸€ä¸ªâ€œæŒ‡ä»¤â€ï¼Œâ€œcomputedè®¡ç®—å±æ€§â€ï¼Œâ€œhandlebarè¡¨è¾¾å¼â€ç­‰ç­‰å‡éœ€è¦åˆ›å»ºä¸€ä¸ªwatcherï¼Œwatcheræ•°é‡è¿‡å¤šå¯¼è‡´å†…å­˜å ç”¨ç‡é«˜ã€‚</li><li>æ¨¡æ¿ç»è¿‡ç¼–è¯‘åç›´æ¥æ“ä½œdomï¼Œæ— æ³•è·¨ç«¯ã€‚</li></ol><h1>Vueä¸­çš„ä¼˜åŒ–</h1><ol><li>æ–°çš„æ¸²æŸ“å¼•æ“ - vdom</li><li>Watcherä¾èµ–åŠ›åº¦è°ƒæ•´</li><li>å…¶ä»–<ol><li>APIã€è¯­æ³•ç³–é‡æ–°è®¾è®¡ä¸å®šä¹‰</li><li>ç”Ÿå‘½å‘¨æœŸè°ƒæ•´</li><li>åŒå‘æ•°æ®æµ -&gt; å•å‘æ•°æ®æµ</li><li>æ”¯æŒäº†jsxè¯­æ³•</li><li>ç­‰ç­‰â€¦</li></ol></li></ol><h2 id="æ–°çš„æ¸²æŸ“å¼•æ“-vdom">æ–°çš„æ¸²æŸ“å¼•æ“ - vdom</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//template</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div v-<span class="keyword">if</span>=<span class="string">&quot;text&quot;</span>&gt;</span><br><span class="line">        &#123;&#123;text&#125;&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// vue-loader ç¼–è¯‘åçš„ compile render</span></span><br><span class="line"><span class="comment">// hå‡½æ•°ç”¨äºç”ŸæˆVdomèŠ‚ç‚¹ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå½“å‰ç»„ä»¶ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå±æ€§ï¼Œç¬¬ä¸‰ä¸ªå±æ€§ä¸ºå­èŠ‚ç‚¹</span></span><br><span class="line"><span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="built_in">this</span>.text</span><br><span class="line">     ? h(</span><br><span class="line">         <span class="string">&#x27;div&#x27;</span>,</span><br><span class="line">         <span class="literal">null</span>,</span><br><span class="line">         h(<span class="built_in">this</span>.text, <span class="literal">null</span>,[])</span><br><span class="line">     )</span><br><span class="line">     : vm.createEmptyVNode()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Watcherä¾èµ–åŠ›åº¦è°ƒæ•´">Watcherä¾èµ–åŠ›åº¦è°ƒæ•´</h2><p>watcherä¸å†ä¸å•ä¸ªdomèŠ‚ç‚¹ã€æŒ‡ä»¤å…³è”ï¼Œä¸€ä¸ªcomponentå¯¹åº”ä¸€ä¸ªwatcherï¼Œæå¤§å‡å°‘äº†vue 1 ä¸­watcheræ•°é‡è¿‡å¤šå¯¼è‡´çš„å†…å­˜é—®é¢˜ã€‚åŒæ—¶ä»¥æ¥vdom diffåœ¨æ¸²æŸ“æ—¶èƒ½ä»¥æœ€å°çš„ä»£ä»·æ¥æ›´æ–°domã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Watch(compoent, vm, <span class="string">&#x27;text&#x27;</span>, <span class="function">() =&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> newVnode = component.render()</span><br><span class="line">    <span class="keyword">const</span> oldVnode = component.render()</span><br><span class="line">    <span class="comment">//é€šè¿‡diffç®—æ³•è¿”å›æ–°æ—§èŠ‚ç‚¹çš„å·®å¼‚</span></span><br><span class="line">    <span class="keyword">const</span> patches = vm.diff(newVnode, oldVnode)</span><br><span class="line">    <span class="comment">// é€šè¿‡patchå‡½æ•°å¯¹è¯¥ç»„ä»¶åº”ç”¨å·®å¼‚</span></span><br><span class="line">    vm.patch(component, patches);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="vdomå¸¦æ¥çš„ä¼˜åŠ¿">vdomå¸¦æ¥çš„ä¼˜åŠ¿</h2><ol><li>æ¡†æ¶å±è”½å…·ä½“æ¸²æŸ“ç»†èŠ‚ï¼ŒæŠ½è±¡äº†æ¸²æŸ“å±‚ï¼Œç»„å»ºçš„æŠ½è±¡èƒ½åŠ›å¾—ä»¥æå‡ï¼Œä¸å†ä¾èµ–æµè§ˆå™¨è¿è¡Œï¼Œè¿›è€Œå¯ä»¥è·¨æ®µï¼Œå¦‚SSRã€åŒæ„æ¸²æŸ“ä¸€å§å°ç¨‹åºã€weexã€uni-appç­‰æ¡†æ¶ã€‚</li><li>é€šè¿‡é™æ€åˆ†æè¿›è¡Œæ›´å¤šçš„AOTï¼ˆAhead Of Timeï¼‰ç¼–è¯‘ä¼˜åŒ–ã€‚</li><li>é™„åŠ èƒ½åŠ›ï¼šå¤§é‡ç»„ä»¶æ›´æ–°æ—¶ä»¥æœ€å°çš„ä»£ä»·å»æ›´æ–°domã€‚</li><li>vdomå¯¹æ¯”ç›´æ¥æ“ä½œdomè¦æ…¢ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹æ•ˆç‡æ¯”vue 1 å·®ï¼Œè™½ç„¶ç‰ºç‰²äº†ä¸€ç‚¹æ€§èƒ½ï¼Œä½†æ˜¯ä½¿å¾—vueè·å¾—æ›´å¤šç‰¹æ€§åŠä¼˜åŒ–ç©ºé—´ã€‚</li></ol><h2 id="AOTç¼–è¯‘ä¼˜åŒ–">AOTç¼–è¯‘ä¼˜åŒ–</h2><h3 id="Cache-static-element">Cache static element</h3><ul><li>ç¼“å­˜é™æ€èŠ‚ç‚¹ã€å±æ€§ï¼Œé¿å…é‡å¤åˆ›å»º</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç¼–è¯‘å‰</span></span><br><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;foo&quot;</span>&gt;</span><br><span class="line">        Static</span><br><span class="line">    &lt;/span&gt;</span><br><span class="line">    &lt;span&gt;</span><br><span class="line">        &#123;&#123;dynmic&#125;&#125;</span><br><span class="line">    &lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¼–è¯‘å</span></span><br><span class="line"><span class="keyword">const</span> __static1=h(<span class="string">&#x27;span&#x27;</span>,&#123;</span><br><span class="line">    class:&#x27;foo&#x27;</span><br><span class="line">&#125;, <span class="string">&#x27;static&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> h(<span class="string">&#x27;div&#x27;</span>, [</span><br><span class="line">        __static1,</span><br><span class="line">        h(<span class="string">&#x27;span&#x27;</span>, <span class="built_in">this</span>.dynamic)</span><br><span class="line">    ])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Component-fast-path">Component fast path</h3><ul><li>ç¼–è¯‘å ç›´æ¥åˆ¤æ–­æ˜¯ç»„ä»¶ã€åŸç”Ÿæ ‡ç­¾è¿˜æ˜¯æ–‡æœ¬èŠ‚ç‚¹ï¼Œé¿å…ä¸å¿…è¦çš„åˆ†æ”¯åˆ¤æ–­ï¼Œæå‡æ€§èƒ½ã€‚</li><li>æé«˜vdom diffæ—¶çš„æ•ˆç‡</li></ul><h4 id="Vue2ä¼˜åŒ–å‰">Vue2ä¼˜åŒ–å‰</h4><ul><li>æ¯æ¬¡éƒ½è¦è°ƒç”¨hå‡½æ•°å»åšåˆ†æ”¯åˆ¤æ–­</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç¼–è¯‘å‰</span></span><br><span class="line">&lt;Comp&gt;&lt;/Comp&gt;</span><br><span class="line">&lt;div&gt;&lt;/div&gt;</span><br><span class="line">&lt;span&gt;&lt;/span&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Vue2</span></span><br><span class="line"><span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> createFragment([</span><br><span class="line">        h(Comp, <span class="literal">null</span>, <span class="literal">null</span>),</span><br><span class="line">        h(<span class="string">&#x27;div&#x27;</span>, <span class="literal">null</span>, [</span><br><span class="line">            h(<span class="string">&#x27;span&#x27;</span>, <span class="literal">null</span>, <span class="literal">null</span>)</span><br><span class="line">        ])</span><br><span class="line">    ])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">h</span>(<span class="params">type, attrs, children</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(isComponent(type))&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºcomponent vnode</span></span><br><span class="line">        <span class="keyword">return</span> createComponentVNode(type, attrs, children)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(isDomElement(type))&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºåŸç”Ÿdom vnode</span></span><br><span class="line">        <span class="keyword">return</span> createElementVNode(type, attrs, children)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ›å»ºçº¯stringèŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">return</span> createStringVNode(type, attrs, children)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Vue3ä¼˜åŒ–å">Vue3ä¼˜åŒ–å</h4><ul><li>ç¼–è¯‘åç›´æ¥è°ƒç”¨ä¸åŒçš„createVNodeæ–¹æ³•</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vue3</span></span><br><span class="line"><span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> createFragment([</span><br><span class="line">        createComponentVNode(Comp, <span class="literal">null</span>, <span class="literal">null</span>),</span><br><span class="line">        createElmentVNode(<span class="string">&#x27;div&#x27;</span>,<span class="literal">null</span>, [</span><br><span class="line">           createElmentVNode(<span class="string">&#x27;span&#x27;</span>, <span class="literal">null</span>, <span class="literal">null</span>)</span><br><span class="line">        ])</span><br><span class="line">    ])</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h3 id="SSR-optimize">SSR optimize</h3><ul><li>SSRæ—¶é‡‡ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œä¸åˆ›å»ºvnodeã€‚</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç¼–è¯‘å‰</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;p <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;foo&quot;</span>&gt;</span><br><span class="line">            &#123;&#123;msg&#125;&#125;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;comp/</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¼–è¯‘å</span></span><br><span class="line"><span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> h(<span class="string">&#x27;div&#x27;</span>, [</span><br><span class="line">        <span class="built_in">this</span>.ssrString(</span><br><span class="line">            <span class="string">`&lt;p class=&quot;foo&quot;&gt;`</span></span><br><span class="line">            + <span class="built_in">this</span>.msg</span><br><span class="line">            + <span class="string">&#x27;&lt;/p&gt;&#x27;</span></span><br><span class="line">        ),</span><br><span class="line">        h(comp)</span><br><span class="line">    ])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Inline-handler">Inline handler</h3><ul><li>ç¼“å­˜domä¸Šçš„event handlerï¼Œé¿å…é‡å¤åˆ›å»ºã€‚</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç¼–è¯‘å‰</span></span><br><span class="line">&lt;div @click=<span class="string">&quot;count++&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¼–è¯‘å</span></span><br><span class="line"><span class="keyword">import</span> &#123;getBoundMethod&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__fn1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.count++</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> h(<span class="string">&#x27;div&#x27;</span>,&#123;</span><br><span class="line">        onClick:getBoundMethod(__fn1,<span class="built_in">this</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>Vue3å˜æ›´</h1><h2 id="Proxy-Reactive-State">Proxy Reactive State</h2><ul><li>Vue3æ”¹ç”¨Proxyå»ç”Ÿæˆå“åº”å¼å¯¹è±¡</li><li>Vue1/2ä¸­éå†å’Œé€’å½’æ‰€æœ‰dataä¸­çš„å±æ€§å»ç”Ÿæˆå“åº”å¼å¯¹è±¡</li><li>Vue3ä¸­æ”¹ä¸ºä»…åœ¨getè·å–è¿™ä¸ªå±æ€§çš„æ—¶å€™æ‰å»ç”Ÿæˆå“åº”å¼å¯¹è±¡ï¼Œå»¶è¿Ÿäº†å“åº”å¼å¯¹è±¡ç”Ÿæˆï¼ŒåŠ å¿«äº†é¦–å±æ¸²æŸ“é€Ÿåº¦ã€‚</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vue1/2ä¸­çš„åšæ³•</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">walk</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.keys(data).foreach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">        defineReactive(data, key, data[key])</span><br><span class="line">        <span class="comment">//å¯¹è±¡é€’å½’è°ƒç”¨walk</span></span><br><span class="line">        walk(data[key])</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Vue3ä¸­çš„åšæ³•</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reactive</span>(<span class="params">target</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> observerd = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, &#123;</span><br><span class="line">        <span class="function"><span class="title">get</span>(<span class="params">target, key, receiver</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">let</span> result = <span class="built_in">Reflect</span>.get(target, key, receiver)</span><br><span class="line">             <span class="comment">//åªæœ‰åœ¨å–å¯¹è±¡å­å±æ€§çš„æ—¶å€™æ‰é€’å½’</span></span><br><span class="line">            reactive(result)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">set</span>(<span class="params">target, key, value, receiver</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> oldValue = target[key]</span><br><span class="line">            <span class="keyword">if</span> (value == oldValue)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">let</span> result = <span class="built_in">Reflect</span>.set(target, key, value, receiver)</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> observerd</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Composition-API">Composition API</h2><ul><li>Vue2ä¸­ï¼Œä»£ç æ ¹æ®æ•°æ®ã€æ–¹æ³•ã€è®¡ç®—å±æ€§ç­‰è¿›è¡Œåˆ†å—ï¼Œå¯¼è‡´å¯èƒ½åŒä¸€ä¸ªä¸šåŠ¡åŠŸèƒ½çš„ä»£ç éœ€è¦åå¤ä¸Šä¸‹åœ°è·³ç€å»çœ‹ã€‚<ul><li>è™½ç„¶æœ‰Mixinï¼Œä½†ä¸šåŠ¡å’Œä¸šåŠ¡ä¹‹é—´çš„å…³ç³»ï¼ŒåŒ…æ‹¬å‘½åç©ºé—´éƒ½ä¼šå‡ºç°ä¸€å®šé—®é¢˜ã€‚</li></ul></li><li>Vue3ä¸­å¼•å…¥Composition APIä½¿å¾—å¼€å‘è€…å¯ä»¥æ ¹æ®ä¸šåŠ¡å°†ä»£ç åˆ†å—ï¼ŒæŒ‰éœ€å¼•å…¥å“åº”å¼å¯¹è±¡ã€watchã€ç”Ÿå‘½å‘¨æœŸé’©å­ç­‰å„ç§å±æ€§ï¼Œä½¿ç”¨æ–¹æ³•ç±»ä¼¼React Hooksï¼Œä½¿å¾—å¼€å‘è€…æ›´çµæ´»åœ°å¼€å‘ã€‚<ul><li>è¯¦æƒ…è§<a href="https://vue3js.cn/docs/zh/">Vue3ä¸­æ–‡æ–‡æ¡£ - vuejs (vue3js.cn)</a></li></ul></li></ul><h3 id="Vue2">Vue2</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;   </span><br><span class="line">    <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;     </span><br><span class="line">        <span class="keyword">return</span> &#123;       </span><br><span class="line">            counter: <span class="number">0</span>     </span><br><span class="line">        &#125;   </span><br><span class="line">   &#125;,   </span><br><span class="line">   watch: &#123;     </span><br><span class="line">       <span class="function"><span class="title">counter</span>(<span class="params">newValue, oldValue</span>)</span> &#123;       </span><br><span class="line">           <span class="built_in">console</span>.log(<span class="string">&#x27;The new counter value is: &#x27;</span> + <span class="built_in">this</span>.counter)     </span><br><span class="line">       &#125;   </span><br><span class="line">   &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Vue3">Vue3</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, watch &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> counter = ref(<span class="number">0</span>) </span><br><span class="line">watch(counter, <span class="function">(<span class="params">newValue, oldValue</span>) =&gt;</span> &#123;   </span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;The new counter value is: &#x27;</span> + counter.value) </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="Why-use-Composition-API">Why use Composition API</h3><ul><li>mixinã€hocã€composition apiéƒ½æ˜¯ä¸ºäº†è§£å†³ä»£ç å¤ç”¨çš„é—®é¢˜ã€‚ä½†æ˜¯mixinã€hocè¿‡äºçµæ´»æ²¡æœ‰è§„èŒƒï¼Œå¯¼è‡´å¼€å‘äººå‘˜å®¹æ˜“å†™å‡ºé›¶æ•£ã€éš¾ä»¥ç»´æŠ¤çš„é€»è¾‘ã€‚</li><li>Compostion APIè§„é¿äº†mixinã€hocå­˜åœ¨çš„ç¼ºé™·ï¼Œæä¾›å›ºå®šçš„ç¼–ç¨‹æ¨¡å¼-&gt;å‡½æ•°ç»„åˆï¼Œå¯¹å„æ¨¡å—è§£è€¦ä½¿å¾—æ›´ä¼˜é›…ã€æ›´å®¹æ˜“åœ°å»ç»„åˆå¤ç”¨ã€‚</li><li>ä»¥ç»„ä»¶çŠ¶æ€ä¸ºä¾‹ï¼Œä¼ ç»Ÿå†™æ³•æ‰€æœ‰stateéƒ½åœ¨ä¸€ä¸ªcomponentï¼Œæ‚ç³…åœ¨ä¸€èµ·ï¼Œè¯­ä¹‰åŒ–ä¸å¼ºï¼Œcompostion apiä½¿å¾—stateæŒ‰ç…§ä¸åŒçš„é€»è¾‘åˆ†ç¦»å‡ºæ¥ï¼ŒæŠ½è±¡å‡ºçŠ¶æ€å±‚ç»„ä»¶ã€‚</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Foo = &#123;</span><br><span class="line">    template:<span class="string">&#x27;#modal&#x27;</span>,</span><br><span class="line">    mixins:[Mixin1, Mixin2],</span><br><span class="line">    methods:&#123;</span><br><span class="line">        <span class="function"><span class="title">click</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.sendLog()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    components:&#123;</span><br><span class="line">        appChild:Child</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>çœ‹å®Œä»¥ä¸Šä»£ç ä¼šå‘ç°ä»¥ä¸‹é—®é¢˜<ul><li>sendLogåˆ°åº•æ¥è‡ªå“ªä¸ªMixin</li><li>mixin1ï¼Œmixin2ä¹‹é—´æœ‰æ²¡æœ‰é€»è¾‘å…³ç³»</li><li>mixin1ï¼Œmixin2å¦‚æœéƒ½æ³¨å…¥äº†sendLogä½¿ç”¨å“ªä¸ª</li><li>å¦‚æœä½¿ç”¨hocçš„æ–¹å¼ï¼Œhocå¢åŠ äº†ä¸¤ä¸ªç»„ä»¶å®ä¾‹æ¶ˆè€—ï¼Œå¤šäº†ä¸¤æ¬¡diffã€‚</li><li>å†æ¥å¤šå‡ ä¸ªmixinï¼Œè¿™ä¸ªç»„ä»¶æ›´éš¾ç»´æŠ¤ã€‚</li></ul></li><li>æ˜æ˜¾åœ°ä½“ç°äº†Composition APIçš„å¥½å¤„</li></ul><h2 id="Time-Slicing">Time Slicing</h2><ul><li>Vue3æœ€å¼€å§‹å®ç°äº†è¿™ä¸ªç‰¹æ€§ï¼Œä¸è¿‡åé¢ç§»é™¤äº†</li><li>åŸå› æ€»ç»“ä¸ºä»¥ä¸‹ä¸¤æ¡<ul><li>åŸºäºå“åº”å¼åŸç†åŠAOTç¼–è¯‘ä¼˜åŒ–ï¼Œç›¸æ¯”reactè€Œè¨€vue vdom diffå…·æœ‰å¾ˆé«˜çš„æ•ˆç‡</li><li>Time Slicingåªåœ¨ä¸€äº›æç«¯æƒ…å†µä¸‹æœ‰æ˜æ˜¾ä½œç”¨ï¼Œå¼•å…¥ä¼šé™ä½vdom diffæ•ˆç‡ï¼Œé˜»å¡UIæ¸²æŸ“ï¼Œæ”¶ç›Šä¸å¤§ã€‚</li></ul></li></ul><h2 id="æŒ‰éœ€å¼•å…¥ã€æ”¯æŒtreeshaking">æŒ‰éœ€å¼•å…¥ã€æ”¯æŒtreeshaking</h2><ul><li>Vueå„æ¨¡å—ï¼ˆå“åº”å¼ã€SSRã€runtimeç­‰ï¼‰çš„è§£è€¦ï¼Œå¯æŒ‰éœ€å¼•å…¥ã€‚</li></ul><h1>Vue vs React</h1><h2 id="ç›¸åŒç‚¹">ç›¸åŒç‚¹</h2><ol><li>åŸºäºMVVMæ€æƒ³ï¼šå“åº”å¼æ•°æ®é©±åŠ¨è¯•å›¾æ›´æ–°</li><li>æä¾›ç»„ä»¶åŒ–çš„è§£å†³æ–¹æ¡ˆ</li><li>è·¨ç«¯ï¼šåŸºäºvdomçš„æ¸²æŸ“å¼•æ“</li></ol><h2 id="æ ¸å¿ƒå·®å¼‚">æ ¸å¿ƒå·®å¼‚</h2><ol><li>å®šä½<ol><li>Reactæ˜¯ä¸€ä¸ªLibraryï¼Œåªä¸“æ³¨äºstateåˆ°viewçš„æ˜ å°„ï¼ŒçŠ¶æ€ã€è·¯ç”±ã€åŠ¨ç”»ç­‰è§£å†³æ–¹æ¡ˆå‡æ¥è‡ªäºç¤¾åŒºã€‚</li><li>Vueæ˜¯ä¸€ä¸ªæ¸è¿›å¼Frameworkï¼Œè®¾è®¡ä¹‹åˆè€ƒè™‘å¼€å‘è€…å¯èƒ½é¢ä¸´çš„é—®é¢˜ï¼Œå®˜æ–¹æä¾›è·¯ç”±ã€çŠ¶æ€ç®¡ç†ã€åŠ¨ç”»ã€æ’ä»¶ç­‰æ¯”è¾ƒé½å…¨çš„è§£å†³æ–¹æ¡ˆï¼Œä¸å¼ºåˆ¶ä½¿ç”¨ï¼Œè­¬å¦‚æ¨¡å—æœºåˆ¶ã€ä¾èµ–æ³¨å…¥ï¼Œå¯ä»¥é€šè¿‡æ’ä»¶æœºåˆ¶å¾ˆå¥½å’Œç¤¾åŒºæ–¹æ¡ˆé›†æˆã€‚</li><li>Libraryï¼ŒèŒè´£èŒƒå›´å°ï¼Œå¼€å‘æ•ˆç‡ä½ï¼Œéœ€å€ŸåŠ©å¤–åŠ›ï¼Œä½†æ˜¯æ˜“äºæ‰©å±•ã€‚å¯¹ç»´æŠ¤å›¢é˜Ÿè€Œè¨€ï¼Œä¿æŒç‰ˆæœ¬é—´å…¼å®¹æˆæœ¬è¾ƒä½ã€‚æ›´å®¹æ˜“é›†ä¸­ç²¾åŠ›ä¸“æ³¨äºæ ¸å¿ƒå˜æ›´ã€‚</li><li>Frameworkï¼ŒèŒè´£èŒƒå›´å¤§ï¼Œå¼€å‘æ•ˆç‡é«˜ï¼Œå†…ç½®ä¸€å¥—è§£å†³æ–¹æ¡ˆï¼Œæ‰©å±•ç¨‹åº¦ä½ã€‚å¯¹ç»´æŠ¤å›¢é˜Ÿè€Œè¨€ï¼Œä¿æŒç‰ˆæœ¬é—´å…¼å®¹æˆæœ¬è¾ƒé«˜ã€‚</li></ol></li><li>æ¸²æŸ“å¼•æ“<ol><li>Vueè¿›è¡Œæ•°æ®æ‹¦æˆª/ä»£ç†ï¼Œå®ƒå¯¹ä¾¦æµ‹æ•°æ®çš„å˜åŒ–æ›´å‡†ç¡®ï¼Œæ”¹å˜äº†å¤šå°‘æ•°æ®ï¼Œå°±è§¦å‘å¤šå°‘æ›´æ–°å¤šå°‘ã€‚</li><li>React setStateè§¦å‘å±€éƒ¨æ•´ä½“åˆ·æ–°ï¼Œæ²¡æœ‰è¿½è¸ªæ•°æ®å˜æ›´ï¼Œåšåˆ°ç²¾ç¡®æ›´æ–°ï¼Œæ‰€ä»¥æä¾›ç»™å¼€å‘è€…shouldComponentUpdateå»é™¤ä¸€äº›ä¸å¿…è¦çš„æ›´æ–°ã€‚</li><li>åŸºäºè¿™ä¸ªå“åº”å¼è®¾è®¡ï¼Œé—´æ¥å½±å“äº†æ ¸å¿ƒæ¶æ„çš„Composition APIã€React Hooksçš„å®ç°ã€‚</li></ol></li><li>æ¨¡æ¿DSL<ol><li>Vue templateè¯­æ³•æ›´æ¥è¿‘htmlï¼Œé™æ€è¡¨è¾¾èƒ½åŠ›å¾ˆå¼ºï¼ŒåŸºäºå£°æ˜å¼çš„èƒ½åŠ›ï¼Œæ›´æ–¹ä¾¿åšAOTç¼–è¯‘ä¼˜åŒ–ã€‚</li><li>JSXè¯­æ³•å¯ä»¥è®¤ä¸ºæ˜¯JSåŸºç¡€ä¸Šåˆå¢åŠ äº†å¯¹htmlçš„æ”¯æŒï¼Œæœ¬è´¨è¿˜æ˜¯å‘½ä»¤å¼å˜æˆã€‚é™æ€è¡¨è¾¾èƒ½åŠ›åå¼±ï¼Œå¯¼è‡´ä¼˜åŒ–ä¿¡æ¯ä¸è¶³ï¼Œæ— æ³•å¾ˆå¥½åœ°åšé™æ€ç¼–è¯‘ã€‚</li></ol></li></ol><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Vueçš„å‰ä¸–ä»Šç”Ÿ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;2013 å°¤é›¨æºªä¸ªäººé¡¹ç›®&lt;/li&gt;
&lt;li&gt;2014.2 0.1ç‰ˆæœ¬å‘å¸ƒ&lt;/li&gt;
&lt;li&gt;2015.10  1.0ç‰ˆæœ¬å‘å¸ƒ
&lt;ul&gt;
&lt;li&gt;æ¨¡æ¿è¯­æ³•æ”¹è¿›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;2016.9  2.0ç‰ˆæœ¬</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://lebronchao.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="Front End" scheme="https://lebronchao.com/tags/Front-End/"/>
    
    <category term="Vue" scheme="https://lebronchao.com/tags/Vue/"/>
    
    <category term="åº•å±‚åŸç†" scheme="https://lebronchao.com/tags/%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>æµ…æå‰ç«¯è·¯ç”±Router</title>
    <link href="https://lebronchao.com/2021/02/15/%E6%B5%85%E6%9E%90%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1Router/"/>
    <id>https://lebronchao.com/2021/02/15/%E6%B5%85%E6%9E%90%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1Router/</id>
    <published>2021-02-15T02:16:34.000Z</published>
    <updated>2021-02-15T07:42:34.000Z</updated>
    
    <content type="html"><![CDATA[<h1>å‰ç«¯è·¯ç”±ä»‹ç»</h1><h2 id="ä»€ä¹ˆå‰ç«¯è·¯ç”±">ä»€ä¹ˆå‰ç«¯è·¯ç”±</h2><p>è·¯ç”±è¿™ä¸ªæ¦‚å¿µæœ€æ—©å‡ºç°åœ¨åç«¯ï¼Œé€šè¿‡â½¤æˆ·è¯·æ±‚çš„urlå¯¼èˆªåˆ°å…·ä½“çš„htmlâ»šâ¾¯ã€‚ç°åœ¨çš„å‰ç«¯è·¯ç”±ä¸åŒ</p><p>äºä¼ ç»Ÿè·¯ç”±ï¼Œå®ƒä¸éœ€è¦æœåŠ¡å™¨è§£æï¼Œâ½½æ˜¯å¯ä»¥é€šè¿‡hashå‡½æ•°æˆ–è€…history APIæ¥å®ç°ã€‚åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæˆ‘</p><p>ä»¬å¯ä»¥ä½¿â½¤è·¯ç”±è®¾ç½®è®¿é—®è·¯å¾„ï¼Œå¹¶æ ¹æ®è·¯å¾„ä¸ç»„ä»¶çš„æ˜ å°„å…³ç³»åˆ‡æ¢ç»„ä»¶çš„æ˜¾ç¤ºï¼Œâ½½è¿™æ•´ä¸ªè¿‡ç¨‹éƒ½æ˜¯åœ¨åŒ</p><p>â¼€ä¸ªâ»šâ¾¯ä¸­å®ç°çš„ï¼Œä¸æ¶‰åŠâ»šâ¾¯é—´çš„è·³è½¬ï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„å•â»šåº”â½¤ï¼ˆspaï¼‰ã€‚</p><h2 id="å‰ç«¯è·¯ç”±å¸¦æ¥äº†ä»€ä¹ˆ">å‰ç«¯è·¯ç”±å¸¦æ¥äº†ä»€ä¹ˆ</h2><h3 id="ç›¸â½å¤šâ»šåº”â½¤-mpa-æ¥è¯´ï¼Œspaæœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š">ç›¸â½å¤šâ»šåº”â½¤(mpa)æ¥è¯´ï¼Œspaæœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</h3><ul><li>ä¸æ¶‰åŠhtmlâ»šâ¾¯è·³è½¬ï¼Œå†…å®¹æ”¹å˜ä¸éœ€è¦é‡æ–°åŠ è½½â»šâ¾¯ï¼Œå¯¹æœåŠ¡å™¨å‹â¼’â¼©ã€‚</li><li>åªæ¶‰åŠç»„ä»¶ä¹‹é—´çš„åˆ‡æ¢ï¼Œå› æ­¤è·³è½¬æµç•…ï¼Œâ½¤æˆ·ä½“éªŒå¥½ã€‚</li><li>â»šâ¾¯æ•ˆæœä¼šâ½è¾ƒç‚«é…·ï¼ˆâ½å¦‚åˆ‡æ¢â»šâ¾¯å†…å®¹æ—¶çš„è½¬åœºåŠ¨ç”»ï¼‰ã€‚</li><li>ç»„ä»¶åŒ–å¼€å‘ä¾¿æ·ã€‚</li></ul><h3 id="ä½†æ˜¯åŒæ—¶spaä¹Ÿæœ‰ä»¥ä¸‹ç¼ºç‚¹ï¼š">ä½†æ˜¯åŒæ—¶spaä¹Ÿæœ‰ä»¥ä¸‹ç¼ºç‚¹ï¼š</h3><ul><li>â¾¸å±åŠ è½½è¿‡æ…¢ã€‚</li><li>ä¸åˆ©äºseoã€‚</li><li>â»šâ¾¯å¤æ‚åº¦æâ¾¼å¾ˆå¤šã€‚</li></ul><h1>â½¤åŸâ½£ <strong>js</strong> å®ç°å‰ç«¯è·¯ç”±</h1><h2 id="ä»€ä¹ˆå‰ç«¯è·¯ç”±-2">ä»€ä¹ˆå‰ç«¯è·¯ç”±</h2><p>è·¯ç”±è¿™ä¸ªæ¦‚å¿µæœ€æ—©å‡ºç°åœ¨åç«¯ï¼Œé€šè¿‡â½¤æˆ·è¯·æ±‚çš„ url å¯¼èˆªåˆ°å…·ä½“çš„ html â»šâ¾¯ã€‚ç°åœ¨çš„å‰ç«¯è·¯ç”±ä¸åŒäº</p><p>ä¼ ç»Ÿè·¯ç”±ï¼Œå®ƒä¸éœ€è¦æœåŠ¡å™¨è§£æï¼Œâ½½æ˜¯å¯ä»¥é€šè¿‡ hash å‡½æ•°æˆ–è€… h5 history API æ¥å®ç°ã€‚åœ¨å‰ç«¯å¼€å‘</p><p>ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿â½¤è·¯ç”±è®¾ç½®è®¿é—®è·¯å¾„ï¼Œå¹¶æ ¹æ®è·¯å¾„ä¸ç»„ä»¶çš„æ˜ å°„å…³ç³»åˆ‡æ¢ç»„ä»¶çš„æ˜¾ç¤ºï¼Œâ½½è¿™æ•´ä¸ªè¿‡ç¨‹éƒ½</p><p>æ˜¯åœ¨åŒâ¼€ä¸ªâ»šâ¾¯ä¸­å®ç°çš„ï¼Œä¸æ¶‰åŠâ»šâ¾¯é—´çš„è·³è½¬ï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„å•â»šåº”â½¤ï¼ˆspaï¼‰ã€‚</p><h2 id="åŸâ½£-js-å®ç°å‰ç«¯è·¯ç”±">åŸâ½£ <strong>js</strong> å®ç°å‰ç«¯è·¯ç”±</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>lesson2<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#/home&quot;</span>&gt;</span>é¦–é¡µ<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#/user&quot;</span>&gt;</span>ç”¨æˆ·ä¸­å¿ƒ<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#/login&quot;</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;view&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> view = <span class="literal">null</span>;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.addEventListener(<span class="string">&quot;DOMContentLoaded&quot;</span>, onLoad);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="comment">// ç›‘å¬hashå˜åŒ–</span></span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.addEventListener(<span class="string">&quot;hashchange&quot;</span>, onHashChange);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">onLoad</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      view = <span class="built_in">document</span>.getElementById(<span class="string">&quot;view&quot;</span>);</span></span><br><span class="line">      onHashChange();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">onHashChange</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">switch</span> (location.hash) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">case</span> <span class="string">&quot;#/home&quot;</span>:</span></span><br><span class="line"><span class="javascript">          view.innerHTML = <span class="string">&quot;é¦–é¡µ&quot;</span>;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">break</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">case</span> <span class="string">&quot;#/user&quot;</span>:</span></span><br><span class="line"><span class="javascript">          view.innerHTML = <span class="string">&quot;ç”¨æˆ·ä¸­å¿ƒ&quot;</span>;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">break</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">case</span> <span class="string">&quot;#/login&quot;</span>:</span></span><br><span class="line"><span class="javascript">          view.innerHTML = <span class="string">&quot;ç™»å½•&quot;</span>;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">break</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>ç¯å¢ƒé…ç½®ä¸ react-router ç®€ä»‹</h1><h2 id="èµ„æº">èµ„æº</h2><ol><li><a href="https://react.docschina.org/">React å®˜ç½‘</a></li><li><a href="http://react-router.docschina.org/">react-router</a></li></ol><h2 id="ç›®æ ‡">ç›®æ ‡</h2><ol><li>æŒæ¡ cra ç¯å¢ƒ</li><li>æŒæ¡ react-router çš„åŸºæœ¬ä½¿ç”¨</li></ol><h2 id="çŸ¥è¯†ç‚¹">çŸ¥è¯†ç‚¹</h2><h3 id="å¿«é€Ÿå¼€å§‹">å¿«é€Ÿå¼€å§‹</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npx create-react-app router-nut</span><br><span class="line"><span class="built_in">cd</span> router-nut</span><br><span class="line">yarn start</span><br></pre></td></tr></table></figure><h3 id="é…ç½®-less-ä¸è£…é¥°å™¨">é…ç½® less ä¸è£…é¥°å™¨</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add @craco/craco craco-less @babel/plugin-proposal-decorators</span><br></pre></td></tr></table></figure><p>æ ¹ç›®å½•ä¸‹æ·»åŠ  craco.config.js æ–‡ä»¶</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// * é…ç½®å®Œæˆåè®°å¾—é‡å¯ä¸‹</span></span><br><span class="line"><span class="keyword">const</span> CracoLessPlugin = <span class="built_in">require</span>(<span class="string">&quot;craco-less&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  babel: &#123;</span><br><span class="line">    <span class="comment">//ç”¨æ¥æ”¯æŒè£…é¥°å™¨</span></span><br><span class="line">    plugins: [[<span class="string">&quot;@babel/plugin-proposal-decorators&quot;</span>, &#123;<span class="attr">legacy</span>: <span class="literal">true</span>&#125;]]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    &#123;</span><br><span class="line">      plugin: CracoLessPlugin</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ package.json</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">   &quot;start&quot;: &quot;craco start&quot;,</span><br><span class="line">   &quot;build&quot;: &quot;craco build&quot;,</span><br><span class="line">   &quot;test&quot;: &quot;craco test&quot;</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure><h3 id="react-router-ç®€ä»‹">react-router ç®€ä»‹</h3><p>react-router åŒ…å« 3 ä¸ªåº“ï¼Œreact-routerã€react-router-dom å’Œ react-router-nativeã€‚react-router æä¾›æœ€åŸºæœ¬çš„è·¯ç”±åŠŸèƒ½ï¼Œå®é™…ä½¿ç”¨çš„æ—¶å€™æˆ‘ä»¬ä¸ä¼šç›´æ¥å®‰è£… react-routerï¼Œè€Œæ˜¯æ ¹æ®åº”ç”¨è¿è¡Œçš„ç¯å¢ƒé€‰æ‹©å®‰è£… react-router-domï¼ˆåœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ï¼‰æˆ– react-router-nativeï¼ˆåœ¨ rn ä¸­ä½¿ç”¨ï¼‰ã€‚react-router-dom å’Œ react-router-native éƒ½ä¾èµ– react-routerï¼Œæ‰€ä»¥åœ¨å®‰è£…æ—¶ï¼Œreact-router ä¹Ÿä¼šè‡ªåŠ¨å®‰è£…ï¼Œåˆ›å»º web åº”ç”¨ã€‚</p><h4 id="å®‰è£…">å®‰è£…</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add react-router-dom</span><br></pre></td></tr></table></figure><h4 id="BrowserRouter-ä¸-HashRouter-å¯¹æ¯”">BrowserRouter ä¸ HashRouter å¯¹æ¯”</h4><ol><li>HashRouter æœ€ç®€å•ï¼Œä¸éœ€è¦æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Œé æµè§ˆå™¨çš„#çš„æ¥åŒºåˆ† path å°±å¯ä»¥ï¼ŒBrowserRouter éœ€è¦æœåŠ¡å™¨ç«¯å¯¹ä¸åŒçš„ URL è¿”å›ä¸åŒçš„ HTMLï¼Œåç«¯é…ç½®å¯<a href="https://react-guide.github.io/react-router-cn/docs/guides/basics/Histories.html">å‚è€ƒ</a>ã€‚</li><li>BrowserRouter ä½¿ç”¨ HTML5 history APIï¼ˆ pushStateï¼ŒreplaceState å’Œ popstate äº‹ä»¶ï¼‰ï¼Œè®©é¡µé¢çš„ UI åŒæ­¥ä¸ URLã€‚</li><li>HashRouter ä¸æ”¯æŒ location.key å’Œ location.stateï¼ŒåŠ¨æ€è·¯ç”±è·³è½¬éœ€è¦é€šè¿‡?ä¼ é€’å‚æ•°ã€‚</li><li>Hash history ä¸éœ€è¦æœåŠ¡å™¨ä»»ä½•é…ç½®å°±å¯ä»¥è¿è¡Œï¼Œå¦‚æœä½ åˆšåˆšå…¥é—¨ï¼Œé‚£å°±ä½¿ç”¨å®ƒå§ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸æ¨èåœ¨å®é™…çº¿ä¸Šç¯å¢ƒä¸­ç”¨åˆ°å®ƒï¼Œå› ä¸ºæ¯ä¸€ä¸ª web åº”ç”¨éƒ½åº”è¯¥æ¸´æœ›ä½¿ç”¨ <code>browserHistory</code>ã€‚</li></ol><h4 id="MemoryRouter">MemoryRouter</h4><p>æŠŠ URL çš„å†å²è®°å½•ä¿å­˜åœ¨å†…å­˜ä¸­çš„ <code>&lt;Router&gt;</code>ï¼ˆä¸è¯»å–ã€ä¸å†™å…¥åœ°å€æ ï¼‰ã€‚åœ¨æµ‹è¯•å’Œéæµè§ˆå™¨ç¯å¢ƒä¸­å¾ˆæœ‰ç”¨ï¼Œå¦‚ React Nativeã€‚</p><h4 id="åŸºæœ¬ä½¿ç”¨">åŸºæœ¬ä½¿ç”¨</h4><p>react-router ä¸­å¥‰è¡Œä¸€åˆ‡çš†ç»„ä»¶çš„æ€æƒ³ï¼Œè·¯ç”±å™¨-<strong>Router</strong>ã€é“¾æ¥-<strong>Link</strong>ã€è·¯ç”±-<strong>Route</strong>ã€ç‹¬å -<strong>Switch</strong>ã€é‡å®šå‘-<strong>Redirect</strong>éƒ½ä»¥ç»„ä»¶å½¢å¼å­˜åœ¨</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;BrowserRouter <span class="keyword">as</span> Router, Route, Link&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> HomePage <span class="keyword">from</span> <span class="string">&quot;./pages/HomePage&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> UserPage <span class="keyword">from</span> <span class="string">&quot;./pages/UserPage&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> LoginPage <span class="keyword">from</span> <span class="string">&quot;./pages/LoginPage&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">&quot;App&quot;</span>&gt;</span><br><span class="line">      &lt;Router&gt;</span><br><span class="line">        &lt;Link to=<span class="string">&quot;/&quot;</span>&gt;é¦–é¡µ&lt;/Link&gt;</span><br><span class="line">        &lt;Link to=<span class="string">&quot;/user&quot;</span>&gt;ç”¨æˆ·ä¸­å¿ƒ&lt;/Link&gt;</span><br><span class="line">        &lt;Link to=<span class="string">&quot;/login&quot;</span>&gt;ç™»å½•&lt;/Link&gt;</span><br><span class="line"></span><br><span class="line">        &#123;<span class="comment">/* æ ¹è·¯ç”±è¦æ·»åŠ exactï¼Œå®ç°ç²¾ç¡®åŒ¹é… */</span>&#125;</span><br><span class="line">        &lt;Route exact path=<span class="string">&quot;/&quot;</span> component=&#123;HomePage&#125; /&gt;</span><br><span class="line">        &lt;Route path=<span class="string">&quot;/user&quot;</span> component=&#123;UserPage&#125; /&gt;</span><br><span class="line">        &lt;Route path=<span class="string">&quot;/login&quot;</span> component=&#123;LoginPage&#125; /&gt;</span><br><span class="line">      &lt;/Router&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br></pre></td></tr></table></figure><h1>Route æ¸²æŸ“å†…å®¹çš„ä¸‰ç§æ–¹å¼</h1><h2 id="èµ„æº-2">èµ„æº</h2><ol><li><a href="https://react.docschina.org/">React å®˜ç½‘</a></li><li><a href="http://react-router.docschina.org/">react-router</a></li></ol><h2 id="ç›®æ ‡-2">ç›®æ ‡</h2><ol><li>æŒæ¡ Route æ¸²æŸ“å†…å®¹çš„ä¸‰ç§æ–¹å¼</li><li>æŒæ¡ 404 è·¯ç”±</li></ol><h2 id="çŸ¥è¯†ç‚¹-2">çŸ¥è¯†ç‚¹</h2><p>Route æ¸²æŸ“ä¼˜å…ˆçº§ï¼šchildren&gt;component&gt;renderã€‚</p><p>ä¸‰è€…èƒ½æ¥æ”¶åˆ°åŒæ ·çš„[route props]ï¼ŒåŒ…æ‹¬ match, location and historyï¼Œä½†æ˜¯å½“ä¸åŒ¹é…çš„æ—¶å€™ï¼Œchildren çš„ match ä¸º nullã€‚</p><p>è¿™ä¸‰ç§æ–¹å¼äº’æ–¥ï¼Œä½ åªèƒ½ç”¨ä¸€ç§ã€‚</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;BrowserRouter <span class="keyword">as</span> Router, Route, Link, Switch&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> HomePage <span class="keyword">from</span> <span class="string">&quot;./pages/HomePage&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> UserPage <span class="keyword">from</span> <span class="string">&quot;./pages/UserPage&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> LoginPage <span class="keyword">from</span> <span class="string">&quot;./pages/LoginPage&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> _404Page <span class="keyword">from</span> <span class="string">&quot;./pages/_404Page&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">&quot;App&quot;</span>&gt;</span><br><span class="line">      &lt;button</span><br><span class="line">        onClick=&#123;<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          setCount(count + <span class="number">1</span>);</span><br><span class="line">        &#125;&#125;&gt;</span><br><span class="line">        add: &#123;count&#125;</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">      &lt;Router&gt;</span><br><span class="line">        &lt;Link to=<span class="string">&quot;/&quot;</span>&gt;é¦–é¡µ&lt;/Link&gt;</span><br><span class="line">        &lt;Link to=<span class="string">&quot;/user&quot;</span>&gt;ç”¨æˆ·ä¸­å¿ƒ&lt;/Link&gt;</span><br><span class="line">        &lt;Link to=<span class="string">&quot;/login&quot;</span>&gt;ç™»å½•&lt;/Link&gt;</span><br><span class="line">        &#123;<span class="comment">/* ç‹¬å è·¯ç”± */</span>&#125;</span><br><span class="line">        &lt;Switch&gt;</span><br><span class="line">          &lt;Route</span><br><span class="line">            path=<span class="string">&quot;/&quot;</span></span><br><span class="line">            exact</span><br><span class="line">            <span class="comment">//children=&#123;children&#125;</span></span><br><span class="line">            component=&#123;HomePage&#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ! æ¸²æŸ“componentçš„æ—¶å€™ä¼šè°ƒç”¨React.createElementï¼Œå¦‚æœä½¿ç”¨ä¸‹é¢è¿™ç§åŒ¿åå‡½æ•°çš„å½¢å¼ï¼Œæ¯æ¬¡éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„åŒ¿åçš„å‡½æ•°ï¼Œ</span></span><br><span class="line">            <span class="comment">// ! å¯¼è‡´ç”Ÿæˆçš„ç»„ä»¶çš„typeæ€»æ˜¯ä¸ç›¸åŒï¼Œè¿™ä¸ªæ—¶å€™ä¼šäº§ç”Ÿé‡å¤çš„å¸è½½å’ŒæŒ‚è½½</span></span><br><span class="line">            <span class="comment">//!  é”™è¯¯ä¸¾ä¾‹ è¯¾ä¸‹è‡ªå·±å°è¯•ä¸‹ è§‚å¯Ÿä¸‹HomePageçš„didMountå’ŒwillUnmountå‡½æ•° */&#125;</span></span><br><span class="line">            <span class="comment">//component=&#123;() =&gt; &lt;HomePage /&gt;&#125;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// render=&#123;render&#125;</span></span><br><span class="line">          /&gt;</span><br><span class="line">          &lt;Route path=<span class="string">&quot;/user&quot;</span> component=&#123;UserPage&#125; /&gt;</span><br><span class="line">          &lt;Route path=<span class="string">&quot;/login&quot;</span> component=&#123;LoginPage&#125; /&gt;</span><br><span class="line">          &lt;Route component=&#123;_404Page&#125; /&gt;</span><br><span class="line">        &lt;/Switch&gt;</span><br><span class="line">      &lt;/Router&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">children</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;children props&quot;</span>, props); <span class="comment">//sy-log</span></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>children<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;props props&quot;</span>, props); <span class="comment">//sy-log</span></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>render<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="childrenï¼šfunc">childrenï¼šfunc</h3><p>æœ‰æ—¶å€™ï¼Œä¸ç®¡ location æ˜¯å¦åŒ¹é…ï¼Œä½ éƒ½éœ€è¦æ¸²æŸ“ä¸€äº›å†…å®¹ï¼Œè¿™æ—¶å€™ä½ å¯ä»¥ç”¨ childrenã€‚</p><p>é™¤äº†ä¸ç®¡ location æ˜¯å¦åŒ¹é…éƒ½ä¼šè¢«æ¸²æŸ“ä¹‹å¤–ï¼Œå…¶å®ƒå·¥ä½œæ–¹æ³•ä¸ render å®Œå…¨ä¸€æ ·ã€‚</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;BrowserRouter <span class="keyword">as</span> Router, Link, Route&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ListItemLink</span>(<span class="params">&#123;to, name, ...rest&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Route</span><br><span class="line">      path=&#123;to&#125;</span><br><span class="line">      children=&#123;<span class="function">(<span class="params">&#123;match&#125;</span>) =&gt;</span> (</span><br><span class="line">        &lt;li className=&#123;match ? <span class="string">&quot;active&quot;</span> : <span class="string">&quot;&quot;</span>&#125;&gt;</span><br><span class="line">          &lt;Link to=&#123;to&#125; &#123;...rest&#125;&gt;</span><br><span class="line">            &#123;name&#125;</span><br><span class="line">          &lt;/Link&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">      )&#125;</span><br><span class="line">    /&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">RouteChildren</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h3&gt;RouteChildren&lt;/h3&gt;</span><br><span class="line">        &lt;Router&gt;</span><br><span class="line">          &lt;ul&gt;</span><br><span class="line">            &lt;ListItemLink to=<span class="string">&quot;/somewhere&quot;</span> name=<span class="string">&quot;é“¾æ¥1&quot;</span> /&gt;</span><br><span class="line">            &lt;ListItemLink to=<span class="string">&quot;/somewhere-else&quot;</span> name=<span class="string">&quot;é“¾æ¥2&quot;</span> /&gt;</span><br><span class="line">          &lt;/ul&gt;</span><br><span class="line">        &lt;/Router&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="renderï¼šfunc">renderï¼šfunc</h3><p>ä½†æ˜¯å½“ä½ ç”¨ render çš„æ—¶å€™ï¼Œä½ è°ƒç”¨çš„åªæ˜¯ä¸ªå‡½æ•°ã€‚ä½†æ˜¯å®ƒå’Œ component ä¸€æ ·ï¼Œèƒ½è®¿é—®åˆ°æ‰€æœ‰çš„[route props]ã€‚</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;BrowserRouter <span class="keyword">as</span> Router, Route&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹ä¾¿çš„å†…è”æ¸²æŸ“</span></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Router&gt;</span><br><span class="line">    &lt;Route path=<span class="string">&quot;/home&quot;</span> render=&#123;<span class="function">() =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&#125; /&gt;</span><br><span class="line">  &lt;/Router&gt;,</span><br><span class="line">  node</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// wrapping/composing</span></span><br><span class="line"><span class="comment">//æŠŠrouteå‚æ•°ä¼ é€’ç»™ä½ çš„ç»„ä»¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FadingRoute</span>(<span class="params">&#123;component: Component, ...rest&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Route &#123;...rest&#125; render=&#123;<span class="function"><span class="params">routeProps</span> =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">Component</span> &#123;<span class="attr">...routeProps</span>&#125; /&gt;</span></span>&#125; /&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Router&gt;</span><br><span class="line">    &lt;FadingRoute path=<span class="string">&quot;/cool&quot;</span> component=&#123;Something&#125; /&gt;</span><br><span class="line">  &lt;/Router&gt;,</span><br><span class="line">  node</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="component-component">component: component</h3><p>åªåœ¨å½“ location åŒ¹é…çš„æ—¶å€™æ¸²æŸ“ã€‚</p><h3 id="æ³¨æ„">æ³¨æ„</h3><p>å½“ä½ ç”¨<code>component</code>çš„æ—¶å€™ï¼ŒRoute ä¼šç”¨ä½ æŒ‡å®šçš„ç»„ä»¶å’Œ React.createElement åˆ›å»ºä¸€ä¸ªæ–°çš„[React element]ã€‚è¿™æ„å‘³ç€å½“ä½ æä¾›çš„æ˜¯ä¸€ä¸ªå†…è”å‡½æ•°çš„æ—¶å€™ï¼Œæ¯æ¬¡ render éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚è¿™ä¼šå¯¼è‡´ä¸å†æ›´æ–°å·²ç»ç°æœ‰ç»„ä»¶ï¼Œè€Œæ˜¯ç›´æ¥å¸è½½ç„¶åå†å»æŒ‚è½½ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚å› æ­¤ï¼Œå½“ç”¨åˆ°å†…è”å‡½æ•°çš„å†…è”æ¸²æŸ“æ—¶ï¼Œè¯·ä½¿ç”¨ render æˆ–è€… childrenã€‚</p><p>Route æ ¸å¿ƒæ¸²æŸ“ä»£ç å¦‚ä¸‹ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/0082zybply1gc7moo8djgj311c0u0wv0-20210325005548144-20210326000547431.jpg" alt="image20200224174023810"></p><h3 id="404-é¡µé¢">404 é¡µé¢</h3><p>è®¾å®šä¸€ä¸ªæ²¡æœ‰ path çš„è·¯ç”±åœ¨è·¯ç”±åˆ—è¡¨æœ€åé¢ï¼Œè¡¨ç¤ºä¸€å®šåŒ¹é…</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;Switch&gt;</span><br><span class="line">  &lt;Route path=<span class="string">&quot;/&quot;</span> exact component=&#123;HomePage&#125; /&gt;</span><br><span class="line">  &lt;Route path=<span class="string">&quot;/user&quot;</span> component=&#123;UserPage&#125; /&gt;</span><br><span class="line">  &lt;Route path=<span class="string">&quot;/login&quot;</span> component=&#123;LoginPage&#125; /&gt;</span><br><span class="line">  &lt;Route component=&#123;_404Page&#125; /&gt;</span><br><span class="line">&lt;/Switch&gt;</span><br></pre></td></tr></table></figure><h1>åŠ¨æ€è·¯ç”±</h1><h2 id="èµ„æº-3">èµ„æº</h2><ol><li><a href="https://react.docschina.org/">React å®˜ç½‘</a></li><li><a href="http://react-router.docschina.org/">react-router</a></li></ol><h2 id="ç›®æ ‡-3">ç›®æ ‡</h2><ol><li>åŠ¨æ€è·¯ç”±</li></ol><h2 id="çŸ¥è¯†ç‚¹-3">çŸ¥è¯†ç‚¹</h2><h3 id="åŠ¨æ€è·¯ç”±">åŠ¨æ€è·¯ç”±</h3><p>ä½¿ç”¨:idçš„å½¢å¼å®šä¹‰åŠ¨æ€è·¯ç”±</p><p>å®šä¹‰è·¯ç”±:</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;Route path=<span class="string">&quot;/product/:id&quot;</span> component=&#123;Product&#125; /&gt;</span><br></pre></td></tr></table></figure><p>æ·»åŠ å¯¼èˆªé“¾æ¥:</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;Link to=&#123;<span class="string">&quot;/product/123&quot;</span>&#125;&gt;æœç´¢&lt;/Link&gt;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºSearchç»„ä»¶å¹¶è·å–å‚æ•°:</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Product</span>(<span class="params">&#123;location, match&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;match&quot;</span>, match); <span class="comment">//sy-log</span></span><br><span class="line">  <span class="keyword">const</span> &#123;id&#125; = match.params;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Product-&#123;id&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>åµŒå¥—è·¯ç”±</h1><h2 id="èµ„æº-4">èµ„æº</h2><ol><li><a href="https://react.docschina.org/">React å®˜ç½‘</a></li><li><a href="http://react-router.docschina.org/">react-router</a></li></ol><h2 id="â½¬æ ‡">â½¬æ ‡</h2><ul><li>æŒæ¡åµŒå¥—è·¯ç”±</li></ul><h2 id="çŸ¥è¯†ç‚¹-4">çŸ¥è¯†ç‚¹</h2><h3 id="åµŒå¥—è·¯ç”±">åµŒå¥—è·¯ç”±</h3><p>Routeç»„ä»¶åµŒå¥—åœ¨å…¶ä»–â»šâ¾¯ç»„ä»¶ä¸­å°±äº§â½£äº†åµŒå¥—å…³ç³»</p><p>ä¿®æ”¹Productï¼Œæ·»åŠ æ–°å¢å’Œè¯¦æƒ…</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;Route path&#x3D;&#123;url + &quot;&#x2F;detail&quot;&#125; component&#x3D;&#123;Detail&#125; &#x2F;&gt;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Product</span>(<span class="params">&#123;match&#125;</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;match&quot;</span>, match); <span class="comment">//sy-log</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123;params, url&#125; = match;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123;id&#125; = params;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line"></span><br><span class="line">&lt;div&gt; </span><br><span class="line"></span><br><span class="line">&lt;h1&gt;Search-&#123;id&#125;&lt;/h1&gt; </span><br><span class="line"></span><br><span class="line">&lt;Link to=&#123;url + <span class="string">&quot;/detail&quot;</span>&#125;&gt;è¯¦æƒ…&lt;/Link&gt; </span><br><span class="line"></span><br><span class="line">&lt;Route path=&#123;url + <span class="string">&quot;/detail&quot;</span>&#125; component=&#123;Detail&#125; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt; );</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>â¼¿å†™å®ç°<strong>BrowserRouter</strong>ã€<strong>Route</strong>ã€<strong>Link</strong></h1><h2 id="èµ„æº-5">èµ„æº</h2><ol><li><a href="https://react.docschina.org/">React å®˜ç½‘</a></li><li><a href="http://react-router.docschina.org/">react-router</a></li></ol><h2 id="â½¬æ ‡-2">â½¬æ ‡</h2><ul><li>react-routeråˆæ­¥å®ç°</li></ul><h2 id="çŸ¥è¯†ç‚¹-5">çŸ¥è¯†ç‚¹</h2><h3 id="è·¨å±‚çº§ä¼ è¾“æ•°æ®-Context">è·¨å±‚çº§ä¼ è¾“æ•°æ® Context</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨Contextåšæ•°æ®è·¨å±‚çº§ä¼ é€’</span></span><br><span class="line"><span class="comment">// step1: åˆ›å»ºcontextå¯¹è±¡</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> RouterContext = React.createContext();</span><br><span class="line"></span><br><span class="line"><span class="comment">// step2: ä½¿ç”¨contextå¯¹è±¡çš„Providerä¼ é€’value</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// step3: å­ç»„ä»¶æ¶ˆè´¹valueï¼š Consumerã€useContextã€contextType</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="å®ç°Router">å®ç°<strong>Router</strong></h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;RouterContext&#125; <span class="keyword">from</span> <span class="string">&quot;./Context&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Router</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="title">computeRootMatch</span>(<span class="params">pathname</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="attr">path</span>: <span class="string">&quot;/&quot;</span>, <span class="attr">url</span>: <span class="string">&quot;/&quot;</span>, <span class="attr">params</span>: &#123;&#125;, <span class="attr">isExact</span>: pathname === <span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">props</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(props);</span><br><span class="line">        <span class="built_in">this</span>.state = &#123;</span><br><span class="line">            location: props.history.location</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.unlisten = props.history.listen(<span class="function"><span class="params">location</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.setState(&#123;</span><br><span class="line">                location</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">componentWillUnmount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.unlisten) &#123;</span><br><span class="line">            <span class="built_in">this</span>.unlisten();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;RouterContext.Provider</span><br><span class="line">                value=&#123;&#123;</span><br><span class="line">                    history: <span class="built_in">this</span>.props.history,</span><br><span class="line">                    location: <span class="built_in">this</span>.state.location,</span><br><span class="line">                    match: Router.computeRootMatch(<span class="built_in">this</span>.state.location.pathname)</span><br><span class="line">                &#125;&#125;&gt;</span><br><span class="line">                &#123;<span class="built_in">this</span>.props.children&#125;</span><br><span class="line">            &lt;/RouterContext.Provider&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®ç°BrowserRouter">å®ç°<strong>BrowserRouter</strong></h3><p><strong>BrowserRouter</strong>ï¼šå†å²è®°å½•ç®¡ç†å¯¹è±¡historyåˆå§‹åŒ–åŠå‘ä¸‹ä¼ é€’ï¼Œlocationå˜æ›´ç›‘å¬</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;createBrowserHistory&#125; <span class="keyword">from</span> <span class="string">&quot;history&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">&quot;./Router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">BrowserRouter</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">props</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(props);</span><br><span class="line">        <span class="built_in">this</span>.history = createBrowserHistory();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Router</span> <span class="attr">history</span>=<span class="string">&#123;this.history&#125;</span>&gt;</span>&#123;this.props.children&#125;<span class="tag">&lt;/<span class="name">Router</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®ç°Route">å®ç°<strong>Route</strong></h3><p>è·¯ç”±é…ç½®ï¼ŒåŒ¹é…æ£€æµ‹ï¼Œå†…å®¹æ¸²æŸ“</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// match æŒ‰ç…§äº’æ–¥è§„åˆ™ ä¼˜å…ˆæ¸²æŸ“é¡ºåºä¸ºchildren component render nullï¼Œchildrenå¦‚æœæ˜¯functionæ‰§â¾functionï¼Œæ˜¯èŠ‚ç‚¹ç›´æ¥æ¸²æŸ“</span></span><br><span class="line"><span class="comment">// ä¸match children æˆ–è€…null ï¼ˆåªæ¸²æŸ“functionï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Route</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;RouterContext.Consumer&gt;</span><br><span class="line">                &#123;<span class="function"><span class="params">context</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="comment">// ä¼˜å…ˆä»propsä¸­å–å€¼</span></span><br><span class="line">                    <span class="keyword">const</span> location = <span class="built_in">this</span>.props.location || context.location;</span><br><span class="line">                    <span class="comment">// ä¼˜å…ˆä»propsä¸­å–å€¼è®¡ç®—</span></span><br><span class="line">                    <span class="keyword">const</span> match = <span class="built_in">this</span>.props.computedMatch</span><br><span class="line">                        ? <span class="built_in">this</span>.props.computedMatch</span><br><span class="line">                        : <span class="built_in">this</span>.props.path</span><br><span class="line">                            ? matchPath(location.pathname, <span class="built_in">this</span>.props)</span><br><span class="line">                            : context.match;</span><br><span class="line">                    <span class="keyword">const</span> props = &#123;</span><br><span class="line">                        ...context,</span><br><span class="line">                        location,</span><br><span class="line">                        match</span><br><span class="line">                    &#125;;</span><br><span class="line">                    <span class="keyword">let</span> &#123;path, children, component, render&#125; = <span class="built_in">this</span>.props;</span><br><span class="line">                    <span class="comment">// match æ¸²æŸ“è¿™ä¸‰è€…ä¹‹â¼€ï¼šchildren component renderæˆ–è€…null</span></span><br><span class="line">                    <span class="comment">// ä¸matchï¼Œæ¸²æŸ“children æˆ–è€… null</span></span><br><span class="line">                    <span class="keyword">return</span> (</span><br><span class="line">                        &lt;RouterContext.Provider value=&#123;props&#125;&gt;</span><br><span class="line">                            &#123;match</span><br><span class="line">                                ? children</span><br><span class="line">                                    ? <span class="keyword">typeof</span> children === <span class="string">&quot;function&quot;</span></span><br><span class="line">                                        ? children(props)</span><br><span class="line">                                        : children</span><br><span class="line">                                    : component</span><br><span class="line">                                        ? React.createElement(component, props)</span><br><span class="line">                                        : render</span><br><span class="line">                                            ? render(props)</span><br><span class="line">                                            : <span class="literal">null</span></span><br><span class="line">                                : <span class="keyword">typeof</span> children === <span class="string">&quot;function&quot;</span></span><br><span class="line">                                    ? children(props)</span><br><span class="line">                                    : <span class="literal">null</span>&#125;</span><br><span class="line">                        &lt;/RouterContext.Provider&gt;</span><br><span class="line">                    );</span><br><span class="line">                &#125;&#125;</span><br><span class="line">            &lt;/RouterContext.Consumer&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å®ç°<strong>Link</strong></p><p>Link.js: è·³è½¬é“¾æ¥ï¼Œå¤„ç†ç‚¹å‡»äº‹ä»¶</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;RouterContext&#125; <span class="keyword">from</span> <span class="string">&quot;./RouterContext&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Link</span>(<span class="params">&#123;to, children, ...restProps&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> context = React.useContext(RouterContext);</span><br><span class="line">  <span class="keyword">const</span> handleClick = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    context.history.push(to);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;a href=&#123;to&#125; &#123;...restProps&#125; onClick=&#123;handleClick&#125;&gt;</span><br><span class="line">      &#123;children&#125;</span><br><span class="line">    &lt;/a&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®ç°Switch">å®ç°<strong>Switch</strong></h3><p>æ¸²æŸ“ä¸è¯¥åœ°å€åŒ¹é…çš„ç¬¬â¼€ä¸ªâ¼¦èŠ‚ç‚¹ <Route> æˆ–è€… <Redirect> ã€‚</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;Component, isValidElement&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;RouterContext&#125; <span class="keyword">from</span> <span class="string">&quot;./Context&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> matchPath <span class="keyword">from</span> <span class="string">&quot;./matchPath&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Switch</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;RouterContext.Consumer&gt;</span><br><span class="line">                &#123;<span class="function"><span class="params">context</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">const</span> &#123;location&#125; = context;</span><br><span class="line">                    <span class="keyword">let</span> match, element;</span><br><span class="line">                    <span class="comment">// children element | array</span></span><br><span class="line">                    React.Children.forEach(<span class="built_in">this</span>.props.children, <span class="function"><span class="params">child</span> =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (match == <span class="literal">null</span> &amp;&amp; React.isValidElement(child)) &#123;</span><br><span class="line">                            element = child;</span><br><span class="line">                            <span class="keyword">const</span> &#123;path&#125; = child.props;</span><br><span class="line">                            match = path</span><br><span class="line">                                ? matchPath(location.pathname, child.props)</span><br><span class="line">                                : context.match;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">return</span> match</span><br><span class="line">                        ? React.cloneElement(element, &#123;<span class="attr">computedMatch</span>: match&#125;)</span><br><span class="line">                        : <span class="literal">null</span>;</span><br><span class="line">                &#125;&#125;</span><br><span class="line">            &lt;/RouterContext.Consumer&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;å‰ç«¯è·¯ç”±ä»‹ç»&lt;/h1&gt;
&lt;h2 id=&quot;ä»€ä¹ˆå‰ç«¯è·¯ç”±&quot;&gt;ä»€ä¹ˆå‰ç«¯è·¯ç”±&lt;/h2&gt;
&lt;p&gt;è·¯ç”±è¿™ä¸ªæ¦‚å¿µæœ€æ—©å‡ºç°åœ¨åç«¯ï¼Œé€šè¿‡â½¤æˆ·è¯·æ±‚çš„urlå¯¼èˆªåˆ°å…·ä½“çš„htmlâ»šâ¾¯ã€‚ç°åœ¨çš„å‰ç«¯è·¯ç”±ä¸åŒ&lt;/p&gt;
&lt;p&gt;äºä¼ ç»Ÿè·¯ç”±ï¼Œå®ƒä¸éœ€è¦æœåŠ¡å™¨è§£æï¼Œâ½½æ˜¯å¯ä»¥é€šè¿‡hashå‡½æ•°æˆ–è€…history A</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://lebronchao.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="React" scheme="https://lebronchao.com/tags/React/"/>
    
    <category term="Front End" scheme="https://lebronchao.com/tags/Front-End/"/>
    
    <category term="åº•å±‚åŸç†" scheme="https://lebronchao.com/tags/%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/"/>
    
    <category term="Router" scheme="https://lebronchao.com/tags/Router/"/>
    
  </entry>
  
  <entry>
    <title>TypeScriptå…¥é—¨ | å­¦ä¹ ç¬”è®°</title>
    <link href="https://lebronchao.com/2021/01/22/TypeScript%E5%85%A5%E9%97%A8-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>https://lebronchao.com/2021/01/22/TypeScript%E5%85%A5%E9%97%A8-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2021-01-22T07:42:34.000Z</published>
    <updated>2021-01-22T07:42:34.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="TypeScriptå­¦ä¹ ç¬”è®°">TypeScriptå­¦ä¹ ç¬”è®°</h3><h3 id="TSç®€ä»‹">TSç®€ä»‹</h3><blockquote><p>Tså¾®è½¯å¼€å‘ï¼ŒåŒ…å«ES6ã€åŒ…å«ES5</p></blockquote><p>ç¼–è¯‘ tsc xx.ts<br>æ¯ä¸€æ¬¡éƒ½å¾—ç¼–è¯‘ï¼Œå¯ä»¥è‡ªåŠ¨ç¼–è¯‘</p><h3 id="å¼€å‘å·¥å…·ä¸­é…ç½®typescirptè‡ªåŠ¨ç¼–è¯‘">å¼€å‘å·¥å…·ä¸­é…ç½®typescirptè‡ªåŠ¨ç¼–è¯‘</h3><p>vscode:</p><ol><li>åˆ›å»ºtsconfig.jsonæ–‡ä»¶ tsc --init ç”Ÿæˆé…ç½®æ–‡ä»¶</li><li>tsconfig.jsoné…ç½®æ–‡ä»¶ä¸­ï¼Œä¿®æ”¹outDiré…ç½®é¡¹ï¼Œå–æ¶ˆæ³¨é‡Šç„¶åä¿®æ”¹ä¸º.js</li><li>vscodeä¸­ï¼Œç‚¹å‡»ä¸Šæ–¹æ ä½run taskï¼Œé€‰æ‹©tsç›‘å¬</li><li>å®Œæˆ</li></ol><h3 id="TSç±»å‹">TSç±»å‹</h3><ul><li>ä¸es5ä¸­çš„åŒºåˆ«</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// es5ï¼šç±»å‹å˜åŒ–ä¸æŠ¥é”™</span></span><br><span class="line"><span class="keyword">var</span> flag = <span class="literal">true</span>;</span><br><span class="line">flag = <span class="number">234</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// tsï¼šå¿…é¡»æŒ‡å®šç±»å‹</span></span><br><span class="line">typescript</span><br><span class="line"><span class="keyword">var</span> flag:<span class="built_in">boolean</span>=<span class="literal">true</span>;</span><br><span class="line">flag = <span class="number">131</span>;<span class="comment">//æŠ¥é”™</span></span><br></pre></td></tr></table></figure><h4 id="TSç±»å‹ï¼š">TSç±»å‹ï¼š</h4><ul><li>boolean</li><li>number</li><li>string</li><li>arrayæ•°ç»„ï¼š<br>æ–¹å¼1ï¼švar arr:number[] = [1,2,3]//åˆ¶å®šarré‡Œé¢å…¨æ˜¯æ•°å­—<br>æ–¹å¼2ï¼švar arr:Array= [1,2,3]</li></ul><h4 id="å…ƒç»„ç±»å‹ï¼ˆtupleï¼‰">å…ƒç»„ç±»å‹ï¼ˆtupleï¼‰</h4><ul><li>æ–¹å¼1ï¼šå±äºæ•°ç»„çš„ä¸€ç§ï¼Œå³æ•°ç»„ä¸­æ¯ä¸€ä¸ªå…ƒç´ æŒ‡å®šç±»å‹</li><li>æ–¹å¼2ï¼švar arr:[number, string]=[123,â€œthis is tsâ€];</li></ul><h4 id="æšä¸¾ç±»å‹-enum">æšä¸¾ç±»å‹(enum)</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¸¸ç”¨æ¥æ ‡è¯†çŠ¶æ€ç </span></span><br><span class="line"><span class="built_in">enum</span> Flag&#123;</span><br><span class="line">   success=<span class="number">1</span>,</span><br><span class="line">     error=<span class="number">2</span></span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">let</span> f:Flag=Flag.error;</span><br><span class="line"> <span class="built_in">console</span>.log(f);<span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœ æ²¡æœ‰æ ‡è¯†ç¬¦æ²¡æœ‰èµ‹å€¼ï¼Œé‚£ä¹ˆæ‰“å°çš„å°±æ˜¯ä¸‹æ ‡</span></span><br><span class="line"><span class="built_in">enum</span> Color&#123;blue,red,orange&#125;;</span><br><span class="line"> <span class="keyword">var</span> c:Color=Color.red;</span><br><span class="line"> <span class="built_in">console</span>.log(c);  <span class="comment">//1ï¼Œä¸‹æ ‡</span></span><br><span class="line"> <span class="built_in">enum</span> Color&#123;blue,red=<span class="number">3</span>,orange&#125;;</span><br><span class="line"> <span class="keyword">var</span> c:Color=Color.red;</span><br><span class="line"> <span class="built_in">console</span>.log(c);  <span class="comment">//3</span></span><br><span class="line">   </span><br><span class="line"> <span class="comment">// å¸¸ç”¨æ¥æ ‡è¯†çŠ¶æ€ç </span></span><br><span class="line"> <span class="built_in">enum</span> Err&#123;</span><br><span class="line">  <span class="string">&#x27;undefined&#x27;</span>=-<span class="number">1</span>,</span><br><span class="line">   <span class="string">&#x27;null&#x27;</span>=-<span class="number">2</span>,</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">var</span> c:Err=Err.null</span><br><span class="line"> <span class="built_in">console</span>.log(c) <span class="comment">// -2</span></span><br></pre></td></tr></table></figure><h4 id="ä»»æ„ç±»å‹any">ä»»æ„ç±»å‹any</h4><ul><li>ç±»ä¼¼ES5ä¸æŒ‡å®šå˜é‡ç±»å‹çš„var</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> num:<span class="built_in">any</span>=<span class="number">123</span>;</span><br><span class="line">num = <span class="literal">true</span>;<span class="comment">// ä¸æŠ¥é”™</span></span><br></pre></td></tr></table></figure><h4 id="nullç±»å‹å’Œundefinedå…¶ä»–æ•°æ®ç±»å‹çš„å­ç±»å‹">nullç±»å‹å’Œundefinedå…¶ä»–æ•°æ®ç±»å‹çš„å­ç±»å‹</h4><ul><li>å˜é‡å®šä¹‰ä¹‹åæ²¡æœ‰èµ‹å€¼ï¼ŒæŠ¥undefined</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸€ä¸ªå…ƒç´ å¯èƒ½æ˜¯numberç±»å‹ï¼Œå¯èƒ½æ˜¯nullæˆ–è€…undefined</span></span><br><span class="line"><span class="keyword">var</span> num:<span class="built_in">number</span> | <span class="literal">undefined</span> | <span class="literal">null</span>;</span><br></pre></td></tr></table></figure><h4 id="voidå’Œjavaä¸€æ ·-æ²¡æœ‰è¿”å›å€¼ç±»å‹">voidå’Œjavaä¸€æ · æ²¡æœ‰è¿”å›å€¼ç±»å‹</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœæ–¹æ³•æ²¡æœ‰è¿”å›å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>):<span class="title">void</span></span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;asdf&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¦‚æœæ–¹æ³•æœ‰è¿”å›å€¼ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>):<span class="title">number</span></span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="neverç±»å‹ï¼Œä»£è¡¨ä»æ¥ä¸ä¼šå‡ºç°çš„å€¼ï¼Œæ˜¯å…¶ä»–ç±»å‹ï¼ˆåŒ…æ‹¬nullâ€˜å’Œundefinedï¼‰çš„å­ç±»å‹ï¼Œä»£è¡¨ä»ä¸ä¼šå‡ºç°çš„å€¼">neverç±»å‹ï¼Œä»£è¡¨ä»æ¥ä¸ä¼šå‡ºç°çš„å€¼ï¼Œæ˜¯å…¶ä»–ç±»å‹ï¼ˆåŒ…æ‹¬nullâ€˜å’Œundefinedï¼‰çš„å­ç±»å‹ï¼Œä»£è¡¨ä»ä¸ä¼šå‡ºç°çš„å€¼</h4><ul><li>è‡ªå·±ç†è§£ä¸ºä¸Šè¿°ç±»å‹ä¹‹å¤–çš„æ•°æ®ç±»å‹</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¦‚ä¸‹ï¼Œæ¥æ”¶Errç±»å‹çš„æ•°æ®</span></span><br><span class="line">   <span class="keyword">var</span> a:<span class="built_in">never</span>;</span><br><span class="line">   a = <span class="literal">undefined</span>;<span class="comment">//æŠ¥é”™</span></span><br><span class="line">   a = (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">       <span class="keyword">new</span> Throw Err(<span class="string">&quot;æŠ¥é”™&quot;</span>)</span><br><span class="line">   &#125;)()</span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°çš„å®šä¹‰">å‡½æ•°çš„å®šä¹‰</h3><ul><li>ES5ä¸­ï¼š</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‡½æ•°å£°æ˜æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åŒ¿åå‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> run2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ..</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>TSä¸­ï¼š</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å‡½æ•°å£°æ˜æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>):<span class="title">number</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">123</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŒ¿åå‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> fun2=<span class="function"><span class="keyword">function</span>(<span class="params"></span>):<span class="title">number</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">123</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="tsä¸­å®šä¹‰æ–¹æ³•ä¼ å‚">tsä¸­å®šä¹‰æ–¹æ³•ä¼ å‚</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params">name:<span class="built_in">string</span>, age:<span class="built_in">number</span></span>):<span class="title">string</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name + <span class="string">&quot; &quot;</span> + age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> getInfo= <span class="function"><span class="keyword">function</span>(<span class="params">name:<span class="built_in">string</span>, age:<span class="built_in">number</span></span>):<span class="title">string</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name+age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•å¯é€‰å‚æ•°">æ–¹æ³•å¯é€‰å‚æ•°</h3><blockquote><p>es5é‡Œæ–¹æ³•å®å‚å’Œå½¢å‚å¯ä»¥ä¸ä¸€æ ·ï¼Œä½†æ˜¯tså¿…é¡»ä¸€è‡´ï¼Œå¦‚æœä¸ä¸€æ ·å°±éœ€è¦é…ç½®å¯é€‰å‚æ•°</p></blockquote><ul><li>å‚æ•°åè¾¹åŠ ?å¯ä»¥è®¾ç½®å‚æ•°å¯é€‰ä¼ </li><li>å¯é€‰å‚æ•°å¿…é¡»é…ç½®åˆ°å‚æ•°çš„æœ€åè¾¹</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params">name:<span class="built_in">string</span>, age?<span class="built_in">number</span></span>):<span class="title">string</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é»˜è®¤å‚æ•°">é»˜è®¤å‚æ•°</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é»˜è®¤å‚æ•°ï¼Œç›´æ¥åœ¨å½¢å‚èµ‹å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params">name:<span class="built_in">string</span>, age:<span class="built_in">number</span>=<span class="number">20</span></span>):<span class="title">string</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span>â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰©ä½™å‚æ•°">å‰©ä½™å‚æ•°</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a:<span class="built_in">number</span>, b:<span class="built_in">number</span>, c:<span class="built_in">number</span>, d:<span class="built_in">number</span></span>):<span class="title">number</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a+b+c+d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸‰ç‚¹è¿ç®—ç¬¦ï¼šæ¥æ”¶ä¸å›ºå®šå‚æ•°çš„ï¼ˆå‰©ä½™å‚æ•°ï¼‰çš„å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">â€¦rest:<span class="built_in">number</span>[]</span>):<span class="title">number</span></span>&#123;</span><br><span class="line"><span class="keyword">var</span> sum= <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;rest.length;i++)&#123;</span><br><span class="line">sum+=rest[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°é‡è½½">å‡½æ•°é‡è½½</h3><ul><li>ç±»ä¼¼javaï¼ŒåŒåä½†æ˜¯ä¸åŒå‚æ•°çš„å¤šä¸ªå‡½æ•°æ–¹æ³•</li><li>tsä¸ºäº†å…¼å®¹es5ï¼Œä»¥åŠes6ï¼Œå’Œjavaæœ‰åŒºåˆ«</li><li>es5ä¸­ï¼Œå‡ºç°åŒåæ–¹æ³•æ—¶å€™ï¼Œä¸‹é¢çš„æ–¹æ³•ä¼šæ›¿æ¢ä¸Šé¢çš„æ–¹æ³•</li><li>tsä¸­çš„é‡è½½ï¼š</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params">name:<span class="built_in">string</span></span>):<span class="title">string</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params">age:<span class="built_in">number</span></span>):<span class="title">string</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params">str:<span class="built_in">any</span></span>):<span class="title">any</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> str ===<span class="string">&quot;string&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;æˆ‘å«ï¼š&quot;</span>+ str;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;æˆ‘çš„å¹´é¾„æ˜¯:&quot;</span> + str;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç®­å¤´å‡½æ•°">ç®­å¤´å‡½æ•°</h3><p>ç®­å¤´å‡½æ•°é‡Œé¢çš„thisæŒ‡å‘ä¸Šä¸‹æ–‡</p><h3 id="ç±»">ç±»</h3><p>1ã€ES5ä¸­å®šä¹‰ç±»ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name=<span class="string">&#x27;å¼ ä¸‰&#x27;</span>;</span><br><span class="line">    <span class="built_in">this</span>.age = <span class="number">20</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person();</span><br><span class="line">alert(p.name);</span><br></pre></td></tr></table></figure><p>2ã€æ„é€ å‡½æ•°å’ŒåŸå‹é“¾é‡Œé¢å®šä¹‰</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å£°æ˜çš„æ„é€ æ–¹æ³•</span></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       <span class="built_in">this</span>.name = <span class="string">&quot;å¼ ä¸‰&quot;</span>;</span><br><span class="line">       <span class="built_in">this</span>.age=<span class="number">20</span>;</span><br><span class="line">       <span class="built_in">this</span>.run = <span class="function"><span class="keyword">function</span>(<span class="params"></span>))</span>&#123;</span><br><span class="line">           alert(<span class="built_in">this</span>.name+<span class="string">&quot;åœ¨è¿åŠ¨&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// åŸå‹é“¾çš„å±æ€§å’Œæ–¹æ³•</span></span><br><span class="line">   Person.prototype.sex=<span class="string">&quot;ç”·&quot;</span>;</span><br><span class="line">   Person.prototype.work=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       alert(xx)</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">var</span> p = <span class="keyword">new</span> Person();</span><br><span class="line">   p.work();</span><br></pre></td></tr></table></figure><p>3ã€é™æ€æ–¹æ³•</p><p>4ã€es5ä¸­çš„ç»§æ‰¿-å¯¹è±¡å†’å……ç»§æ‰¿</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¦å®ç°Webç±» ç»§æ‰¿ Personç±»  åŸå‹é“¾+å¯¹è±¡å†’å……çš„ç»„åˆç»§æ‰¿æ¨¡å¼</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&quot;å¼ ä¸‰&quot;</span>;</span><br><span class="line">    <span class="built_in">this</span>.age=<span class="number">20</span>;</span><br><span class="line">    <span class="built_in">this</span>.run = <span class="function"><span class="keyword">function</span>(<span class="params"></span>))</span>&#123;</span><br><span class="line">        alert(<span class="built_in">this</span>.name+<span class="string">&quot;åœ¨è¿åŠ¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŸå‹é“¾çš„å±æ€§å’Œæ–¹æ³•</span></span><br><span class="line">Person.prototype.sex=<span class="string">&quot;ç”·&quot;</span>;</span><br><span class="line">Person.prototype.work=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(xx)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¦å®ç°Webç±» ç»§æ‰¿ Personç±»</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Web</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    Person.call(<span class="built_in">this</span>); <span class="comment">//å¯¹è±¡å†’å……ç»§æ‰¿</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> w = <span class="keyword">new</span> Web();</span><br><span class="line">w.run();<span class="comment">//æ‰§è¡Œçˆ¶ç±»Personçš„runï¼Œå¯¹è±¡å†’å……å¯ä»¥ç»§æ‰¿æ„é€ å‡½æ•°é‡Œé¢çš„å±æ€§å’Œæ–¹æ³•</span></span><br><span class="line">w.work();<span class="comment">// å¯¹è±¡å†’å……å¯ä»¥ç»§æ‰¿æ„é€ å‡½æ•°çš„å±æ€§å’Œæ–¹æ³• ä½†æ˜¯æ²¡åŠæ³•ç»§æ‰¿åŸå‹é“¾çš„å±æ€§å’Œæ–¹æ³•ï¼ˆprototypeï¼‰</span></span><br></pre></td></tr></table></figure><ul><li>å…³äºcallï¼š</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">c, d</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.a + <span class="built_in">this</span>.b + c + d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.error(add.call(obj, <span class="number">3</span>, <span class="number">4</span>)); <span class="comment">// 10</span></span><br><span class="line">å¤§ç»Ÿä¸Šçš„è¯´æ³•å°±æ˜¯ï¼Œcallæ”¹å˜äº†<span class="built_in">this</span>çš„æŒ‡å‘ã€‚ç„¶åï¼Œä»‹ç»<span class="built_in">this</span> xxxä»€ä¹ˆä¸€å¤§å †åè¯ï¼Œåæ­£ä¸ç®¡ä½ æ‡‚ä¸æ‡‚ï¼ŒæˆåŠŸç»•æ™•ä½ å°±å·²ç»okäº†ï¼Œä½†æ˜¯å®é™…å‘ç”Ÿçš„è¿‡ç¨‹ï¼Œå¯ä»¥çœ‹æˆä¸‹é¢çš„æ ·å­ã€‚</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> o = &#123;</span><br><span class="line">  a: <span class="number">1</span>,</span><br><span class="line">  b: <span class="number">2</span>,</span><br><span class="line">  add: <span class="function"><span class="keyword">function</span>(<span class="params">c, d</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.a + <span class="built_in">this</span>.b + c + d</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ç»™oå¯¹è±¡æ·»åŠ ä¸€ä¸ªaddå±æ€§ï¼Œè¿™ä¸ªæ—¶å€™ <span class="built_in">this</span> å°±æŒ‡å‘äº† oï¼Œ</span><br><span class="line">o.add(<span class="number">5</span>,<span class="number">7</span>)å¾—åˆ°çš„ç»“æœå’Œadd.call(o, <span class="number">5</span>, <span class="number">6</span>)ç›¸åŒã€‚</span><br></pre></td></tr></table></figure><p>5ã€åŸå‹é“¾ç»§æ‰¿æ–¹æ³•</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&quot;å¼ ä¸‰&quot;</span>;</span><br><span class="line">    <span class="built_in">this</span>.age=<span class="number">20</span>;</span><br><span class="line">    <span class="built_in">this</span>.run = <span class="function"><span class="keyword">function</span>(<span class="params"></span>))</span>&#123;</span><br><span class="line">        alert(<span class="built_in">this</span>.name+<span class="string">&quot;åœ¨è¿åŠ¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŸå‹é“¾çš„å±æ€§å’Œæ–¹æ³•</span></span><br><span class="line">Person.prototype.sex=<span class="string">&quot;ç”·&quot;</span>;</span><br><span class="line">Person.prototype.work=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(xx)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// webåŸå‹é“¾æ–¹å¼ç»§æ‰¿ person</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">web</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">web.prototype= <span class="keyword">new</span> person();<span class="comment">// åŸå‹é“¾ç»§æ‰¿</span></span><br><span class="line"></span><br><span class="line">web.work();<span class="comment">// å¯ä»¥å·¥ä½œï¼Œå¯ä»¥ç»§æ‰¿åŸå‹é“¾å±æ€§æ–¹æ³•</span></span><br></pre></td></tr></table></figure><p>6ã€åŸå‹é“¾å®ç°ç»§æ‰¿çš„é—®é¢˜ï¼Ÿï¼Ÿæ— æ³•ç»™çˆ¶ç±»ä¼ å‚</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&quot;å¼ ä¸‰&quot;</span>;</span><br><span class="line">    <span class="built_in">this</span>.age=<span class="number">20</span>;</span><br><span class="line">    <span class="built_in">this</span>.run = <span class="function"><span class="keyword">function</span>(<span class="params"></span>))</span>&#123;</span><br><span class="line">        alert(<span class="built_in">this</span>.name+<span class="string">&quot;åœ¨è¿åŠ¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŸå‹é“¾çš„å±æ€§å’Œæ–¹æ³•</span></span><br><span class="line">Person.prototype.sex=<span class="string">&quot;ç”·&quot;</span>;</span><br><span class="line">Person.prototype.work=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(xx)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> person(<span class="string">&#x27;æå››&#x27;</span>, <span class="number">20</span>);</span><br><span class="line">p.run(); <span class="comment">// æ²¡é—®é¢˜</span></span><br><span class="line"><span class="comment">// ç»§æ‰¿ï¼Œæ— æ³•ç»™çˆ¶ç±»ä¼ å‚</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Web</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">Web.prototype= <span class="keyword">new</span> Person();</span><br><span class="line"><span class="keyword">var</span> w = <span class="keyword">new</span> Web(<span class="string">&#x27;sss&#x27;</span>, <span class="number">20</span>);</span><br><span class="line">w.run();<span class="comment">// çˆ¶ç±»ä¼šalertå‡ºæ¥â€œundefiendåœ¨è¿åŠ¨â€</span></span><br><span class="line"><span class="comment">// å®ä¾‹åŒ–å­ç±»æ—¶å€™æ²¡æ³•ç»™çˆ¶ç±»ä¼ å‚</span></span><br></pre></td></tr></table></figure><p>7ã€åŸå‹é“¾+æ„é€ å‡½æ•°çš„ç»„åˆç»§æ‰¿æ¨¡å¼</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&quot;å¼ ä¸‰&quot;</span>;</span><br><span class="line">    <span class="built_in">this</span>.age=<span class="number">20</span>;</span><br><span class="line">    <span class="built_in">this</span>.run = <span class="function"><span class="keyword">function</span>(<span class="params"></span>))</span>&#123;</span><br><span class="line">        alert(<span class="built_in">this</span>.name+<span class="string">&quot;åœ¨è¿åŠ¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŸå‹é“¾çš„å±æ€§å’Œæ–¹æ³•</span></span><br><span class="line">Person.prototype.sex=<span class="string">&quot;ç”·&quot;</span>;</span><br><span class="line">Person.prototype.work=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(xx)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> person(<span class="string">&#x27;æå››&#x27;</span>, <span class="number">20</span>);</span><br><span class="line">p.run(); <span class="comment">// æ²¡é—®é¢˜</span></span><br><span class="line"><span class="comment">// ç»§æ‰¿ï¼Œæ— æ³•ç»™çˆ¶ç±»ä¼ å‚</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Web</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">    Person.call(<span class="built_in">this</span>,name,age); <span class="comment">// å¯¹è±¡å†’å……ç»§æ‰¿ å¯ä»¥ç»§æ‰¿æ„é€ å‡½æ•°é‡Œé¢çš„å±æ€§å’Œæ–¹æ³• å®ä¾‹åŒ–å­ç±»å¯ä»¥ç»™çˆ¶ç±»ä¼ å‚</span></span><br><span class="line">&#125;</span><br><span class="line">Web.prototype = <span class="keyword">new</span> Person();<span class="comment">// å®ä¾‹åŒ–</span></span><br><span class="line"><span class="keyword">var</span> w = <span class="keyword">new</span> Web(<span class="string">&#x27;sss&#x27;</span>, <span class="number">20</span>);</span><br><span class="line">w.run();<span class="comment">// çˆ¶ç±»ä¼šalertå‡ºæ¥â€œundefiendåœ¨è¿åŠ¨â€</span></span><br><span class="line"><span class="comment">// å®ä¾‹åŒ–å­ç±»æ—¶å€™æ²¡æ³•ç»™çˆ¶ç±»ä¼ å‚</span></span><br></pre></td></tr></table></figure><p>8ã€åŸå‹é“¾+å¯¹è±¡å†’å……çš„å¦ä¸€ç§å†™æ³•</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&quot;å¼ ä¸‰&quot;</span>;</span><br><span class="line">    <span class="built_in">this</span>.age=<span class="number">20</span>;</span><br><span class="line">    <span class="built_in">this</span>.run = <span class="function"><span class="keyword">function</span>(<span class="params"></span>))</span>&#123;</span><br><span class="line">        alert(<span class="built_in">this</span>.name+<span class="string">&quot;åœ¨è¿åŠ¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŸå‹é“¾çš„å±æ€§å’Œæ–¹æ³•</span></span><br><span class="line">Person.prototype.sex=<span class="string">&quot;ç”·&quot;</span>;</span><br><span class="line">Person.prototype.work=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(xx)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> person(<span class="string">&#x27;æå››&#x27;</span>, <span class="number">20</span>);</span><br><span class="line">p.run(); <span class="comment">// æ²¡é—®é¢˜</span></span><br><span class="line"><span class="comment">// ç»§æ‰¿ï¼Œæ— æ³•ç»™çˆ¶ç±»ä¼ å‚</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Web</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">    Person.call(<span class="built_in">this</span>,name,age); <span class="comment">// å¯¹è±¡å†’å……ç»§æ‰¿ å¯ä»¥ç»§æ‰¿æ„é€ å‡½æ•°é‡Œé¢çš„å±æ€§å’Œæ–¹æ³• å®ä¾‹åŒ–å­ç±»å¯ä»¥ç»™çˆ¶ç±»ä¼ å‚</span></span><br><span class="line">&#125;</span><br><span class="line">Web.prototype = Person.prototype; <span class="comment">// å’Œæ–¹æ³•7ä¸­ä¸åŒçš„æ˜¯è¿™é‡Œï¼ï¼ï¼</span></span><br><span class="line"><span class="keyword">var</span> w = <span class="keyword">new</span> Web(<span class="string">&#x27;sss&#x27;</span>, <span class="number">20</span>);</span><br><span class="line">w.run();<span class="comment">// çˆ¶ç±»ä¼šalertå‡ºæ¥â€œundefiendåœ¨è¿åŠ¨â€</span></span><br><span class="line"><span class="comment">// å®ä¾‹åŒ–å­ç±»æ—¶å€™æ²¡æ³•ç»™çˆ¶ç±»ä¼ å‚</span></span><br></pre></td></tr></table></figure><h3 id="ç±»çš„å®šä¹‰">ç±»çš„å®šä¹‰</h3><p>1ã€tsä¸­å®šä¹‰ç±»ï¼Œç±»ä¼¼javaï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>()</span>&#123;</span><br><span class="line">    name:<span class="built_in">string</span>; <span class="comment">//å±æ€§ å‰é¢çœç•¥äº†private</span></span><br><span class="line">    <span class="function"><span class="title">construtor</span>(<span class="params">n:<span class="built_in">string</span></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name = n;</span><br><span class="line">    &#125;</span><br><span class="line">    run():<span class="built_in">void</span>&#123;</span><br><span class="line">        log(<span class="built_in">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€ç»§æ‰¿</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web</span> <span class="keyword">extends</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">name:<span class="built_in">string</span></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> w = <span class="keyword">new</span> Web(<span class="string">&quot;æå››&quot;</span>);</span><br><span class="line">alert(w.run());</span><br></pre></td></tr></table></figure><p>3ã€ç±»é‡Œé¢çš„ä¿®é¥°ç¬¦</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">tsæä¾›äº†ä¸‰ç§ä¿®é¥°ç¬¦ï¼š</span><br><span class="line"><span class="keyword">public</span>(é»˜è®¤çš„)ï¼š å…¬æœ‰ åœ¨ç±»é‡Œé¢ã€å­ç±»ç±»å¤–è¾¹éƒ½å¯ä»¥è®¿é—®</span><br><span class="line"><span class="keyword">protected</span>ï¼šåœ¨ç±»é‡Œé¢ã€å­ç±»é‡Œé¢å¯ä»¥è®¿é—®ã€åœ¨ç±»å¤–éƒ¨æ— æ³•è®¿é—®</span><br><span class="line"><span class="keyword">private</span>ï¼šåœ¨ç±»é‡Œé¢å¯ä»¥è®¿é—®ã€å­ç±»ã€ç±»å¤–éƒ¨æ²¡æ³•è®¿é—®</span><br></pre></td></tr></table></figure><h3 id="é™æ€å±æ€§-é™æ€æ–¹æ³•">é™æ€å±æ€§ é™æ€æ–¹æ³•</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.run1=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">// å®ä¾‹æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.run2=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125; <span class="comment">// é™æ€æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">è°ƒç”¨å®ä¾‹æ–¹æ³•ï¼š(å®ä¾‹åŒ–ä¹‹åæ‰èƒ½è°ƒç”¨çš„)</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person();</span><br><span class="line">p.run1();</span><br><span class="line"></span><br><span class="line">è°ƒç”¨é™æ€æ–¹æ³•ï¼š</span><br><span class="line">Person.run2();</span><br></pre></td></tr></table></figure><blockquote><p>ä¸ºä»€ä¹ˆä¼šæœ‰é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ä¹‹åˆ†ï¼Ÿ<br>JQueryçš„å®ä¾‹æ–¹æ³•css()æ–¹æ³•å’Œé™æ€æ–¹æ³•$.get()æ–¹æ³•å¤§æ¦‚åŸç ä¸ºï¼š</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç”Ÿå‘½ä¸€ä¸ªèŠ‚ç‚¹/å…ƒç´ å¯¹è±¡</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Base</span>(<span class="params">element</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.element = è·å–domeèŠ‚ç‚¹çš„æ–¹æ³•;</span><br><span class="line">    <span class="built_in">this</span>.css = <span class="function"><span class="keyword">function</span>(<span class="params">str, value</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.element.style[str] = value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// $æ–¹æ³•å»å®ä¾‹åŒ–è¿™ä¸ªBAseå¯¹è±¡ã€å®ä¾‹æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">$</span>(<span class="params">element</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Base(element); <span class="comment">// å®ä¾‹åŒ–ä¸€ä¸ªæ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é™æ€æ–¹æ³•get</span></span><br><span class="line">$.<span class="function"><span class="title">get</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    ã€‚ã€‚ã€‚</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é‚£ä¹ˆcssè°ƒç”¨æ—¶å€™å°±å¯ä»¥è¿™æ ·å†™</span></span><br><span class="line">å®ä¾‹æ–¹æ³•:</span><br><span class="line">$(<span class="string">&quot;#box&quot;</span>).css(<span class="string">&quot;color&quot;</span>, <span class="string">&quot;red&quot;</span>);</span><br><span class="line"></span><br><span class="line">é™æ€æ–¹æ³•ï¼š</span><br><span class="line">$.get(<span class="string">&#x27;url&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure><ul><li>å¦ä¸€ç§æ–¹å¼å£°æ˜é™æ€æ–¹æ³•ï¼Œåˆ©ç”¨staticå…³é”®å­—å£°æ˜ï¼š</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> name:<span class="built_in">string</span>;</span><br><span class="line">    <span class="keyword">static</span> sex = <span class="string">&quot;ç”·&quot;</span>;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">name:<span class="built_in">string</span></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="title">print</span>(<span class="params"></span>)</span>&#123;<span class="comment">// é™æ€æ–¹æ³• é‡Œé¢æ²¡åŠæ³•ç›´æ¥è°ƒç”¨ç±»é‡Œé¢çš„å±æ€§ï¼Œ</span></span><br><span class="line">        alert(<span class="string">&quot;é™æ€æ–¹æ³•ï¼š&quot;</span>+Person.sex);<span class="comment">// å¦‚æœè°ƒç”¨this.nameå°±ä¼šæŠ¥é”™ï¼ï¼ï¼</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// $.get()&#123;// jqé‡Œé¢çš„getå°±æ˜¯é™æ€æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¤šæ€">å¤šæ€</h3><blockquote><p>çˆ¶ç±»å®šä¹‰ä¸€ä¸ªæ–¹æ³•ä¸å»å®ç°ï¼Œè®©ç»§æ‰¿ä»–çš„å­ç±»å»å®ç°ï¼Œæ¯ä¸€ä¸ªå­ç±»éƒ½æœ‰ä¸åŒçš„è¡¨ç°</p></blockquote><h3 id="æŠ½è±¡æ–¹æ³•">æŠ½è±¡æ–¹æ³•</h3><ul><li>ç”¨æ¥å®šä¹‰ä¸€ä¸ªæ ‡å‡†</li><li>tsä¸­çš„æŠ½è±¡ç±»ï¼Œå®ƒæ˜¯æä¾›å…¶ä»–ç±»ç»§æ‰¿çš„åŸºç±»ï¼Œä¸èƒ½ç›´æ¥è¢«å®ä¾‹åŒ–</li><li>ç”¨abstractå…³é”®å­—å®šä¹‰æŠ½è±¡ç±»å’ŒæŠ½è±¡æ–¹æ³•ï¼ŒæŠ½è±¡ç±»ä¸­çš„æŠ½è±¡æ–¹æ³•ä¸åŒ…å«å…·ä½“å®ç°å¹¶ä¸”å¿…é¡»åœ¨æ´¾ç”Ÿç±»ä¸­å®ç°</li><li>abstract æŠ½è±¡æ–¹æ³•åªèƒ½æ”¾åœ¨æŠ½è±¡ç±»ä¸­</li><li>æŠ½è±¡ç±»å’ŒæŠ½è±¡æ–¹æ³•ç”¨æ¥å®šä¹‰æ ‡å‡†ï¼ŒåŸºç±»è¦æ±‚ä»–çš„å­ç±»å¿…é¡»åŒ…å«æŸç§æ–¹æ³•</li><li>æŠ½è±¡æ–¹æ³•åªèƒ½å‡ºç°åœ¨æŠ½è±¡ç±»ä¸­</li><li>æŠ½è±¡ç±»ä¸­å¿…é¡»åŒ…å«è‡³å°‘ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œä¸ç„¶æ²¡æœ‰æ„ä¹‰</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span></span>&#123;</span><br><span class="line">    <span class="comment">// çœç•¥æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">abstract</span> eat():<span class="built_in">any</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ½è±¡ç±»æ— æ³•ç›´æ¥å®ä¾‹åŒ–</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> Animal();<span class="comment">// è¿™å¥è¯æ˜¯é”™çš„</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span></span>&#123;</span><br><span class="line">    <span class="comment">// çœç•¥æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="title">eat</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.name + <span class="string">&#x27;åƒ&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> Dog(<span class="string">&quot;sss&quot;</span>)</span><br><span class="line">d.eat();<span class="comment">// sssåƒ</span></span><br></pre></td></tr></table></figure><h3 id="æ¥å£">æ¥å£</h3><blockquote><p>ä¹Ÿæ˜¯å®šä¹‰æ ‡å‡†ï¼Œå®šä¹‰äº†è¡Œä¸ºå’ŒåŠ¨ä½œçš„è§„èŒƒ</p></blockquote><p>1ã€å±æ€§æ¥å£</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰äº†è¿™ä¸ªæ–¹æ³•çš„å‚æ•°æ˜¯jsonObjecï¼Œè€Œä¸”å¿…é¡»æœ‰</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printLabel</span>(<span class="params">labelInfo:&#123;label:<span class="built_in">string</span>&#125;</span>):<span class="title">void</span></span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(labelInfo.label);</span><br><span class="line">&#125;</span><br><span class="line">printLabel(<span class="string">&quot;ssss&quot;</span>); <span class="comment">// é”™è¯¯</span></span><br><span class="line"></span><br><span class="line">printLabel(&#123;<span class="attr">name</span>:<span class="string">&quot;asdf&quot;</span>&#125;); <span class="comment">// é”™è¯¯</span></span><br><span class="line">printLabel(&#123;<span class="attr">label</span>:<span class="string">&quot;sss&quot;</span>&#125;); <span class="comment">// æ­£ç¡®ï¼Œæ‰“å°sss</span></span><br></pre></td></tr></table></figure><p>2ã€æ¥å£ï¼Œå¯¹æ‰¹é‡æ–¹æ³•è¿›è¡Œçº¦æŸ</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¯¹æ‰¹é‡æ–¹æ³•ä¼ å…¥å‚æ•°è¿›è¡Œçº¦æŸ</span></span><br><span class="line"><span class="comment">// ä¼ å…¥å¯¹è±¡çš„çº¦æŸ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ç±»å‹</span></span><br><span class="line"><span class="keyword">interface</span> FullName&#123;</span><br><span class="line">    firstName:<span class="built_in">string</span>; <span class="comment">// æ³¨æ„æ˜¯;ç»“æŸ</span></span><br><span class="line">    secondName:<span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ–¹æ³•åä¸­å¼•ç”¨FullNameç±»å‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printName</span>(<span class="params">name:FullName</span>)</span>&#123;</span><br><span class="line">    log(name.firstName +<span class="string">&quot;  &quot;</span>+ name.secondName);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨æ–¹å¼ä¸€ï¼ˆä¸‹æ–¹è°ƒç”¨æ–¹å¼æ˜¯ä¼šæŠ¥é”™çš„ï¼Œinterfaceå®šä¹‰çš„å±æ€§objectåªèƒ½åŒ…å«firstNameå’ŒsecondNameï¼‰</span></span><br><span class="line">printName(&#123;</span><br><span class="line">    age:<span class="number">20</span>,</span><br><span class="line">    firstName: <span class="string">&quot;å¼ &quot;</span>,</span><br><span class="line">    secondName: <span class="string">&quot;ä¸‰&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨æ–¹å¼äºŒï¼Œä¸‹æ–¹å¼•å…¥å…¶ä»–çš„objectå³å¯å¿½ç•¥å¤šä½™å‚æ•°</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    age:<span class="number">20</span>,</span><br><span class="line">    firstName: <span class="string">&quot;å¼ &quot;</span>,</span><br><span class="line">    secondName: <span class="string">&quot;ä¸‰&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line">printName(obj);<span class="comment">// è¿™ä¸ªä¸æŠ¥é”™</span></span><br></pre></td></tr></table></figure><p>3ã€æ¥å£ã€å¯é€‰å±æ€§ï¼ŒåŠ ?é—®å·è¡¨ç¤ºå¯ä¼ å¯ä¸ä¼ </p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> FullName&#123;</span><br><span class="line">    firstName:<span class="built_in">string</span>;</span><br><span class="line">    secondName?:<span class="built_in">string</span>;<span class="comment">// secondNameå¯ä¼ å¯ä¸ä¼ </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>4ã€æ¨¡æ‹Ÿå°è£…ä¸€ä¸ªajax</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Config&#123;</span><br><span class="line">    <span class="keyword">type</span>:<span class="built_in">string</span>;</span><br><span class="line">    url:<span class="built_in">string</span>;</span><br><span class="line">    data?:<span class="built_in">string</span>;</span><br><span class="line">    dataType:<span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>5ã€å‡½æ•°ç±»å‹æ¥å£ã€å¯¹æ–¹æ³•ä¼ å…¥çš„å‚æ•°ã€ä»¥åŠè¿”å›å€¼è¿›è¡Œçº¦æŸã€æ‰¹é‡çº¦æŸ</p><ul><li>ä¾‹å­ï¼šå®šä¹‰åŠ å¯†çš„å‡½æ•°ç±»å‹æ¥å£</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> encrypt&#123;</span><br><span class="line"><span class="comment">// å®šä¹‰äº†å‡½æ•°å‚æ•°ä¸ºstringã€valueï¼Œè¿”å›string</span></span><br><span class="line">(key:<span class="built_in">string</span>,<span class="attr">value</span>:<span class="built_in">string</span>):<span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> md5:encrypt=<span class="function"><span class="keyword">function</span>(<span class="params">key:<span class="built_in">string</span>, value:<span class="built_in">string</span></span>):<span class="title">string</span></span>&#123;</span><br><span class="line"><span class="comment">// å®ç°encryptç±»å‹çš„å‡½æ•°return key+value;//æ¨¡æ‹Ÿä¸‹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>6ã€å¯ç´¢å¼•æ¥å£ï¼šå¯¹æ•°ç»„ã€å¯¹è±¡çš„çº¦æŸ</p><ul><li>tså®šä¹‰æ•°ç»„æ–¹æ³•ï¼š</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr:<span class="built_in">number</span>[]=[<span class="number">123</span>,<span class="number">234</span>];</span><br><span class="line"><span class="keyword">var</span> arr1:<span class="built_in">Array</span>&lt;<span class="built_in">string</span>&gt; = [<span class="string">&#x27;123&#x27;</span>, <span class="string">&#x27;222&#x27;</span>];</span><br></pre></td></tr></table></figure><ul><li>å¯¹æ•°ç»„çš„çº¦æŸï¼Œæ•°ç»„ç±»å‹æ¥å£</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> UserArray&#123;</span><br><span class="line">    <span class="comment">// è¡¨ç¤ºæ•°ç»„ä¸­indexå¿…é¡»æ˜¯numberï¼Œvalueå¿…é¡»æ˜¯string</span></span><br><span class="line">    [index:numer]:<span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr:UserArray=[<span class="string">&#x27;123&#x27;</span>, <span class="string">&#x27;22312&#x27;</span>];</span><br></pre></td></tr></table></figure><ul><li>å¯¹å¯¹è±¡çš„çº¦æŸï¼Œå¯¹è±¡ç±»å‹æ¥å£</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> UserObj&#123;</span><br><span class="line">    [index:<span class="built_in">string</span>]:<span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj:UserObj=&#123;<span class="attr">name</span>:<span class="string">&quot;2342&quot;</span>&#125;;</span><br></pre></td></tr></table></figure><ul><li>å¯¹ç±»çš„çº¦æŸï¼Œç±»ç±»å‹æ¥å£ï¼Œå’ŒæŠ½è±¡ç±»æœ‰ç‚¹ç›¸ä¼¼</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Animal&#123;</span><br><span class="line">    <span class="comment">// è§„å®šå®ç°ç±»å¿…é¡»è¦æœ‰nameå±æ€§å’Œeatæ–¹æ³•</span></span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">    eat(str:<span class="built_in">string</span>):<span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="title">implements</span> <span class="title">Animal</span></span>&#123;</span><br><span class="line">    name:<span class="built_in">string</span>;<span class="comment">// è‹¥æ²¡æ­¤å±æ€§ï¼Œtsä¼šç¼–è¯‘æŠ¥é”™</span></span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">name:<span class="built_in">string</span></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">eat</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        log(<span class="string">&quot;eat&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ¥å£çš„æ‰©å±•ï¼šæ¥å£å¯ä»¥ç»§æ‰¿æ¥å£</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Animal&#123;</span><br><span class="line">   eat():<span class="built_in">void</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">interface</span> Person <span class="keyword">extends</span> Animal&#123;</span><br><span class="line">   work():<span class="built_in">void</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Web</span> <span class="title">implements</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> name:<span class="built_in">string</span>;</span><br><span class="line">       <span class="function"><span class="title">constructor</span>(<span class="params">name:<span class="built_in">string</span></span>)</span>&#123;</span><br><span class="line">       <span class="built_in">this</span>.name = name;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// eatå¿…é¡»å®šä¹‰</span></span><br><span class="line">      <span class="function"><span class="title">eat</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       log(<span class="built_in">this</span>.name+<span class="string">&quot;åƒ&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// workä¹Ÿå¿…é¡»å®šä¹‰</span></span><br><span class="line">      <span class="function"><span class="title">work</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       log(<span class="built_in">this</span>.name+<span class="string">&quot;å·¥ä½œ&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Animal&#123;</span><br><span class="line">   eat():<span class="built_in">void</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">interface</span> Person <span class="keyword">extends</span> Animal&#123;</span><br><span class="line">   work():<span class="built_in">void</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Programmer</span></span>&#123;</span><br><span class="line">   <span class="comment">//æ„é€ æ–¹æ³•çœç•¥</span></span><br><span class="line">       </span><br><span class="line">       <span class="function"><span class="title">coding</span>(<span class="params">code:<span class="built_in">string</span></span>)</span>&#123;</span><br><span class="line">       log(<span class="built_in">this</span>.name+ <span class="string">&quot;  &quot;</span>+code)</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Web</span> <span class="keyword">extends</span> <span class="title">Programmer</span> <span class="title">implements</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> name:<span class="built_in">string</span>;</span><br><span class="line">       <span class="function"><span class="title">constructor</span>(<span class="params">name:<span class="built_in">string</span></span>)</span>&#123;</span><br><span class="line">       <span class="built_in">this</span>.name = name;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// eatå¿…é¡»å®šä¹‰</span></span><br><span class="line">      <span class="function"><span class="title">eat</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       log(<span class="built_in">this</span>.name+<span class="string">&quot;åƒ&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// workä¹Ÿå¿…é¡»å®šä¹‰</span></span><br><span class="line">      <span class="function"><span class="title">work</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       log(<span class="built_in">this</span>.name+<span class="string">&quot;å·¥ä½œ&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h3 id="æ³›å‹">æ³›å‹</h3><blockquote><p>å’Œanyæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p></blockquote><ul><li>anyæ”¾å¼ƒäº†ç±»å‹æ£€æŸ¥</li><li>å¦‚æœæƒ³åšåˆ°ä¼ å…¥ä»€ä¹ˆç±»å‹å°±è¿”å›ä»€ä¹ˆç±»å‹ï¼Œä¾‹å¦‚ä¼ å…¥numberå°±è¿”å›numberï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨æ³›å‹</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getData</span>(<span class="params">value:<span class="built_in">any</span></span>):<span class="title">any</span></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;&quot;</span><span class="comment">//ä»€ä¹ˆç±»å‹éƒ½å¯ä»¥</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h4 id="æ³›å‹ï¼š">æ³›å‹ï¼š</h4><ul><li>è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸ä»…è¦åˆ›å»ºä¸€è‡´çš„å®šä¹‰å¥½çš„APIï¼ŒåŒæ—¶ä¹Ÿè¦è€ƒè™‘å¯é‡ç”¨æ€§ï¼Œç»„ä»¶ä¸ä»…èƒ½å¤Ÿæ”¯æŒå½“å‰çš„æ•°æ®ç±»å‹ï¼ŒåŒæ—¶ä¹Ÿèƒ½æ”¯æŒæœªæ¥çš„æ•°æ®ç±»å‹ï¼Œè¿™åœ¨åˆ›å»ºå¤§å‹ç³»ç»Ÿæ—¶ä¸ºä½ æä¾›äº†ååˆ†çµæ´»çš„åŠŸèƒ½</li><li>åœ¨åƒc#å’Œjavaä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ³›å‹æ¥åˆ›å»ºå¯é‡ç”¨çš„ç»„ä»¶ï¼Œä¸€ä¸ªç»„ä»¶å¯æ”¯æŒå¤šç§ç±»å‹çš„æ•°æ®ï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥ä»¥è‡ªå·±çš„æ•°æ®ç±»å‹æ¥ä½¿ç”¨ç»„ä»¶</li><li>é€šä¿—ç†è§£ï¼šæ³›å‹å°±æ˜¯è§£å†³ ç±» æ¥å£ æ–¹æ³•çš„é‡ç”¨æ€§ã€ä»¥åŠå¯¹ä¸ç‰¹å®šæ•°æ®ç±»å‹çš„æ”¯æŒ</li><li>å¯ä»¥æ”¯æŒä¸ç‰¹å®šçš„æ•°æ®ç±»å‹</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getData</span>&lt;<span class="title">T</span>&gt;(<span class="params">value:T</span>):<span class="title">T</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> value;<span class="comment">//ä¼ å…¥ä»€ä¹ˆè¿”å›ä»€ä¹ˆ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿™æ ·è°ƒç”¨</span></span><br><span class="line">getData&lt;<span class="built_in">number</span>&gt;(<span class="number">123123</span>);</span><br><span class="line">getData&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;12131&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¹Ÿå¯ä»¥å†™æˆï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getData</span>&lt;<span class="title">T</span>&gt;(<span class="params">value:T</span>):<span class="title">any</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> value;<span class="comment">//ä¼ å…¥ä»€ä¹ˆè¿”å›ä»€ä¹ˆ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ³›å‹ç±»ï¼Œæ¯”å¦‚æœ‰ä¸ªæœ€å°å †ç®—æ³•ï¼Œéœ€è¦åŒæ—¶æ”¯æŒè¿”å›æ•°å­—å’Œå­—ç¬¦ä¸²ä¸¤ç§ç±»å‹ï¼Œé€šè¿‡ç±»çš„æ³›å‹æ¥å®ç°ï¼Œç¤ºä¾‹ï¼š</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰æ³›å‹ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinClass</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> list:<span class="built_in">number</span>[]=[];</span><br><span class="line">    <span class="function"><span class="title">add</span>(<span class="params">num:<span class="built_in">number</span></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.list.push(num);</span><br><span class="line">    &#125;</span><br><span class="line">    min():<span class="built_in">number</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> minNum = <span class="built_in">this</span>.list[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>;i&lt;<span class="built_in">this</span>.list.length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(minNum&gt;<span class="built_in">this</span>.list[i])&#123;</span><br><span class="line">                minNum=<span class="built_in">this</span>.list[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> minNum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è°ƒç”¨</span></span><br><span class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> MinClass();</span><br><span class="line">m.add(<span class="number">3</span>);</span><br><span class="line">m.add(<span class="number">2</span>);</span><br><span class="line">log(m.min());<span class="comment">// 2</span></span><br></pre></td></tr></table></figure><ul><li>ä½†æ˜¯ä¸Šè¾¹çš„åªèƒ½ä¼ å…¥æ•°å­—ç±»å‹ï¼Œæ˜¯å¦å¯ä»¥ç”¨æ³›å‹è§£å†³ï¼Ÿå¯ä»¥ï¼š</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinClass</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> list:T[]=[];</span><br><span class="line">    add(num:T):<span class="built_in">void</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.list.push(num);</span><br><span class="line">    &#125;</span><br><span class="line">    min():T&#123;</span><br><span class="line">        <span class="keyword">var</span> minNum = <span class="built_in">this</span>.list[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>;i&lt;<span class="built_in">this</span>.list.length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(minNum&gt;<span class="built_in">this</span>.list[i])&#123;</span><br><span class="line">                minNum=<span class="built_in">this</span>.list[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> minNum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è°ƒç”¨ï¼Œå®ä¾‹åŒ–æ—¶å€™è¦å…ˆå£°æ˜å‚æ•°ç±»å‹&lt;bumber</span></span><br><span class="line"><span class="keyword">var</span> m1 = <span class="keyword">new</span> MinClass&lt;<span class="built_in">number</span>&gt;();</span><br><span class="line">m1.add(<span class="number">2</span>);</span><br><span class="line">m1.add(<span class="number">4</span>);</span><br><span class="line">log(m.min());<span class="comment">// 2</span></span><br></pre></td></tr></table></figure><h5 id="å‡½æ•°ç±»å‹æ¥å£">å‡½æ•°ç±»å‹æ¥å£</h5><ul><li>æŒ‡å®šç‰¹æ®Šç±»å‹çš„æ–¹æ³•ï¼š</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> ConfigFn&#123;</span><br><span class="line">   (value1:<span class="built_in">string</span>, <span class="attr">value2</span>:<span class="built_in">string</span>):<span class="built_in">string</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> setData:ConfigFn=<span class="function"><span class="keyword">function</span>(<span class="params">value1:<span class="built_in">string</span>, value2:<span class="built_in">string</span></span>):<span class="title">string</span></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> value1 + value2;</span><br><span class="line">   &#125;</span><br><span class="line">   setData(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;å¼ ä¸‰);</span></span><br></pre></td></tr></table></figure><ul><li>æ³›å‹æ¥å£å†™æ³•1ï¼š</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Config&#123;</span><br><span class="line">   &lt;T&gt;(value:T):T;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> getData:ConfigFn=<span class="function"><span class="keyword">function</span>&lt;<span class="title">T</span>&gt;(<span class="params">value:T</span>):<span class="title">T</span></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> value;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   getData&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>æ³›å‹æ¥å£å†™æ³•2ï¼š</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">   <span class="keyword">interface</span> Config&lt;T&gt;&#123;</span><br><span class="line">   (value:T):T;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getData</span>&lt;<span class="title">T</span>&gt;(<span class="params">value:T</span>):<span class="title">T</span></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> value;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> myGetData:ConfigFn&lt;<span class="built_in">string</span>&gt;=getData;</span><br><span class="line"></span><br><span class="line">   myGetData(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>æŠŠç±»ä½œä¸ºå‚æ•°æ¥çº¦æŸæ•°æ®ä¼ å…¥çš„ç±»å‹</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">   username:<span class="built_in">string</span> | <span class="literal">undefined</span>;</span><br><span class="line">       password:<span class="built_in">string</span> | <span class="literal">undefined</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">MySqlDb</span></span>&#123;</span><br><span class="line">   add(user:User):<span class="built_in">boolean</span>&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(user);</span><br><span class="line">           retrun <span class="literal">true</span>;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// è°ƒç”¨</span></span><br><span class="line">   <span class="keyword">var</span> u = <span class="keyword">new</span> User();</span><br><span class="line">   u.username=<span class="string">&quot;å¼ ä¸‰&quot;</span>;</span><br><span class="line">   u.password=<span class="string">&quot;123456&quot;</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> Db = <span class="keyword">new</span> MySqlDb();</span><br><span class="line">   Db.add(u);<span class="comment">// console.log(u)</span></span><br></pre></td></tr></table></figure><ul><li>ä¸Šè¿°æ–¹æ³•å¯ä»¥æ”¹ä¸ºæ³›å‹ç±»</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ“ä½œæ•°æ®åº“çš„æ³›å‹ç±»ï¼Œè¿™æ ·å¯ä»¥è§„èŒƒæ’å…¥æ•°æ®åº“æ•°æ®çš„ç±»è§„èŒƒ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySqlDb</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">   add(info:T):<span class="built_in">boolean</span>&#123;</span><br><span class="line">       log(info);</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">// æƒ³ç»™Userè¡¨å¢åŠ æ•°æ®</span></span><br><span class="line">   <span class="comment">// 1ã€å®šä¹‰ä¸€ä¸ªUserç±» å’Œæ•°æ®åº“è¿›è¡Œæ˜ å°„</span></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">   username:<span class="built_in">string</span> | <span class="literal">undefined</span>;</span><br><span class="line">       password:<span class="built_in">string</span> | <span class="literal">undefined</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">var</span> u = <span class="keyword">new</span> User();</span><br><span class="line">   u.username= <span class="string">&#x27;å¼ ä¸‰&#x27;</span>;</span><br><span class="line">   u.password=<span class="string">&quot;2312&quot;</span>ï¼›</span><br><span class="line">   <span class="keyword">var</span> Db = <span class="keyword">new</span> MySqlDb&lt;User&gt;();<span class="comment">// è¿™ä¸€æ­¥å¾ˆå…³é”®ï¼Œè¦å®šä¹‰Userç±»å‹</span></span><br><span class="line">   Db.add(u);</span><br><span class="line"></span><br><span class="line">   <span class="comment">// 2ã€æ–‡ç« ç±»ï¼Œæ•°æ®åº“æ˜ å°„</span></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Article</span></span>&#123;</span><br><span class="line">   title:<span class="built_in">string</span> | <span class="literal">undefined</span>;</span><br><span class="line">       desc:<span class="built_in">string</span> | <span class="literal">undefined</span>;</span><br><span class="line">       status:<span class="built_in">number</span> | <span class="literal">undefined</span>;</span><br><span class="line">       <span class="title">constructor</span>(<span class="params">params:&#123;</span></span><br><span class="line"><span class="params">       title:<span class="built_in">string</span> | <span class="literal">undefined</span>;</span></span><br><span class="line"><span class="params">           desc:<span class="built_in">string</span> | <span class="literal">undefined</span>;</span></span><br><span class="line"><span class="params">           status?<span class="built_in">number</span> | <span class="literal">undefined</span>;<span class="regexp">//</span> statuså¯é€‰å‚æ•°</span></span><br><span class="line"><span class="params">       &#125;</span>)&#123;</span><br><span class="line">       <span class="built_in">this</span>.title=params.title;</span><br><span class="line">           <span class="built_in">this</span>.desc=params.desc;</span><br><span class="line">           <span class="built_in">this</span>.status=params.status;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// è°ƒç”¨</span></span><br><span class="line">   <span class="keyword">var</span> a = <span class="keyword">new</span> Article(&#123;</span><br><span class="line">   title:<span class="string">&quot;åˆ†ç±»&quot;</span>,</span><br><span class="line">       desc:<span class="string">&quot;111&quot;</span>,</span><br><span class="line">       status:<span class="number">1</span></span><br><span class="line">   &#125;)</span><br><span class="line"></span><br><span class="line">   <span class="comment">//ç±»å½“å‰å‚æ•°çš„æ³›å‹ç±»</span></span><br><span class="line">   <span class="keyword">var</span> Db = MySqlDB&lt;Article&gt;();<span class="comment">// æŒ‡å®šç±»å‹</span></span><br><span class="line">   Db.add(a);<span class="comment">// log a</span></span><br></pre></td></tr></table></figure><h3 id="å®æˆ˜ï¼šè¦å®ç°TSå°è£…ç»Ÿä¸€æ“ä½œMysql-Mongodb-Mssqlçš„åº•å±‚åº“">å®æˆ˜ï¼šè¦å®ç°TSå°è£…ç»Ÿä¸€æ“ä½œMysql Mongodb Mssqlçš„åº•å±‚åº“</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œç”¨äºæä¾›å„ç±»å‹æ•°æ®åº“è§„èŒƒ</span></span><br><span class="line">   <span class="keyword">interface</span> DBI&lt;T&gt;&#123;</span><br><span class="line">   add(info:T):<span class="built_in">boolean</span>;</span><br><span class="line">       update(info:T, <span class="attr">id</span>:<span class="built_in">number</span>):<span class="built_in">boolean</span>;</span><br><span class="line">       <span class="keyword">delete</span>(id:<span class="built_in">number</span>):<span class="built_in">boolean</span>;</span><br><span class="line">       get(id:<span class="built_in">number</span>):<span class="built_in">any</span>[];</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// å®šä¹‰ä¸€ä¸ªæ“ä½œmysqlçš„ç±»ï¼Œæ³¨æ„ è¦å®ç°æ³›å‹æ¥å£ è¿™ä¸ªç±»ä¹Ÿåº”è¯¥ä¸€å®šæ˜¯ä¸ªæ³›å‹ç±»</span></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">MysqlDb</span>&lt;<span class="title">T</span>&gt; <span class="title">implements</span> <span class="title">DBI</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">   add(info:T): <span class="built_in">boolean</span>&#123;</span><br><span class="line">       log(info);</span><br><span class="line">       &#125;</span><br><span class="line">       update...</span><br><span class="line">       <span class="keyword">delete</span>...</span><br><span class="line">       get...</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// è°ƒç”¨ æ“ä½œæ•°æ®è¡¨ï¼Œå®šä¹‰ä¸€ä¸ªUserç±»å’Œæ•°æ®åº“è¿›è¡Œæ˜ å°„ï¼Œå¹¶è¿›è¡ŒMySqlæ•°æ®çš„æ’å…¥æ“ä½œ</span></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">   username:<span class="built_in">string</span> | <span class="literal">undefined</span>;</span><br><span class="line">       password:<span class="built_in">string</span> | <span class="literal">undefined</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> u = <span class="keyword">new</span> User();</span><br><span class="line">   u.username = <span class="string">&quot;å¼ ä¸‰&quot;</span>;</span><br><span class="line">   u.password=<span class="string">&quot;213&quot;</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> oMysql = <span class="keyword">new</span> MysqlDb&lt;User&gt;();<span class="comment">// å£°æ˜Userç±»å‹å‚æ•°</span></span><br><span class="line">   oMysql.add(u);<span class="comment">// æ’å…¥</span></span><br></pre></td></tr></table></figure><h3 id="æ¨¡å—">æ¨¡å—</h3><p>æ¦‚å¿µï¼š</p><ul><li>æŠŠä¸€äº›å…¬å…±çš„åŠŸèƒ½å•ç‹¬æŠ½ç¦»æˆä¸€ä¸ªæ–‡ä»¶ä½œä¸ºä¸€ä¸ªæ¨¡å—</li><li>æ¨¡å—é‡Œé¢çš„å˜é‡ å‡½æ•° ç±»ç­‰é»˜è®¤éƒ½æ˜¯ç§æœ‰çš„ï¼Œå¦‚æœæˆ‘ä»¬è¦åœ¨å¤–éƒ¨è®¿é—®æ¨¡å—å†…çš„æ•°æ®ï¼ˆå‡½æ•°ã€å˜é‡ã€ç±»ï¼‰</li><li>æˆ‘ä»¬å°±éœ€è¦é€šè¿‡exportæš´éœ²æ¨¡å—é‡Œé¢çš„æ•°æ®</li><li>ç„¶åå…¶ä»–åœ°æ–¹é€šè¿‡importå¼•å…¥æ¨¡å—å°±å¯ä»¥ä½¿ç”¨æ¨¡å—å†…çš„æ•°æ®</li></ul><p>æ¨¡å—æš´éœ²exportï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//  æ–¹å¼ä¸€</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ–¹å¼äºŒ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> &#123; a &#125;</span><br></pre></td></tr></table></figure><p>æ¨¡å—å¯¼å…¥import:</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; a, a <span class="keyword">as</span> alias &#125; <span class="keyword">from</span> <span class="string">&quot;xxx&quot;</span>;</span><br><span class="line">a();</span><br><span class="line">alias();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¨¡å—é»˜è®¤å¯¼å‡ºdefaultï¼Œä¸€ä¸ªæ¨¡å—åªèƒ½ç”¨ä¸€æ¬¡<br>æš´éœ²ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="title">a</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¼•å…¥(ä¸ç”¨èŠ±æ‹¬å·)ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> a <span class="keyword">from</span> <span class="string">&quot;aaa&quot;</span>;</span><br><span class="line">a();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>DBåº“ç”¨æ¨¡å—åŒ–å°è£…// çœç•¥äº†ï¼Œä»£ç æ¯”è¾ƒç®€å•</p><h3 id="TSå‘½åç©ºé—´">TSå‘½åç©ºé—´</h3><blockquote><p>å†…éƒ¨æ¨¡å—ï¼Œä¸»è¦ç”¨äºç»„ç»‡ä»£ç ï¼Œé¿å…å‘½åå†²çªï¼Œ<br>ä¸ªäººç†è§£ï¼šæ¨¡å—ä¹‹ä¸­å†åˆ†æ¨¡å—<br>å®šä¹‰æ¨¡å—ã€å¹¶å¯¼å‡ºä¸åŒå‘½åç©ºé—´ï¼š</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">namespace</span> A&#123;</span><br><span class="line">    <span class="keyword">interface</span> Animal&#123;</span><br><span class="line">        name: <span class="built_in">string</span>;</span><br><span class="line">        eat(): <span class="built_in">void</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">export</span> Class Dog <span class="keyword">implements</span> Animal&#123;</span><br><span class="line">        name: <span class="built_in">string</span>;</span><br><span class="line">        <span class="function"><span class="title">constructor</span>(<span class="params">name:<span class="built_in">string</span></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line">        eat:<span class="function"><span class="title">void</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            log(<span class="built_in">this</span>.name +<span class="string">&quot;åœ¨ç©ºé—´Aä¸­åƒç‹—ç²®&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">namespace</span> B&#123;</span><br><span class="line">    <span class="keyword">interface</span> Animal&#123;</span><br><span class="line">        name: <span class="built_in">string</span>;</span><br><span class="line">        eat(): <span class="built_in">void</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">export</span> Class Dog <span class="keyword">implements</span> Animal&#123;</span><br><span class="line">        name: <span class="built_in">string</span>;</span><br><span class="line">        <span class="function"><span class="title">constructor</span>(<span class="params">name:<span class="built_in">string</span></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line">        eat:<span class="function"><span class="title">void</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            log(<span class="built_in">this</span>.name +<span class="string">&quot;åœ¨ç©ºé—´Aä¸­åƒç‹—ç²®&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>è°ƒç”¨ï¼š</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;A, B&#125; <span class="keyword">from</span> <span class="string">&quot;xxx&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> A.Dog(<span class="string">&quot;å°é»‘&quot;</span>);</span><br><span class="line">d.eat();<span class="comment">// å°é»‘åœ¨ç©ºé—´Aä¸­åƒç‹—ç²®</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dog = <span class="keyword">new</span> B.Dog(<span class="string">&quot;å°èŠ±&quot;</span>);</span><br><span class="line">dog.eat(); <span class="comment">// å°èŠ±åœ¨ç©ºé—´Bä¸­åƒç‹—ç²®</span></span><br></pre></td></tr></table></figure><h3 id="è£…é¥°å™¨">è£…é¥°å™¨</h3><p>å®šä¹‰ï¼š</p><ul><li>è£…é¥°å™¨æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„å£°æ˜ï¼Œä»–èƒ½å¤Ÿè¢«é™„åŠ åˆ°ç±»å£°æ˜ï¼Œæ–¹æ³•ï¼Œå±æ€§æˆ–è€…å‚æ•°ä¸Šï¼Œå¯ä»¥ä¿®æ”¹ç±»çš„è¡Œä¸ºã€‚</li><li>é€šä¿—çš„å°†è£…é¥°å™¨å°±æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥æ³¨å…¥åˆ°ç±»ã€æ–¹æ³•ã€å±æ€§å‚æ•°ä¸Šæ¥æ‰©å±•ç±»ã€å±æ€§ã€æ–¹æ³•ã€å‚æ•°çš„åŠŸèƒ½ã€‚</li><li>å¸¸è§çš„è£…é¥°å™¨æœ‰ï¼šç±»è£…é¥°å™¨ã€å±æ€§è£…é¥°å™¨ã€æ–¹æ³•è£…é¥°å™¨ã€å‚æ•°è£…é¥°å™¨</li><li>è£…é¥°å™¨çš„å†™æ³•ï¼šæ™®é€šè£…é¥°å™¨ï¼ˆæ— æ³•ä¼ å‚ï¼‰ã€è£…é¥°å™¨å·¥å‚ï¼ˆå¯ä¼ å‚ï¼‰</li><li>è£…é¥°å™¨æ˜¯è¿‡å»å‡ å¹´ä¸­jsæœ€å¤§çš„æˆå°±ä¹‹ä¸€ï¼Œå·²ç»æ˜¯ES7çš„æ ‡å‡†ç‰¹æ€§ä¹‹ä¸€</li></ul><h4 id="ç±»è£…é¥°å™¨ï¼šæ™®é€šè£…é¥°å™¨">ç±»è£…é¥°å™¨ï¼šæ™®é€šè£…é¥°å™¨</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logClass</span>(<span class="params">params:<span class="built_in">any</span></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(params);</span><br><span class="line">    <span class="comment">// paramså°±æ˜¯å½“å‰ç±»</span></span><br><span class="line">    params.prototype.apiUrl = <span class="string">&quot;åŠ¨æ€æ‰©å±•çš„å±æ€§&quot;</span>;</span><br><span class="line">    params.prototype.run=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;æˆ‘æ˜¯ä¸€ä¸ªrunæ–¹æ³•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@logClass</span>  <span class="comment">// ç±»è£…é¥°å™¨ï¼Œæ™®é€šè£…é¥°å™¨ï¼Œæ— æ³•ä¼ å‚ï¼Œé»˜è®¤å§classä¼ å…¥</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HttpClient</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">getData</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç±»è£…é¥°å™¨ï¼šè£…é¥°å™¨å·¥å‚">ç±»è£…é¥°å™¨ï¼šè£…é¥°å™¨å·¥å‚</h4><p>ä½œç”¨ï¼š</p><ol><li>ä¿®æ”¹æ„é€ å‡½æ•°</li><li>æ‰©å±•ç±»å±æ€§å’Œæ–¹æ³•<br>å®šä¹‰ï¼š</li></ol><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">logClass</span>(<span class="params">params:<span class="built_in">string</span></span>)</span>&#123;<span class="comment">// paramsæ˜¯ä¸‹æ–¹ä¼ è¿‡æ¥çš„å‚æ•°</span></span><br><span class="line">       <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target:<span class="built_in">any</span></span>)</span>&#123;<span class="comment">// targetç›¸å½“äºæ˜¯é»˜è®¤ä¼ è¿‡æ¥çš„</span></span><br><span class="line">           log(target);</span><br><span class="line">           log(params);</span><br><span class="line">           target.prototype.apiUrl = params;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@logClass</span>(<span class="string">&quot;https://baidu.com&quot;</span>)<span class="comment">// å¯ä»¥ä¼ å‚</span></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">HttpClient</span></span>&#123;</span><br><span class="line">       <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line">       <span class="function"><span class="title">getData</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> http:<span class="built_in">any</span> = <span class="keyword">new</span> HttpClient();</span><br><span class="line">   <span class="built_in">console</span>.log(http.apiUrl);<span class="comment">// https://baidu.com</span></span><br><span class="line"></span><br><span class="line">å¯ä»¥ä¿®æ”¹æ„é€ å‡½æ•°çš„å†™æ³•</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">logClass</span>(<span class="params">target:<span class="built_in">any</span></span>)</span>&#123;</span><br><span class="line">       log(target);</span><br><span class="line">       <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">target</span></span>&#123;</span><br><span class="line">           apiUrl:<span class="built_in">any</span> = <span class="string">&quot;æˆ‘æ˜¯ä¿®æ”¹åçš„æ–°æ•°æ®&quot;</span>;</span><br><span class="line"></span><br><span class="line">           <span class="function"><span class="title">getData</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">               <span class="built_in">this</span>.apiUrl = <span class="built_in">this</span>.apiUrl + <span class="string">&quot;----&quot;</span>;</span><br><span class="line">               log(<span class="built_in">this</span>.apiUrl);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@logClass</span></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">HttpClient</span></span>&#123;</span><br><span class="line">       <span class="keyword">public</span> apiUrl:<span class="built_in">string</span> | <span class="literal">undefined</span>;</span><br><span class="line">       <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">           <span class="built_in">this</span>.apiUrl = <span class="string">&quot;æˆ‘æ˜¯æ„é€ å‡½æ•°é‡Œé¢çš„apiUrl&quot;</span></span><br><span class="line">       &#125;</span><br><span class="line">       <span class="function"><span class="title">getData</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">           log(<span class="built_in">this</span>.apiUrl)</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> http= <span class="keyword">new</span> HttpClient();</span><br><span class="line">   http.getData();</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="å±æ€§è£…é¥°å™¨">å±æ€§è£…é¥°å™¨</h4><p>ä½œç”¨ï¼š</p><ol><li>å¯ä»¥ç»™å±æ€§èµ‹å€¼</li></ol><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç±»è£…é¥°å™¨</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logClass</span>(<span class="params">params:<span class="built_in">string</span></span>)</span>&#123;<span class="comment">// paramsæ˜¯ä¸‹æ–¹ä¼ è¿‡æ¥çš„å‚æ•°</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target:<span class="built_in">any</span></span>)</span>&#123;<span class="comment">// targetç›¸å½“äºæ˜¯é»˜è®¤ä¼ è¿‡æ¥çš„</span></span><br><span class="line">        log(target);</span><br><span class="line">        log(params);</span><br><span class="line">        target.prototype.apiUrl = params;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å±æ€§è£…é¥°å™¨</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logProperty</span>(<span class="params">params:<span class="built_in">any</span></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// å›ºå®šå†™æ³•ï¼Œå‚æ•°ä¸­ï¼Œtargetä¸ºç±»å¯¹è±¡ï¼Œatträ¸ºå‚æ•°åç§°</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target:<span class="built_in">any</span>, attr:<span class="built_in">any</span></span>)</span>&#123;</span><br><span class="line">        log(target);</span><br><span class="line">        log(attr);</span><br><span class="line">        target[attr] = params;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@logClass</span>(<span class="string">&quot;https://baidu.com&quot;</span>)<span class="comment">// å¯ä»¥ä¼ å‚</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HttpClient</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿™ä¸ªå±æ€§ä¿®é¥°å™¨çš„ä½œç”¨å°±æ˜¯ç»™urlèµ‹å€¼åˆå§‹å€¼</span></span><br><span class="line">    <span class="meta">@logProperty</span>(<span class="string">&quot;http://baidu.com&quot;</span>)</span><br><span class="line">    <span class="keyword">public</span> url:<span class="built_in">any</span> | <span class="literal">undefined</span>;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">getData</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> http:<span class="built_in">any</span> = <span class="keyword">new</span> HttpClient();</span><br><span class="line"><span class="built_in">console</span>.log(http.apiUrl);<span class="comment">// https://baidu.com</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="æ–¹æ³•è£…é¥°å™¨">æ–¹æ³•è£…é¥°å™¨</h4><p>ç”¨çš„æ˜¯æœ€å¤šçš„</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">params:<span class="built_in">any</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target:<span class="built_in">any</span>, methodName:<span class="built_in">any</span>, desc:<span class="built_in">any</span></span>)</span>&#123;</span><br><span class="line">        log(target); <span class="comment">// ç±»å±æ€§</span></span><br><span class="line">        log(methodName); <span class="comment">// æ–¹æ³•åå­— getData</span></span><br><span class="line">        log(desc); <span class="comment">// æ–¹æ³•çš„æè¿°ï¼Œdesc.valueæ˜¯æ–¹æ³•æè¿°</span></span><br><span class="line">        target.apiUrl = <span class="string">&quot;xxx&quot;</span>; <span class="comment">// ä¿®æ”¹é›·å±æ€§</span></span><br><span class="line">        target.run=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            log(<span class="string">&quot;run&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HttpClient</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> url:<span class="built_in">any</span> | <span class="literal">undefined</span>;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@get</span>(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">    <span class="function"><span class="title">getData</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        log(<span class="built_in">this</span>.url);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> http:<span class="built_in">any</span> = <span class="keyword">new</span> HttpClient();</span><br><span class="line">log(http.apiUrl); <span class="comment">// https://www.baidu.comâ€˜</span></span><br><span class="line">http.run(); <span class="comment">// log run</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹å½“å‰çš„æ–¹æ³•ï¼ˆä¸»è¦ä½œç”¨æ˜¯è£…é¥°æ–¹æ³•ï¼Œå¹¶æŠŠæ–¹æ³•çš„å‚æ•°ç»™å˜æ¢ç±»å‹ï¼‰ï¼š</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿™ä¸ªæ–¹æ³•è£…é¥°å…¶ä¸»è¦ä½œç”¨å°±æ˜¯æŠŠå‚æ•°éƒ½ç»™æ ¼å¼åŒ–æˆstringç±»å‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">params:<span class="built_in">any</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target:<span class="built_in">any</span>, methodName:<span class="built_in">any</span>, desc:<span class="built_in">any</span></span>)</span>&#123;</span><br><span class="line">        log(target); <span class="comment">// ç±»å±æ€§ </span></span><br><span class="line">        log(methodName); <span class="comment">// æ–¹æ³•åå­— getData</span></span><br><span class="line">        log(desc.value); <span class="comment">// æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// æƒ³ä¿®æ”¹ä¸‹æ–¹æ³•ï¼Œè£…é¥°ä¸€ä¸‹ï¼Œè®©ä»–ä»¬çš„æ‰€æœ‰å‚æ•°å˜æˆstringç±»å‹ï¼Œå¹¶ä¸”æ‰“å°å‡ºæ¥</span></span><br><span class="line">        <span class="keyword">var</span> oMethod = desc.value;</span><br><span class="line">        desc.value = <span class="function"><span class="keyword">function</span>(<span class="params">...args:<span class="built_in">any</span>[]</span>)</span>&#123;</span><br><span class="line">            args = args.map(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">String</span>(value);</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">            <span class="comment">// åˆ©ç”¨applyè¿›è¡Œå¯¹è±¡å†’å……ï¼Œå¯¹getdataè¿›è¡Œä¿®æ”¹ï¼Œå¦‚æœæ²¡æœ‰applyå°±ç›¸å½“äºæ˜¯æŠŠgetDataæ–¹æ³•ç»™æ›¿æ¢æ‰äº†</span></span><br><span class="line"></span><br><span class="line">            oMethod.apply(<span class="built_in">this</span>, args);<span class="comment">// thiså°±æ˜¯æŒ‡function(...args:any[])è¿™ä¸ªå‡½æ•°</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HttpClient</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> url:<span class="built_in">any</span> | <span class="literal">undefined</span>;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@get</span>(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">    <span class="function"><span class="title">getData</span>(<span class="params">...args:<span class="built_in">any</span>[]</span>)</span>&#123;</span><br><span class="line">        log(args);</span><br><span class="line">        log(<span class="string">&quot;æˆ‘æ˜¯getDataæ–¹æ³•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> http:<span class="built_in">any</span> = <span class="keyword">new</span> HttpClient();</span><br><span class="line">http.get(<span class="number">123</span>,<span class="string">&quot;xxx&quot;</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">// å°±ä¼šå…ˆæ‰“å°[&quot;123&quot;, &quot;xxx&quot;]åæ‰“å° æˆ‘æ˜¯getDataæ–¹æ³•</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="æ–¹æ³•å‚æ•°è£…é¥°å™¨">æ–¹æ³•å‚æ•°è£…é¥°å™¨</h4><p>ç”¨çš„æ¯”è¾ƒå°‘ï¼Œç±»è£…é¥°å™¨ä¹Ÿå¯ä»¥å®ç°è¿™ä¸ªåŠŸèƒ½</p><ul><li>è¿è¡Œæ—¶å€™å½“åšå‡½æ•°è¢«è°ƒç”¨ï¼Œå¯ä»¥ä½¿ç”¨å‚æ•°å¼ è¯—çªä¸ºç´¯çš„åŸå‹å¢åŠ ä¸€äº›å…ƒç´ æ•°æ®ï¼Œä¼ å…¥ä¸‹åˆ—ä¸‰ä¸ªå‚æ•°ï¼š</li><li>1å¯¹äºé™æ€æˆå‘˜æ¥è¯´æ˜¯ç±»çš„æ„é€ å‡½æ•°ï¼Œå¯¹äºå®ä¾‹æˆå‘˜æ˜¯ç±»çš„åŸå‹å¯¹è±¡</li><li>2æ–¹æ³•çš„åå­—</li><li>3å‚æ•°åœ¨å‡½æ•°å‚æ•°åˆ—è¡¨ä¸­çš„ç´¢å¼•</li></ul><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logParams</span>(<span class="params">params:<span class="built_in">any</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target:<span class="built_in">any</span>, methodName:<span class="built_in">any</span>, paramsIndex:<span class="built_in">any</span></span>)</span>&#123;</span><br><span class="line">        log(params);<span class="comment">// xxxx</span></span><br><span class="line">        log(target); <span class="comment">// åŸå‹å¯¹è±¡</span></span><br><span class="line">        log(methodName);<span class="comment">// getData</span></span><br><span class="line">        log(paramsIndex); <span class="comment">// 0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HttpClient</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> url:<span class="built_in">any</span> | <span class="literal">undefined</span>;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="title">getData</span>(<span class="params"><span class="meta">@logParams</span>(<span class="string">&quot;xxxx&quot;</span>) uuid:<span class="built_in">any</span></span>)</span>&#123;</span><br><span class="line">        log(uuid); <span class="comment">// iii</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> HttpClient();</span><br><span class="line">a.getData(<span class="string">&quot;iii&quot;</span>);</span><br><span class="line"></span><br><span class="line">å…ˆåè¾“å‡ºï¼š</span><br><span class="line"><span class="number">1.</span> xxxx</span><br><span class="line"><span class="number">2.</span> åŸå‹å¯¹è±¡</span><br><span class="line"><span class="number">3.</span> getData</span><br><span class="line"><span class="number">4.</span> <span class="number">0</span> </span><br><span class="line"><span class="number">5.</span> iii</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="è£…é¥°å™¨æ‰§è¡Œé¡ºåº">è£…é¥°å™¨æ‰§è¡Œé¡ºåº</h4><p>å½“å­˜åœ¨  å¤šä¸ªè£…é¥°å™¨æ—¶å€™ï¼š</p><ul><li><p>æ‰§è¡Œä¼˜å…ˆçº§ï¼šå±æ€§è£…é¥°å™¨&gt;æ–¹æ³•è£…é¥°å™¨&gt;æ–¹æ³•å‚æ•°è£…é¥°å™¨&gt;ç±»è£…é¥°å™¨</p></li><li><p>å¦‚æœæœ‰å¤šä¸ªåŒæ ·çš„è£…é¥°å™¨ï¼Œå®ƒä¼šå…ˆä»åè¾¹æ‰§è¡Œ</p></li></ul><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;TypeScriptå­¦ä¹ ç¬”è®°&quot;&gt;TypeScriptå­¦ä¹ ç¬”è®°&lt;/h3&gt;
&lt;h3 id=&quot;TSç®€ä»‹&quot;&gt;TSç®€ä»‹&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Tså¾®è½¯å¼€å‘ï¼ŒåŒ…å«ES6ã€åŒ…å«ES5&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç¼–è¯‘ tsc xx.ts&lt;br&gt;</summary>
      
    
    
    
    <category term="Front End" scheme="https://lebronchao.com/categories/Front-End/"/>
    
    
    <category term="Webå¼€å‘" scheme="https://lebronchao.com/tags/Web%E5%BC%80%E5%8F%91/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://lebronchao.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="Front End" scheme="https://lebronchao.com/tags/Front-End/"/>
    
    <category term="TypeScript" scheme="https://lebronchao.com/tags/TypeScript/"/>
    
    <category term="JavaScriptè¶…é›†" scheme="https://lebronchao.com/tags/JavaScript%E8%B6%85%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>æ•°æ®åº“ç³»ç»Ÿ | ç¬¬å…«ç«  æ•°æ®åº“ç¼–ç¨‹</title>
    <link href="https://lebronchao.com/2021/01/21/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E5%85%AB%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/"/>
    <id>https://lebronchao.com/2021/01/21/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E5%85%AB%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/</id>
    <published>2021-01-21T02:31:24.000Z</published>
    <updated>2021-01-21T06:54:24.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åµŒå…¥å¼SQL">åµŒå…¥å¼SQL</h2><ul><li>SQLè¯­è¨€æä¾›äº†ä¸¤ç§ä¸åŒçš„ä½¿ç”¨æ–¹å¼<ul><li>äº¤äº’å¼</li><li>åµŒå…¥å¼</li></ul></li><li>ä¸ºä»€ä¹ˆè¦å¼•å…¥åµŒå…¥å¼SQL<ul><li>SQLè¯­è¨€æ˜¯éè¿‡ç¨‹æ€§è¯­è¨€</li><li>äº‹åŠ¡å¤„ç†åº”ç”¨éœ€è¦é«˜çº§è¯­è¨€</li></ul></li><li>è¿™ä¸¤ç§æ–¹å¼ç»†èŠ‚ä¸Šæœ‰å·®åˆ«ï¼Œåœ¨ç¨‹åºè®¾è®¡çš„ç¯å¢ƒä¸‹ï¼ŒSQLè¯­å¥è¦åšæŸäº›å¿…è¦çš„æ‰©å……</li></ul><h3 id="åµŒå…¥å¼SQLçš„å¤„ç†è¿‡ç¨‹">åµŒå…¥å¼SQLçš„å¤„ç†è¿‡ç¨‹</h3><ul><li><p>ä¸»è¯­è¨€<br>åµŒå…¥å¼SQLæ˜¯å°†SQLè¯­å¥åµŒå…¥ç¨‹åºè®¾è®¡è¯­è¨€ä¸­ï¼Œè¢«åµŒå…¥çš„ç¨‹åºè®¾è®¡è¯­è¨€ï¼Œå¦‚Cã€C++ã€Javaï¼Œç§°ä¸ºå®¿ä¸»è¯­è¨€ï¼Œç®€ç§°ä¸»è¯­è¨€ã€‚</p></li><li><p>å¤„ç†è¿‡ç¨‹<br>é¢„ç¼–è¯‘æ–¹æ³•</p></li><li><p>ä¸ºäº†åŒºåˆ†SQLè¯­å¥ä¸ä¸»è¯­è¨€è¯­å¥ï¼Œæ‰€æœ‰SQLè¯­å¥å¿…é¡»åŠ å‰ç¼€EXEC SQLï¼Œ</p><ul><li><p>ä¸»è¯­è¨€ä¸ºCè¯­è¨€æ—¶ï¼Œè¯­å¥æ ¼å¼ï¼š<br>EXEC SQL &lt;SQLè¯­å¥&gt;;</p></li><li><p>ä¸»è¯­è¨€ä¸ºJavaè¯­è¨€æ—¶ï¼Œè¯­å¥æ ¼å¼ï¼š<br># SQL &lt;SQLè¯­å¥&gt;;</p></li><li><p>ä¸»è¯­è¨€ä¸ºC++è¯­è¨€æ—¶</p><p>ä½¿ç”¨ADOï¼š</p></li></ul></li></ul><h3 id="åµŒå…¥å¼SQLè¯­å¥ä¸ä¸»è¯­è¨€ä¹‹é—´çš„é€šä¿¡">åµŒå…¥å¼SQLè¯­å¥ä¸ä¸»è¯­è¨€ä¹‹é—´çš„é€šä¿¡</h3><ul><li><p>å°†SQLåµŒå…¥åˆ°é«˜çº§è¯­è¨€ä¸­æ··åˆç¼–ç¨‹ï¼Œç¨‹åºä¸­ä¼šå«æœ‰ä¸¤ç§ä¸åŒè®¡ç®—æ¨¡å‹çš„è¯­å¥</p><ul><li>SQLè¯­å¥<br>æè¿°æ€§çš„é¢å‘é›†åˆçš„è¯­å¥<br>è´Ÿè´£æ“çºµæ•°æ®åº“</li><li>é«˜çº§è¯­è¨€è¯­å¥<br>è¿‡ç¨‹æ€§çš„é¢å‘è®°å½•çš„è¯­å¥<br>è´Ÿè´£æ§åˆ¶é€»è¾‘æµç¨‹</li><li>å®ƒä»¬ä¹‹é—´åº”è¯¥å¦‚ä½•é€šä¿¡ï¼Ÿ</li></ul></li><li><p>æ•°æ®åº“å·¥ä½œå•å…ƒä¸æºç¨‹åºå·¥ä½œå•å…ƒä¹‹é—´çš„é€šä¿¡<br>ï¼ˆ1ï¼‰å‘ä¸»è¯­è¨€ä¼ é€’SQLè¯­å¥çš„æ‰§è¡ŒçŠ¶æ€ä¿¡æ¯ï¼Œä½¿ä¸»è¯­è¨€èƒ½å¤Ÿæ®æ­¤æ§åˆ¶ç¨‹åºæµç¨‹ï¼Œä¸»è¦ç”¨SQLé€šä¿¡åŒºå®ç°<br>ï¼ˆ2ï¼‰ä¸»è¯­è¨€å‘SQLè¯­å¥æä¾›å‚æ•°ï¼Œä¸»è¦ç”¨ä¸»å˜é‡å®ç°<br>ï¼ˆ3ï¼‰å°†SQLè¯­å¥æŸ¥è¯¢æ•°æ®åº“çš„ç»“æœäº¤ä¸»è¯­è¨€å¤„ç†ï¼Œä¸»è¦ç”¨ä¸»å˜é‡å’Œæ¸¸æ ‡å®ç°</p></li><li><p>SQLCAï¼š SQL Communication Area<br>SQLCAæ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„</p></li><li><p>SQLCAçš„ç”¨é€”</p><ul><li>SQLè¯­å¥æ‰§è¡Œåï¼Œç³»ç»Ÿåé¦ˆç»™åº”ç”¨ç¨‹åºä¿¡æ¯<br>æè¿°ç³»ç»Ÿå½“å‰å·¥ä½œçŠ¶æ€<br>æè¿°è¿è¡Œç¯å¢ƒ</li><li>è¿™äº›ä¿¡æ¯å°†é€åˆ°SQLé€šä¿¡åŒºä¸­</li><li>åº”ç”¨ç¨‹åºä»SQLé€šä¿¡åŒºä¸­å–å‡ºè¿™äº›çŠ¶æ€ä¿¡æ¯ï¼Œæ®æ­¤å†³å®šæ¥ä¸‹æ¥æ‰§è¡Œçš„è¯­å¥</li></ul></li><li><p>SQLCAä½¿ç”¨æ–¹æ³•</p><ul><li>å®šä¹‰SQLCA<ul><li>ç”¨EXEC SQL INCLUDE SQLCAå®šä¹‰</li></ul></li><li>ä½¿ç”¨SQLCA<ul><li>SQLCAä¸­æœ‰ä¸€ä¸ªå­˜æ”¾æ¯æ¬¡æ‰§è¡ŒSQLè¯­å¥åè¿”å›ä»£ç çš„å˜é‡SQLCODE</li><li>å¦‚æœSQLCODEç­‰äºé¢„å®šä¹‰çš„å¸¸é‡SUCCESSï¼Œåˆ™è¡¨ç¤ºSQLè¯­å¥æˆåŠŸï¼Œå¦åˆ™è¡¨ç¤ºå‡ºé”™</li><li>åº”ç”¨ç¨‹åºæ¯æ‰§è¡Œå®Œä¸€æ¡SQL è¯­å¥ä¹‹åéƒ½åº”è¯¥æµ‹è¯•ä¸€ä¸‹SQLCODEçš„å€¼ï¼Œä»¥äº†è§£è¯¥SQLè¯­å¥æ‰§è¡Œæƒ…å†µå¹¶åšç›¸åº”å¤„ç†</li></ul></li></ul></li><li><p>ä¸»å˜é‡</p><ul><li>åµŒå…¥å¼SQLè¯­å¥ä¸­å¯ä»¥ä½¿ç”¨ä¸»è¯­è¨€çš„ç¨‹åºå˜é‡æ¥è¾“å…¥æˆ–è¾“å‡ºæ•°æ®</li><li>åœ¨SQLè¯­å¥ä¸­ä½¿ç”¨çš„ä¸»è¯­è¨€ç¨‹åºå˜é‡ç®€ç§°ä¸ºä¸»å˜é‡ï¼ˆHost Variableï¼‰</li></ul></li><li><p>ä¸»å˜é‡çš„ç±»å‹</p><ul><li>è¾“å…¥ä¸»å˜é‡<br>ç”±åº”ç”¨ç¨‹åºå¯¹å…¶èµ‹å€¼ï¼ŒSQLè¯­å¥å¼•ç”¨</li><li>è¾“å‡ºä¸»å˜é‡<br>ç”±SQLè¯­å¥å¯¹å…¶èµ‹å€¼æˆ–è®¾ç½®çŠ¶æ€ä¿¡æ¯ï¼Œè¿”å›ç»™åº”ç”¨ç¨‹åº</li></ul></li><li><p>æŒ‡ç¤ºå˜é‡</p><ul><li>æ˜¯ä¸€ä¸ªæ•´å‹å˜é‡ï¼Œç”¨æ¥â€œæŒ‡ç¤ºâ€æ‰€æŒ‡ä¸»å˜é‡çš„å€¼æˆ–æ¡ä»¶</li><li>ä¸€ä¸ªä¸»å˜é‡å¯ä»¥é™„å¸¦ä¸€ä¸ªæŒ‡ç¤ºå˜é‡ï¼ˆIndicator Variableï¼‰</li><li>æŒ‡ç¤ºå˜é‡çš„ç”¨é€”<ul><li>æŒ‡ç¤ºè¾“å…¥ä¸»å˜é‡æ˜¯å¦ä¸ºç©ºå€¼</li><li>æ£€æµ‹è¾“å‡ºå˜é‡æ˜¯å¦ä¸ºç©ºå€¼ï¼Œå€¼æ˜¯å¦è¢«æˆªæ–­</li></ul></li></ul></li><li><p>åœ¨SQLè¯­å¥ä¸­ä½¿ç”¨ä¸»å˜é‡å’ŒæŒ‡ç¤ºå˜é‡çš„æ–¹æ³•<br>è¯´æ˜ä¸»å˜é‡å’ŒæŒ‡ç¤ºå˜é‡<br>BEGIN DECLARE SECTION<br>â€¦<br>â€¦  ï¼ˆè¯´æ˜ä¸»å˜é‡å’ŒæŒ‡ç¤ºå˜é‡ï¼‰<br>â€¦<br>END DECLARE SECTION</p></li><li><p>åœ¨SQLè¯­å¥ä¸­ä½¿ç”¨ä¸»å˜é‡å’ŒæŒ‡ç¤ºå˜é‡çš„æ–¹æ³•ï¼ˆç»­ï¼‰</p><ul><li>ä½¿ç”¨ä¸»å˜é‡<br>è¯´æ˜ä¹‹åçš„ä¸»å˜é‡å¯ä»¥åœ¨SQLè¯­å¥ä¸­ä»»ä½•ä¸€ä¸ªèƒ½å¤Ÿä½¿ç”¨è¡¨è¾¾å¼çš„åœ°æ–¹å‡ºç°<br>ä¸ºäº†ä¸æ•°æ®åº“å¯¹è±¡åï¼ˆè¡¨åã€è§†å›¾åã€åˆ—åç­‰ï¼‰åŒºåˆ«ï¼ŒSQLè¯­å¥ä¸­çš„ä¸»å˜é‡åå‰è¦åŠ å†’å·ï¼ˆ:ï¼‰ä½œä¸ºæ ‡å¿—</li><li>ä½¿ç”¨æŒ‡ç¤ºå˜é‡<br>æŒ‡ç¤ºå˜é‡å‰ä¹Ÿå¿…é¡»åŠ å†’å·æ ‡å¿—<br>å¿…é¡»ç´§è·Ÿåœ¨æ‰€æŒ‡ä¸»å˜é‡ä¹‹å</li></ul></li><li><p>åœ¨SQLè¯­å¥ä¹‹å¤–ï¼ˆä¸»è¯­è¨€è¯­å¥ä¸­ï¼‰ä½¿ç”¨ä¸»å˜é‡å’ŒæŒ‡ç¤ºå˜é‡çš„æ–¹æ³•<br>å¯ä»¥ç›´æ¥å¼•ç”¨ï¼Œä¸å¿…åŠ å†’å·</p></li><li><p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¸¸æ ‡</p><ul><li>SQLè¯­è¨€ä¸ä¸»è¯­è¨€å…·æœ‰ä¸åŒæ•°æ®å¤„ç†æ–¹å¼</li><li>SQLè¯­è¨€æ˜¯é¢å‘é›†åˆçš„ï¼Œä¸€æ¡SQLè¯­å¥åŸåˆ™ä¸Šå¯ä»¥äº§ç”Ÿæˆ–å¤„ç†å¤šæ¡è®°å½•</li><li>ä¸»è¯­è¨€æ˜¯é¢å‘è®°å½•çš„ï¼Œä¸€ç»„ä¸»å˜é‡ä¸€æ¬¡åªèƒ½å­˜æ”¾ä¸€æ¡è®°å½•</li><li>ä»…ä½¿ç”¨ä¸»å˜é‡å¹¶ä¸èƒ½å®Œå…¨æ»¡è¶³SQLè¯­å¥å‘åº”ç”¨ç¨‹åºè¾“å‡ºæ•°æ®çš„è¦æ±‚</li><li>åµŒå…¥å¼SQLå¼•å…¥äº†æ¸¸æ ‡çš„æ¦‚å¿µï¼Œç”¨æ¥åè°ƒè¿™ä¸¤ç§ä¸åŒçš„å¤„ç†æ–¹å¼</li></ul></li><li><p>æ¸¸æ ‡</p><ul><li>æ¸¸æ ‡æ˜¯ç³»ç»Ÿä¸ºç”¨æˆ·å¼€è®¾çš„ä¸€ä¸ªæ•°æ®ç¼“å†²åŒºï¼Œå­˜æ”¾SQLè¯­å¥çš„æ‰§è¡Œç»“æœ</li><li>æ¯ä¸ªæ¸¸æ ‡åŒºéƒ½æœ‰ä¸€ä¸ªåå­—</li><li>ç”¨æˆ·å¯ä»¥ç”¨SQLè¯­å¥é€ä¸€ä»æ¸¸æ ‡ä¸­è·å–è®°å½•ï¼Œå¹¶èµ‹ç»™ä¸»å˜é‡ï¼Œäº¤ç”±ä¸»è¯­è¨€è¿›ä¸€æ­¥å¤„ç†</li></ul></li><li><p>å»ºç«‹æ•°æ®åº“è¿æ¥<br>EXEC SQL CONNECT TO target[AS connection-name][USER user-name];<br>targetæ˜¯è¦è¿æ¥çš„æ•°æ®åº“æœåŠ¡å™¨<br>å¸¸è§çš„æœåŠ¡å™¨æ ‡è¯†ä¸²ï¼Œå¦‚<dbname>@<hostname>:<port><br>åŒ…å«æœåŠ¡å™¨æ ‡è¯†çš„SQLä¸²å¸¸é‡<br>DEFAULT</p></li><li><p>connect-nameæ˜¯å¯é€‰çš„è¿æ¥åï¼Œè¿æ¥åå¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ ‡è¯†ç¬¦</p></li><li><p>åœ¨æ•´ä¸ªç¨‹åºå†…åªæœ‰ä¸€ä¸ªè¿æ¥æ—¶å¯ä»¥ä¸æŒ‡å®šè¿æ¥å</p></li><li><p>ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å¯ä»¥ä¿®æ”¹å½“å‰è¿æ¥<br>EXEC SQL SET CONNECTION connection-name<br>|DEFAULT;</p></li><li><p>å…³é—­æ•°æ®åº“è¿æ¥<br>EXEC SQL DISCONNECT [connection];</p></li></ul><h3 id="ä¸ç”¨æ¸¸æ ‡çš„SQLè¯­å¥">ä¸ç”¨æ¸¸æ ‡çš„SQLè¯­å¥</h3><ul><li>ä¸ç”¨æ¸¸æ ‡çš„SQLè¯­å¥çš„ç§ç±»<ul><li>è¯´æ˜æ€§è¯­å¥</li><li>æ•°æ®å®šä¹‰è¯­å¥</li><li>æ•°æ®æ§åˆ¶è¯­å¥</li><li>æŸ¥è¯¢ç»“æœä¸ºå•è®°å½•çš„SELECTè¯­å¥</li><li>éCURRENTå½¢å¼çš„å¢åˆ æ”¹è¯­å¥</li></ul></li></ul><h3 id="ä½¿ç”¨æ¸¸æ ‡çš„SQLè¯­å¥">ä½¿ç”¨æ¸¸æ ‡çš„SQLè¯­å¥</h3><ul><li>å¿…é¡»ä½¿ç”¨æ¸¸æ ‡çš„SQLè¯­å¥<ul><li>æŸ¥è¯¢ç»“æœä¸ºå¤šæ¡è®°å½•çš„SELECTè¯­å¥</li><li>CURRENTå½¢å¼çš„UPDATEè¯­å¥</li><li>CURRENTå½¢å¼çš„DELETEè¯­å¥</li></ul></li></ul><h3 id="åŠ¨æ€SQL">åŠ¨æ€SQL</h3><ul><li>é™æ€åµŒå…¥å¼SQL<br>é™æ€åµŒå…¥å¼SQLè¯­å¥èƒ½å¤Ÿæ»¡è¶³ä¸€èˆ¬è¦æ±‚<br>æ— æ³•æ»¡è¶³è¦åˆ°æ‰§è¡Œæ—¶æ‰èƒ½å¤Ÿç¡®å®šè¦æäº¤çš„SQLè¯­å¥ã€æŸ¥è¯¢çš„æ¡ä»¶</li><li>åŠ¨æ€åµŒå…¥å¼SQL<br>å…è®¸åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä¸´æ—¶â€œç»„è£…â€SQLè¯­å¥<br>æ”¯æŒåŠ¨æ€ç»„è£…SQLè¯­å¥å’ŒåŠ¨æ€å‚æ•°ä¸¤ç§å½¢å¼</li></ul><ol><li><p>ä½¿ç”¨SQLè¯­å¥ä¸»å˜é‡</p></li><li><p>åŠ¨æ€å‚æ•°æ‰§è¡Œå‡†å¤‡å¥½çš„è¯­å¥ï¼ˆEXECUTEï¼‰</p></li><li><p>åŠ¨æ€å‚æ•°</p></li></ol><ul><li><p>ä¸»å˜é‡</p></li><li><p>[ä¾‹8.6]  åˆ›å»ºåŸºæœ¬è¡¨TESTã€‚</p><p>â€‹EXEC SQL BEGIN DECLARE SECTION;<br>â€‹       const char *stmt=â€œCREATE TABLE test(a int);â€;<br>â€‹               /<em>SQLè¯­å¥ä¸»å˜é‡ï¼Œå†…å®¹æ˜¯åˆ›å»ºè¡¨çš„SQLè¯­å¥</em>/<br>â€‹EXEC SQL END DECLARE SECTION;<br>â€‹    â€¦<br>â€‹EXEC SQL EXECUTE IMMEDIATE :stmt;<br>â€‹               /<em>æ‰§è¡ŒåŠ¨æ€SQLè¯­å¥</em>/</p></li><li><p>åŠ¨æ€å‚æ•°</p><ul><li>SQLè¯­å¥ä¸­çš„å¯å˜å…ƒç´ </li><li>ä½¿ç”¨å‚æ•°ç¬¦å·ï¼ˆ?ï¼‰è¡¨ç¤ºè¯¥ä½ç½®çš„æ•°æ®åœ¨è¿è¡Œæ—¶è®¾å®š</li><li>å’Œä¸»å˜é‡çš„åŒºåˆ«<ul><li>åŠ¨æ€å‚æ•°çš„è¾“å…¥ä¸æ˜¯ç¼–è¯‘æ—¶å®Œæˆç»‘å®š</li><li>è€Œæ˜¯é€šè¿‡ PREPAREè¯­å¥å‡†å¤‡ä¸»å˜é‡å’Œæ‰§è¡Œè¯­å¥EXECUTEç»‘å®šæ•°æ®æˆ–ä¸»å˜é‡æ¥å®Œæˆ</li></ul></li></ul></li><li><p>ä½¿ç”¨åŠ¨æ€å‚æ•°çš„æ­¥éª¤<br>ï¼ˆ1ï¼‰å£°æ˜SQLè¯­å¥ä¸»å˜é‡<br>ï¼ˆ2ï¼‰å‡†å¤‡SQLè¯­å¥ï¼ˆPREPAREï¼‰<br>EXEC SQL PREPARE &lt;è¯­å¥å&gt;<br>FROM &lt;SQLè¯­å¥ä¸»å˜é‡&gt;;</p><p>EXEC SQL EXECUTE &lt;è¯­å¥å&gt;<br>[INTO &lt;ä¸»å˜é‡è¡¨&gt;]<br>[USING &lt;ä¸»å˜é‡æˆ–å¸¸é‡&gt;];</p></li><li><p>å‡†å¤‡å¥½çš„SQL</p></li><li><p>[ä¾‹8.7] å‘TESTä¸­æ’å…¥å…ƒç»„ã€‚<br>EXEC SQL BEGIN DECLARE SECTION;<br>const char *stmt = â€œINSERT INTO test VALUES(?);â€;<br>/*å£°æ˜SQLä¸»å˜é‡å†…å®¹æ˜¯INSERTè¯­å¥ */<br>EXEC SQL END DECLARE SECTION;<br>â€¦<br>EXEC SQL PREPARE mystmt FROM :stmt; /<em>å‡†å¤‡è¯­å¥</em>/<br>â€¦<br>EXEC SQL EXECUTE mystmt USING 100;<br>/*æ‰§è¡Œè¯­å¥ï¼Œè®¾å®šINSERTè¯­å¥æ’å…¥å€¼100 <em>/<br>EXEC SQL EXECUTE mystmt USING 200;<br>/</em> æ‰§è¡Œè¯­å¥ï¼Œè®¾å®šINSERTè¯­å¥æ’å…¥å€¼200 */</p></li></ul><h2 id="è¿‡ç¨‹åŒ–SQL">è¿‡ç¨‹åŒ–SQL</h2><h3 id="è¿‡ç¨‹åŒ–SQLçš„å—ç»“æ„">è¿‡ç¨‹åŒ–SQLçš„å—ç»“æ„</h3><ul><li><p>SQLçš„æ‰©å±•</p><ul><li>å¢åŠ äº†è¿‡ç¨‹åŒ–è¯­å¥åŠŸèƒ½</li><li>åŸºæœ¬ç»“æ„æ˜¯å—</li><li>å—ä¹‹é—´å¯ä»¥äº’ç›¸åµŒå¥—</li><li>æ¯ä¸ªå—å®Œæˆä¸€ä¸ªé€»è¾‘æ“ä½œ</li></ul></li><li><p>è¿‡ç¨‹åŒ–SQLå—çš„åŸºæœ¬ç»“æ„</p><ol><li><p>å®šä¹‰éƒ¨åˆ†<br>DECLARE å˜é‡ã€å¸¸é‡ã€æ¸¸æ ‡ã€å¼‚å¸¸ç­‰<br>å®šä¹‰çš„å˜é‡ã€å¸¸é‡ç­‰åªèƒ½åœ¨è¯¥åŸºæœ¬å—ä¸­ä½¿ç”¨<br>å½“åŸºæœ¬å—æ‰§è¡Œç»“æŸæ—¶ï¼Œå®šä¹‰å°±ä¸å†å­˜åœ¨</p></li><li><p>æ‰§è¡Œéƒ¨åˆ†<br>BEGIN</p><p>SQLè¯­å¥ã€è¿‡ç¨‹åŒ–SQLçš„æµç¨‹æ§åˆ¶è¯­å¥</p></li></ol><p>EXCEPTION<br>å¼‚å¸¸å¤„ç†éƒ¨åˆ†        <br>ENDï¼›</p></li></ul><h3 id="å˜é‡å’Œå¸¸é‡çš„å®šä¹‰">å˜é‡å’Œå¸¸é‡çš„å®šä¹‰</h3><ol><li>å˜é‡å®šä¹‰<br>å˜é‡å æ•°æ®ç±»å‹ [[NOT NULL]:=åˆå€¼è¡¨è¾¾å¼]æˆ–<br>å˜é‡å æ•°æ®ç±»å‹ [[NOT NULL] åˆå€¼è¡¨è¾¾å¼]</li><li>å¸¸é‡å®šä¹‰<br>å¸¸é‡å æ•°æ®ç±»å‹ CONSTANT :=å¸¸é‡è¡¨è¾¾å¼<br>å¸¸é‡å¿…é¡»è¦ç»™ä¸€ä¸ªå€¼ï¼Œå¹¶ä¸”è¯¥å€¼åœ¨å­˜åœ¨æœŸé—´æˆ–å¸¸é‡çš„ä½œç”¨åŸŸå†…ä¸èƒ½æ”¹å˜ã€‚å¦‚æœè¯•å›¾ä¿®æ”¹å®ƒï¼Œè¿‡ç¨‹åŒ–SQLå°†è¿”å›ä¸€ä¸ªå¼‚å¸¸</li><li>èµ‹å€¼è¯­å¥<br>å˜é‡åç§° :=è¡¨è¾¾å¼</li></ol><h3 id="æµç¨‹æ§åˆ¶">æµç¨‹æ§åˆ¶</h3><p>è¿‡ç¨‹åŒ–SQLåŠŸèƒ½</p><ol><li><p>æ¡ä»¶æ§åˆ¶è¯­å¥</p></li><li><p>å¾ªç¯æ§åˆ¶è¯­å¥</p></li><li><p>é”™è¯¯å¤„ç†</p></li></ol><ul><li><p>æ¡ä»¶æ§åˆ¶è¯­å¥<br>IF-THENï¼ŒIF-THEN-ELSEå’ŒåµŒå¥—çš„IFè¯­å¥<br>ï¼ˆ1ï¼‰IF condition THEN<br>Sequence_of_statements;<br>END IF;<br>ï¼ˆ2ï¼‰IF condition THEN<br>Sequence_of_statements1;<br>ELSE<br>Sequence_of_statements2;<br>END IF;<br>ï¼ˆ3ï¼‰åœ¨THENå’ŒELSEå­å¥ä¸­è¿˜å¯ä»¥å†åŒ…å«IFè¯­å¥ï¼Œå³IFè¯­å¥å¯ä»¥åµŒå¥—</p></li><li><p>å¾ªç¯æ§åˆ¶è¯­å¥<br>LOOPï¼ŒWHILE-LOOPå’ŒFOR-LOOP<br>ï¼ˆ1ï¼‰ç®€å•çš„å¾ªç¯è¯­å¥LOOP<br>LOOP<br>Sequence_of_statements;<br>END LOOP;<br>å¤šæ•°æ•°æ®åº“æœåŠ¡å™¨çš„è¿‡ç¨‹åŒ–SQLéƒ½æä¾›EXITã€BREAKæˆ–<br>LEAVEç­‰å¾ªç¯ç»“æŸè¯­å¥ï¼Œä¿è¯LOOPè¯­å¥å—èƒ½å¤Ÿç»“æŸ</p><p>ï¼ˆ2ï¼‰WHILE-LOOP<br>WHILE condition LOOP<br>Sequence_of_statements;<br>END LOOP;<br>æ¯æ¬¡æ‰§è¡Œå¾ªç¯ä½“è¯­å¥ä¹‹å‰ï¼Œé¦–å…ˆå¯¹æ¡ä»¶è¿›è¡Œæ±‚å€¼<br>å¦‚æœæ¡ä»¶ä¸ºçœŸï¼Œåˆ™æ‰§è¡Œå¾ªç¯ä½“å†…çš„è¯­å¥åºåˆ—<br>å¦‚æœæ¡ä»¶ä¸ºå‡ï¼Œåˆ™è·³è¿‡å¾ªç¯å¹¶æŠŠæ§åˆ¶ä¼ é€’ç»™ä¸‹ä¸€ä¸ªè¯­å¥</p><p>ï¼ˆ3ï¼‰FOR-LOOP<br>FOR count IN [REVERSE] bound1 â€¦ bound2 LOOP<br>Sequence_of_statements;<br>END LOOP;</p></li><li><ol start="3"><li>é”™è¯¯å¤„ç†</li></ol><ul><li>å¦‚æœè¿‡ç¨‹åŒ–SQLåœ¨æ‰§è¡Œæ—¶å‡ºç°å¼‚å¸¸ï¼Œåˆ™åº”è¯¥è®©ç¨‹åºåœ¨äº§ç”Ÿå¼‚å¸¸çš„è¯­å¥å¤„åœä¸‹æ¥ï¼Œæ ¹æ®å¼‚å¸¸çš„ç±»å‹å»æ‰§è¡Œå¼‚å¸¸å¤„ç†è¯­å¥</li><li>SQLæ ‡å‡†å¯¹æ•°æ®åº“æœåŠ¡å™¨æä¾›ä»€ä¹ˆæ ·çš„å¼‚å¸¸å¤„ç†åšå‡ºäº†å»ºè®®ï¼Œè¦æ±‚è¿‡ç¨‹åŒ–SQLç®¡ç†å™¨æä¾›å®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶</li></ul></li></ul><h2 id="å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°">å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°</h2><h3 id="å­˜å‚¨è¿‡ç¨‹">å­˜å‚¨è¿‡ç¨‹</h3><ul><li><p>è¿‡ç¨‹åŒ–SQLå—ç±»å‹</p><ul><li>å‘½åå—<br>ç¼–è¯‘åä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œå¯ä»¥è¢«åå¤è°ƒç”¨ï¼Œè¿è¡Œé€Ÿåº¦è¾ƒå¿«ï¼Œè¿‡ç¨‹å’Œå‡½æ•°æ˜¯å‘½åå—</li><li>åŒ¿åå—<br>æ¯æ¬¡æ‰§è¡Œæ—¶éƒ½è¦è¿›è¡Œç¼–è¯‘ï¼Œå®ƒä¸èƒ½è¢«å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œä¹Ÿä¸èƒ½åœ¨å…¶ä»–è¿‡ç¨‹åŒ–SQLå—ä¸­è°ƒç”¨</li></ul></li><li><p>å­˜å‚¨è¿‡ç¨‹ï¼š</p><p>ç”±è¿‡ç¨‹åŒ–SQLè¯­å¥ä¹¦å†™çš„è¿‡ç¨‹ï¼Œç»ç¼–è¯‘å’Œä¼˜åŒ–åå­˜å‚¨åœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸­ï¼Œä½¿ç”¨æ—¶åªè¦è°ƒç”¨å³å¯ã€‚</p><ul><li>å­˜å‚¨è¿‡ç¨‹çš„ä¼˜ç‚¹<br>ï¼ˆ1ï¼‰è¿è¡Œæ•ˆç‡é«˜<br>ï¼ˆ2ï¼‰é™ä½äº†å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡é‡<br>ï¼ˆ3ï¼‰æ–¹ä¾¿å®æ–½ä¼ä¸šè§„åˆ™</li></ul></li><li><p>å­˜å‚¨è¿‡ç¨‹çš„ç”¨æˆ·æ¥å£<br>ï¼ˆ1ï¼‰åˆ›å»ºå­˜å‚¨è¿‡ç¨‹<br>ï¼ˆ2ï¼‰æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹<br>ï¼ˆ3ï¼‰ä¿®æ”¹å­˜å‚¨è¿‡ç¨‹<br>ï¼ˆ4ï¼‰åˆ é™¤å­˜å‚¨è¿‡ç¨‹</p></li><li><p>ï¼ˆ1ï¼‰åˆ›å»ºå­˜å‚¨è¿‡ç¨‹<br>CREATE OR REPLACE PROCEDURE è¿‡ç¨‹å([å‚æ•°1,å‚æ•°2,â€¦]) AS &lt;è¿‡ç¨‹åŒ–SQLå—&gt;ï¼›<br>è¿‡ç¨‹åï¼šæ•°æ®åº“æœåŠ¡å™¨åˆæ³•çš„å¯¹è±¡æ ‡è¯†<br>å‚æ•°åˆ—è¡¨ï¼šç”¨åå­—æ¥æ ‡è¯†è°ƒç”¨æ—¶ç»™å‡ºçš„å‚æ•°å€¼ï¼Œå¿…é¡»æŒ‡å®šå€¼çš„æ•°æ®ç±»å‹ã€‚å‚æ•°ä¹Ÿå¯ä»¥å®šä¹‰è¾“å…¥å‚æ•°ã€è¾“å‡ºå‚æ•°æˆ–è¾“å…¥/è¾“å‡ºå‚æ•°ï¼Œé»˜è®¤ä¸ºè¾“å…¥å‚æ•°<br>è¿‡ç¨‹ä½“ï¼šæ˜¯ä¸€ä¸ª&lt;è¿‡ç¨‹åŒ–SQLå—&gt;ï¼ŒåŒ…æ‹¬å£°æ˜éƒ¨åˆ†å’Œå¯æ‰§è¡Œè¯­å¥éƒ¨åˆ†</p></li><li><p>[ä¾‹8.8] åˆ©ç”¨å­˜å‚¨è¿‡ç¨‹æ¥å®ç°ä¸‹é¢çš„åº”ç”¨ï¼šä»è´¦æˆ·1è½¬æŒ‡å®šæ•°é¢çš„æ¬¾é¡¹åˆ°è´¦æˆ·2ä¸­ã€‚</p><p>â€‹CREATE OR REPLACE PROCEDURE TRANSFER(inAccount INT,outAccount  INT,amount FLOAT)<br>â€‹       /<em>å®šä¹‰å­˜å‚¨è¿‡ç¨‹TRANSFERï¼Œå…¶å‚æ•°ä¸ºè½¬å…¥è´¦æˆ·ã€è½¬å‡ºè´¦æˆ·ã€è½¬è´¦é¢åº¦</em>/<br>â€‹AS DECLARE/<em>å®šä¹‰å˜é‡</em>/<br>â€‹        totalDepositOut Float;<br>â€‹             totalDepositIn Float;<br>â€‹inAccountnum INT;</p><p>BEGIN                             /*æ£€æŸ¥è½¬å‡ºè´¦æˆ·çš„ä½™é¢ */<br>SELECT Total INTO totalDepositOut FROM Accout<br>WHERE accountnum=outAccount;<br>IF totalDepositOut IS NULL THEN<br>/<em>å¦‚æœè½¬å‡ºè´¦æˆ·ä¸å­˜åœ¨æˆ–è´¦æˆ·ä¸­æ²¡æœ‰å­˜æ¬¾</em>/<br>ROLLBACK;    /<em>å›æ»šäº‹åŠ¡</em>/<br>RETURN;<br>END IF;</p><p>IF totalDeposit Out&lt; amount THEN    /<em>å¦‚æœè´¦æˆ·å­˜æ¬¾ä¸è¶³</em>/<br>ROLLBACK; /<em>å›æ»šäº‹åŠ¡</em>/<br>RETURN;<br>END IF;</p><p>SELECT Accountnum INTO inAccountnum FROM Account<br>WHERE accountnum=inAccount;</p><p>IF inAccount IS NULL THEN  /<em>å¦‚æœè½¬å…¥è´¦æˆ·ä¸å­˜åœ¨</em>/<br>ROLLBACK;           /<em>å›æ»šäº‹åŠ¡</em>/<br>RETURN;<br>ENDIF;</p><p>UPDATE Account SET total=total-amount WHERE accountnum=outAccount;<br>/* ä¿®æ”¹è½¬å‡ºè´¦æˆ·ä½™é¢ï¼Œå‡å»è½¬å‡ºé¢ <em>/<br>UPDATE Account SET total=total + amount<br>WHERE   accountnum=inAccount;<br>/</em> ä¿®æ”¹è½¬å…¥è´¦æˆ·ä½™é¢ï¼Œå¢åŠ è½¬å…¥é¢ <em>/<br>COMMIT;                       /</em> æäº¤è½¬è´¦äº‹åŠ¡ */<br>END;</p></li><li><p>ï¼ˆ2ï¼‰æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹<br>CALL/PERFORM  PROCEDURE è¿‡ç¨‹å([å‚æ•°1,å‚æ•°2,â€¦])ï¼›<br>ä½¿ç”¨CALLæˆ–è€…PERFORMç­‰æ–¹å¼æ¿€æ´»å­˜å‚¨è¿‡ç¨‹çš„æ‰§è¡Œ<br>åœ¨è¿‡ç¨‹åŒ–SQLä¸­ï¼Œæ•°æ®åº“æœåŠ¡å™¨æ”¯æŒåœ¨è¿‡ç¨‹ä½“ä¸­è°ƒç”¨å…¶ä»–å­˜å‚¨è¿‡ç¨‹</p></li><li><p>[ä¾‹8.9] ä»è´¦æˆ·01003815868è½¬10000å…ƒåˆ°01003813828è´¦æˆ·ä¸­ã€‚<br>CALL PROCEDURE TRANSFER(01003813828,01003815868,10000);</p></li><li><p>ï¼ˆ3ï¼‰ä¿®æ”¹å­˜å‚¨è¿‡ç¨‹<br>ALTER PROCEDURE è¿‡ç¨‹å1  RENAME TO è¿‡ç¨‹å2;</p></li><li><p>ï¼ˆ4ï¼‰åˆ é™¤å­˜å‚¨è¿‡ç¨‹<br>DROP  PROCEDURE è¿‡ç¨‹å()ï¼›</p></li></ul><h3 id="å‡½æ•°">å‡½æ•°</h3><ul><li>å‡½æ•°å’Œå­˜å‚¨è¿‡ç¨‹çš„å¼‚åŒ<br>åŒï¼šéƒ½æ˜¯æŒä¹…æ€§å­˜å‚¨æ¨¡å—<br>å¼‚ï¼šå‡½æ•°å¿…é¡»æŒ‡å®šè¿”å›çš„ç±»å‹</li></ul><ol><li>å‡½æ•°çš„å®šä¹‰è¯­å¥æ ¼å¼<br>CREATE OR REPLACE FUNCTION å‡½æ•°å ([å‚æ•°1,å‚æ•°2,â€¦]) RETURNS &lt;ç±»å‹&gt;  AS &lt;è¿‡ç¨‹åŒ–SQLå—&gt;;</li><li>å‡½æ•°çš„æ‰§è¡Œè¯­å¥æ ¼å¼<br>CALL/SELECT å‡½æ•°å ([å‚æ•°1,å‚æ•°2,â€¦]);</li><li>ä¿®æ”¹å‡½æ•°<br>é‡å‘½å<br>ALTER FUNCTION è¿‡ç¨‹å1 RENAME TO è¿‡ç¨‹å2;<br>é‡æ–°ç¼–è¯‘<br>ALTER FUNCTION è¿‡ç¨‹å COMPILE;</li></ol><p>å­˜å‚¨è¿‡ç¨‹ï¼š</p><ul><li>ä¼˜ç‚¹ï¼š<ul><li>æœ‰if/else,case,whileç­‰æ§åˆ¶è¯­å¥ï¼Œé€šè¿‡ç¼–å†™å­˜å‚¨è¿‡ç¨‹ï¼Œå¯ä»¥å®ç°ä¸€äº›é€»è¾‘æ¯”è¾ƒå¤æ‚çš„åŠŸèƒ½ï¼›</li><li>æ¨¡å—åŒ–ï¼›å¯¹ä¸€äº›åŠŸèƒ½è¿›è¡Œäº†å°è£…ï¼Œä»£ç çš„å¤ç”¨ï¼›</li><li>å“åº”é€Ÿåº¦å¿«ï¼Œåªæœ‰åœ¨é¦–æ¬¡æ‰§è¡Œæ—¶éœ€è¦ç»è¿‡ç¼–è¯‘å’Œä¼˜åŒ–æ­¥éª¤ï¼Œåè¢«è°ƒç”¨ç›´æ¥æ‰§è¡Œï¼Œçœå»äº†é‡æ–°ç¼–å†™ä»£ç è®¡ç®—çš„æ­¥éª¤ã€‚</li><li>å‡å°‘ç½‘ç»œä¼ è¾“ã€‚å­˜å‚¨è¿‡ç¨‹ç›´æ¥å°±åœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸Šè·‘ï¼Œæ‰€æœ‰çš„æ•°æ®è®¿é—®éƒ½åœ¨æœåŠ¡å™¨å†…éƒ¨è¿›è¡Œï¼Œä¸éœ€è¦ä¼ è¾“æ•°æ®åˆ°å…¶å®ƒç»ˆç«¯ã€‚</li><li>æ–¹ä¾¿DBAä¼˜åŒ–ã€‚æ‰€æœ‰çš„SQLé›†ä¸­åœ¨ä¸€ä¸ªåœ°æ–¹</li></ul></li><li>ç¼ºç‚¹ï¼š<br>å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ã€‚æ²¡åŠæ³•åº”ç”¨ç¼“å­˜ã€‚</li></ul><p>è§¦å‘å™¨</p><ul><li>ä¼˜ç‚¹ï¼š<ul><li>å®‰å…¨ã€‚ä»¥åŸºäºæ•°æ®åº“çš„å€¼ä½¿ç”¨æˆ·å…·æœ‰æ“ä½œæ•°æ®åº“çš„æŸç§æƒåˆ©ã€‚å¯ä»¥è·Ÿè¸ªç”¨æˆ·å¯¹æ•°æ®åº“çš„æ“ä½œã€‚</li><li>è§¦å‘å™¨èƒ½å¤Ÿæ‹’ç»æˆ–å›é€€é‚£äº›ç ´åç›¸å…³å®Œæ•´æ€§çš„å˜åŒ–ï¼Œå–æ¶ˆè¯•å›¾è¿›è¡Œæ•°æ®æ›´æ–°çš„äº‹åŠ¡ã€‚å½“æ’å…¥ä¸€ä¸ªä¸å…¶ä¸»å¥ä¸åŒ¹é…çš„å¤–éƒ¨é”®æ—¶ï¼Œè¿™ç§è§¦å‘å™¨ä¼šèµ·ä½œç”¨ã€‚</li></ul></li><li>ç¼ºç‚¹ï¼š*æ•°æ®é›†æ•°æ®é‡åˆè¾ƒå¤§æ—¶ï¼Œè§¦å‘å™¨æ•ˆæœä¼šéå¸¸ä½ï¼ˆå› ä¸ºè‡ªåŠ¨è®¡ç®—æ•°æ®å€¼ï¼Œéœ€è¦å˜åŠ¨æ•´ä¸ªæ•°æ®é›†å¯¼è‡´æ•ˆç‡ä¸‹é™ï¼‰<ul><li>å¯¹äºæ‰¹é‡æ“ä½œå¹¶ä¸é€‚åˆä½¿ç”¨è§¦å‘å™¨ï¼Œä½¿ç”¨è§¦å‘å™¨å®ç°çš„ä¸šåŠ¡é€»è¾‘åœ¨å‡ºç°é—®é¢˜æ—¶å¾ˆéš¾è¿›è¡Œå®šä½ã€‚</li></ul></li></ul><h2 id="ODBCç¼–ç¨‹">ODBCç¼–ç¨‹</h2><ul><li>ODBCä¼˜ç‚¹<ul><li>ç§»æ¤æ€§å¥½</li><li>èƒ½åŒæ—¶è®¿é—®ä¸åŒçš„æ•°æ®åº“</li><li>å…±äº«å¤šä¸ªæ•°æ®èµ„æº</li></ul></li></ul><h3 id="ODBCæ¦‚è¿°">ODBCæ¦‚è¿°</h3><ul><li><p>ODBCäº§ç”Ÿçš„åŸå› </p><ul><li>ç”±äºä¸åŒçš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„å­˜åœ¨ï¼Œåœ¨æŸä¸ªå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸‹ç¼–å†™çš„åº”ç”¨ç¨‹åºå°±ä¸èƒ½åœ¨å¦ä¸€ä¸ªå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸‹è¿è¡Œ</li><li>è®¸å¤šåº”ç”¨ç¨‹åºéœ€è¦å…±äº«å¤šä¸ªéƒ¨é—¨çš„æ•°æ®èµ„æºï¼Œè®¿é—®ä¸åŒçš„å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ</li></ul></li><li><p>ODBC</p><ul><li>æ˜¯å¾®è½¯å…¬å¸å¼€æ”¾æœåŠ¡ä½“ç³»ï¼ˆWindows Open Services Architectureï¼ŒWOSAï¼‰ä¸­æœ‰å…³æ•°æ®åº“çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†</li><li>æä¾›äº†ä¸€ç»„è®¿é—®æ•°æ®åº“çš„åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼ˆApplication Programming Interfaceï¼ŒAPI ï¼‰</li></ul></li><li><p>ODBCçº¦æŸåŠ›</p><ul><li>è§„èŒƒåº”ç”¨å¼€å‘</li><li>è§„èŒƒå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿåº”ç”¨æ¥å£</li></ul></li></ul><h3 id="ODBCå·¥ä½œåŸç†æ¦‚è¿°">ODBCå·¥ä½œåŸç†æ¦‚è¿°</h3><ul><li><p>ODBCåº”ç”¨ç³»ç»Ÿçš„ä½“ç³»ç»“æ„</p><ol><li><p>ç”¨æˆ·åº”ç”¨ç¨‹åº</p></li><li><p>ODBCé©±åŠ¨ç¨‹åºç®¡ç†å™¨</p></li><li><p>æ•°æ®åº“é©±åŠ¨ç¨‹åº</p></li><li><p>æ•°æ®æº</p></li></ol></li><li><p>ODBCåº”ç”¨ç¨‹åºåŒ…æ‹¬çš„å†…å®¹</p><ul><li>è¯·æ±‚è¿æ¥æ•°æ®åº“</li><li>å‘æ•°æ®æºå‘é€SQLè¯­å¥</li><li>ä¸ºSQLè¯­å¥æ‰§è¡Œç»“æœåˆ†é…å­˜å‚¨ç©ºé—´ï¼Œå®šä¹‰æ‰€è¯»å–çš„æ•°æ®æ ¼å¼</li><li>è·å–æ•°æ®åº“æ“ä½œç»“æœæˆ–å¤„ç†é”™è¯¯</li><li>è¿›è¡Œæ•°æ®å¤„ç†å¹¶å‘ç”¨æˆ·æäº¤å¤„ç†ç»“æœ</li><li>è¯·æ±‚äº‹åŠ¡çš„æäº¤å’Œå›æ»šæ“ä½œ</li><li>æ–­å¼€ä¸æ•°æ®æºçš„è¿æ¥</li></ul></li><li><p>é©±åŠ¨ç¨‹åºç®¡ç†å™¨ï¼šç”¨æ¥ç®¡ç†å„ç§é©±åŠ¨ç¨‹åº</p><ul><li>åŒ…å«åœ¨ODBC32.DLLä¸­</li><li>ç®¡ç†åº”ç”¨ç¨‹åºå’Œé©±åŠ¨ç¨‹åºä¹‹é—´çš„é€šä¿¡</li><li>å»ºç«‹ã€é…ç½®æˆ–åˆ é™¤æ•°æ®æºï¼Œå¹¶æŸ¥çœ‹ç³»ç»Ÿå½“å‰æ‰€å®‰è£…çš„æ•°æ®åº“ODBCé©±åŠ¨ç¨‹åº</li></ul></li><li><p>ä¸»è¦åŠŸèƒ½ï¼š</p><ul><li>è£…è½½ODBCé©±åŠ¨ç¨‹åº</li><li>é€‰æ‹©å’Œè¿æ¥æ­£ç¡®çš„é©±åŠ¨ç¨‹åº</li><li>ç®¡ç†æ•°æ®æº</li><li>æ£€æŸ¥ODBCè°ƒç”¨å‚æ•°çš„åˆæ³•æ€§</li><li>è®°å½•ODBCå‡½æ•°çš„è°ƒç”¨ç­‰</li></ul></li><li><p>ODBCé©±åŠ¨ç¨‹åºç±»å‹</p><ul><li>å•æŸ<br>æ•°æ®æºå’Œåº”ç”¨ç¨‹åºåœ¨åŒä¸€å°æœºå™¨ä¸Š<br>é©±åŠ¨ç¨‹åºç›´æ¥å®Œæˆå¯¹æ•°æ®æ–‡ä»¶çš„I/Oæ“ä½œ<br>é©±åŠ¨ç¨‹åºç›¸å½“äºæ•°æ®ç®¡ç†å™¨</li><li>å¤šæŸ<br>æ”¯æŒå®¢æˆ·æœºâ€”æœåŠ¡å™¨ã€å®¢æˆ·æœºâ€”åº”ç”¨æœåŠ¡å™¨/æ•°æ®åº“æœåŠ¡å™¨ç­‰ç½‘ç»œç¯å¢ƒä¸‹çš„æ•°æ®è®¿é—®<br>ç”±é©±åŠ¨ç¨‹åºå®Œæˆæ•°æ®åº“è®¿é—®è¯·æ±‚çš„æäº¤å’Œç»“æœé›†æ¥æ”¶<br>åº”ç”¨ç¨‹åºä½¿ç”¨é©±åŠ¨ç¨‹åºæä¾›çš„ç»“æœé›†ç®¡ç†æ¥å£æ“çºµæ‰§è¡Œåçš„ç»“æœæ•°æ®</li></ul></li><li><p>æ•°æ®æºï¼šæ˜¯æœ€ç»ˆç”¨æˆ·éœ€è¦è®¿é—®çš„æ•°æ®ï¼ŒåŒ…å«äº†æ•°æ®åº“ä½ç½®å’Œæ•°æ®åº“ç±»å‹ç­‰ä¿¡æ¯ï¼Œæ˜¯ä¸€ç§æ•°æ®è¿æ¥çš„æŠ½è±¡</p></li><li><p>æ•°æ®æºå¯¹æœ€ç»ˆç”¨æˆ·æ˜¯é€æ˜çš„</p><ul><li>ODBCç»™æ¯ä¸ªè¢«è®¿é—®çš„æ•°æ®æºæŒ‡å®šå”¯ä¸€çš„æ•°æ®æºåï¼ˆData Source Nameï¼Œç®€ç§°DSNï¼‰ï¼Œå¹¶æ˜ å°„åˆ°æ‰€æœ‰å¿…è¦çš„ã€ç”¨æ¥å­˜å–æ•°æ®çš„ä½å±‚è½¯ä»¶</li><li>åœ¨è¿æ¥ä¸­ï¼Œç”¨æ•°æ®æºåæ¥ä»£è¡¨ç”¨æˆ·åã€æœåŠ¡å™¨åã€æ‰€è¿æ¥çš„æ•°æ®åº“åç­‰</li><li>æœ€ç»ˆç”¨æˆ·æ— é¡»çŸ¥é“æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæˆ–å…¶ä»–æ•°æ®ç®¡ç†è½¯ä»¶ã€ç½‘ç»œä»¥åŠæœ‰å…³ODBCé©±åŠ¨ç¨‹åºçš„ç»†èŠ‚</li></ul></li><li><p>ä¾‹å¦‚ï¼Œå‡è®¾æŸä¸ªå­¦æ ¡åœ¨SQL Serverå’ŒKingbaseESä¸Šåˆ›å»ºäº†ä¸¤ä¸ªæ•°æ®åº“ï¼šå­¦æ ¡äººäº‹æ•°æ®åº“å’Œæ•™å­¦ç§‘ç ”æ•°æ®åº“ã€‚<br>å­¦æ ¡çš„ä¿¡æ¯ç³»ç»Ÿè¦ä»è¿™ä¸¤ä¸ªæ•°æ®åº“ä¸­å­˜å–æ•°æ®<br>ä¸ºäº†æ–¹ä¾¿åœ°ä¸ä¸¤ä¸ªæ•°æ®åº“è¿æ¥ï¼Œä¸ºå­¦æ ¡äººäº‹æ•°æ®åº“åˆ›å»ºä¸€ä¸ªæ•°æ®æºåPERSONï¼Œä¸ºæ•™å­¦ç§‘ç ”æ•°æ®åº“åˆ›å»ºä¸€ä¸ªåä¸ºEDUçš„æ•°æ®æº<br>å½“è¦è®¿é—®æ¯ä¸€ä¸ªæ•°æ®åº“æ—¶ï¼Œåªè¦ä¸PERSONå’ŒEDUè¿æ¥å³å¯ï¼Œä¸éœ€è¦è®°ä½ä½¿ç”¨çš„é©±åŠ¨ç¨‹åºã€æœåŠ¡å™¨åç§°ã€æ•°æ®åº“å</p></li></ul><h3 id="ODBC-APIåŸºç¡€">ODBC APIåŸºç¡€</h3><ul><li><p>ODBC åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£çš„ä¸€è‡´æ€§</p><ul><li>APIä¸€è‡´æ€§<br>åŒ…å«æ ¸å¿ƒçº§ã€æ‰©å±•1çº§ã€æ‰©å±•2çº§</li><li>è¯­æ³•ä¸€è‡´æ€§<br>åŒ…å«æœ€ä½é™åº¦SQLè¯­æ³•çº§ã€æ ¸å¿ƒSQLè¯­æ³•çº§ã€æ‰©å±•SQLè¯­æ³•çº§</li></ul></li><li><ol><li><p>å‡½æ•°æ¦‚è¿°</p></li><li><p>å¥æŸ„åŠå…¶å±æ€§</p></li><li><p>æ•°æ®ç±»å‹</p></li></ol></li><li><p>ODBC 3.0 æ ‡å‡†æä¾›äº†76ä¸ªå‡½æ•°æ¥å£</p><ul><li>åˆ†é…å’Œé‡Šæ”¾ç¯å¢ƒå¥æŸ„ã€è¿æ¥å¥æŸ„ã€è¯­å¥å¥æŸ„</li><li>è¿æ¥å‡½æ•°ï¼ˆSQLDriverconnectç­‰ï¼‰</li><li>ä¸ä¿¡æ¯ç›¸å…³çš„å‡½æ•°ï¼ˆSQLGetinfoã€SQLGetFuctionç­‰ï¼‰</li><li>äº‹åŠ¡å¤„ç†å‡½æ•°ï¼ˆå¦‚SQLEndTranï¼‰</li><li>æ‰§è¡Œç›¸å…³å‡½æ•°ï¼ˆSQLExecdirectã€SQLExecuteç­‰ï¼‰</li><li>ç¼–ç›®å‡½æ•°ï¼ŒODBC 3.0æä¾›äº†11ä¸ªç¼–ç›®å‡½æ•°ï¼Œå¦‚SQLTablesã€SQLColumnç­‰ã€‚åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡å¯¹ç¼–ç›®å‡½æ•°çš„è°ƒç”¨æ¥è·å–æ•°æ®å­—å…¸çš„ä¿¡æ¯ï¼Œå¦‚æƒé™ã€è¡¨ç»“æ„ç­‰</li></ul></li><li><p>å¥æŸ„æ˜¯32ä½æ•´æ•°å€¼ï¼Œä»£è¡¨ä¸€ä¸ªæŒ‡é’ˆ</p></li><li><p>ODBC 3.0ä¸­å¥æŸ„åˆ†ç±»</p><ul><li>ç¯å¢ƒå¥æŸ„</li><li>è¿æ¥å¥æŸ„</li><li>è¯­å¥å¥æŸ„</li><li>æè¿°ç¬¦å¥æŸ„</li></ul></li><li><p>åº”ç”¨ç¨‹åºå¥æŸ„ä¹‹é—´çš„å…³ç³»ï¼ˆç»­ï¼‰</p><ul><li>åœ¨ä¸€ä¸ªè¿æ¥ä¸­å¯ä»¥å»ºç«‹å¤šä¸ªè¯­å¥å¥æŸ„ï¼Œå®ƒä¸åªæ˜¯ä¸€ä¸ªSQLè¯­å¥ï¼Œè¿˜åŒ…æ‹¬SQLè¯­å¥äº§ç”Ÿçš„ç»“æœé›†ä»¥åŠç›¸å…³çš„ä¿¡æ¯ç­‰</li><li>åœ¨ODBC 3.0ä¸­åˆæå‡ºäº†æè¿°ç¬¦å¥æŸ„çš„æ¦‚å¿µï¼Œå®ƒæ˜¯æè¿°SQLè¯­å¥çš„å‚æ•°ã€ç»“æœé›†åˆ—çš„å…ƒæ•°æ®é›†åˆ</li></ul></li><li><p>ODBCæ•°æ®ç±»å‹</p><ul><li>SQLæ•°æ®ç±»å‹ï¼šç”¨äºæ•°æ®æº</li><li>Cæ•°æ®ç±»å‹ ï¼šç”¨äºåº”ç”¨ç¨‹åºçš„Cä»£ç </li></ul></li><li><p>åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡SQLGetTypeInfoæ¥è·å–ä¸åŒçš„é©±åŠ¨ç¨‹åºå¯¹äºæ•°æ®ç±»å‹çš„æ”¯æŒæƒ…å†µ</p></li><li><p>[ä¾‹8.11] å°†KingbaseESæ•°æ®åº“ä¸­Studentè¡¨çš„æ•°æ®å¤‡ä»½åˆ°SQL Serveræ•°æ®åº“ä¸­ã€‚</p><ul><li>è¯¥åº”ç”¨æ¶‰åŠä¸¤ä¸ªä¸åŒçš„å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸­çš„æ•°æ®æº</li><li>ä½¿ç”¨ODBCæ¥å¼€å‘åº”ç”¨ç¨‹åºï¼Œåªè¦æ”¹å˜åº”ç”¨ç¨‹åºä¸­è¿æ¥å‡½æ•°ï¼ˆSQLConnectï¼‰çš„å‚æ•°ï¼Œå°±å¯ä»¥è¿æ¥ä¸åŒå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„é©±åŠ¨ç¨‹åºï¼Œè¿æ¥ä¸¤ä¸ªæ•°æ®æº</li></ul></li><li><p>æ“ä½œæ­¥éª¤</p><ol><li><p>é…ç½®æ•°æ®æº</p></li><li><p>åˆå§‹åŒ–ç¯å¢ƒ</p></li><li><p>å»ºç«‹è¿æ¥</p></li><li><p>åˆ†é…è¯­å¥å¥æŸ„</p></li><li><p>æ‰§è¡ŒSQLè¯­å¥</p></li><li><p>ç»“æœé›†å¤„ç†</p></li><li><p>ä¸­æ­¢å¤„ç†</p></li></ol></li><li><p>åº”ç”¨ç¨‹åºä¸­æ­¢æ­¥éª¤</p><ul><li>é‡Šæ”¾è¯­å¥å¥æŸ„</li><li>é‡Šæ”¾æ•°æ®åº“è¿æ¥</li><li>ä¸æ•°æ®åº“æœåŠ¡å™¨æ–­å¼€</li><li>é‡Šæ”¾ODBCç¯å¢ƒ</li></ul></li></ul><h2 id="å°ç»“">å°ç»“</h2><ul><li>åµŒå…¥å¼SQLæŠŠSQLè¯­å¥åµŒå…¥åˆ°æŸç§é«˜çº§è¯­è¨€ä¸­</li><li>SQLä¸ä¸»è¯­è¨€å…·æœ‰ä¸åŒçš„æ•°æ®å¤„ç†æ–¹å¼</li><li>æœ¬ç« è®²è§£äº†ä»¥ä¸‹å†…å®¹<ul><li>åµŒå…¥å¼SQL</li><li>è¿‡ç¨‹åŒ–SQL</li><li>å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°</li><li>ODBCç¼–ç¨‹</li></ul></li></ul><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;åµŒå…¥å¼SQL&quot;&gt;åµŒå…¥å¼SQL&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;SQLè¯­è¨€æä¾›äº†ä¸¤ç§ä¸åŒçš„ä½¿ç”¨æ–¹å¼
&lt;ul&gt;
&lt;li&gt;äº¤äº’å¼&lt;/li&gt;
&lt;li&gt;åµŒå…¥å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸ºä»€ä¹ˆè¦å¼•å…¥åµŒå…¥å¼SQL
&lt;ul&gt;
&lt;li&gt;SQLè¯­è¨€æ˜¯éè¿‡ç¨‹æ€§è¯­è¨€&lt;/li</summary>
      
    
    
    
    <category term="æ•°æ®åº“" scheme="https://lebronchao.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://lebronchao.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="æ•°æ®åº“" scheme="https://lebronchao.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="SQL" scheme="https://lebronchao.com/tags/SQL/"/>
    
    <category term="åç«¯" scheme="https://lebronchao.com/tags/%E5%90%8E%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>æ•°æ®åº“ç³»ç»Ÿ | ç¬¬ä¸ƒç«  æ•°æ®åº“è®¾è®¡</title>
    <link href="https://lebronchao.com/2021/01/20/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%B8%83%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/"/>
    <id>https://lebronchao.com/2021/01/20/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%B8%83%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/</id>
    <published>2021-01-20T02:31:24.000Z</published>
    <updated>2021-01-20T06:54:24.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é‡ç‚¹å’Œéš¾ç‚¹">é‡ç‚¹å’Œéš¾ç‚¹</h2><ul><li><p>é‡ç‚¹ï¼š</p><p>æŒæ¡æ•°æ®åº“è®¾è®¡æ­¥éª¤å’Œæ•°æ®åº“è®¾è®¡è¿‡ç¨‹ä¸­çš„å„çº§æ¨¡å¼è®¾è®¡æ–¹æ³•ã€‚ç‰¹åˆ«æ˜¯æ•°æ®åº“æ¦‚å¿µç»“æ„çš„è®¾è®¡å’Œé€»è¾‘ç»“æ„çš„è®¾è®¡ï¼Œè¿™æ˜¯æ•°æ®åº“è®¾è®¡è¿‡ç¨‹ä¸­æœ€é‡è¦çš„ä¸¤ä¸ªç¯èŠ‚ã€‚ç‰¢å›ºæŒæ¡ç”¨E-Rå›¾æ¥è¡¨ç¤ºæ¦‚å¿µæ¨¡å‹çš„æ–¹æ³•ï¼ŒæŒæ¡E-Rå›¾çš„è®¾è®¡ï¼ŒE-Rå›¾å‘å…³ç³»æ¨¡å‹çš„è½¬æ¢ã€‚</p></li><li><p>éš¾ç‚¹ï¼š</p><p>æŠ€æœ¯ä¸Šçš„éš¾ç‚¹æ˜¯E-Rå›¾çš„è®¾è®¡å’Œæ•°æ®æ¨¡å‹çš„ä¼˜åŒ–ï¼ŒåŒ…æ‹¬å¯¹ç°å®ä¸–ç•Œè¿›è¡ŒæŠ½è±¡çš„èƒ½åŠ›ï¼Œæå–å®ä½“ã€å±æ€§ã€å®ä½“å‹ä¹‹é—´çš„è”ç³»ï¼Œæ­£ç¡®åˆ’åˆ†å®ä½“ä¸å±æ€§çš„èƒ½åŠ›ã€‚å¦‚ä½•æŠŠç¬¬6ç« å…³ç³»æ•°æ®ç†è®ºä¸æœ¬ç« ç»“åˆï¼Œç”¨å…³ç³»æ•°æ®ç†è®ºæŒ‡å¯¼æ•°æ®åº“çš„é€»è¾‘è®¾è®¡ã€‚çœŸæ­£çš„éš¾ç‚¹æ˜¯ç†è®ºä¸å®é™…çš„ç»“åˆã€‚</p></li></ul><h2 id="æ•°æ®åº“è®¾è®¡æ¦‚è¿°">æ•°æ®åº“è®¾è®¡æ¦‚è¿°</h2><ul><li>æ•°æ®åº“è®¾è®¡<ul><li>æ•°æ®åº“è®¾è®¡æ˜¯æŒ‡å¯¹äºä¸€ä¸ªç»™å®šçš„åº”ç”¨ç¯å¢ƒï¼Œæ„é€ ï¼ˆè®¾è®¡ï¼‰ä¼˜åŒ–çš„æ•°æ®åº“é€»è¾‘æ¨¡å¼å’Œç‰©ç†ç»“æ„ï¼Œå¹¶æ®æ­¤å»ºç«‹æ•°æ®åº“åŠå…¶åº”ç”¨ç³»ç»Ÿï¼Œä½¿ä¹‹èƒ½å¤Ÿæœ‰æ•ˆåœ°å­˜å‚¨å’Œç®¡ç†æ•°æ®ï¼Œæ»¡è¶³å„ç§ç”¨æˆ·çš„åº”ç”¨éœ€æ±‚ï¼ŒåŒ…æ‹¬ä¿¡æ¯ç®¡ç†è¦æ±‚å’Œæ•°æ®æ“ä½œè¦æ±‚ã€‚</li><li>ä¿¡æ¯ç®¡ç†è¦æ±‚ï¼šåœ¨æ•°æ®åº“ä¸­åº”è¯¥å­˜å‚¨å’Œç®¡ç†å“ªäº›æ•°æ®å¯¹è±¡ ã€‚</li><li>æ•°æ®æ“ä½œè¦æ±‚ï¼šå¯¹æ•°æ®å¯¹è±¡éœ€è¦è¿›è¡Œå“ªäº›æ“ä½œï¼Œå¦‚æŸ¥è¯¢ã€å¢ã€åˆ ã€æ”¹ã€ç»Ÿè®¡ç­‰æ“ä½œã€‚</li><li>æ•°æ®åº“è®¾è®¡çš„ç›®æ ‡æ˜¯ä¸ºç”¨æˆ·å’Œå„ç§åº”ç”¨ç³»ç»Ÿæä¾›ä¸€ä¸ªä¿¡æ¯åŸºç¡€è®¾æ–½å’Œé«˜æ•ˆç‡çš„è¿è¡Œç¯å¢ƒ ã€‚</li><li>é«˜æ•ˆç‡çš„è¿è¡Œç¯å¢ƒ<ul><li>æ•°æ®åº“æ•°æ®çš„å­˜å–æ•ˆç‡é«˜</li><li>æ•°æ®åº“å­˜å‚¨ç©ºé—´çš„åˆ©ç”¨ç‡é«˜</li><li>æ•°æ®åº“ç³»ç»Ÿè¿è¡Œç®¡ç†çš„æ•ˆç‡é«˜</li></ul></li></ul></li></ul><h3 id="æ•°æ®åº“è®¾è®¡çš„ç‰¹ç‚¹">æ•°æ®åº“è®¾è®¡çš„ç‰¹ç‚¹</h3><ul><li><p>æ•°æ®åº“å»ºè®¾çš„åŸºæœ¬è§„å¾‹</p><ul><li>ä¸‰åˆ†æŠ€æœ¯ï¼Œä¸ƒåˆ†ç®¡ç†ï¼ŒåäºŒåˆ†åŸºç¡€æ•°æ®</li><li>ç®¡ç†<ul><li>æ•°æ®åº“å»ºè®¾é¡¹ç›®ç®¡ç†</li><li>ä¼ä¸šï¼ˆå³åº”ç”¨éƒ¨é—¨ï¼‰çš„ä¸šåŠ¡ç®¡ç†</li></ul></li><li>åŸºç¡€æ•°æ®<ul><li>æ•°æ®çš„æ”¶é›†ã€æ•´ç†ã€ç»„ç»‡å’Œä¸æ–­æ›´æ–°</li></ul></li></ul></li><li><p>ç»“æ„ï¼ˆæ•°æ®ï¼‰è®¾è®¡å’Œè¡Œä¸ºï¼ˆå¤„ç†ï¼‰è®¾è®¡ç›¸ç»“åˆ</p><ul><li>å°†æ•°æ®åº“ç»“æ„è®¾è®¡å’Œæ•°æ®å¤„ç†è®¾è®¡å¯†åˆ‡ç»“åˆ</li></ul></li><li><p>ç»“æ„å’Œè¡Œä¸ºåˆ†ç¦»çš„è®¾è®¡</p><ul><li>ä¼ ç»Ÿçš„è½¯ä»¶å·¥ç¨‹ï¼šé‡ è¡Œä¸ºè®¾è®¡<br>å¿½è§†å¯¹åº”ç”¨ä¸­æ•°æ®è¯­ä¹‰çš„åˆ†æå’ŒæŠ½è±¡ï¼Œåªè¦æœ‰å¯èƒ½å°±å°½é‡æ¨è¿Ÿæ•°æ®ç»“æ„è®¾è®¡çš„å†³ç­–</li><li>æ—©æœŸçš„æ•°æ®åº“è®¾è®¡ï¼šé‡ ç»“æ„è®¾è®¡<br>è‡´åŠ›äºæ•°æ®æ¨¡å‹å’Œæ•°æ®åº“å»ºæ¨¡æ–¹æ³•ç ”ç©¶ï¼Œå¿½è§†äº†è¡Œä¸ºè®¾è®¡å¯¹ç»“æ„è®¾è®¡çš„å½±å“</li></ul></li></ul><h3 id="æ•°æ®åº“è®¾è®¡æ–¹æ³•">æ•°æ®åº“è®¾è®¡æ–¹æ³•</h3><ul><li><p>å¤§å‹æ•°æ®åº“è®¾è®¡æ˜¯æ¶‰åŠå¤šå­¦ç§‘çš„ç»¼åˆæ€§æŠ€æœ¯ï¼Œåˆæ˜¯ä¸€é¡¹åºå¤§çš„å·¥ç¨‹é¡¹ç›®ã€‚</p></li><li><p>å®ƒè¦æ±‚å¤šæ–¹é¢çš„çŸ¥è¯†å’ŒæŠ€æœ¯ã€‚ä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li>è®¡ç®—æœºçš„åŸºç¡€çŸ¥è¯†</li><li>è½¯ä»¶å·¥ç¨‹çš„åŸç†å’Œæ–¹æ³•</li><li>ç¨‹åºè®¾è®¡çš„æ–¹æ³•å’ŒæŠ€å·§</li><li>æ•°æ®åº“çš„åŸºæœ¬çŸ¥è¯†</li><li>æ•°æ®åº“è®¾è®¡æŠ€æœ¯</li><li>åº”ç”¨é¢†åŸŸçš„çŸ¥è¯†</li></ul></li><li><p>æ‰‹å·¥è¯•å‡‘æ³•</p><ul><li>è®¾è®¡è´¨é‡ä¸è®¾è®¡äººå‘˜çš„ç»éªŒå’Œæ°´å¹³æœ‰ç›´æ¥å…³ç³»</li><li>ç¼ºä¹ç§‘å­¦ç†è®ºå’Œå·¥ç¨‹æ–¹æ³•çš„æ”¯æŒï¼Œå·¥ç¨‹çš„è´¨é‡éš¾ä»¥ä¿è¯</li><li>æ•°æ®åº“è¿è¡Œä¸€æ®µæ—¶é—´åå¸¸å¸¸åˆä¸åŒç¨‹åº¦åœ°å‘ç°å„ç§é—®é¢˜ï¼Œå¢åŠ äº†ç»´æŠ¤ä»£ä»·</li></ul></li><li><p>è§„èŒƒè®¾è®¡æ³•</p><ul><li>æ‰‹å·¥è®¾è®¡æ–¹æ³•</li><li>åŸºæœ¬æ€æƒ³<br>è¿‡ç¨‹è¿­ä»£å’Œé€æ­¥æ±‚ç²¾</li><li>å…¸å‹æ–¹æ³•<ul><li>æ–°å¥¥å°”è‰¯ï¼ˆNew Orleansï¼‰æ–¹æ³•</li><li>åŸºäºE-Ræ¨¡å‹çš„æ•°æ®åº“è®¾è®¡æ–¹æ³•</li><li>3NFï¼ˆç¬¬ä¸‰èŒƒå¼ï¼‰çš„è®¾è®¡æ–¹æ³•</li><li>é¢å‘å¯¹è±¡çš„æ•°æ®åº“è®¾è®¡æ–¹æ³•</li><li>ç»Ÿä¸€å»ºæ¨¡è¯­è¨€ï¼ˆUMLï¼‰æ–¹æ³•</li></ul></li></ul></li></ul><h3 id="æ•°æ®åº“è®¾è®¡çš„åŸºæœ¬æ­¥éª¤">æ•°æ®åº“è®¾è®¡çš„åŸºæœ¬æ­¥éª¤</h3><ul><li><p>æ•°æ®åº“è®¾è®¡åˆ†6ä¸ªé˜¶æ®µ</p><ul><li>éœ€æ±‚åˆ†æ</li><li>æ¦‚å¿µç»“æ„è®¾è®¡</li><li>é€»è¾‘ç»“æ„è®¾è®¡</li><li>ç‰©ç†ç»“æ„è®¾è®¡</li><li>æ•°æ®åº“å®æ–½</li><li>æ•°æ®åº“è¿è¡Œå’Œç»´æŠ¤</li></ul></li><li><p>éœ€æ±‚åˆ†æå’Œæ¦‚å¿µè®¾è®¡ç‹¬ç«‹äºä»»ä½•æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ</p></li><li><p>é€»è¾‘è®¾è®¡å’Œç‰©ç†è®¾è®¡ä¸é€‰ç”¨çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå¯†åˆ‡ç›¸å…³</p></li><li><p>å‚åŠ æ•°æ®åº“è®¾è®¡çš„äººå‘˜</p><ul><li>ç³»ç»Ÿåˆ†æäººå‘˜å’Œæ•°æ®åº“è®¾è®¡äººå‘˜<br>è‡ªå§‹è‡³ç»ˆå‚ä¸æ•°æ®åº“è®¾è®¡ï¼Œå…¶æ°´å¹³å†³å®šäº†æ•°æ®åº“ç³»ç»Ÿçš„è´¨é‡</li><li>æ•°æ®åº“ç®¡ç†å‘˜å’Œç”¨æˆ·ä»£è¡¨<br>ä¸»è¦å‚åŠ éœ€æ±‚åˆ†æä¸æ•°æ®åº“çš„è¿è¡Œå’Œç»´æŠ¤</li><li>åº”ç”¨å¼€å‘äººå‘˜<br>åŒ…æ‹¬ç¨‹åºå‘˜å’Œæ“ä½œå‘˜<br>åœ¨å®æ–½é˜¶æ®µå‚ä¸è¿›æ¥ï¼Œåˆ†åˆ«è´Ÿè´£ç¼–åˆ¶ç¨‹åºå’Œå‡†å¤‡è½¯ç¡¬ä»¶ç¯å¢ƒ</li></ul></li></ul><ol><li><p>éœ€æ±‚åˆ†æé˜¶æ®µ<br>æ˜¯å¦åšå¾—å……åˆ†ä¸å‡†ç¡®ï¼Œå†³å®šäº†æ„å»ºæ•°æ®åº“çš„é€Ÿåº¦å’Œè´¨é‡</p></li><li><p>æ¦‚å¿µç»“æ„è®¾è®¡é˜¶æ®µ<br>é€šè¿‡å¯¹ç”¨æˆ·éœ€æ±‚è¿›è¡Œç»¼åˆã€å½’çº³ä¸æŠ½è±¡ï¼Œå½¢æˆä¸€ä¸ªç‹¬ç«‹äºå…·ä½“æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„æ¦‚å¿µæ¨¡å‹</p></li><li><p>é€»è¾‘ç»“æ„è®¾è®¡é˜¶æ®µ<br>å°†æ¦‚å¿µç»“æ„è½¬æ¢ä¸ºæŸä¸ªæ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ‰€æ”¯æŒçš„æ•°æ®æ¨¡å‹ï¼Œå¹¶å¯¹å…¶è¿›è¡Œä¼˜åŒ–</p></li><li><p>ç‰©ç†ç»“æ„è®¾è®¡é˜¶æ®µ<br>ä¸ºé€»è¾‘æ•°æ®ç»“æ„é€‰å–ä¸€ä¸ªæœ€é€‚åˆåº”ç”¨ç¯å¢ƒçš„ç‰©ç†ç»“æ„<br>åŒ…æ‹¬å­˜å‚¨ç»“æ„å’Œå­˜å–æ–¹æ³•</p></li><li><p>æ•°æ®åº“å®æ–½é˜¶æ®µ<br>æ ¹æ®é€»è¾‘è®¾è®¡å’Œç‰©ç†è®¾è®¡çš„ç»“æœæ„å»ºæ•°æ®åº“<br>ç¼–å†™ä¸è°ƒè¯•åº”ç”¨ç¨‹åº<br>ç»„ç»‡æ•°æ®å…¥åº“å¹¶è¿›è¡Œè¯•è¿è¡Œ</p></li><li><p>æ•°æ®åº“è¿è¡Œå’Œç»´æŠ¤é˜¶æ®µ<br>ç»è¿‡è¯•è¿è¡Œåå³å¯æŠ•å…¥æ­£å¼è¿è¡Œ<br>åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å¿…é¡»ä¸æ–­å¯¹å…¶è¿›è¡Œè¯„ä¼°ã€è°ƒæ•´ä¸ä¿®æ”¹</p></li></ol><ul><li>è®¾è®¡ä¸€ä¸ªå®Œå–„çš„æ•°æ®åº“åº”ç”¨ç³»ç»Ÿ å¾€å¾€æ˜¯ä¸Šè¿°6ä¸ªé˜¶æ®µçš„ä¸æ–­åå¤</li><li>è¿™ä¸ªè®¾è®¡æ­¥éª¤æ—¢æ˜¯æ•°æ®åº“è®¾è®¡çš„è¿‡ç¨‹ï¼Œä¹ŸåŒ…æ‹¬äº†æ•°æ®åº“åº”ç”¨ç³»ç»Ÿçš„è®¾è®¡è¿‡ç¨‹</li><li>æŠŠæ•°æ®åº“çš„è®¾è®¡å’Œå¯¹æ•°æ®åº“ä¸­æ•°æ®å¤„ç†çš„è®¾è®¡ç´§å¯†ç»“åˆèµ·æ¥ï¼Œå°†è¿™ä¸¤ä¸ªæ–¹é¢çš„éœ€æ±‚åˆ†æã€æŠ½è±¡ã€è®¾è®¡ã€å®ç°åœ¨å„ä¸ªé˜¶æ®µåŒæ—¶è¿›è¡Œï¼Œç›¸äº’å‚ç…§ï¼Œç›¸äº’è¡¥å……ï¼Œä»¥å®Œå–„ä¸¤æ–¹é¢çš„è®¾è®¡</li></ul><h2 id="éœ€æ±‚åˆ†æ">éœ€æ±‚åˆ†æ</h2><h3 id="éœ€æ±‚åˆ†æçš„ä»»åŠ¡">éœ€æ±‚åˆ†æçš„ä»»åŠ¡</h3><ul><li><p>éœ€æ±‚åˆ†æå°±æ˜¯åˆ†æç”¨æˆ·çš„è¦æ±‚</p><ul><li>æ˜¯è®¾è®¡æ•°æ®åº“çš„èµ·ç‚¹</li><li>ç»“æœæ˜¯å¦å‡†ç¡®åœ°åæ˜ äº†ç”¨æˆ·çš„å®é™…è¦æ±‚ï¼Œå°†ç›´æ¥å½±å“åˆ°åé¢å„ä¸ªé˜¶æ®µçš„è®¾è®¡ï¼Œå¹¶å½±å“åˆ°è®¾è®¡ç»“æœæ˜¯å¦åˆç†å’Œå®ç”¨</li></ul></li><li><p>è¯¦ç»†è°ƒæŸ¥ç°å®ä¸–ç•Œè¦å¤„ç†çš„å¯¹è±¡ï¼ˆç»„ç»‡ã€éƒ¨é—¨ã€ä¼ä¸šç­‰ï¼‰</p></li><li><p>å……åˆ†äº†è§£åŸç³»ç»Ÿï¼ˆæ‰‹å·¥ç³»ç»Ÿæˆ–è®¡ç®—æœºç³»ç»Ÿï¼‰å·¥ä½œæ¦‚å†µ</p></li><li><p>æ˜ç¡®ç”¨æˆ·çš„å„ç§éœ€æ±‚</p></li><li><p>åœ¨æ­¤åŸºç¡€ä¸Šç¡®å®šæ–°ç³»ç»Ÿçš„åŠŸèƒ½</p></li><li><p>æ–°ç³»ç»Ÿå¿…é¡»å……åˆ†è€ƒè™‘ä»Šåå¯èƒ½çš„æ‰©å……å’Œæ”¹å˜</p></li><li><p>è°ƒæŸ¥çš„é‡ç‚¹æ˜¯â€œæ•°æ®â€å’Œâ€œå¤„ç†â€ï¼Œè·å¾—ç”¨æˆ·å¯¹æ•°æ®åº“çš„è¦æ±‚<br>ï¼ˆ1ï¼‰ä¿¡æ¯è¦æ±‚<br>ç”¨æˆ·éœ€è¦ä»æ•°æ®åº“ä¸­è·å¾—ä¿¡æ¯çš„å†…å®¹ä¸æ€§è´¨<br>ç”±ä¿¡æ¯è¦æ±‚å¯ä»¥å¯¼å‡ºæ•°æ®è¦æ±‚ï¼Œå³åœ¨æ•°æ®åº“ä¸­éœ€è¦å­˜å‚¨å“ªäº›æ•°æ®<br>ï¼ˆ2ï¼‰å¤„ç†è¦æ±‚<br>ç”¨æˆ·è¦å®Œæˆçš„å¤„ç†åŠŸèƒ½<br>å¯¹å¤„ç†æ€§èƒ½çš„è¦æ±‚<br>ï¼ˆ3ï¼‰å®‰å…¨æ€§ä¸å®Œæ•´æ€§è¦æ±‚</p></li><li><p>ç¡®å®šç”¨æˆ·æœ€ç»ˆéœ€æ±‚çš„éš¾ç‚¹</p><ul><li>ç”¨æˆ·ç¼ºå°‘è®¡ç®—æœºçŸ¥è¯†ï¼Œä¸èƒ½å‡†ç¡®åœ°è¡¨è¾¾è‡ªå·±çš„éœ€æ±‚ï¼Œä»–ä»¬æ‰€æå‡ºçš„éœ€æ±‚å¾€å¾€ä¸æ–­åœ°å˜åŒ–ã€‚</li><li>è®¾è®¡äººå‘˜ç¼ºå°‘ç”¨æˆ·çš„ä¸“ä¸šçŸ¥è¯†ï¼Œä¸æ˜“ç†è§£ç”¨æˆ·çš„çœŸæ­£éœ€æ±‚ï¼Œç”šè‡³è¯¯è§£ç”¨æˆ·çš„éœ€æ±‚</li></ul></li><li><p>è§£å†³æ–¹æ³•</p><p>è®¾è®¡äººå‘˜å¿…é¡»ä¸æ–­æ·±å…¥åœ°ä¸ç”¨æˆ·è¿›è¡Œäº¤æµï¼Œæ‰èƒ½é€æ­¥ç¡®å®šç”¨æˆ·çš„å®é™…éœ€æ±‚</p></li></ul><h3 id="éœ€æ±‚åˆ†æçš„æ–¹æ³•">éœ€æ±‚åˆ†æçš„æ–¹æ³•</h3><ul><li>è°ƒæŸ¥æ¸…æ¥šç”¨æˆ·çš„å®é™…éœ€æ±‚å¹¶è¿›è¡Œåˆæ­¥åˆ†æ</li><li>ä¸ç”¨æˆ·è¾¾æˆå…±è¯†</li><li>åˆ†æä¸è¡¨è¾¾è¿™äº›éœ€æ±‚</li></ul><p>ï¼ˆ1ï¼‰è°ƒæŸ¥ç»„ç»‡æœºæ„æƒ…å†µ<br>ï¼ˆ2ï¼‰è°ƒæŸ¥å„éƒ¨é—¨çš„ä¸šåŠ¡æ´»åŠ¨æƒ…å†µ<br>ï¼ˆ3ï¼‰ååŠ©ç”¨æˆ·æ˜ç¡®å¯¹æ–°ç³»ç»Ÿçš„å„ç§è¦æ±‚ï¼ŒåŒ…æ‹¬ä¿¡æ¯è¦æ±‚ã€å¤„ç†è¦æ±‚ã€å®Œå…¨æ€§ä¸å®Œæ•´æ€§è¦æ±‚<br>ï¼ˆ4ï¼‰ç¡®å®šæ–°ç³»ç»Ÿçš„è¾¹ç•Œ</p><h4 id="å¸¸ç”¨è°ƒæŸ¥æ–¹æ³•">å¸¸ç”¨è°ƒæŸ¥æ–¹æ³•</h4><p>ï¼ˆ1ï¼‰è·Ÿç­ä½œä¸š<br>é€šè¿‡äº²èº«å‚åŠ ä¸šåŠ¡å·¥ä½œäº†è§£ä¸šåŠ¡æ´»åŠ¨çš„æƒ…å†µ<br>ï¼ˆ2ï¼‰å¼€è°ƒæŸ¥ä¼š<br>é€šè¿‡ä¸ç”¨æˆ·åº§è°ˆæ¥äº†è§£ä¸šåŠ¡æ´»åŠ¨æƒ…å†µåŠç”¨æˆ·éœ€æ±‚<br>ï¼ˆ3ï¼‰è¯·ä¸“äººä»‹ç»<br>ï¼ˆ4ï¼‰è¯¢é—®<br>å¯¹æŸäº›è°ƒæŸ¥ä¸­çš„é—®é¢˜ï¼Œå¯ä»¥æ‰¾ä¸“äººè¯¢é—®<br>ï¼ˆ5ï¼‰è®¾è®¡è°ƒæŸ¥è¡¨è¯·ç”¨æˆ·å¡«å†™<br>è°ƒæŸ¥è¡¨è®¾è®¡åˆç†ï¼Œåˆ™å¾ˆæœ‰æ•ˆ<br>ï¼ˆ6ï¼‰æŸ¥é˜…è®°å½•<br>æŸ¥é˜…ä¸åŸç³»ç»Ÿæœ‰å…³çš„æ•°æ®è®°å½•</p><ul><li>åˆ†ææ–¹æ³•<ul><li>ç»“æ„åŒ–åˆ†ææ–¹æ³•ï¼ˆStructured Analysisï¼Œç®€ç§°SAæ–¹æ³•ï¼‰<ul><li>SAæ–¹æ³•ä»æœ€ä¸Šå±‚çš„ç³»ç»Ÿç»„ç»‡æœºæ„å…¥æ‰‹</li><li>é‡‡ç”¨è‡ªé¡¶å‘ä¸‹ã€é€å±‚åˆ†è§£çš„æ–¹å¼åˆ†æç³»ç»Ÿ</li></ul></li></ul></li><li>å¯¹ç”¨æˆ·éœ€æ±‚è¿›è¡Œåˆ†æä¸è¡¨è¾¾åï¼Œéœ€æ±‚åˆ†ææŠ¥å‘Šå¿…é¡»æäº¤ç»™ç”¨æˆ·ï¼Œå¾å¾—ç”¨æˆ·çš„è®¤å¯</li></ul><h3 id="æ•°æ®å­—å…¸">æ•°æ®å­—å…¸</h3><ul><li><p>æ•°æ®å­—å…¸æ˜¯å…³äºæ•°æ®åº“ä¸­æ•°æ®çš„æè¿°ï¼Œå³å…ƒæ•°æ®ï¼Œä¸æ˜¯æ•°æ®æœ¬èº«</p></li><li><p>æ•°æ®å­—å…¸åœ¨éœ€æ±‚åˆ†æé˜¶æ®µå»ºç«‹ï¼Œåœ¨æ•°æ®åº“è®¾è®¡è¿‡ç¨‹ä¸­ä¸æ–­ä¿®æ”¹ã€å……å®ã€å®Œå–„</p></li><li><p>æ•°æ®å­—å…¸æ˜¯è¿›è¡Œè¯¦ç»†çš„æ•°æ®æ”¶é›†å’Œæ•°æ®åˆ†ææ‰€è·å¾—çš„ä¸»è¦ç»“æœ</p></li><li><p>æ³¨æ„ï¼š<br>å’Œå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸­æ•°æ®å­—å…¸çš„åŒºåˆ«å’Œè”ç³»</p></li><li><p>æ•°æ®å­—å…¸çš„å†…å®¹</p><ul><li>æ•°æ®é¡¹</li><li>æ•°æ®ç»“æ„</li><li>æ•°æ®æµ</li><li>æ•°æ®å­˜å‚¨</li><li>å¤„ç†è¿‡ç¨‹</li></ul></li><li><p>æ•°æ®é¡¹æ˜¯æ•°æ®çš„æœ€å°ç»„æˆå•ä½</p></li><li><p>è‹¥å¹²ä¸ªæ•°æ®é¡¹å¯ä»¥ç»„æˆä¸€ä¸ªæ•°æ®ç»“æ„</p></li><li><p>æ•°æ®å­—å…¸é€šè¿‡å¯¹æ•°æ®é¡¹å’Œæ•°æ®ç»“æ„çš„å®šä¹‰æ¥æè¿°æ•°æ®æµã€æ•°æ®å­˜å‚¨çš„é€»è¾‘å†…å®¹</p></li></ul><h3 id="éœ€æ±‚åˆ†æå°ç»“">éœ€æ±‚åˆ†æå°ç»“</h3><ul><li><p>æŠŠéœ€æ±‚æ”¶é›†å’Œåˆ†æä½œä¸ºæ•°æ®åº“è®¾è®¡çš„ç¬¬ä¸€é˜¶æ®µæ˜¯ååˆ†é‡è¦çš„ã€‚</p></li><li><p>ç¬¬ä¸€é˜¶æ®µæ”¶é›†çš„åŸºç¡€æ•°æ®ï¼ˆç”¨æ•°æ®å­—å…¸æ¥è¡¨è¾¾ï¼‰æ˜¯ä¸‹ä¸€æ­¥è¿›è¡Œæ¦‚å¿µè®¾è®¡çš„åŸºç¡€ã€‚</p></li><li><p>å¼ºè°ƒä¸¤ç‚¹</p><p>ï¼ˆ1ï¼‰è®¾è®¡äººå‘˜åº”å……åˆ†è€ƒè™‘åˆ°å¯èƒ½çš„æ‰©å……å’Œæ”¹å˜ï¼Œä½¿è®¾è®¡æ˜“äºæ›´æ”¹ï¼Œç³»ç»Ÿæ˜“äºæ‰©å……<br>ï¼ˆ2ï¼‰å¿…é¡»å¼ºè°ƒç”¨æˆ·çš„å‚ä¸</p></li></ul><h2 id="æ¦‚å¿µç»“æ„è®¾è®¡">æ¦‚å¿µç»“æ„è®¾è®¡</h2><h3 id="æ¦‚å¿µæ¨¡å‹">æ¦‚å¿µæ¨¡å‹</h3><ul><li>å°†éœ€æ±‚åˆ†æå¾—åˆ°çš„ç”¨æˆ·éœ€æ±‚æŠ½è±¡ä¸ºä¿¡æ¯ç»“æ„ï¼ˆå³æ¦‚å¿µæ¨¡å‹ï¼‰çš„è¿‡ç¨‹å°±æ˜¯æ¦‚å¿µç»“æ„è®¾è®¡</li><li>æ¦‚å¿µæ¨¡å‹çš„ç‰¹ç‚¹<br>ï¼ˆ1ï¼‰èƒ½çœŸå®ã€å……åˆ†åœ°åæ˜ ç°å®ä¸–ç•Œï¼Œæ˜¯ç°å®ä¸–ç•Œçš„ä¸€ä¸ªçœŸå®æ¨¡å‹ã€‚<br>ï¼ˆ2ï¼‰æ˜“äºç†è§£ï¼Œä»è€Œå¯ä»¥ç”¨å®ƒå’Œä¸ç†Ÿæ‚‰è®¡ç®—æœºçš„ç”¨æˆ·äº¤æ¢æ„è§ã€‚<br>ï¼ˆ3ï¼‰æ˜“äºæ›´æ”¹ï¼Œå½“åº”ç”¨ç¯å¢ƒå’Œåº”ç”¨è¦æ±‚æ”¹å˜æ—¶ï¼Œå®¹æ˜“å¯¹æ¦‚å¿µæ¨¡å‹ä¿®æ”¹å’Œæ‰©å……ã€‚<br>ï¼ˆ4ï¼‰æ˜“äºå‘å…³ç³»ã€ç½‘çŠ¶ã€å±‚æ¬¡ç­‰å„ç§æ•°æ®æ¨¡å‹è½¬æ¢</li><li>æè¿°æ¦‚å¿µæ¨¡å‹çš„å·¥å…·<ul><li>E-Ræ¨¡å‹</li></ul></li></ul><h3 id="E-Ræ¨¡å‹">E-Ræ¨¡å‹</h3><ul><li><p>å®ä½“ä¹‹é—´çš„è”ç³»<br>ä¸¤ä¸ªå®ä½“å‹ä¹‹é—´çš„è”ç³»ï¼š<br>â‘ ä¸€å¯¹ä¸€è”ç³»ï¼ˆ1âˆ¶1ï¼‰<br>â‘¡ä¸€å¯¹å¤šè”ç³»ï¼ˆ1âˆ¶nï¼‰<br>â‘¢å¤šå¯¹å¤šè”ç³»ï¼ˆmâˆ¶nï¼‰</p></li><li><p>ä¸€å¯¹ä¸€è”ç³»ï¼ˆ1âˆ¶1ï¼‰</p><ul><li>å¦‚æœå¯¹äºå®ä½“é›†Aä¸­çš„æ¯ä¸€ä¸ªå®ä½“ï¼Œå®ä½“é›†Bä¸­è‡³å¤šæœ‰ä¸€ä¸ªï¼ˆä¹Ÿå¯ä»¥æ²¡æœ‰ï¼‰å®ä½“ä¸ä¹‹è”ç³»ï¼Œåä¹‹äº¦ç„¶ï¼Œåˆ™ç§°å®ä½“é›†Aä¸å®ä½“é›†Bå…·æœ‰ä¸€å¯¹ä¸€è”ç³»ï¼Œè®°ä¸º1âˆ¶1ã€‚</li><li>ä¾‹å¦‚ï¼Œå­¦æ ¡é‡Œä¸€ä¸ªç­çº§åªæœ‰ä¸€ä¸ªæ­£ç­é•¿ï¼Œè€Œä¸€ä¸ªç­é•¿åªåœ¨ä¸€ä¸ªç­ä¸­ä»»èŒï¼Œåˆ™ç­çº§ä¸ç­é•¿ä¹‹é—´å…·æœ‰ä¸€å¯¹ä¸€è”ç³»ã€‚</li></ul></li><li><p>ä¸€å¯¹å¤šè”ç³»ï¼ˆ1âˆ¶nï¼‰</p><ul><li>å¦‚æœå¯¹äºå®ä½“é›†Aä¸­çš„æ¯ä¸€ä¸ªå®ä½“ï¼Œå®ä½“é›†Bä¸­æœ‰nä¸ªå®ä½“ï¼ˆnâ‰¥0ï¼‰ä¸ä¹‹è”ç³»ï¼Œåä¹‹ï¼Œå¯¹äºå®ä½“é›†Bä¸­çš„æ¯ä¸€ä¸ªå®ä½“ï¼Œå®ä½“é›†Aä¸­è‡³å¤šåªæœ‰ä¸€ä¸ªå®ä½“ä¸ä¹‹è”ç³»ï¼Œåˆ™ç§°å®ä½“é›†Aä¸å®ä½“é›†Bæœ‰ä¸€å¯¹å¤šè”ç³»ï¼Œè®°ä¸º1âˆ¶nã€‚</li><li>ä¾‹å¦‚ï¼Œä¸€ä¸ªç­çº§ä¸­æœ‰è‹¥å¹²åå­¦ç”Ÿï¼Œè€Œæ¯ä¸ªå­¦ç”Ÿåªåœ¨ä¸€ä¸ªç­çº§ä¸­å­¦ä¹ ï¼Œåˆ™ç­çº§ä¸å­¦ç”Ÿä¹‹é—´å…·æœ‰ä¸€å¯¹å¤šè”ç³»ã€‚</li></ul></li><li><p>å¤šå¯¹å¤šè”ç³»ï¼ˆmâˆ¶nï¼‰</p><ul><li>å¦‚æœå¯¹äºå®ä½“é›†Aä¸­çš„æ¯ä¸€ä¸ªå®ä½“ï¼Œå®ä½“é›†Bä¸­æœ‰nä¸ªå®ä½“ï¼ˆnâ‰¥0ï¼‰ä¸ä¹‹è”ç³»ï¼Œåä¹‹ï¼Œå¯¹äºå®ä½“é›†Bä¸­çš„æ¯ä¸€ä¸ªå®ä½“ï¼Œå®ä½“é›†Aä¸­ä¹Ÿæœ‰mä¸ªå®ä½“ï¼ˆmâ‰¥0ï¼‰ä¸ä¹‹è”ç³»ï¼Œåˆ™ç§°å®ä½“é›†Aä¸å®ä½“é›†Bå…·æœ‰å¤šå¯¹å¤šè”ç³»ï¼Œè®°ä¸ºmâˆ¶nã€‚</li><li>ä¾‹å¦‚ï¼Œä¸€é—¨è¯¾ç¨‹åŒæ—¶æœ‰è‹¥å¹²ä¸ªå­¦ç”Ÿé€‰ä¿®ï¼Œè€Œä¸€ä¸ªå­¦ç”Ÿå¯ä»¥åŒæ—¶é€‰ä¿®å¤šé—¨è¯¾ç¨‹ï¼Œåˆ™è¯¾ç¨‹ä¸å­¦ç”Ÿä¹‹é—´å…·æœ‰å¤šå¯¹å¤šè”ç³»ã€‚</li></ul></li><li><p>è”ç³»çš„åº¦ï¼šå‚ä¸è”ç³»çš„å®ä½“å‹çš„æ•°ç›®</p><ul><li>2ä¸ªå®ä½“å‹ä¹‹é—´çš„è”ç³»åº¦ä¸º2ï¼Œä¹Ÿç§°ä¸ºäºŒå…ƒè”ç³»ï¼›</li><li>3ä¸ªå®ä½“å‹ä¹‹é—´çš„è”ç³»åº¦ä¸º3ï¼Œç§°ä¸ºä¸‰å…ƒè”ç³»ï¼›</li><li>Nä¸ªå®ä½“å‹ä¹‹é—´çš„è”ç³»åº¦ä¸ºNï¼Œä¹Ÿç§°ä¸ºNå…ƒè”ç³»</li></ul></li><li><p>E-Rå›¾</p><ul><li>E-Rå›¾æä¾›äº†è¡¨ç¤ºå®ä½“å‹ã€å±æ€§å’Œè”ç³»çš„æ–¹æ³•ï¼š<ul><li>å®ä½“å‹ï¼šç”¨çŸ©å½¢è¡¨ç¤ºï¼ŒçŸ©å½¢æ¡†å†…å†™æ˜å®ä½“åã€‚</li><li>å±æ€§ï¼šç”¨æ¤­åœ†å½¢è¡¨ç¤ºï¼Œå¹¶ç”¨æ— å‘è¾¹å°†å…¶ä¸ç›¸åº”çš„å®ä½“å‹è¿æ¥èµ·æ¥ã€‚<br>ä¾‹å¦‚ï¼Œå­¦ç”Ÿå®ä½“å…·æœ‰å­¦å·ã€å§“åã€æ€§åˆ«ã€å‡ºç”Ÿå¹´ä»½ã€ç³»ã€å…¥å­¦æ—¶é—´ç­‰å±æ€§ï¼Œç”¨E-Rå›¾è¡¨ç¤ºå¦‚å›¾7.9æ‰€ç¤º</li></ul></li></ul></li></ul><h3 id="æ¦‚å¿µç»“æ„è®¾è®¡-2">æ¦‚å¿µç»“æ„è®¾è®¡</h3><ul><li>å®ä½“ä¸å±æ€§çš„åˆ’åˆ†åŸåˆ™<ul><li>ä¸ºäº†ç®€åŒ–E-Rå›¾çš„å¤„ç½®ï¼Œç°å®ä¸–ç•Œçš„äº‹ç‰©èƒ½ä½œä¸ºå±æ€§å¯¹å¾…çš„ï¼Œå°½é‡ä½œä¸ºå±æ€§å¯¹å¾…ã€‚</li><li>ä¸¤æ¡å‡†åˆ™ï¼š<ul><li>ä½œä¸ºå±æ€§ï¼Œä¸èƒ½å†å…·æœ‰éœ€è¦æè¿°çš„æ€§è´¨ã€‚å±æ€§å¿…é¡»æ˜¯ä¸å¯åˆ†çš„æ•°æ®é¡¹ï¼Œä¸èƒ½åŒ…å«å…¶ä»–å±æ€§ã€‚</li><li>å±æ€§ä¸èƒ½ä¸å…¶ä»–å®ä½“å…·æœ‰è”ç³»ï¼Œå³E-Rå›¾ä¸­æ‰€è¡¨ç¤ºçš„è”ç³»æ˜¯å®ä½“ä¹‹é—´çš„è”ç³»ã€‚</li></ul></li></ul></li></ul><h2 id="é€»è¾‘ç»“æ„è®¾è®¡">é€»è¾‘ç»“æ„è®¾è®¡</h2><h3 id="E-Rå›¾å‘å…³ç³»æ¨¡å‹çš„è½¬æ¢">E-Rå›¾å‘å…³ç³»æ¨¡å‹çš„è½¬æ¢</h3><ul><li><p>è½¬æ¢å†…å®¹</p><ul><li>E-Rå›¾ç”±å®ä½“å‹ã€å®ä½“çš„å±æ€§å’Œå®ä½“å‹ä¹‹é—´çš„è”ç³»ä¸‰ä¸ªè¦ç´ ç»„æˆ</li><li>å…³ç³»æ¨¡å‹çš„é€»è¾‘ç»“æ„æ˜¯ä¸€ç»„å…³ç³»æ¨¡å¼çš„é›†åˆ</li><li>å°†E-Rå›¾è½¬æ¢ä¸ºå…³ç³»æ¨¡å‹ï¼šå°†å®ä½“å‹ã€å®ä½“çš„å±æ€§å’Œå®ä½“å‹ä¹‹é—´çš„è”ç³»è½¬åŒ–ä¸ºå…³ç³»æ¨¡å¼</li></ul></li><li><p>è½¬æ¢åŸåˆ™</p><ul><li>ä¸€ä¸ªå®ä½“å‹è½¬æ¢ä¸ºä¸€ä¸ªå…³ç³»æ¨¡å¼ã€‚<ul><li>å…³ç³»çš„å±æ€§ï¼šå®ä½“çš„å±æ€§</li><li>å…³ç³»çš„ç ï¼šå®ä½“çš„ç </li></ul></li><li>å®ä½“å‹é—´çš„è”ç³»æœ‰ä»¥ä¸‹ä¸åŒæƒ…å†µ<br>ä¸€ä¸ª1:1è”ç³»å¯ä»¥è½¬æ¢ä¸ºä¸€ä¸ªç‹¬ç«‹çš„å…³ç³»æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥ä¸ä»»æ„ä¸€ç«¯å¯¹åº”çš„å…³ç³»æ¨¡å¼åˆå¹¶ã€‚<br>â‘  è½¬æ¢ä¸ºä¸€ä¸ªç‹¬ç«‹çš„å…³ç³»æ¨¡å¼<br>å…³ç³»çš„å±æ€§ï¼šä¸è¯¥è”ç³»ç›¸è¿çš„å„å®ä½“çš„ç ä»¥åŠè”ç³»æœ¬èº«çš„å±æ€§<br>å…³ç³»çš„å€™é€‰ç ï¼šæ¯ä¸ªå®ä½“çš„ç å‡æ˜¯è¯¥å…³ç³»çš„å€™é€‰ç </li><li>è”ç³»å½¢æˆçš„å…³ç³»ç‹¬ç«‹å­˜åœ¨ï¼š<br>èŒå·¥ï¼ˆèŒå·¥å·ï¼Œå§“åï¼Œå¹´é¾„ï¼‰<br>äº§å“ï¼ˆäº§å“å·ï¼Œäº§å“åï¼Œä»·æ ¼ï¼‰<br>è´Ÿè´£ï¼ˆèŒå·¥å·ï¼Œäº§å“å·ï¼‰</li><li>ä¸€ä¸ª1:1è”ç³»çš„è½¬æ¢ï¼ˆç»­ï¼‰<br>â‘¡ä¸æŸä¸€ç«¯å®ä½“å¯¹åº”çš„å…³ç³»æ¨¡å¼åˆå¹¶<br>åˆå¹¶åå…³ç³»çš„å±æ€§ï¼šåŠ å…¥å¯¹åº”å…³ç³»çš„ç å’Œè”ç³»æœ¬èº«çš„å±æ€§<br>åˆå¹¶åå…³ç³»çš„ç ï¼šä¸å˜</li><li>â€œè´Ÿè´£â€ä¸â€œèŒå·¥â€ä¸¤å…³ç³»åˆå¹¶ï¼š<br>èŒå·¥ï¼ˆèŒå·¥å·ï¼Œå§“åï¼Œå¹´é¾„ï¼Œäº§å“å·ï¼‰<br>äº§å“ï¼ˆäº§å“å·ï¼Œäº§å“åï¼Œä»·æ ¼ï¼‰<br>ä¹Ÿå¯ä»¥â€œè´Ÿè´£â€ä¸â€œäº§å“â€ä¸¤å…³ç³»åˆå¹¶ï¼š<br>èŒå·¥ï¼ˆèŒå·¥å·ï¼Œå§“åï¼Œå¹´é¾„ï¼‰<br>äº§å“ï¼ˆäº§å“å·ï¼Œäº§å“åï¼Œä»·æ ¼ï¼ŒèŒå·¥å·ï¼‰</li><li>ä¸€ä¸ª1:nè”ç³»å¯ä»¥è½¬æ¢ä¸ºä¸€ä¸ªç‹¬ç«‹çš„å…³ç³»æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥ä¸nç«¯å¯¹åº”çš„å…³ç³»æ¨¡å¼åˆå¹¶ã€‚<br>â‘ è½¬æ¢ä¸ºä¸€ä¸ªç‹¬ç«‹çš„å…³ç³»æ¨¡å¼<br>å…³ç³»çš„å±æ€§ï¼šä¸è¯¥è”ç³»ç›¸è¿çš„å„å®ä½“çš„ç ä»¥åŠè”ç³»æœ¬èº«çš„å±æ€§<br>å…³ç³»çš„ç ï¼šnç«¯å®ä½“çš„ç </li><li>è”ç³»å½¢æˆçš„å…³ç³»ç‹¬ç«‹å­˜åœ¨ï¼š<br>ä»“åº“ï¼ˆä»“åº“å·ï¼Œåœ°ç‚¹ï¼Œé¢ç§¯ï¼‰<br>äº§å“ï¼ˆäº§å“å·ï¼Œäº§å“åï¼Œä»·æ ¼ï¼‰<br>ä»“å‚¨ï¼ˆäº§å“å·ï¼Œä»“åº“å·ï¼Œæ•°é‡ï¼‰</li><li>ä¸€ä¸ªm:nè”ç³»è½¬æ¢ä¸ºä¸€ä¸ªå…³ç³»æ¨¡å¼<br>å…³ç³»çš„å±æ€§ï¼šä¸è¯¥è”ç³»ç›¸è¿çš„å„å®ä½“çš„ç ä»¥åŠè”ç³»æœ¬èº«çš„å±æ€§<br>å…³ç³»çš„ç ï¼šå„å®ä½“ç çš„ç»„åˆ<br>[ä¾‹]â€œé€‰ä¿®â€è”ç³»æ˜¯ä¸€ä¸ªm:nè”ç³»ï¼Œå¯ä»¥å°†å®ƒè½¬æ¢ä¸ºå¦‚ä¸‹å…³ç³»æ¨¡å¼ï¼Œå…¶ä¸­å­¦å·ä¸è¯¾ç¨‹å·ä¸ºå…³ç³»çš„ç»„åˆç ï¼š<br>ã€€ã€€  é€‰ä¿®ï¼ˆå­¦å·ï¼Œè¯¾ç¨‹å·ï¼Œæˆç»©ï¼‰</li><li>ä¸‰ä¸ªæˆ–ä¸‰ä¸ªä»¥ä¸Šå®ä½“é—´çš„ä¸€ä¸ªå¤šå…ƒè”ç³»è½¬æ¢ä¸ºä¸€ä¸ªå…³ç³»æ¨¡å¼ã€‚<br>å…³ç³»çš„å±æ€§ï¼šä¸è¯¥å¤šå…ƒè”ç³»ç›¸è¿çš„å„å®ä½“çš„ç ä»¥åŠè”ç³»æœ¬èº«çš„å±æ€§<br>å…³ç³»çš„ç ï¼šå„å®ä½“ç çš„ç»„åˆ</li><li>ä¾›åº”å•†ï¼ˆä¾›åº”å•†å·ï¼Œä¾›åº”å•†åï¼Œåœ°å€ï¼‰<br>é›¶ä»¶ï¼ˆé›¶ä»¶å·ï¼Œé›¶ä»¶åï¼Œå•ä»·ï¼‰<br>äº§å“ï¼ˆäº§å“å·ï¼Œäº§å“åï¼Œå‹å·ï¼‰<br>ä¾›åº”ï¼ˆä¾›åº”å•†å·ï¼Œé›¶ä»¶å·ï¼Œäº§å“å·ï¼Œæ•°é‡ï¼‰</li></ul></li></ul><h3 id="æ•°æ®æ¨¡å‹çš„ä¼˜åŒ–">æ•°æ®æ¨¡å‹çš„ä¼˜åŒ–</h3><ul><li><p>ä¸€èˆ¬çš„æ•°æ®æ¨¡å‹è¿˜éœ€è¦å‘ç‰¹å®šæ•°æ®åº“ç®¡ç†ç³»ç»Ÿè§„å®šçš„æ¨¡å‹è¿›è¡Œè½¬æ¢ã€‚</p></li><li><p>è½¬æ¢çš„ä¸»è¦ä¾æ®æ˜¯æ‰€é€‰ç”¨çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„åŠŸèƒ½åŠé™åˆ¶ã€‚æ²¡æœ‰é€šç”¨è§„åˆ™ã€‚</p></li><li><p>å¯¹äºå…³ç³»æ¨¡å‹æ¥è¯´ï¼Œè¿™ç§è½¬æ¢é€šå¸¸éƒ½æ¯”è¾ƒç®€å•ã€‚</p></li><li><p>ä¸€èˆ¬çš„æ•°æ®æ¨¡å‹è¿˜éœ€è¦å‘ç‰¹å®šæ•°æ®åº“ç®¡ç†ç³»ç»Ÿè§„å®šçš„æ¨¡å‹è¿›è¡Œè½¬æ¢ã€‚</p></li><li><p>è½¬æ¢çš„ä¸»è¦ä¾æ®æ˜¯æ‰€é€‰ç”¨çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„åŠŸèƒ½åŠé™åˆ¶ã€‚æ²¡æœ‰é€šç”¨è§„åˆ™ã€‚</p></li><li><p>å¯¹äºå…³ç³»æ¨¡å‹æ¥è¯´ï¼Œè¿™ç§è½¬æ¢é€šå¸¸éƒ½æ¯”è¾ƒç®€å•ã€‚</p></li><li><p>ä¼˜åŒ–æ•°æ®æ¨¡å‹çš„æ–¹æ³•:<br>ï¼ˆ1ï¼‰ç¡®å®šæ•°æ®ä¾èµ–<br>æŒ‰éœ€æ±‚åˆ†æé˜¶æ®µæ‰€å¾—åˆ°çš„è¯­ä¹‰ï¼Œåˆ†åˆ«å†™å‡ºæ¯ä¸ªå…³ç³»æ¨¡å¼å†…éƒ¨å„å±æ€§ä¹‹é—´çš„æ•°æ®ä¾èµ–ä»¥åŠä¸åŒå…³ç³»æ¨¡å¼å±æ€§ä¹‹é—´æ•°æ®ä¾èµ–ã€‚<br>ï¼ˆ2ï¼‰å¯¹äºå„ä¸ªå…³ç³»æ¨¡å¼ä¹‹é—´çš„æ•°æ®ä¾èµ–è¿›è¡Œæå°åŒ–å¤„ç†ï¼Œæ¶ˆé™¤å†—ä½™çš„è”ç³»ã€‚</p><p>ï¼ˆ3ï¼‰æŒ‰ç…§æ•°æ®ä¾èµ–çš„ç†è®ºå¯¹å…³ç³»æ¨¡å¼è¿›è¡Œåˆ†æï¼Œè€ƒå¯Ÿæ˜¯å¦å­˜åœ¨éƒ¨åˆ†å‡½æ•°ä¾èµ–ã€ä¼ é€’å‡½æ•°ä¾èµ–ã€å¤šå€¼ä¾èµ–ç­‰ï¼Œç¡®å®šå„å…³ç³»æ¨¡å¼åˆ†åˆ«å±äºç¬¬å‡ èŒƒå¼ã€‚<br>ï¼ˆ4ï¼‰æŒ‰ç…§éœ€æ±‚åˆ†æé˜¶æ®µå¾—åˆ°çš„å„ç§åº”ç”¨å¯¹æ•°æ®å¤„ç†çš„è¦æ±‚ï¼Œåˆ†æå¯¹äºè¿™æ ·çš„åº”ç”¨ç¯å¢ƒè¿™äº›æ¨¡å¼æ˜¯å¦åˆé€‚ï¼Œç¡®å®šæ˜¯å¦è¦å¯¹å®ƒä»¬è¿›è¡Œåˆå¹¶æˆ–åˆ†è§£ã€‚</p><p>ï¼ˆ5ï¼‰å¯¹å…³ç³»æ¨¡å¼è¿›è¡Œå¿…è¦åˆ†è§£ï¼Œæé«˜æ•°æ®æ“ä½œæ•ˆç‡å’Œå­˜å‚¨ç©ºé—´çš„åˆ©ç”¨ç‡ã€‚</p><ul><li><p>å¸¸ç”¨åˆ†è§£æ–¹æ³•</p></li><li><p>æ°´å¹³åˆ†è§£</p><ul><li><p>ä»€ä¹ˆæ˜¯æ°´å¹³åˆ†è§£<br>æŠŠ(åŸºæœ¬)å…³ç³»çš„å…ƒç»„åˆ†ä¸ºè‹¥å¹²å­é›†åˆï¼Œå®šä¹‰æ¯ä¸ªå­é›†åˆä¸ºä¸€ä¸ªå­å…³ç³»ï¼Œä»¥æé«˜ç³»ç»Ÿçš„æ•ˆç‡ã€‚</p></li><li><p>å¦‚ä½•åˆ†è§£</p><p>å¯¹ç¬¦åˆ80/20çš„ï¼ŒæŠŠç»å¸¸è¢«ä½¿ç”¨çš„æ•°æ®ï¼ˆçº¦20%ï¼‰<br>æ°´å¹³åˆ†è§£å‡ºæ¥ï¼Œå½¢æˆä¸€ä¸ªå­å…³ç³»ã€‚<br>æ°´å¹³åˆ†è§£ä¸ºè‹¥å¹²å­å…³ç³»ï¼Œä½¿æ¯ä¸ªäº‹åŠ¡å­˜å–çš„æ•°æ®å¯¹åº”ä¸€ä¸ªå­å…³ç³»ã€‚</p></li></ul></li><li><p>å‚ç›´åˆ†è§£</p><ul><li>ä»€ä¹ˆæ˜¯å‚ç›´åˆ†è§£<br>æŠŠå…³ç³»æ¨¡å¼Rçš„å±æ€§åˆ†è§£ä¸ºè‹¥å¹²å­é›†åˆï¼Œå½¢æˆè‹¥å¹²å­å…³ç³»æ¨¡å¼ã€‚</li><li>å‚ç›´åˆ†è§£çš„åŸåˆ™<br>ç»å¸¸åœ¨ä¸€èµ·ä½¿ç”¨çš„å±æ€§ä»Rä¸­åˆ†è§£å‡ºæ¥å½¢æˆä¸€ä¸ªå­å…³ç³»æ¨¡å¼</li><li>å‚ç›´åˆ†è§£çš„ä¼˜ç‚¹<br>å¯ä»¥æé«˜æŸäº›äº‹åŠ¡çš„æ•ˆç‡</li><li>å‚ç›´åˆ†è§£çš„ç¼ºç‚¹<br>å¯èƒ½ä½¿å¦ä¸€äº›äº‹åŠ¡ä¸å¾—ä¸æ‰§è¡Œè¿æ¥æ“ä½œï¼Œé™ä½äº†æ•ˆç‡</li></ul></li></ul></li><li><p>å¹¶ä¸æ˜¯è§„èŒƒåŒ–ç¨‹åº¦è¶Šé«˜çš„å…³ç³»å°±è¶Šä¼˜</p><ul><li>å½“æŸ¥è¯¢ç»å¸¸æ¶‰åŠä¸¤ä¸ªæˆ–å¤šä¸ªå…³ç³»æ¨¡å¼çš„å±æ€§æ—¶ï¼Œç³»ç»Ÿå¿…é¡»ç»å¸¸åœ°è¿›è¡Œè¿æ¥è¿ç®—</li><li>è¿æ¥è¿ç®—çš„ä»£ä»·æ˜¯ç›¸å½“é«˜çš„</li><li>å› æ­¤åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¬¬äºŒèŒƒå¼ç”šè‡³ç¬¬ä¸€èŒƒå¼ä¹Ÿè®¸æ˜¯é€‚åˆçš„ã€‚</li></ul></li><li><p>éBCNFçš„å…³ç³»æ¨¡å¼è™½ç„¶ä¼šå­˜åœ¨ä¸åŒç¨‹åº¦çš„æ›´æ–°å¼‚å¸¸ï¼Œä½†å¦‚æœåœ¨å®é™…åº”ç”¨ä¸­å¯¹æ­¤å…³ç³»æ¨¡å¼åªæ˜¯æŸ¥è¯¢ï¼Œå¹¶ä¸æ‰§è¡Œæ›´æ–°æ“ä½œï¼Œå°±ä¸ä¼šäº§ç”Ÿå®é™…å½±å“ã€‚</p></li><li><p>å¯¹äºä¸€ä¸ªå…·ä½“åº”ç”¨æ¥è¯´ï¼Œåˆ°åº•è§„èŒƒåŒ–è¿›è¡Œåˆ°ä»€ä¹ˆç¨‹åº¦ï¼Œéœ€è¦æƒè¡¡å“åº”æ—¶é—´å’Œæ½œåœ¨é—®é¢˜ä¸¤è€…çš„åˆ©å¼Šæ‰èƒ½å†³å®š</p></li></ul><h3 id="è®¾è®¡ç”¨æˆ·å­æ¨¡å¼">è®¾è®¡ç”¨æˆ·å­æ¨¡å¼</h3><ul><li>å®šä¹‰æ•°æ®åº“æ¨¡å¼ä¸»è¦æ˜¯ä»ç³»ç»Ÿçš„æ—¶é—´æ•ˆç‡ã€ç©ºé—´æ•ˆç‡ã€æ˜“ç»´æŠ¤ç­‰è§’åº¦å‡ºå‘ã€‚</li><li>å®šä¹‰ç”¨æˆ·å¤–æ¨¡å¼æ—¶åº”è¯¥æ›´æ³¨é‡è€ƒè™‘ç”¨æˆ·çš„ä¹ æƒ¯ä¸æ–¹ä¾¿ã€‚åŒ…æ‹¬ä¸‰ä¸ªæ–¹é¢ï¼š<ul><li>ï¼ˆ1ï¼‰ä½¿ç”¨æ›´ç¬¦åˆç”¨æˆ·ä¹ æƒ¯çš„åˆ«å<br>åˆå¹¶å„åˆ†E-Rå›¾æ›¾åšäº†æ¶ˆé™¤å‘½åå†²çªçš„å·¥ä½œï¼Œä»¥ä½¿æ•°æ®åº“ç³»ç»Ÿä¸­åŒä¸€å…³ç³»å’Œå±æ€§å…·æœ‰å”¯ä¸€çš„åå­—ã€‚è¿™åœ¨è®¾è®¡æ•°æ®åº“æ•´ä½“ç»“æ„æ—¶æ˜¯éå¸¸å¿…è¦çš„ã€‚<br>ç”¨è§†å›¾æœºåˆ¶å¯ä»¥åœ¨è®¾è®¡ç”¨æˆ·è§†å›¾æ—¶å¯ä»¥é‡æ–°å®šä¹‰æŸäº›å±æ€§åï¼Œä½¿å…¶ä¸ç”¨æˆ·ä¹ æƒ¯ä¸€è‡´ï¼Œä»¥æ–¹ä¾¿ä½¿ç”¨ã€‚</li><li>ï¼ˆ2ï¼‰é’ˆå¯¹ä¸åŒçº§åˆ«çš„ç”¨æˆ·å®šä¹‰ä¸åŒçš„è§†å›¾ï¼Œä»¥ä¿è¯ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚<br>å‡è®¾æœ‰å…³ç³»æ¨¡å¼äº§å“ï¼ˆäº§å“å·ï¼Œäº§å“åï¼Œè§„æ ¼ï¼Œå•ä»·ï¼Œç”Ÿäº§è½¦é—´ï¼Œç”Ÿäº§è´Ÿè´£äººï¼Œäº§å“æˆæœ¬ï¼Œäº§å“åˆæ ¼ç‡ï¼Œè´¨é‡ç­‰çº§ï¼‰ï¼Œå¯ä»¥åœ¨äº§å“å…³ç³»ä¸Šå»ºç«‹ä¸¤ä¸ªè§†å›¾ï¼š<br>ä¸ºä¸€èˆ¬é¡¾å®¢å»ºç«‹è§†å›¾ï¼š    äº§å“1ï¼ˆäº§å“å·ï¼Œäº§å“åï¼Œè§„æ ¼ï¼Œå•ä»·ï¼‰<br>ä¸ºäº§å“é”€å”®éƒ¨é—¨å»ºç«‹è§†å›¾ï¼š    äº§å“2ï¼ˆäº§å“å·ï¼Œäº§å“åï¼Œè§„æ ¼ï¼Œå•ä»·ï¼Œè½¦é—´ï¼Œ<br>ç”Ÿäº§è´Ÿè´£äººï¼‰</li><li>ï¼ˆ3ï¼‰ç®€åŒ–ç”¨æˆ·å¯¹ç³»ç»Ÿçš„ä½¿ç”¨</li><li>å¦‚æœæŸäº›å±€éƒ¨åº”ç”¨ä¸­ç»å¸¸è¦ä½¿ç”¨æŸäº›å¾ˆå¤æ‚çš„æŸ¥è¯¢ï¼Œä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ï¼Œå¯ä»¥å°†è¿™äº›å¤æ‚æŸ¥è¯¢å®šä¹‰ä¸ºè§†å›¾ã€‚</li></ul></li></ul><h2 id="ç‰©ç†ç»“æ„è®¾è®¡">ç‰©ç†ç»“æ„è®¾è®¡</h2><ul><li><p>ä»€ä¹ˆæ˜¯æ•°æ®åº“çš„ç‰©ç†è®¾è®¡</p><ul><li>æ•°æ®åº“åœ¨ç‰©ç†è®¾å¤‡ä¸Šçš„å­˜å‚¨ç»“æ„ä¸å­˜å–æ–¹æ³•ç§°ä¸ºæ•°æ®åº“çš„ç‰©ç†ç»“æ„ï¼Œå®ƒä¾èµ–äºé€‰å®šçš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€‚</li><li>ä¸ºä¸€ä¸ªç»™å®šçš„é€»è¾‘æ•°æ®æ¨¡å‹é€‰å–ä¸€ä¸ªæœ€é€‚åˆåº”ç”¨è¦æ±‚çš„ç‰©ç†ç»“æ„çš„è¿‡ç¨‹ï¼Œå°±æ˜¯æ•°æ®åº“çš„ç‰©ç†è®¾è®¡ã€‚</li></ul></li><li><p>æ•°æ®åº“ç‰©ç†è®¾è®¡çš„æ­¥éª¤</p><ul><li>ç¡®å®šæ•°æ®åº“çš„ç‰©ç†ç»“æ„<br>åœ¨å…³ç³»æ•°æ®åº“ä¸­ä¸»è¦æŒ‡å­˜å–æ–¹æ³•å’Œå­˜å‚¨ç»“æ„;</li><li>å¯¹ç‰©ç†ç»“æ„è¿›è¡Œè¯„ä»·<br>è¯„ä»·çš„é‡ç‚¹æ˜¯æ—¶é—´å’Œç©ºé—´æ•ˆç‡</li><li>è‹¥è¯„ä»·ç»“æœæ»¡è¶³åŸè®¾è®¡è¦æ±‚ï¼Œåˆ™å¯è¿›å…¥åˆ°ç‰©ç†å®æ–½é˜¶æ®µã€‚å¦åˆ™ï¼Œå°±éœ€è¦é‡æ–°è®¾è®¡æˆ–ä¿®æ”¹ç‰©ç†ç»“æ„ï¼Œæœ‰æ—¶ç”šè‡³è¦è¿”å›é€»è¾‘è®¾è®¡é˜¶æ®µä¿®æ”¹æ•°æ®æ¨¡å‹ã€‚</li></ul></li></ul><h3 id="æ•°æ®åº“ç‰©ç†è®¾è®¡çš„å†…å®¹å’Œæ–¹æ³•">æ•°æ®åº“ç‰©ç†è®¾è®¡çš„å†…å®¹å’Œæ–¹æ³•</h3><ul><li><p>è®¾è®¡ç‰©ç†æ•°æ®åº“ç»“æ„çš„å‡†å¤‡å·¥ä½œ</p><ul><li>å……åˆ†äº†è§£åº”ç”¨ç¯å¢ƒï¼Œè¯¦ç»†åˆ†æè¦è¿è¡Œçš„äº‹åŠ¡ï¼Œä»¥è·å¾—é€‰æ‹©ç‰©ç†æ•°æ®åº“è®¾è®¡æ‰€éœ€å‚æ•°ã€‚</li><li>å……åˆ†äº†è§£æ‰€ç”¨å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„å†…éƒ¨ç‰¹å¾ï¼Œç‰¹åˆ«æ˜¯ç³»ç»Ÿæä¾›çš„å­˜å–æ–¹æ³•å’Œå­˜å‚¨ç»“æ„ã€‚</li></ul></li><li><p>é€‰æ‹©ç‰©ç†æ•°æ®åº“è®¾è®¡æ‰€éœ€å‚æ•°</p><ul><li>æ•°æ®åº“æŸ¥è¯¢äº‹åŠ¡<ul><li>æŸ¥è¯¢çš„å…³ç³»</li><li>æŸ¥è¯¢æ¡ä»¶æ‰€æ¶‰åŠçš„å±æ€§</li><li>è¿æ¥æ¡ä»¶æ‰€æ¶‰åŠçš„å±æ€§</li><li>æŸ¥è¯¢çš„æŠ•å½±å±æ€§</li></ul></li><li>æ•°æ®æ›´æ–°äº‹åŠ¡<ul><li>è¢«æ›´æ–°çš„å…³ç³»</li><li>æ¯ä¸ªå…³ç³»ä¸Šçš„æ›´æ–°æ“ä½œæ¡ä»¶æ‰€æ¶‰åŠçš„å±æ€§</li><li>ä¿®æ”¹æ“ä½œè¦æ”¹å˜çš„å±æ€§å€¼</li></ul></li><li>æ¯ä¸ªäº‹åŠ¡åœ¨å„å…³ç³»ä¸Šè¿è¡Œçš„é¢‘ç‡å’Œæ€§èƒ½è¦æ±‚</li></ul></li><li><p>å…³ç³»æ•°æ®åº“ç‰©ç†è®¾è®¡çš„å†…å®¹</p><ul><li>ä¸ºå…³ç³»æ¨¡å¼é€‰æ‹©å­˜å–æ–¹æ³•ï¼ˆå»ºç«‹å­˜å–è·¯å¾„ï¼‰</li><li>è®¾è®¡å…³ç³»ã€ç´¢å¼•ç­‰æ•°æ®åº“æ–‡ä»¶çš„ç‰©ç†å­˜å‚¨ç»“æ„</li></ul></li></ul><h3 id="å…³ç³»æ¨¡å¼å­˜å–æ–¹æ³•é€‰æ‹©">å…³ç³»æ¨¡å¼å­˜å–æ–¹æ³•é€‰æ‹©</h3><ul><li><p>æ•°æ®åº“ç³»ç»Ÿæ˜¯å¤šç”¨æˆ·å…±äº«çš„ç³»ç»Ÿï¼Œå¯¹åŒä¸€ä¸ªå…³ç³»è¦å»ºç«‹å¤šæ¡å­˜å–è·¯å¾„æ‰èƒ½æ»¡è¶³å¤šç”¨æˆ·çš„å¤šç§åº”ç”¨è¦æ±‚ã€‚</p></li><li><p>ç‰©ç†ç»“æ„è®¾è®¡çš„ä»»åŠ¡ä¹‹ä¸€æ˜¯æ ¹æ®å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ”¯æŒçš„å­˜å–æ–¹æ³•ç¡®å®šé€‰æ‹©å“ªäº›å­˜å–æ–¹æ³•ã€‚</p></li><li><p>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå¸¸ç”¨å­˜å–æ–¹æ³•</p><ul><li>B+æ ‘ç´¢å¼•å­˜å–æ–¹æ³•</li><li>Hashç´¢å¼•å­˜å–æ–¹æ³•</li><li>èšç°‡å­˜å–æ–¹æ³•</li></ul></li><li><p>é€‰æ‹©ç´¢å¼•å­˜å–æ–¹æ³•çš„ä¸»è¦å†…å®¹</p><ul><li>æ ¹æ®åº”ç”¨è¦æ±‚ç¡®å®š</li><li>å¯¹å“ªäº›å±æ€§åˆ—å»ºç«‹ç´¢å¼•</li><li>å¯¹å“ªäº›å±æ€§åˆ—å»ºç«‹ç»„åˆç´¢å¼•</li><li>å¯¹å“ªäº›ç´¢å¼•è¦è®¾è®¡ä¸ºå”¯ä¸€ç´¢å¼•</li></ul></li><li><p>é€‰æ‹©ç´¢å¼•å­˜å–æ–¹æ³•çš„ä¸€èˆ¬è§„åˆ™</p><ul><li>å¦‚æœä¸€ä¸ªï¼ˆæˆ–ä¸€ç»„ï¼‰å±æ€§ç»å¸¸åœ¨æŸ¥è¯¢æ¡ä»¶ä¸­å‡ºç°ï¼Œåˆ™è€ƒè™‘åœ¨è¿™ä¸ªï¼ˆæˆ–è¿™ç»„ï¼‰å±æ€§ä¸Šå»ºç«‹ç´¢å¼•ï¼ˆæˆ–ç»„åˆç´¢å¼•ï¼‰</li><li>å¦‚æœä¸€ä¸ªå±æ€§ç»å¸¸ä½œä¸ºæœ€å¤§å€¼å’Œæœ€å°å€¼ç­‰èšé›†å‡½æ•°çš„å‚æ•°ï¼Œåˆ™è€ƒè™‘åœ¨è¿™ä¸ªå±æ€§ä¸Šå»ºç«‹ç´¢å¼•</li><li>å¦‚æœä¸€ä¸ªï¼ˆæˆ–ä¸€ç»„ï¼‰å±æ€§ç»å¸¸åœ¨è¿æ¥æ“ä½œçš„è¿æ¥æ¡ä»¶ä¸­ å‡ºç°ï¼Œåˆ™è€ƒè™‘åœ¨è¿™ä¸ªï¼ˆæˆ–è¿™ç»„ï¼‰å±æ€§ä¸Šå»ºç«‹ç´¢å¼•</li></ul></li><li><p>å…³ç³»ä¸Šå®šä¹‰çš„ç´¢å¼•æ•°è¿‡å¤šä¼šå¸¦æ¥è¾ƒå¤šçš„é¢å¤–å¼€é”€</p><ul><li>ç»´æŠ¤ç´¢å¼•çš„å¼€é”€</li><li>æŸ¥æ‰¾ç´¢å¼•çš„å¼€é”€</li></ul></li><li><p>é€‰æ‹©Hashå­˜å–æ–¹æ³•çš„è§„åˆ™</p><ul><li>å¦‚æœä¸€ä¸ªå…³ç³»çš„å±æ€§ä¸»è¦å‡ºç°åœ¨ç­‰å€¼è¿æ¥æ¡ä»¶ä¸­æˆ–ä¸»è¦å‡ºç°åœ¨ç­‰å€¼æ¯”è¾ƒé€‰æ‹©æ¡ä»¶ä¸­ï¼Œè€Œä¸”æ»¡è¶³ä¸‹åˆ—ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€<ul><li>è¯¥å…³ç³»çš„å¤§å°å¯é¢„çŸ¥ï¼Œè€Œä¸”ä¸å˜ï¼›</li><li>è¯¥å…³ç³»çš„å¤§å°åŠ¨æ€æ”¹å˜ï¼Œä½†æ‰€é€‰ç”¨çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæä¾›äº†åŠ¨æ€Hashå­˜å–æ–¹æ³•ã€‚</li></ul></li></ul></li><li><p>ä»€ä¹ˆæ˜¯èšç°‡</p><ul><li>ä¸ºäº†æé«˜æŸä¸ªå±æ€§ï¼ˆæˆ–å±æ€§ç»„ï¼‰çš„æŸ¥è¯¢é€Ÿåº¦ï¼ŒæŠŠè¿™ä¸ªæˆ–è¿™äº›å±æ€§ï¼ˆç§°ä¸ºèšç°‡ç ï¼‰ä¸Šå…·æœ‰ç›¸åŒå€¼çš„å…ƒç»„é›†ä¸­å­˜æ”¾åœ¨è¿ç»­çš„ç‰©ç†å—ä¸­ç§°ä¸ºèšç°‡ã€‚è¯¥å±æ€§ï¼ˆæˆ–å±æ€§ç»„ï¼‰ç§°ä¸ºèšç°‡ç ï¼ˆcluster keyï¼‰</li><li>è®¸å¤šå…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿéƒ½æä¾›äº†èšç°‡åŠŸèƒ½</li><li>èšç°‡å­˜æ”¾ä¸èšç°‡ç´¢å¼•çš„åŒºåˆ«</li></ul></li><li><p>èšç°‡ç´¢å¼•</p><ul><li>å»ºç«‹èšç°‡ç´¢å¼•åï¼ŒåŸºè¡¨ä¸­æ•°æ®ä¹Ÿéœ€è¦æŒ‰æŒ‡å®šçš„èšç°‡å±æ€§å€¼çš„å‡åºæˆ–é™åºå­˜æ”¾ã€‚ä¹Ÿå³èšç°‡ç´¢å¼•çš„ç´¢å¼•é¡¹é¡ºåºä¸è¡¨ä¸­å…ƒç»„çš„ç‰©ç†é¡ºåºä¸€è‡´ã€‚</li><li>åœ¨ä¸€ä¸ªåŸºæœ¬è¡¨ä¸Šæœ€å¤šåªèƒ½å»ºç«‹ä¸€ä¸ªèšç°‡ç´¢å¼•</li></ul></li><li><p>èšç°‡ç´¢å¼•çš„é€‚ç”¨æ¡ä»¶</p><ul><li><p>å¾ˆå°‘å¯¹åŸºè¡¨è¿›è¡Œå¢åˆ æ“ä½œ</p></li><li><p>å¾ˆå°‘å¯¹å…¶ä¸­çš„é•¿åˆ—è¿›è¡Œä¿®æ”¹æ“ä½œ</p></li></ul></li><li><p>èšç°‡çš„ç”¨é€”<br>å¯¹äºæŸäº›ç±»å‹çš„æŸ¥è¯¢ï¼Œå¯ä»¥æé«˜æŸ¥è¯¢æ•ˆç‡</p><ol><li>å¤§å¤§æé«˜æŒ‰èšç°‡å±æ€§è¿›è¡ŒæŸ¥è¯¢çš„æ•ˆç‡<br>[ä¾‹] å‡è®¾å­¦ç”Ÿå…³ç³»æŒ‰æ‰€åœ¨ç³»å»ºæœ‰ç´¢å¼•ï¼Œç°åœ¨è¦æŸ¥è¯¢ä¿¡æ¯ç³»çš„æ‰€æœ‰å­¦ç”Ÿåå•ã€‚<br>è®¡ç®—æœºç³»çš„500åå­¦ç”Ÿåˆ†å¸ƒåœ¨500ä¸ªä¸åŒçš„ç‰©ç†å—ä¸Šæ—¶ï¼Œè‡³å°‘è¦æ‰§è¡Œ500æ¬¡I/Oæ“ä½œã€‚<br>å¦‚æœå°†åŒä¸€ç³»çš„å­¦ç”Ÿå…ƒç»„é›†ä¸­å­˜æ”¾ï¼Œåˆ™æ¯è¯»ä¸€ä¸ªç‰©ç†å—å¯å¾—åˆ°å¤šä¸ªæ»¡è¶³æŸ¥è¯¢æ¡ä»¶çš„å…ƒç»„ï¼Œä»è€Œæ˜¾è‘—åœ°å‡å°‘äº†è®¿é—®ç£ç›˜çš„æ¬¡æ•°ã€‚</li><li>èŠ‚çœå­˜å‚¨ç©ºé—´<br>èšç°‡ä»¥åï¼Œèšç°‡ç ç›¸åŒçš„å…ƒç»„é›†ä¸­åœ¨ä¸€èµ·äº†ï¼Œå› è€Œèšç°‡ç å€¼ä¸å¿…åœ¨æ¯ä¸ªå…ƒç»„ä¸­é‡å¤å­˜å‚¨ï¼Œåªè¦åœ¨ä¸€ç»„ä¸­å­˜ä¸€æ¬¡å°±è¡Œäº†ã€‚</li></ol></li><li><p>èšç°‡çš„å±€é™æ€§</p><ul><li>èšç°‡åªèƒ½æé«˜æŸäº›ç‰¹å®šåº”ç”¨çš„æ€§èƒ½</li><li>å»ºç«‹ä¸ç»´æŠ¤èšç°‡çš„å¼€é”€ç›¸å½“å¤§<ul><li>å¯¹å·²æœ‰å…³ç³»å»ºç«‹èšç°‡ï¼Œå°†å¯¼è‡´å…³ç³»ä¸­å…ƒç»„çš„ç‰©ç†å­˜å‚¨ä½ç½®ç§»åŠ¨ï¼Œå¹¶ä½¿æ­¤å…³ç³»ä¸ŠåŸæœ‰çš„ç´¢å¼•æ— æ•ˆï¼Œå¿…é¡»é‡å»ºã€‚</li><li>å½“ä¸€ä¸ªå…ƒç»„çš„èšç°‡ç æ”¹å˜æ—¶ï¼Œè¯¥å…ƒç»„çš„å­˜å‚¨ä½ç½®ä¹Ÿè¦åšç›¸åº”æ”¹å˜ã€‚</li></ul></li></ul></li><li><p>èšç°‡çš„é€‚ç”¨èŒƒå›´</p><ul><li>æ—¢é€‚ç”¨äºå•ä¸ªå…³ç³»ç‹¬ç«‹èšç°‡ï¼Œä¹Ÿé€‚ç”¨äºå¤šä¸ªå…³ç³»ç»„åˆèšç°‡</li><li>å½“é€šè¿‡èšç°‡ç è¿›è¡Œè®¿é—®æˆ–è¿æ¥æ˜¯è¯¥å…³ç³»çš„ä¸»è¦åº”ç”¨ï¼Œä¸èšç°‡ç æ— å…³çš„å…¶ä»–è®¿é—®å¾ˆå°‘æˆ–è€…æ˜¯æ¬¡è¦çš„æ—¶ï¼Œå¯ä»¥ä½¿ç”¨èšç°‡<ul><li>å°¤å…¶å½“SQLè¯­å¥ä¸­åŒ…å«æœ‰ä¸èšç°‡ç æœ‰å…³çš„ORDER BY, GROUP BY, UNION, DISTINCTç­‰å­å¥æˆ–çŸ­è¯­æ—¶ï¼Œä½¿ç”¨èšç°‡ç‰¹åˆ«æœ‰åˆ©ï¼Œå¯ä»¥çœå»æˆ–å‡åŒ–å¯¹ç»“æœé›†çš„æ’åºæ“ä½œ</li></ul></li></ul></li><li><p>é€‰æ‹©èšç°‡å­˜å–æ–¹æ³•</p><ul><li>è®¾è®¡å€™é€‰èšç°‡<br>ï¼ˆ1ï¼‰å¸¸åœ¨ä¸€èµ·è¿›è¡Œè¿æ¥æ“ä½œçš„å…³ç³»å¯ä»¥å»ºç«‹ç»„åˆèšç°‡<br>ï¼ˆ2ï¼‰å¦‚æœä¸€ä¸ªå…³ç³»çš„ä¸€ç»„å±æ€§ç»å¸¸å‡ºç°åœ¨ç›¸ç­‰æ¯”è¾ƒæ¡<br>ä»¶ä¸­ï¼Œåˆ™è¯¥å•ä¸ªå…³ç³»å¯å»ºç«‹èšç°‡ï¼›<br>ï¼ˆ3ï¼‰å¦‚æœä¸€ä¸ªå…³ç³»çš„ä¸€ä¸ªï¼ˆæˆ–ä¸€ç»„ï¼‰å±æ€§ä¸Šçš„å€¼é‡å¤<br>ç‡å¾ˆé«˜ï¼Œåˆ™æ­¤å•ä¸ªå…³ç³»å¯å»ºç«‹èšç°‡ã€‚</li></ul></li><li><p>æ£€æŸ¥å€™é€‰èšç°‡ä¸­çš„å…³ç³»ï¼Œå–æ¶ˆå…¶ä¸­ä¸å¿…è¦çš„å…³ç³»<br>ï¼ˆ1ï¼‰ä»èšç°‡ä¸­åˆ é™¤ç»å¸¸è¿›è¡Œå…¨è¡¨æ‰«æçš„å…³ç³»<br>ï¼ˆ2ï¼‰ä»èšç°‡ä¸­åˆ é™¤æ›´æ–°æ“ä½œè¿œå¤šäºè¿æ¥æ“ä½œçš„å…³ç³»<br>ï¼ˆ3ï¼‰ä»èšç°‡ä¸­åˆ é™¤é‡å¤å‡ºç°çš„å…³ç³»</p><p>å½“ä¸€ä¸ªå…³ç³»åŒæ—¶åŠ å…¥å¤šä¸ªèšç°‡æ—¶ï¼Œå¿…é¡»ä»è¿™å¤šä¸ªèšç°‡æ–¹æ¡ˆ<br>ï¼ˆåŒ…æ‹¬ä¸å»ºç«‹èšç°‡ï¼‰ä¸­é€‰æ‹©ä¸€ä¸ªè¾ƒä¼˜çš„ï¼Œå³åœ¨è¿™ä¸ªèšç°‡ä¸Š<br>è¿è¡Œå„ç§äº‹åŠ¡çš„æ€»ä»£ä»·æœ€å°ã€‚</p></li></ul><h3 id="ç¡®å®šæ•°æ®åº“çš„å­˜å‚¨ç»“æ„">ç¡®å®šæ•°æ®åº“çš„å­˜å‚¨ç»“æ„</h3><ul><li><p>ç¡®å®šæ•°æ®åº“ç‰©ç†ç»“æ„ä¸»è¦æŒ‡ç¡®å®šæ•°æ®çš„å­˜æ”¾ä½ç½®å’Œå­˜å‚¨ç»“æ„ï¼ŒåŒ…æ‹¬ï¼šç¡®å®šå…³ç³»ã€ç´¢å¼•ã€èšç°‡ã€æ—¥å¿—ã€å¤‡ä»½ç­‰çš„å­˜å‚¨å®‰æ’å’Œå­˜å‚¨ç»“æ„ï¼Œç¡®å®šç³»ç»Ÿé…ç½®ç­‰ã€‚</p></li><li><p>ç¡®å®šæ•°æ®çš„å­˜æ”¾ä½ç½®å’Œå­˜å‚¨ç»“æ„è¦ç»¼åˆè€ƒè™‘å­˜å–æ—¶é—´ã€å­˜å‚¨ç©ºé—´åˆ©ç”¨ç‡å’Œç»´æŠ¤ä»£ä»·3ä¸ªæ–¹é¢çš„å› ç´ ã€‚</p></li><li><p>å½±å“æ•°æ®å­˜æ”¾ä½ç½®å’Œå­˜å‚¨ç»“æ„çš„å› ç´ </p><ul><li>ç¡¬ä»¶ç¯å¢ƒ</li><li>åº”ç”¨éœ€æ±‚<ul><li>å­˜å–æ—¶é—´</li><li>å­˜å‚¨ç©ºé—´åˆ©ç”¨ç‡</li><li>ç»´æŠ¤ä»£ä»·</li></ul></li><li>è¿™ä¸‰ä¸ªæ–¹é¢å¸¸å¸¸æ˜¯ç›¸äº’çŸ›ç›¾çš„</li></ul></li><li><p>åŸºæœ¬åŸåˆ™</p><ul><li>æ ¹æ®åº”ç”¨æƒ…å†µå°†<ul><li>æ˜“å˜éƒ¨åˆ†ä¸ç¨³å®šéƒ¨åˆ†åˆ†å¼€å­˜æ”¾</li><li>ç»å¸¸å­˜å–éƒ¨åˆ†ä¸å­˜å–é¢‘ç‡è¾ƒä½éƒ¨åˆ†åˆ†å¼€å­˜æ”¾</li></ul></li></ul></li><li><p>[ä¾‹]</p><ul><li>å¯ä»¥å°†æ¯”è¾ƒå¤§çš„è¡¨åˆ†åˆ«æ”¾åœ¨ä¸¤ä¸ªç£ç›˜ä¸Šï¼Œä»¥åŠ å¿«å­˜å–é€Ÿåº¦ï¼Œè¿™åœ¨å¤šç”¨æˆ·ç¯å¢ƒä¸‹ç‰¹åˆ«æœ‰æ•ˆã€‚</li><li>å¯ä»¥å°†æ—¥å¿—æ–‡ä»¶ä¸æ•°æ®åº“å¯¹è±¡ï¼ˆè¡¨ã€ç´¢å¼•ç­‰ï¼‰æ”¾åœ¨ä¸åŒçš„ç£ç›˜ä»¥æ”¹è¿›ç³»ç»Ÿçš„æ€§èƒ½ã€‚</li></ul></li><li><p>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸€èˆ¬éƒ½æä¾›äº†ä¸€äº›å­˜å‚¨åˆ†é…å‚æ•°</p><ul><li>åŒæ—¶ä½¿ç”¨æ•°æ®åº“çš„ç”¨æˆ·æ•°</li><li>åŒæ—¶æ‰“å¼€çš„æ•°æ®åº“å¯¹è±¡æ•°</li><li>å†…å­˜åˆ†é…å‚æ•°</li><li>ç¼“å†²åŒºåˆ†é…å‚æ•°ï¼ˆä½¿ç”¨çš„ç¼“å†²åŒºé•¿åº¦ã€ä¸ªæ•°ï¼‰</li><li>å­˜å‚¨åˆ†é…å‚æ•°</li><li>ç‰©ç†å—çš„å¤§å°</li><li>ç‰©ç†å—è£…å¡«å› å­</li><li>æ—¶é—´ç‰‡å¤§å°</li><li>æ•°æ®åº“çš„å¤§å°</li><li>é”çš„æ•°ç›®ç­‰</li></ul></li><li><p>ç³»ç»Ÿéƒ½ä¸ºè¿™äº›å˜é‡èµ‹äºˆäº†åˆç†çš„ç¼ºçœå€¼ã€‚åœ¨è¿›è¡Œç‰©ç†è®¾è®¡æ—¶éœ€è¦æ ¹æ®åº”ç”¨ç¯å¢ƒç¡®å®šè¿™äº›å‚æ•°å€¼ï¼Œä»¥ä½¿ç³»ç»Ÿæ€§èƒ½æœ€ä¼˜ã€‚</p></li><li><p>åœ¨ç‰©ç†è®¾è®¡æ—¶å¯¹ç³»ç»Ÿé…ç½®å˜é‡çš„è°ƒæ•´åªæ˜¯åˆæ­¥çš„ï¼Œè¦æ ¹æ®ç³»ç»Ÿå®é™…è¿è¡Œæƒ…å†µåšè¿›ä¸€æ­¥çš„è°ƒæ•´ï¼Œä»¥åˆ‡å®æ”¹è¿›ç³»ç»Ÿæ€§èƒ½ã€‚</p></li></ul><h3 id="è¯„ä»·ç‰©ç†ç»“æ„">è¯„ä»·ç‰©ç†ç»“æ„</h3><ul><li>å¯¹æ•°æ®åº“ç‰©ç†è®¾è®¡è¿‡ç¨‹ä¸­äº§ç”Ÿçš„å¤šç§æ–¹æ¡ˆè¿›è¡Œè¯„ä»·ï¼Œä»ä¸­é€‰æ‹©ä¸€ä¸ªè¾ƒä¼˜çš„æ–¹æ¡ˆä½œä¸ºæ•°æ®åº“çš„ç‰©ç†ç»“æ„ã€‚</li><li>è¯„ä»·æ–¹æ³•<ul><li>å®šé‡ä¼°ç®—å„ç§æ–¹æ¡ˆ<ul><li>å­˜å‚¨ç©ºé—´</li><li>å­˜å–æ—¶é—´</li><li>ç»´æŠ¤ä»£ä»·</li></ul></li><li>å¯¹ä¼°ç®—ç»“æœè¿›è¡Œæƒè¡¡ã€æ¯”è¾ƒï¼Œé€‰æ‹©å‡ºä¸€ä¸ªè¾ƒä¼˜çš„åˆç†çš„ç‰©ç†ç»“æ„ã€‚</li></ul></li></ul><h2 id="æ•°æ®åº“çš„å®æ–½å’Œç»´æŠ¤">æ•°æ®åº“çš„å®æ–½å’Œç»´æŠ¤</h2><h3 id="æ•°æ®çš„è½½å…¥å’Œåº”ç”¨ç¨‹åºçš„è°ƒè¯•">æ•°æ®çš„è½½å…¥å’Œåº”ç”¨ç¨‹åºçš„è°ƒè¯•</h3><ul><li><p>æ•°æ®åº“ç»“æ„å»ºç«‹å¥½åï¼Œå°±å¯ä»¥å‘æ•°æ®åº“ä¸­è£…è½½æ•°æ®äº†ã€‚ç»„ç»‡æ•°æ®å…¥åº“æ˜¯æ•°æ®åº“å®æ–½é˜¶æ®µæœ€ä¸»è¦çš„å·¥ä½œã€‚</p></li><li><p>æ•°æ®è£…è½½æ–¹æ³•</p><ul><li>äººå·¥æ–¹æ³•</li><li>è®¡ç®—æœºè¾…åŠ©æ•°æ®å…¥åº“</li></ul></li><li><p>æ•°æ®åº“åº”ç”¨ç¨‹åºçš„è®¾è®¡åº”è¯¥ä¸æ•°æ®è®¾è®¡å¹¶è¡Œè¿›è¡Œ</p></li><li><p>åœ¨ç»„ç»‡æ•°æ®å…¥åº“çš„åŒæ—¶è¿˜è¦è°ƒè¯•åº”ç”¨ç¨‹åº</p></li><li><p>åº”ç”¨ç¨‹åºçš„è®¾è®¡ã€ç¼–ç å’Œè°ƒè¯•çš„æ–¹æ³•ã€æ­¥éª¤åœ¨è½¯ä»¶å·¥ç¨‹ç­‰è¯¾ç¨‹ä¸­æœ‰è¯¦ç»†è®²è§£ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†</p></li></ul><h3 id="æ•°æ®åº“çš„è¯•è¿è¡Œ">æ•°æ®åº“çš„è¯•è¿è¡Œ</h3><ul><li><p>åº”ç”¨ç¨‹åºè°ƒè¯•å®Œæˆï¼Œå¹¶ä¸”å·²æœ‰ä¸€å°éƒ¨åˆ†æ•°æ®å…¥åº“åï¼Œå°±å¯ä»¥å¼€å§‹å¯¹æ•°æ®åº“ç³»ç»Ÿè¿›è¡Œè”åˆè°ƒè¯•ï¼Œä¹Ÿç§°æ•°æ®åº“çš„è¯•è¿è¡Œã€‚</p></li><li><p>ä¸»è¦å·¥ä½œåŒ…æ‹¬ï¼š</p><ul><li>åŠŸèƒ½æµ‹è¯•ï¼šå®é™…è¿è¡Œåº”ç”¨ç¨‹åºï¼Œæ‰§è¡Œå¯¹æ•°æ®åº“çš„å„ç§æ“ä½œï¼Œæµ‹è¯•åº”ç”¨ç¨‹åºçš„å„ç§åŠŸèƒ½ã€‚</li><li>æ€§èƒ½æµ‹è¯•ï¼šæµ‹é‡ç³»ç»Ÿçš„æ€§èƒ½æŒ‡æ ‡ï¼Œåˆ†ææ˜¯å¦ç¬¦åˆè®¾è®¡ç›®æ ‡ã€‚</li></ul></li><li><p>æ•°æ®åº“æ€§èƒ½æŒ‡æ ‡çš„æµ‹é‡</p><ul><li>æ•°æ®åº“ç‰©ç†è®¾è®¡é˜¶æ®µåœ¨è¯„ä»·æ•°æ®åº“ç»“æ„ä¼°ç®—æ—¶é—´ã€ç©ºé—´æŒ‡æ ‡æ—¶ï¼Œä½œäº†è®¸å¤šç®€åŒ–å’Œå‡è®¾ï¼Œå¿½ç•¥äº†è®¸å¤šæ¬¡è¦å› ç´ ï¼Œå› æ­¤ç»“æœå¿…ç„¶å¾ˆç²—ç³™ã€‚</li><li>æ•°æ®åº“è¯•è¿è¡Œåˆ™æ˜¯è¦å®é™…æµ‹é‡ç³»ç»Ÿçš„å„ç§æ€§èƒ½æŒ‡æ ‡ï¼ˆä¸ä»…æ˜¯æ—¶é—´ã€ç©ºé—´æŒ‡æ ‡ï¼‰ï¼Œå¦‚æœç»“æœä¸ç¬¦åˆè®¾è®¡ç›®æ ‡ï¼Œåˆ™éœ€è¦è¿”å›ç‰©ç†è®¾è®¡é˜¶æ®µï¼Œè°ƒæ•´ç‰©ç†ç»“æ„ï¼Œä¿®æ”¹å‚æ•°ï¼›æœ‰æ—¶ç”šè‡³éœ€è¦è¿”å›é€»è¾‘è®¾è®¡é˜¶æ®µï¼Œè°ƒæ•´é€»è¾‘ç»“æ„ã€‚</li></ul></li><li><p>æ•°æ®çš„åˆ†æœŸå…¥åº“</p><ul><li>é‡æ–°è®¾è®¡ç‰©ç†ç»“æ„ç”šè‡³é€»è¾‘ç»“æ„ï¼Œä¼šå¯¼è‡´æ•°æ®é‡æ–°å…¥åº“</li><li>ç”±äºæ•°æ®å…¥åº“å·¥ä½œé‡å®åœ¨å¤ªå¤§ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨åˆ†æœŸè¾“å…¥æ•°æ®çš„æ–¹æ³•<ul><li>å…ˆè¾“å…¥å°æ‰¹é‡æ•°æ®ä¾›å…ˆæœŸè”åˆè°ƒè¯•ä½¿ç”¨</li><li>å¾…è¯•è¿è¡ŒåŸºæœ¬åˆæ ¼åå†è¾“å…¥å¤§æ‰¹é‡æ•°æ®</li><li>é€æ­¥å¢åŠ æ•°æ®é‡ï¼Œé€æ­¥å®Œæˆè¿è¡Œè¯„ä»·</li></ul></li></ul></li><li><p>æ•°æ®åº“çš„è½¬å‚¨å’Œæ¢å¤</p><ul><li>åœ¨æ•°æ®åº“è¯•è¿è¡Œé˜¶æ®µï¼Œç³»ç»Ÿè¿˜ä¸ç¨³å®šï¼Œç¡¬ã€è½¯ä»¶æ•…éšœéšæ—¶éƒ½å¯èƒ½å‘ç”Ÿ</li><li>ç³»ç»Ÿçš„æ“ä½œäººå‘˜å¯¹æ–°ç³»ç»Ÿè¿˜ä¸ç†Ÿæ‚‰ï¼Œè¯¯æ“ä½œä¹Ÿä¸å¯é¿å…</li><li>å› æ­¤å¿…é¡»åšå¥½æ•°æ®åº“çš„è½¬å‚¨å’Œæ¢å¤å·¥ä½œï¼Œå°½é‡å‡å°‘å¯¹æ•°æ®åº“çš„ç ´å</li></ul></li></ul><h3 id="æ•°æ®åº“çš„è¿è¡Œå’Œç»´æŠ¤">æ•°æ®åº“çš„è¿è¡Œå’Œç»´æŠ¤</h3><ul><li><p>åœ¨æ•°æ®åº“è¿è¡Œé˜¶æ®µï¼Œå¯¹æ•°æ®åº“ç»å¸¸æ€§çš„ç»´æŠ¤å·¥ä½œä¸»è¦æ˜¯ç”±æ•°æ®åº“ç®¡ç†å‘˜å®Œæˆçš„ï¼ŒåŒ…æ‹¬ï¼š</p><ol><li><p>æ•°æ®åº“çš„è½¬å‚¨å’Œæ¢å¤<br>æ•°æ®åº“ç®¡ç†å‘˜è¦é’ˆå¯¹ä¸åŒçš„åº”ç”¨è¦æ±‚åˆ¶å®šä¸åŒçš„è½¬å‚¨è®¡åˆ’ï¼Œå®šæœŸå¯¹æ•°æ®åº“å’Œæ—¥å¿—æ–‡ä»¶è¿›è¡Œå¤‡ä»½ã€‚<br>ä¸€æ—¦å‘ç”Ÿä»‹è´¨æ•…éšœï¼Œå³åˆ©ç”¨æ•°æ®åº“å¤‡ä»½åŠæ—¥å¿—æ–‡ä»¶å¤‡ä»½ï¼Œå°½å¿«å°†æ•°æ®åº“æ¢å¤åˆ°æŸç§ä¸€è‡´æ€§çŠ¶æ€ã€‚</p></li><li><p>æ•°æ®åº“çš„å®‰å…¨æ€§ã€å®Œæ•´æ€§æ§åˆ¶</p><ul><li>åˆå§‹å®šä¹‰<br>æ•°æ®åº“ç®¡ç†å‘˜æ ¹æ®ç”¨æˆ·çš„å®é™…éœ€è¦æˆäºˆä¸åŒçš„æ“ä½œæƒé™<br>æ ¹æ®åº”ç”¨ç¯å¢ƒå®šä¹‰ä¸åŒçš„å®Œæ•´æ€§çº¦æŸæ¡ä»¶</li><li>ä¿®æ”¹å®šä¹‰<br>å½“åº”ç”¨ç¯å¢ƒå‘ç”Ÿå˜åŒ–ï¼Œå¯¹å®‰å…¨æ€§çš„è¦æ±‚ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ•°æ®åº“ç®¡ç†å‘˜éœ€è¦æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹åŸæœ‰çš„å®‰å…¨æ€§æ§åˆ¶<br>ç”±äºåº”ç”¨ç¯å¢ƒå‘ç”Ÿå˜åŒ–ï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§çº¦æŸæ¡ä»¶ä¹Ÿä¼šå˜åŒ–ï¼Œä¹Ÿéœ€è¦æ•°æ®åº“ç®¡ç†å‘˜ä¸æ–­ä¿®æ­£ï¼Œä»¥æ»¡è¶³ç”¨æˆ·è¦æ±‚</li></ul></li><li><p>æ•°æ®åº“æ€§èƒ½çš„ç›‘ç£ã€åˆ†æå’Œæ”¹è¿›</p><ul><li>åœ¨æ•°æ®åº“è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ•°æ®åº“ç®¡ç†å‘˜å¿…é¡»ç›‘ç£ç³»ç»Ÿè¿è¡Œï¼Œå¯¹ç›‘æµ‹æ•°æ®è¿›è¡Œåˆ†æï¼Œæ‰¾å‡ºæ”¹è¿›ç³»ç»Ÿæ€§èƒ½çš„æ–¹æ³•ã€‚<ul><li>åˆ©ç”¨ç›‘æµ‹å·¥å…·è·å–ç³»ç»Ÿè¿è¡Œè¿‡ç¨‹ä¸­ä¸€ç³»åˆ—æ€§èƒ½å‚æ•°çš„å€¼</li><li>é€šè¿‡ä»”ç»†åˆ†æè¿™äº›æ•°æ®ï¼Œåˆ¤æ–­å½“å‰ç³»ç»Ÿæ˜¯å¦å¤„äºæœ€ä½³è¿è¡ŒçŠ¶æ€</li><li>å¦‚æœä¸æ˜¯ï¼Œåˆ™éœ€è¦é€šè¿‡è°ƒæ•´æŸäº›å‚æ•°æ¥è¿›ä¸€æ­¥æ”¹è¿›æ•°æ®åº“æ€§èƒ½</li></ul></li></ul></li><li><p>æ•°æ®åº“çš„é‡ç»„ç»‡ä¸é‡æ„é€ <br>ï¼ˆ1ï¼‰æ•°æ®åº“çš„é‡ç»„ç»‡<br>ä¸ºä»€ä¹ˆè¦é‡ç»„ç»‡æ•°æ®åº“<br>æ•°æ®åº“è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œç”±äºè®°å½•çš„ä¸æ–­å¢ã€åˆ ã€æ”¹ï¼Œä¼šä½¿æ•°æ®åº“çš„ç‰©ç†å­˜å‚¨å˜åï¼Œä»è€Œé™ä½æ•°æ®åº“å­˜å‚¨ç©ºé—´çš„åˆ©ç”¨ç‡å’Œæ•°æ®çš„å­˜å–æ•ˆç‡ï¼Œä½¿æ•°æ®åº“çš„æ€§èƒ½ä¸‹é™ã€‚</p><ul><li><p>é‡ç»„ç»‡çš„å½¢å¼</p><ul><li>å…¨éƒ¨é‡ç»„ç»‡</li><li>éƒ¨åˆ†é‡ç»„ç»‡</li><li>åªå¯¹é¢‘ç¹å¢ã€åˆ çš„è¡¨è¿›è¡Œé‡ç»„ç»‡</li></ul></li><li><p>é‡ç»„ç»‡çš„ç›®æ ‡</p><p>æé«˜ç³»ç»Ÿæ€§èƒ½</p></li><li><p>é‡ç»„ç»‡çš„å·¥ä½œ</p><ul><li>æŒ‰åŸè®¾è®¡è¦æ±‚<br>é‡æ–°å®‰æ’å­˜å‚¨ä½ç½®<br>å›æ”¶åƒåœ¾<br>å‡å°‘æŒ‡é’ˆé“¾</li><li>æ•°æ®åº“çš„é‡ç»„ç»‡ä¸ä¼šæ”¹å˜åŸè®¾è®¡çš„æ•°æ®é€»è¾‘ç»“æ„å’Œç‰©ç†ç»“æ„</li></ul></li><li><p>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸€èˆ¬éƒ½æä¾›äº†ä¾›é‡ç»„ç»‡æ•°æ®åº“ä½¿ç”¨çš„å®ç”¨ç¨‹åºï¼Œå¸®åŠ©æ•°æ®åº“ç®¡ç†å‘˜é‡æ–°ç»„ç»‡æ•°æ®åº“ã€‚</p></li></ul><p>ï¼ˆ2ï¼‰æ•°æ®åº“çš„é‡æ„é€ </p><ul><li>ä¸ºä»€ä¹ˆè¦è¿›è¡Œæ•°æ®åº“çš„é‡æ„é€ <ul><li>æ•°æ®åº“åº”ç”¨ç¯å¢ƒå‘ç”Ÿå˜åŒ–ï¼Œä¼šå¯¼è‡´å®ä½“åŠå®ä½“é—´çš„è”ç³»ä¹Ÿå‘ç”Ÿç›¸åº”çš„å˜åŒ–ï¼Œä½¿åŸæœ‰çš„æ•°æ®åº“è®¾è®¡ä¸èƒ½å¾ˆå¥½åœ°æ»¡è¶³æ–°çš„éœ€æ±‚<ul><li>å¢åŠ æ–°çš„åº”ç”¨æˆ–æ–°çš„å®ä½“</li><li>å–æ¶ˆæŸäº›å·²æœ‰åº”ç”¨</li><li>æ”¹å˜æŸäº›å·²æœ‰åº”ç”¨</li></ul></li></ul></li></ul></li></ol></li><li><p>æ•°æ®åº“é‡æ„é€ çš„ä¸»è¦å·¥ä½œ</p><ul><li>æ ¹æ®æ–°ç¯å¢ƒè°ƒæ•´æ•°æ®åº“çš„æ¨¡å¼å’Œå†…æ¨¡å¼<ul><li>å¢åŠ æˆ–åˆ é™¤æŸäº›æ•°æ®é¡¹</li><li>æ”¹å˜æ•°æ®é¡¹çš„ç±»å‹</li><li>å¢åŠ æˆ–åˆ é™¤æŸä¸ªè¡¨</li><li>æ”¹å˜æ•°æ®åº“çš„å®¹é‡</li><li>å¢åŠ æˆ–åˆ é™¤æŸäº›ç´¢å¼•</li></ul></li></ul></li><li><p>é‡æ„é€ æ•°æ®åº“çš„ç¨‹åº¦æ˜¯æœ‰é™çš„</p><ul><li>è‹¥åº”ç”¨å˜åŒ–å¤ªå¤§ï¼Œå·²æ— æ³•é€šè¿‡é‡æ„æ•°æ®åº“æ¥æ»¡è¶³æ–°çš„éœ€æ±‚ï¼Œæˆ–é‡æ„æ•°æ®åº“çš„ä»£ä»·å¤ªå¤§ï¼Œåˆ™è¡¨æ˜ç°æœ‰æ•°æ®åº“åº”ç”¨ç³»ç»Ÿçš„ç”Ÿå‘½å‘¨æœŸå·²ç»ç»“æŸï¼Œåº”è¯¥é‡æ–°è®¾è®¡æ–°çš„æ•°æ®åº“åº”ç”¨ç³»ç»Ÿäº†ã€‚</li></ul></li></ul><h2 id="å°ç»“">å°ç»“</h2><ul><li><p>æ•°æ®åº“çš„è®¾è®¡è¿‡ç¨‹</p><ul><li>éœ€æ±‚åˆ†æ</li><li>æ¦‚å¿µç»“æ„è®¾è®¡</li><li>é€»è¾‘ç»“æ„è®¾è®¡</li><li>ç‰©ç†ç»“æ„è®¾è®¡</li><li>æ•°æ®åº“å®æ–½</li><li>æ•°æ®åº“è¿è¡Œç»´æŠ¤</li><li>è®¾è®¡è¿‡ç¨‹ä¸­å¾€å¾€è¿˜ä¼šæœ‰è®¸å¤šåå¤</li></ul></li><li><p>æ•°æ®åº“å„çº§æ¨¡å¼çš„å½¢æˆ</p><ul><li>éœ€æ±‚åˆ†æé˜¶æ®µï¼šç»¼åˆå„ä¸ªç”¨æˆ·çš„åº”ç”¨éœ€æ±‚ï¼ˆç°å®ä¸–ç•Œçš„éœ€æ±‚ï¼‰ã€‚</li><li>æ¦‚å¿µè®¾è®¡é˜¶æ®µï¼šæ¦‚å¿µæ¨¡å¼ï¼ˆä¿¡æ¯ä¸–ç•Œæ¨¡å‹ï¼‰ï¼Œç”¨E-Rå›¾æ¥æè¿°ã€‚</li><li>é€»è¾‘è®¾è®¡é˜¶æ®µï¼šé€»è¾‘æ¨¡å¼ã€å¤–æ¨¡å¼ã€‚</li><li>ç‰©ç†è®¾è®¡é˜¶æ®µï¼šå†…æ¨¡å¼ã€‚</li></ul></li><li><p>æ¦‚å¿µç»“æ„è®¾è®¡</p><ul><li>E-Ræ¨¡å‹çš„åŸºæœ¬æ¦‚å¿µå’Œå›¾ç¤ºæ–¹æ³•</li><li>E-Ræ¨¡å‹çš„è®¾è®¡</li><li>æŠŠE-Ræ¨¡å‹è½¬æ¢ä¸ºå…³ç³»æ¨¡å‹çš„æ–¹æ³•</li></ul></li><li><p>åœ¨é€»è¾‘è®¾è®¡é˜¶æ®µå°†E-Rå›¾è½¬æ¢æˆå…·ä½“çš„æ•°æ®åº“äº§å“æ”¯æŒçš„æ•°æ®æ¨¡å‹å¦‚å…³ç³»æ¨¡å‹ï¼Œå½¢æˆæ•°æ®åº“é€»è¾‘æ¨¡å¼ã€‚</p></li><li><p>ç„¶åæ ¹æ®ç”¨æˆ·å¤„ç†çš„è¦æ±‚ï¼Œå®‰å…¨æ€§çš„è€ƒè™‘ï¼Œåœ¨åŸºæœ¬è¡¨çš„åŸºç¡€ä¸Šå†å»ºç«‹å¿…è¦çš„è§†å›¾ï¼Œå½¢æˆæ•°æ®çš„å¤–æ¨¡å¼</p></li><li><p>åœ¨ç‰©ç†è®¾è®¡é˜¶æ®µæ ¹æ®DBMSç‰¹ç‚¹å’Œå¤„ç†çš„éœ€è¦ï¼Œè¿›è¡Œç‰©ç†å­˜å‚¨å®‰æ’ï¼Œè®¾è®¡ç´¢å¼•ï¼Œå½¢æˆæ•°æ®åº“å†…æ¨¡å¼</p></li></ul><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;é‡ç‚¹å’Œéš¾ç‚¹&quot;&gt;é‡ç‚¹å’Œéš¾ç‚¹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;é‡ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;æŒæ¡æ•°æ®åº“è®¾è®¡æ­¥éª¤å’Œæ•°æ®åº“è®¾è®¡è¿‡ç¨‹ä¸­çš„å„çº§æ¨¡å¼è®¾è®¡æ–¹æ³•ã€‚ç‰¹åˆ«æ˜¯æ•°æ®åº“æ¦‚å¿µç»“æ„çš„è®¾è®¡å’Œé€»è¾‘ç»“æ„çš„è®¾è®¡ï¼Œè¿™æ˜¯æ•°æ®åº“è®¾è®¡è¿‡ç¨‹ä¸­æœ€é‡è¦çš„ä¸¤ä¸ªç¯èŠ‚ã€‚ç‰¢å›ºæŒæ¡ç”¨E-Rå›¾æ¥è¡¨ç¤ºæ¦‚å¿µæ¨¡å‹çš„æ–¹æ³•ï¼ŒæŒ</summary>
      
    
    
    
    <category term="æ•°æ®åº“" scheme="https://lebronchao.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://lebronchao.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="æ•°æ®åº“" scheme="https://lebronchao.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="SQL" scheme="https://lebronchao.com/tags/SQL/"/>
    
    <category term="åç«¯" scheme="https://lebronchao.com/tags/%E5%90%8E%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>æ•°æ®åº“ç³»ç»Ÿ | ç¬¬å…­ç«  å…³ç³»æ•°æ®ç†è®º</title>
    <link href="https://lebronchao.com/2021/01/19/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E7%90%86%E8%AE%BA/"/>
    <id>https://lebronchao.com/2021/01/19/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E7%90%86%E8%AE%BA/</id>
    <published>2021-01-19T02:31:24.000Z</published>
    <updated>2021-01-19T06:54:24.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜çš„æå‡º">é—®é¢˜çš„æå‡º</h2><ul><li><p>å…³ç³»æ•°æ®åº“é€»è¾‘è®¾è®¡</p><ul><li>é’ˆå¯¹å…·ä½“é—®é¢˜ï¼Œå¦‚ä½•æ„é€ ä¸€ä¸ªé€‚åˆäºå®ƒçš„æ•°æ®æ¨¡å¼</li><li>æ•°æ®åº“é€»è¾‘è®¾è®¡çš„å·¥å…·â”€â”€å…³ç³»æ•°æ®åº“çš„è§„èŒƒåŒ–ç†è®º</li></ul></li><li><p>å…³ç³»æ¨¡å¼ç”±äº”éƒ¨åˆ†ç»„æˆï¼Œæ˜¯ä¸€ä¸ªäº”å…ƒç»„ï¼š</p><p>R(U, D, DOM, F)</p><ul><li>å…³ç³»åRæ˜¯ç¬¦å·åŒ–çš„å…ƒç»„è¯­ä¹‰</li><li>Uä¸ºä¸€ç»„å±æ€§</li><li>Dä¸ºå±æ€§ç»„Uä¸­çš„å±æ€§æ‰€æ¥è‡ªçš„åŸŸ</li><li>DOMä¸ºå±æ€§åˆ°åŸŸçš„æ˜ å°„</li><li>Fä¸ºå±æ€§ç»„Uä¸Šçš„ä¸€ç»„æ•°æ®ä¾èµ–</li></ul></li><li><p>ç”±äºDã€DOMä¸æ¨¡å¼è®¾è®¡å…³ç³»ä¸å¤§ï¼Œå› æ­¤åœ¨æœ¬ç« ä¸­æŠŠå…³ç³»æ¨¡å¼çœ‹ä½œä¸€ä¸ªä¸‰å…ƒç»„ï¼šR&lt;U,F&gt;</p></li><li><p>å½“ä¸”ä»…å½“Uä¸Šçš„ä¸€ä¸ªå…³ç³»ræ»¡è¶³Fæ—¶ï¼Œrç§°ä¸ºå…³ç³»æ¨¡å¼R&lt;U,F&gt;çš„ä¸€ä¸ªå…³ç³»</p></li><li><p>ä½œä¸ºäºŒç»´è¡¨ï¼Œå…³ç³»è¦ç¬¦åˆä¸€ä¸ªæœ€åŸºæœ¬çš„æ¡ä»¶ï¼šæ¯ä¸ªåˆ†é‡å¿…é¡»æ˜¯ä¸å¯åˆ†å¼€çš„æ•°æ®é¡¹ã€‚æ»¡è¶³äº†è¿™ä¸ªæ¡ä»¶çš„å…³ç³»æ¨¡å¼å°±å±äºç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰</p></li><li><p>æ•°æ®ä¾èµ–</p><ul><li>æ˜¯ä¸€ä¸ªå…³ç³»å†…éƒ¨å±æ€§ä¸å±æ€§ä¹‹é—´çš„ä¸€ç§çº¦æŸå…³ç³»</li><li>é€šè¿‡å±æ€§é—´å€¼çš„ç›¸ç­‰ä¸å¦ä½“ç°å‡ºæ¥çš„æ•°æ®é—´ç›¸äº’è”ç³»</li><li>æ˜¯ç°å®ä¸–ç•Œå±æ€§é—´ç›¸äº’è”ç³»çš„æŠ½è±¡</li><li>æ˜¯æ•°æ®å†…åœ¨çš„æ€§è´¨</li><li>æ˜¯è¯­ä¹‰çš„ä½“ç°</li></ul></li><li><p>æ•°æ®ä¾èµ–çš„ä¸»è¦ç±»å‹</p><ul><li>å‡½æ•°ä¾èµ–ï¼ˆFunctional Dependencyï¼Œç®€è®°ä¸ºFDï¼‰</li><li>å¤šå€¼ä¾èµ–ï¼ˆMulti-Valued Dependencyï¼Œç®€è®°ä¸ºMVDï¼‰</li></ul></li><li><p>å‡½æ•°ä¾èµ–æ™®éå­˜åœ¨äºç°å®ç”Ÿæ´»ä¸­</p><ul><li>æè¿°ä¸€ä¸ªå­¦ç”Ÿå…³ç³»ï¼Œå¯ä»¥æœ‰å­¦å·ã€å§“åã€ç³»åç­‰å±æ€§ã€‚</li><li>ä¸€ä¸ªå­¦å·åªå¯¹åº”ä¸€ä¸ªå­¦ç”Ÿï¼Œä¸€ä¸ªå­¦ç”Ÿåªåœ¨ä¸€ä¸ªç³»ä¸­å­¦ä¹ </li><li>â€œå­¦å·â€å€¼ç¡®å®šåï¼Œå­¦ç”Ÿçš„å§“ååŠæ‰€åœ¨ç³»çš„å€¼å°±è¢«å”¯ä¸€ç¡®å®šã€‚</li><li>Sname=f(Sno)ï¼ŒSdept=f(Sno)<ul><li>å³Snoå‡½æ•°å†³å®šSname</li><li>Snoå‡½æ•°å†³å®šSdept</li><li>è®°ä½œSnoâ†’Snameï¼ŒSnoâ†’Sdept</li></ul></li></ul></li><li><p>[ä¾‹6.1] å»ºç«‹ä¸€ä¸ªæè¿°å­¦æ ¡æ•™åŠ¡çš„æ•°æ®åº“ã€‚æ¶‰åŠçš„å¯¹è±¡åŒ…æ‹¬ï¼š</p><ul><li>å­¦ç”Ÿçš„å­¦å·ï¼ˆSnoï¼‰</li><li>æ‰€åœ¨ç³»ï¼ˆSdeptï¼‰</li><li>ç³»ä¸»ä»»å§“åï¼ˆMnameï¼‰</li><li>è¯¾ç¨‹å·ï¼ˆCnoï¼‰</li><li>æˆç»©ï¼ˆGradeï¼‰</li></ul></li><li><p>å‡è®¾å­¦æ ¡æ•™åŠ¡çš„æ•°æ®åº“æ¨¡å¼ç”¨ä¸€ä¸ªå•ä¸€çš„å…³ç³»æ¨¡å¼Studentæ¥è¡¨ç¤ºï¼Œåˆ™è¯¥å…³ç³»æ¨¡å¼çš„å±æ€§é›†åˆä¸ºï¼šU ï¼{Sno, Sdept, Mname, Cno, Grade}</p><ul><li>ç°å®ä¸–ç•Œçš„å·²çŸ¥äº‹å®ï¼ˆè¯­ä¹‰ï¼‰ï¼š<ul><li>ä¸€ä¸ªç³»æœ‰è‹¥å¹²å­¦ç”Ÿï¼Œ ä½†ä¸€ä¸ªå­¦ç”Ÿåªå±äºä¸€ä¸ªç³»ï¼›</li><li>ä¸€ä¸ªç³»åªæœ‰ä¸€åï¼ˆæ­£èŒï¼‰è´Ÿè´£äººï¼›</li><li>ä¸€ä¸ªå­¦ç”Ÿå¯ä»¥é€‰ä¿®å¤šé—¨è¯¾ç¨‹ï¼Œæ¯é—¨è¯¾ç¨‹æœ‰è‹¥å¹²å­¦ç”Ÿé€‰ä¿®ï¼›</li><li>æ¯ä¸ªå­¦ç”Ÿå­¦ä¹ æ¯ä¸€é—¨è¯¾ç¨‹æœ‰ä¸€ä¸ªæˆç»©ã€‚</li></ul></li></ul></li><li><p>ç”±æ­¤å¯å¾—åˆ°å±æ€§ç»„Uä¸Šçš„ä¸€ç»„å‡½æ•°ä¾èµ–Fï¼š<br>F={Snoâ†’Sdept, Sdeptâ†’ Mname, (Sno, Cno)â†’ Grade}</p></li><li><p>å…³ç³»æ¨¡å¼Student&lt;U, F&gt;ä¸­å­˜åœ¨çš„é—®é¢˜ï¼š<br>ï¼ˆ1ï¼‰æ•°æ®å†—ä½™</p><ul><li>æµªè´¹å¤§é‡çš„å­˜å‚¨ç©ºé—´<ul><li>æ¯ä¸€ä¸ªç³»ä¸»ä»»çš„å§“åé‡å¤å‡ºç°ï¼Œé‡å¤æ¬¡æ•°ä¸è¯¥ç³»æ‰€æœ‰å­¦ç”Ÿçš„æ‰€æœ‰è¯¾ç¨‹æˆç»©å‡ºç°æ¬¡æ•°ç›¸åŒã€‚</li></ul></li></ul><p>ï¼ˆ2ï¼‰æ›´æ–°å¼‚å¸¸ï¼ˆUpdate Anomaliesï¼‰</p><ul><li>æ•°æ®å†—ä½™ ï¼Œæ›´æ–°æ•°æ®æ—¶ï¼Œç»´æŠ¤æ•°æ®å®Œæ•´æ€§ä»£ä»·å¤§ã€‚<ul><li>æŸç³»æ›´æ¢ç³»ä¸»ä»»åï¼Œå¿…é¡»ä¿®æ”¹ä¸è¯¥ç³»å­¦ç”Ÿæœ‰å…³çš„æ¯ä¸€ä¸ªå…ƒç»„ã€‚</li></ul></li></ul><p>ï¼ˆ3ï¼‰æ’å…¥å¼‚å¸¸ï¼ˆInsertion Anomaliesï¼‰</p><ul><li>å¦‚æœä¸€ä¸ªç³»åˆšæˆç«‹ï¼Œå°šæ— å­¦ç”Ÿï¼Œåˆ™æ— æ³•æŠŠè¿™ä¸ªç³»åŠå…¶ç³»ä¸»ä»»çš„ä¿¡æ¯å­˜å…¥æ•°æ®åº“ã€‚</li></ul><p>ï¼ˆ4ï¼‰åˆ é™¤å¼‚å¸¸ï¼ˆDeletion Anomaliesï¼‰</p><ul><li>å¦‚æœæŸä¸ªç³»çš„å­¦ç”Ÿå…¨éƒ¨æ¯•ä¸šäº†ï¼Œ åˆ™åœ¨åˆ é™¤è¯¥ç³»å­¦ç”Ÿä¿¡æ¯çš„åŒæ—¶ï¼ŒæŠŠè¿™ä¸ªç³»åŠå…¶ç³»ä¸»ä»»çš„ä¿¡æ¯ä¹Ÿä¸¢æ‰äº†ã€‚</li></ul></li><li><p>ç»“è®º</p><ul><li>Studentå…³ç³»æ¨¡å¼ä¸æ˜¯ä¸€ä¸ªå¥½çš„æ¨¡å¼ã€‚</li><li>ä¸€ä¸ªâ€œå¥½â€çš„æ¨¡å¼åº”å½“ä¸ä¼šå‘ç”Ÿæ’å…¥å¼‚å¸¸ã€åˆ é™¤å¼‚å¸¸å’Œæ›´æ–°å¼‚å¸¸ï¼Œæ•°æ®å†—ä½™åº”å°½å¯èƒ½å°‘ã€‚</li></ul></li><li><p>åŸå› <br>ç”±å­˜åœ¨äºæ¨¡å¼ä¸­çš„æŸäº›æ•°æ®ä¾èµ–å¼•èµ·çš„ã€‚</p></li><li><p>è§£å†³æ–¹æ³•<br>ç”¨è§„èŒƒåŒ–ç†è®ºæ”¹é€ å…³ç³»æ¨¡å¼æ¥æ¶ˆé™¤å…¶ä¸­ä¸åˆé€‚çš„æ•°æ®ä¾èµ–</p></li><li><p>æŠŠè¿™ä¸ªå•ä¸€çš„æ¨¡å¼åˆ†æˆä¸‰ä¸ªå…³ç³»æ¨¡å¼ï¼š</p><ul><li>S(Sno,Sdept,Sno â†’ Sdept);</li><li>SC(Sno,Cno,Grade,(Sno,Cno) â†’ Grade);</li><li>DEPT(Sdept,Mname,Sdept â†’ Mname);</li></ul></li><li><p>è¿™ä¸‰ä¸ªæ¨¡å¼éƒ½ä¸ä¼šå‘ç”Ÿæ’å…¥å¼‚å¸¸ã€åˆ é™¤å¼‚å¸¸çš„é—®é¢˜ï¼Œæ•°æ®çš„å†—ä½™ä¹Ÿå¾—åˆ°äº†æ§åˆ¶ã€‚</p></li></ul><h2 id="è§„èŒƒåŒ–">è§„èŒƒåŒ–</h2><h3 id="å‡½æ•°ä¾èµ–">å‡½æ•°ä¾èµ–</h3><ul><li><p>å®šä¹‰6.1</p><p>è®¾R(U)æ˜¯ä¸€ä¸ªå±æ€§é›†Uä¸Šçš„å…³ç³»æ¨¡å¼ï¼ŒXå’ŒYæ˜¯Uçš„å­é›†ã€‚è‹¥å¯¹äºR(U)çš„ä»»æ„ä¸€ä¸ªå¯èƒ½çš„å…³ç³»rï¼Œr ä¸­ä¸å¯èƒ½å­˜åœ¨ä¸¤ä¸ªå…ƒç»„åœ¨Xä¸Šçš„å±æ€§å€¼ç›¸ç­‰ï¼Œ è€Œåœ¨Yä¸Šçš„å±æ€§å€¼ä¸ç­‰ï¼Œ åˆ™ç§°â€œXå‡½æ•°ç¡®å®šYâ€æˆ–â€œYå‡½æ•°ä¾èµ–äºXâ€ï¼Œè®°ä½œXâ†’Yã€‚</p></li><li><p>[ä¾‹] Student(Sno, Sname, Ssex, Sage, Sdept),<br>å‡è®¾ä¸å…è®¸é‡åï¼Œåˆ™æœ‰:<br>Sno â†’ Ssexï¼Œ      Sno â†’ Sage<br>Sno â†’ Sdeptï¼Œ    Sno â†â†’ Sname<br>Sname â†’ Ssexï¼Œ Sname â†’ Sage<br>Sname â†’ Sdept<br>ä½†Ssex â†’Sage, Ssexâ†’ Sdept</p><p>è‹¥Xâ†’Yï¼Œå¹¶ä¸”Yâ†’X, åˆ™è®°ä¸ºXâ†â†’Yã€‚<br>è‹¥Yä¸å‡½æ•°ä¾èµ–äºX, åˆ™è®°ä¸ºXâ†’Yã€‚</p></li><li><p>Xâ†’Yï¼Œä½†YâŠˆXåˆ™ç§°Xâ†’Yæ˜¯éå¹³å‡¡çš„å‡½æ•°ä¾èµ–ã€‚</p></li><li><p>Xâ†’Yï¼Œä½†YâŠ†X åˆ™ç§°Xâ†’Yæ˜¯å¹³å‡¡çš„å‡½æ•°ä¾èµ–ã€‚</p></li><li><p>å¯¹äºä»»ä¸€å…³ç³»æ¨¡å¼ï¼Œå¹³å‡¡å‡½æ•°ä¾èµ–éƒ½æ˜¯å¿…ç„¶æˆç«‹çš„ï¼Œå®ƒä¸åæ˜ æ–°çš„è¯­ä¹‰ã€‚<br>è‹¥ä¸ç‰¹åˆ«å£°æ˜ï¼Œ æˆ‘ä»¬æ€»æ˜¯è®¨è®ºéå¹³å‡¡å‡½æ•°ä¾èµ–ã€‚</p></li><li><p>è‹¥Xâ†’Yï¼Œåˆ™Xç§°ä¸ºè¿™ä¸ªå‡½æ•°ä¾èµ–çš„å†³å®šå› ç´ ï¼ˆDeterminantï¼‰ã€‚<br>è‹¥Xâ†’Yï¼ŒYâ†’Xï¼Œåˆ™è®°ä½œXâ†â†’Yã€‚<br>è‹¥Yä¸å‡½æ•°ä¾èµ–äºXï¼Œåˆ™è®°ä½œXâ†›Yã€‚</p></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/1610897081703.jpg" alt=""></p><ul><li>å®šä¹‰6.3  åœ¨R(U)ä¸­ï¼Œå¦‚æœXâ†’Y(YâŠˆX)ï¼ŒYâ†›Xï¼ŒYâ†’Zï¼ŒZâŠˆY, åˆ™ç§°Zå¯¹Xä¼ é€’å‡½æ•°ä¾èµ–(transitive functional dependency)ã€‚è®°ä¸ºï¼šX â†’ Zã€‚<br>æ³¨: å¦‚æœYâ†’X, å³Xâ†â†’Yï¼Œåˆ™Zç›´æ¥ä¾èµ–äºXï¼Œè€Œä¸æ˜¯ä¼ é€’å‡½æ•°ä¾èµ–ã€‚<br>[ä¾‹] åœ¨å…³ç³»Std(Sno, Sdept, Mname)ä¸­ï¼Œæœ‰ï¼š<br>Sno â†’ Sdeptï¼ŒSdept â†’ Mnameï¼Œ<br>Mnameä¼ é€’å‡½æ•°ä¾èµ–äºSno</li></ul><h3 id="ç ">ç </h3><ul><li><p>å®šä¹‰6.4</p><p>è®¾Kä¸ºR&lt;U,F&gt;ä¸­çš„å±æ€§æˆ–å±æ€§ç»„åˆã€‚è‹¥K â†’ Uï¼Œåˆ™Kç§°ä¸ºRçš„ä¸€ä¸ªå€™é€‰ç (Candidate Key)ã€‚å”¯ä¸€æ ‡è¯†å®ä½“çš„å±æ€§æˆ–å±æ€§ç»„åˆç§°ä¸ºç <br>å¦‚æœUéƒ¨åˆ†å‡½æ•°ä¾èµ–äºKï¼Œå³K â†’ U,åˆ™Kç§°ä¸ºè¶…ç       ï¼ˆSurpkeyï¼‰ã€‚å€™é€‰ç æ˜¯æœ€å°çš„è¶…ç ï¼Œå³Kçš„ä»»æ„ä¸€ä¸ªçœŸå­é›†éƒ½ä¸æ˜¯å€™é€‰ç ã€‚</p></li><li><p>è‹¥å…³ç³»æ¨¡å¼Ræœ‰å¤šä¸ªå€™é€‰ç ï¼Œåˆ™é€‰å®šå…¶ä¸­çš„ä¸€ä¸ªåšä¸ºä¸»ç (Primary key)ã€‚</p></li><li><p>ä¸»å±æ€§ä¸éä¸»å±æ€§<br>åŒ…å«åœ¨ä»»ä½•ä¸€ä¸ªå€™é€‰ç ä¸­çš„å±æ€§ ï¼Œç§°ä¸ºä¸»å±æ€§          ï¼ˆPrime attributeï¼‰<br>ä¸åŒ…å«åœ¨ä»»ä½•ç ä¸­çš„å±æ€§ç§°ä¸ºéä¸»å±æ€§ï¼ˆNonprime attributeï¼‰æˆ–éç å±æ€§ï¼ˆNon-key attributeï¼‰</p></li><li><p>å…¨ç ï¼šæ•´ä¸ªå±æ€§ç»„æ˜¯ç ï¼Œç§°ä¸ºå…¨ç ï¼ˆAll-keyï¼‰</p></li><li><p>ä¸»ç =ä¸»é”®=ä¸»å…³é”®å­—ï¼Œ<br>å…³é”®å­—=å€™é€‰ç <br>å€™é€‰å…³é”®å­—=å€™é€‰ç ä¸­é™¤å»ä¸»ç çš„å…¶ä»–å€™é€‰ç </p></li><li><p>[ä¾‹6.2]S(Sno, Sdept, Sage)ï¼Œå•ä¸ªå±æ€§Snoæ˜¯ç <br>SC(Sno, Cno, Grade)ä¸­ï¼Œ(Sno, Cno)æ˜¯ç </p></li><li><p>[ä¾‹6.3] R(P,W,A) Pï¼šæ¼”å¥è€…     Wï¼šä½œå“    Aï¼šå¬ä¼—<br>ä¸€ä¸ªæ¼”å¥è€…å¯ä»¥æ¼”å¥å¤šä¸ªä½œå“<br>æŸä¸€ä½œå“å¯è¢«å¤šä¸ªæ¼”å¥è€…æ¼”å¥<br>å¬ä¼—å¯ä»¥æ¬£èµä¸åŒæ¼”å¥è€…çš„ä¸åŒä½œå“<br>ç ä¸º(P,W,A)ï¼Œå³All-Key</p></li><li><p>å®šä¹‰6.5  å…³ç³»æ¨¡å¼ Rä¸­å±æ€§æˆ–å±æ€§ç»„X å¹¶é Rçš„ç ï¼Œä½† X æ˜¯å¦ä¸€ä¸ªå…³ç³»æ¨¡å¼çš„ç ï¼Œåˆ™ç§° X æ˜¯R çš„å¤–éƒ¨ç ï¼ˆForeign keyï¼‰ä¹Ÿç§°å¤–ç ã€‚</p><ul><li>SC(Sno,Cno,Grade)ä¸­ï¼ŒSnoä¸æ˜¯ç </li><li>Snoæ˜¯ S(Sno,Sdept,Sage)çš„ç ï¼Œåˆ™Snoæ˜¯SCçš„å¤–ç </li></ul></li><li><p>ä¸»ç ä¸å¤–éƒ¨ç ä¸€èµ·æä¾›äº†è¡¨ç¤ºå…³ç³»é—´è”ç³»çš„æ‰‹æ®µ</p></li></ul><h3 id="èŒƒå¼">èŒƒå¼</h3><ul><li><p>èŒƒå¼æ˜¯ç¬¦åˆæŸä¸€ç§çº§åˆ«çš„å…³ç³»æ¨¡å¼çš„é›†åˆã€‚</p></li><li><p>ä½œä¸ºäºŒç»´è¡¨ï¼Œå…³ç³»è¦ç¬¦åˆä¸€ä¸ªæœ€åŸºæœ¬çš„æ¡ä»¶ï¼šæ¯ä¸ªåˆ†é‡å¿…é¡»æ˜¯ä¸å¯åˆ†å¼€çš„æ•°æ®é¡¹ã€‚æ»¡è¶³äº†è¿™ä¸ªæ¡ä»¶çš„å…³ç³»æ¨¡å¼å°±å±äºç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰</p></li><li><p>å…³ç³»æ•°æ®åº“ä¸­çš„å…³ç³»å¿…é¡»æ»¡è¶³ä¸€å®šçš„è¦æ±‚ã€‚æ»¡è¶³   ä¸åŒç¨‹åº¦è¦æ±‚çš„ä¸ºä¸åŒèŒƒå¼ã€‚</p></li><li><p>èŒƒå¼çš„ç§ç±»</p><ul><li>ç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰</li><li>ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰</li><li>ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰</li><li>BCèŒƒå¼ï¼ˆBCNFï¼‰</li><li>ç¬¬å››èŒƒå¼ï¼ˆ4NFï¼‰</li><li>ç¬¬äº”èŒƒå¼ï¼ˆ5NFï¼‰</li></ul></li><li><p>å„ç§èŒƒå¼ä¹‹é—´å­˜åœ¨è”ç³»ï¼š<br>æŸä¸€å…³ç³»æ¨¡å¼Rä¸ºç¬¬nèŒƒå¼ï¼Œå¯ç®€è®°ä¸ºRâˆˆnNFã€‚</p></li><li><p>ä¸€ä¸ªä½ä¸€çº§èŒƒå¼çš„å…³ç³»æ¨¡å¼ï¼Œé€šè¿‡æ¨¡å¼åˆ†è§£ï¼ˆschema decompositionï¼‰å¯ä»¥è½¬æ¢ä¸ºè‹¥å¹²ä¸ªé«˜ä¸€çº§èŒƒå¼çš„å…³ç³»æ¨¡å¼çš„é›†åˆï¼Œè¿™ç§è¿‡ç¨‹å°±å«è§„èŒƒåŒ–ï¼ˆnormalizationï¼‰ã€‚</p></li></ul><h3 id="2NF">2NF</h3><ul><li><p>å®šä¹‰6.6  è‹¥å…³ç³»æ¨¡å¼Râˆˆ1NFï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªéä¸»å±æ€§éƒ½å®Œå…¨å‡½æ•°ä¾èµ–äºä»»ä½•ä¸€ä¸ªå€™é€‰ç ï¼Œåˆ™Râˆˆ2NF</p></li><li><p>[ä¾‹6.4]  S-L-C(Sno,Sdept,Sloc,Cno,Grade)ï¼Œ Slocä¸ºå­¦ç”Ÿçš„ä½å¤„ï¼Œå¹¶ä¸”æ¯ä¸ªç³»çš„å­¦ç”Ÿä½åœ¨åŒä¸€ä¸ªåœ°æ–¹ã€‚S-L-Cçš„ç ä¸º(Sno,Cno)ã€‚<br>å‡½æ•°ä¾èµ–æœ‰</p><ul><li>(Sno,Cno)â†’Grade</li><li>Snoâ†’Sdept, (Sno,Cno)â†’Sdept</li><li>Snoâ†’Sloc, (Sno,Cno)â†’Sloc</li><li>Sdeptâ†’Sloc</li></ul></li><li><p>ä¸€ä¸ªå…³ç³»æ¨¡å¼ä¸å±äº2NFï¼Œä¼šäº§ç”Ÿä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li>æ’å…¥å¼‚å¸¸<br>å¦‚æœæ’å…¥ä¸€ä¸ªæ–°å­¦ç”Ÿï¼Œä½†è¯¥ç”Ÿæœªé€‰è¯¾ï¼Œå³è¯¥ç”Ÿæ— Cnoï¼Œç”±äºæ’å…¥å…ƒç»„æ—¶ï¼Œå¿…é¡»ç»™å®šç å€¼ï¼Œå› æ­¤æ’å…¥å¤±è´¥ã€‚</li><li>åˆ é™¤å¼‚å¸¸<br>å¦‚æœS4åªé€‰äº†ä¸€é—¨è¯¾C3ï¼Œç°åœ¨ä»–ä¸å†é€‰è¿™é—¨è¯¾ï¼Œåˆ™åˆ é™¤C3åï¼Œæ•´ä¸ªå…ƒç»„çš„å…¶ä»–ä¿¡æ¯ä¹Ÿè¢«åˆ é™¤äº†ã€‚</li><li>ä¿®æ”¹å¤æ‚<br>å¦‚æœä¸€ä¸ªå­¦ç”Ÿé€‰äº†å¤šé—¨è¯¾ï¼Œåˆ™Sdeptï¼ŒSlocè¢«å­˜å‚¨äº†å¤šæ¬¡ã€‚å¦‚æœè¯¥ç”Ÿè½¬ç³»ï¼Œåˆ™éœ€è¦ä¿®æ”¹æ‰€æœ‰ç›¸å…³çš„Sdeptå’ŒSlocï¼Œé€ æˆä¿®æ”¹çš„å¤æ‚åŒ–ã€‚</li></ul></li><li><p>å‡ºç°è¿™ç§é—®é¢˜çš„åŸå› </p><ul><li>ä¾‹å­ä¸­æœ‰ä¸¤ç±»éä¸»å±æ€§ï¼š<ul><li>ä¸€ç±»å¦‚Gradeï¼Œå®ƒå¯¹ç å®Œå…¨å‡½æ•°ä¾èµ–</li><li>å¦ä¸€ç±»å¦‚Sdeptã€Slocï¼Œå®ƒä»¬å¯¹ç ä¸æ˜¯å®Œå…¨å‡½æ•°ä¾èµ–</li></ul></li></ul></li><li><p>è§£å†³æ–¹æ³•ï¼š</p><ul><li>ç”¨æŠ•å½±åˆ†è§£æŠŠå…³ç³»æ¨¡å¼S-L-Cåˆ†è§£æˆä¸¤ä¸ªå…³ç³»æ¨¡å¼<ul><li>SC(Sno,Cno,Grade)</li><li>S-L(Sno,Sdept,Sloc)</li></ul></li></ul></li><li><p>SCçš„ç ä¸º(Sno,Cno),SLçš„ç ä¸ºSnoï¼Œè¿™æ ·ä½¿å¾—éä¸»å±æ€§å¯¹å€™é€‰ç éƒ½æ˜¯å®Œå…¨å‡½æ•°ä¾èµ–äº†ï¼Œå•å…³é”®å­—çš„æ•°æ®åº“è¡¨éƒ½ç¬¦åˆç¬¬äºŒèŒƒå¼</p></li></ul><h3 id="3NF">3NF</h3><ul><li><p>å®šä¹‰6.7ï¼ˆæ— ä¼ é€’å‡½æ•°ä¾èµ–å³3NFï¼‰</p><p>è®¾å…³ç³»æ¨¡å¼R&lt;U,F&gt;âˆˆ1NF,è‹¥Rä¸­ä¸å­˜åœ¨è¿™æ ·çš„ç Xã€å±æ€§ç»„Y(éç )åŠéä¸»å±æ€§Zï¼ˆZ âŠˆ Yï¼‰, ä½¿å¾—Xâ†’Y(YâŠˆXï¼ŒY â†› X)ï¼ŒYâ†’Zæˆç«‹ï¼Œåˆ™ç§°R&lt;U,F&gt; âˆˆ 3NFã€‚</p><ul><li>SCæ²¡æœ‰ä¼ é€’ä¾èµ–ï¼Œå› æ­¤SC âˆˆ 3NF</li><li>S-Lä¸­Sno â†’Sdept( Sdept â†› Sno), Sdeptâ†’Slocï¼Œå¯å¾—Sno  â†’  Slocã€‚</li><li>è§£å†³çš„åŠæ³•æ˜¯å°†S-Låˆ†è§£æˆ<ul><li>S-D(Sno,Sdept)âˆˆ 3NF</li><li>D-L(Sdept,Sloc)âˆˆ 3NF</li></ul></li></ul></li><li><p>åŸºäº2NFï¼Œéä¸»å±æ€§ä¸èƒ½å‡½æ•°ä¾èµ–äºéç ã€‚æ­¤å¤–ï¼Œéä¸»å±æ€§åªèƒ½å­˜åœ¨ä¸€ä¸ªè¡¨ä¸­ï¼Œä¸åº”è¯¥å­˜åœ¨å¤šä¸ªè¡¨ä¸­ï¼›</p></li></ul><h3 id="BCNF">BCNF</h3><ul><li><p>BCNFï¼ˆBoyce Codd Normal Formï¼‰ç”±Boyceå’ŒCoddæå‡ºï¼Œæ¯”3NFæ›´è¿›äº†ä¸€æ­¥ã€‚é€šå¸¸è®¤ä¸ºBCNFæ˜¯ä¿®æ­£çš„ç¬¬ä¸‰èŒƒå¼ï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸ºæ‰©å……çš„ç¬¬ä¸‰èŒƒå¼ã€‚</p></li><li><p>å®šä¹‰6.8</p><p>è®¾å…³ç³»æ¨¡å¼R&lt;U,F&gt;âˆˆ1NFï¼Œè‹¥X â†’Yä¸”Y âŠ† Xæ—¶Xå¿…å«æœ‰ç ï¼Œåˆ™R&lt;U,F&gt;âˆˆBCNFã€‚</p></li><li><p>æ¢è¨€ä¹‹ï¼Œåœ¨å…³ç³»æ¨¡å¼R&lt;U,F&gt;ä¸­ï¼Œå¦‚æœæ¯ä¸€ä¸ªå†³å®šå±æ€§é›†éƒ½åŒ…å«å€™é€‰ç ï¼Œåˆ™RâˆˆBCNFã€‚</p></li><li><p>BCNFçš„å…³ç³»æ¨¡å¼æ‰€å…·æœ‰çš„æ€§è´¨</p><ul><li>æ‰€æœ‰éä¸»å±æ€§éƒ½å®Œå…¨å‡½æ•°ä¾èµ–äºæ¯ä¸ªå€™é€‰ç (2NF)</li><li>æ‰€æœ‰ä¸»å±æ€§éƒ½å®Œå…¨å‡½æ•°ä¾èµ–äºæ¯ä¸ªä¸åŒ…å«å®ƒçš„å€™é€‰ç (BCNF)</li><li>æ²¡æœ‰ä»»ä½•å±æ€§å®Œå…¨å‡½æ•°ä¾èµ–äºéç çš„ä»»ä½•ä¸€ç»„å±æ€§(3NF+)</li></ul></li><li><p>å¦‚æœä¸€ä¸ªå…³ç³»æ•°æ®åº“ä¸­çš„æ‰€æœ‰å…³ç³»æ¨¡å¼éƒ½å±äºBCNFï¼Œé‚£ä¹ˆåœ¨å‡½æ•°ä¾èµ–èŒƒç•´å†…ï¼Œå®ƒå·²å®ç°äº†æ¨¡å¼çš„å½»åº•åˆ†è§£ï¼Œè¾¾åˆ°äº†æœ€é«˜çš„è§„èŒƒåŒ–ç¨‹åº¦ï¼Œæ¶ˆé™¤äº†æ’å…¥å¼‚å¸¸å’Œåˆ é™¤å¼‚å¸¸ã€‚</p></li><li><p>[ä¾‹6.5]è€ƒå¯Ÿå…³ç³»æ¨¡å¼C(Cno,Cname,Pcno)</p></li><li><p>[ä¾‹6.6] å…³ç³»æ¨¡å¼S(Sno,Sname,Sdept,Sage)ï¼Œ</p><ul><li>å‡å®šSnameä¹Ÿå…·æœ‰å”¯ä¸€æ€§ï¼Œé‚£ä¹ˆSå°±æœ‰ä¸¤ä¸ªç ï¼Œè¿™ä¸¤ä¸ªç éƒ½ç”±å•ä¸ªå±æ€§ç»„æˆï¼Œå½¼æ­¤ä¸ç›¸äº¤ã€‚</li><li>å…¶ä»–å±æ€§ä¸å­˜åœ¨å¯¹ç çš„ä¼ é€’ä¾èµ–ä¸éƒ¨åˆ†ä¾èµ–ï¼Œæ‰€ä»¥Sâˆˆ3NFã€‚</li><li>åŒæ—¶Sä¸­é™¤Snoï¼ŒSnameå¤–æ²¡æœ‰å…¶ä»–å†³å®šå› ç´ ï¼Œæ‰€ä»¥Sä¹Ÿå±äºBCNFã€‚</li></ul></li><li><p>[ä¾‹6.7] å…³ç³»æ¨¡å¼SJP(S,J,P)ä¸­ï¼ŒSæ˜¯å­¦ç”Ÿï¼ŒJè¡¨ç¤º<br>è¯¾ç¨‹ï¼ŒPè¡¨ç¤ºåæ¬¡ã€‚æ¯ä¸€ä¸ªå­¦ç”Ÿé€‰ä¿®æ¯é—¨è¯¾ç¨‹çš„æˆç»©æœ‰ä¸€å®šçš„åæ¬¡ï¼Œæ¯é—¨è¯¾ç¨‹ä¸­æ¯ä¸€åæ¬¡åªæœ‰ä¸€ä¸ªå­¦ç”Ÿï¼ˆå³æ²¡æœ‰å¹¶åˆ—åæ¬¡ï¼‰ã€‚</p><ul><li><p>ç”±è¯­ä¹‰å¯å¾—åˆ°å‡½æ•°ä¾èµ–ï¼š (S,J)â†’Pï¼›(J,P)â†’S(S,J)ä¸(J,P)éƒ½å¯ä»¥ä½œä¸ºå€™é€‰ç ã€‚</p></li><li><p>å…³ç³»æ¨¡å¼ä¸­æ²¡æœ‰å±æ€§å¯¹ç ä¼ é€’ä¾èµ–æˆ–éƒ¨åˆ†ä¾èµ–ï¼Œæ‰€ä»¥   SJPâˆˆ3NFã€‚</p></li><li><p>é™¤(S,J)ä¸(J,P)ä»¥å¤–æ²¡æœ‰å…¶ä»–å†³å®šå› ç´ ï¼Œæ‰€ä»¥SJPâˆˆBCNFã€‚</p></li></ul></li><li><p>[ä¾‹6.8] å…³ç³»æ¨¡å¼STJ(S,T,J)ä¸­ï¼ŒSè¡¨ç¤ºå­¦ç”Ÿï¼ŒTè¡¨ç¤ºæ•™å¸ˆï¼ŒJè¡¨ç¤ºè¯¾ç¨‹ã€‚æ¯ä¸€æ•™å¸ˆåªæ•™ä¸€é—¨è¯¾ã€‚æ¯é—¨è¯¾æœ‰è‹¥å¹²æ•™å¸ˆï¼ŒæŸä¸€å­¦ç”Ÿé€‰å®šæŸé—¨è¯¾ï¼Œå°±å¯¹åº”ä¸€ä¸ªå›ºå®šçš„æ•™å¸ˆã€‚</p><ul><li>ç”±è¯­ä¹‰å¯å¾—åˆ°å‡½æ•°ä¾èµ–ï¼š(S,J)â†’Tï¼›(S,T)â†’Jï¼›Tâ†’J</li><li>å› ä¸ºæ²¡æœ‰ä»»ä½•éä¸»å±æ€§å¯¹ç ä¼ é€’ä¾èµ–æˆ–éƒ¨åˆ†ä¾èµ–ï¼ŒSTJ âˆˆ 3NFã€‚</li><li>å› ä¸ºTæ˜¯å†³å®šå› ç´ ï¼Œè€ŒTä¸åŒ…å«ç ï¼Œæ‰€ä»¥STJ âˆˆ BCNFå…³ç³»ã€‚BCNFæ¯ä¸ªå±æ€§å‡å®Œå…¨ä¾èµ–äºæ¯ä¸ªå€™é€‰ç (ä¸å«å®ƒ)</li></ul></li><li><p>å¯¹äºä¸æ˜¯BCNFçš„å…³ç³»æ¨¡å¼ï¼Œä»ç„¶å­˜åœ¨ä¸åˆé€‚çš„åœ°æ–¹ã€‚</p></li><li><p>éBCNFçš„å…³ç³»æ¨¡å¼ä¹Ÿå¯ä»¥é€šè¿‡åˆ†è§£æˆä¸ºBCNFã€‚ä¾‹å¦‚STJå¯åˆ†è§£ä¸ºST(S,T)ä¸TJ(T,J)ï¼Œå®ƒä»¬éƒ½æ˜¯BCNFã€‚</p></li><li><p>3NFå’ŒBCNFæ˜¯åœ¨å‡½æ•°ä¾èµ–çš„æ¡ä»¶ä¸‹å¯¹æ¨¡å¼åˆ†è§£æ‰€èƒ½è¾¾åˆ°çš„åˆ†ç¦»ç¨‹åº¦çš„æµ‹åº¦ã€‚</p><ul><li>ä¸€ä¸ªæ¨¡å¼ä¸­çš„å…³ç³»æ¨¡å¼å¦‚æœéƒ½å±äºBCNFï¼Œé‚£ä¹ˆåœ¨å‡½æ•°ä¾èµ–èŒƒç•´å†…ï¼Œå®ƒå·²å®ç°äº†å½»åº•çš„åˆ†ç¦»ï¼Œå·²æ¶ˆé™¤äº†æ’å…¥å’Œåˆ é™¤çš„å¼‚å¸¸ã€‚</li><li>3NFçš„â€œä¸å½»åº•â€æ€§è¡¨ç°åœ¨å¯èƒ½å­˜åœ¨ä¸»å±æ€§å¯¹ç çš„éƒ¨åˆ†ä¾èµ–å’Œä¼ é€’ä¾èµ–ã€‚</li></ul></li></ul><h3 id="è§„èŒƒåŒ–å°ç»“">è§„èŒƒåŒ–å°ç»“</h3><ul><li><p>åœ¨å…³ç³»æ•°æ®åº“ä¸­ï¼Œå¯¹å…³ç³»æ¨¡å¼çš„åŸºæœ¬è¦æ±‚æ˜¯æ»¡è¶³ç¬¬ä¸€èŒƒå¼ã€‚</p></li><li><p>è§„èŒƒåŒ–ç¨‹åº¦è¿‡ä½çš„å…³ç³»ä¸ä¸€å®šèƒ½å¤Ÿå¾ˆå¥½åœ°æè¿°ç°å®ä¸–ç•Œ</p><ul><li>å¯èƒ½å­˜åœ¨æ’å…¥å¼‚å¸¸ã€åˆ é™¤å¼‚å¸¸ã€ä¿®æ”¹å¤æ‚ã€æ•°æ®å†—ä½™ç­‰é—®é¢˜</li><li>è§£å†³æ–¹æ³•å°±æ˜¯å¯¹å…¶è¿›è¡Œè§„èŒƒåŒ–ï¼Œè½¬æ¢æˆé«˜çº§èŒƒå¼ã€‚</li></ul></li><li><p>ä¸€ä¸ªä½ä¸€çº§èŒƒå¼çš„å…³ç³»æ¨¡å¼ï¼Œé€šè¿‡æ¨¡å¼åˆ†è§£å¯ä»¥è½¬æ¢ä¸ºè‹¥å¹²ä¸ªé«˜ä¸€çº§èŒƒå¼çš„å…³ç³»æ¨¡å¼é›†åˆï¼Œè¿™ç§è¿‡ç¨‹å°±å«å…³ç³»æ¨¡å¼çš„è§„èŒƒåŒ–ã€‚</p></li><li><p>å…³ç³»æ•°æ®åº“çš„è§„èŒƒåŒ–ç†è®ºæ˜¯æ•°æ®åº“é€»è¾‘è®¾è®¡çš„å·¥å…·ã€‚</p></li><li><p>è§„èŒƒåŒ–çš„åŸºæœ¬æ€æƒ³</p><ul><li>æ˜¯é€æ­¥æ¶ˆé™¤æ•°æ®ä¾èµ–ä¸­ä¸åˆé€‚çš„éƒ¨åˆ†ï¼Œä½¿æ¨¡å¼ä¸­çš„å„å…³ç³»æ¨¡å¼è¾¾åˆ°æŸç§ç¨‹åº¦çš„â€œåˆ†ç¦»â€ã€‚</li><li>å³é‡‡ç”¨â€œä¸€äº‹ä¸€åœ°â€çš„æ¨¡å¼è®¾è®¡åŸåˆ™<ul><li>è®©ä¸€ä¸ªå…³ç³»æè¿°ä¸€ä¸ªæ¦‚å¿µã€ä¸€ä¸ªå®ä½“æˆ–è€…å®ä½“é—´çš„ä¸€ç§è”ç³»ã€‚</li><li>è‹¥å¤šäºä¸€ä¸ªæ¦‚å¿µå°±æŠŠå®ƒâ€œåˆ†ç¦»â€å‡ºå»ã€‚</li></ul></li><li>å› æ­¤ è§„èŒƒåŒ–å®è´¨ä¸Šæ˜¯æ¦‚å¿µçš„å•ä¸€åŒ–ã€‚</li></ul></li></ul><h2 id="æ•°æ®ä¾èµ–çš„å…¬ç†ç³»ç»Ÿ">æ•°æ®ä¾èµ–çš„å…¬ç†ç³»ç»Ÿ</h2><ul><li><p>ä¸€å¥—æ¨ç†è§„åˆ™ï¼Œæ˜¯æ¨¡å¼åˆ†è§£ç®—æ³•çš„ç†è®ºåŸºç¡€</p></li><li><p>ç”¨é€”</p><ul><li>æ±‚ç»™å®šå…³ç³»æ¨¡å¼çš„ç </li><li>ä»ä¸€ç»„å‡½æ•°ä¾èµ–æ±‚å¾—è•´æ¶µçš„å‡½æ•°ä¾èµ–</li></ul></li><li><p>Armstrongå…¬ç†ç³»ç»Ÿ  è®¾Uä¸ºå±æ€§é›†æ€»ä½“ï¼ŒFæ˜¯Uä¸Šçš„ä¸€ç»„å‡½æ•°ä¾èµ–ï¼Œ äºæ˜¯æœ‰å…³ç³»æ¨¡å¼R &lt;U,F &gt;ã€‚å¯¹R &lt;U,F&gt; æ¥è¯´æœ‰ä»¥ä¸‹çš„æ¨ç†è§„åˆ™ï¼š</p><ul><li>A1 è‡ªåå¾‹ï¼ˆreflexivity ruleï¼‰ï¼šè‹¥Y ïƒ X ïƒ Uï¼Œåˆ™X â†’Y ä¸ºFæ‰€è•´æ¶µã€‚</li><li>A2 å¢å¹¿å¾‹ï¼ˆaugmentation ruleï¼‰ï¼šè‹¥Xâ†’Yä¸ºFæ‰€è•´æ¶µï¼Œä¸”Z ïƒ Uï¼Œåˆ™XZâ†’YZ ä¸ºFæ‰€è•´æ¶µã€‚</li><li>A3 ä¼ é€’å¾‹ï¼ˆtransitivity ruleï¼‰ï¼šè‹¥Xâ†’YåŠYâ†’Zä¸ºFæ‰€è•´æ¶µï¼Œåˆ™Xâ†’Z ä¸ºFæ‰€è•´æ¶µã€‚</li></ul></li><li><p>æ ¹æ®A1ï¼ŒA2ï¼ŒA3è¿™ä¸‰æ¡æ¨ç†è§„åˆ™å¯ä»¥å¾—åˆ°ä¸‹é¢ä¸‰æ¡æ¨ç†è§„åˆ™ï¼š</p><ul><li>åˆå¹¶è§„åˆ™ï¼ˆunion ruleï¼‰ï¼š<br>ç”±Xâ†’Yï¼ŒXâ†’Zï¼Œæœ‰Xâ†’YZã€‚</li><li>ä¼ªä¼ é€’è§„åˆ™ï¼ˆpseudo transitivity ruleï¼‰ï¼š<br>ç”±Xâ†’Yï¼ŒWYâ†’Zï¼Œæœ‰XWâ†’Zã€‚</li><li>åˆ†è§£è§„åˆ™ï¼ˆdecomposition ruleï¼‰ï¼š<br>ç”±Xâ†’YåŠZïƒYï¼Œæœ‰Xâ†’Zã€‚</li></ul></li><li><p>å®šä¹‰6.12</p><p>åœ¨å…³ç³»æ¨¡å¼R&lt;U,F&gt;ä¸­ä¸ºFæ‰€é€»è¾‘è•´æ¶µçš„å‡½æ•°ä¾èµ–çš„å…¨ä½“å«ä½œFçš„é—­åŒ…ï¼Œè®°ä¸ºF +ã€‚</p></li><li><p>å®šä¹‰6.13</p><p>è®¾Fä¸ºå±æ€§é›†Uä¸Šçš„ä¸€ç»„å‡½æ•°ä¾èµ–ï¼ŒXã€Y ïƒUï¼Œ XF+={ A|Xâ†’Aèƒ½ç”±Fæ ¹æ®Armstrongå…¬ç†å¯¼å‡º}ï¼ŒXF+ç§°ä¸ºå±æ€§é›†Xå…³äºå‡½æ•°ä¾èµ–é›†Fçš„é—­åŒ…ã€‚</p></li><li><p>æœ‰æ•ˆæ€§ä¸å®Œå¤‡æ€§çš„å«ä¹‰</p><ul><li>æœ‰æ•ˆæ€§ï¼šç”±F å‡ºå‘æ ¹æ®Armstrongå…¬ç†æ¨å¯¼å‡ºæ¥çš„æ¯ä¸€ä¸ªå‡½æ•°ä¾èµ–ä¸€å®šåœ¨F +ä¸­</li><li>å®Œå¤‡æ€§ï¼šF +ä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°ä¾èµ–ï¼Œå¿…å®šå¯ä»¥ç”±Få‡ºå‘æ ¹æ®Armstrongå…¬ç†æ¨å¯¼å‡ºæ¥</li></ul></li></ul><h2 id="å°ç»“">å°ç»“</h2><ul><li>è‹¥è¦æ±‚åˆ†è§£å…·æœ‰æ— æŸè¿æ¥æ€§ï¼Œé‚£ä¹ˆæ¨¡å¼åˆ†è§£ä¸€å®šèƒ½å¤Ÿè¾¾åˆ°4NFã€‚</li><li>è‹¥è¦æ±‚åˆ†è§£ä¿æŒå‡½æ•°ä¾èµ–ï¼Œé‚£ä¹ˆæ¨¡å¼åˆ†è§£ä¸€å®šèƒ½å¤Ÿè¾¾åˆ°3NFï¼Œä½†ä¸ä¸€å®šèƒ½å¤Ÿè¾¾åˆ°BCNFã€‚</li><li>è‹¥åˆ†è§£æ—¢å…·æœ‰æ— æŸè¿æ¥æ€§ï¼Œåˆä¿æŒå‡½æ•°ä¾èµ–ï¼Œåˆ™æ¨¡å¼åˆ†è§£ä¸€å®šèƒ½å¤Ÿè¾¾åˆ°3NFï¼Œä½†ä¸ä¸€å®šèƒ½å¤Ÿè¾¾åˆ°BCNFã€‚</li></ul><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/user/3913917127467805">å‰ç«¯LeBron</a></p><p>çŸ¥ä¹ï¼š<a href="https://www.zhihu.com/people/lebronchao">å‰ç«¯LeBron</a></p><p>æŒç»­åˆ†äº«æŠ€æœ¯åšæ–‡ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ‘‡ğŸ»</p><p><img src= "/img/loading.gif" data-lazy-src="https://bloginfo.lebronchao.com/doc-image/v2-be6b9cd0588dddc0e39428cacf11f6a3_720w.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;é—®é¢˜çš„æå‡º&quot;&gt;é—®é¢˜çš„æå‡º&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å…³ç³»æ•°æ®åº“é€»è¾‘è®¾è®¡&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é’ˆå¯¹å…·ä½“é—®é¢˜ï¼Œå¦‚ä½•æ„é€ ä¸€ä¸ªé€‚åˆäºå®ƒçš„æ•°æ®æ¨¡å¼&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“é€»è¾‘è®¾è®¡çš„å·¥å…·â”€â”€å…³ç³»æ•°æ®åº“çš„è§„èŒƒåŒ–ç†è®º&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
</summary>
      
    
    
    
    <category term="æ•°æ®åº“" scheme="https://lebronchao.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://lebronchao.com/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="æ•°æ®åº“" scheme="https://lebronchao.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="SQL" scheme="https://lebronchao.com/tags/SQL/"/>
    
    <category term="åç«¯" scheme="https://lebronchao.com/tags/%E5%90%8E%E7%AB%AF/"/>
    
  </entry>
  
</feed>
